{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":[" "]},"docs":[{"location":"","title":"Home","text":""},{"location":"tags/","title":"Tags","text":""},{"location":"tags/#tag:0_1_bfs","title":"0_1_bfs","text":"<ul> <li>            D1P3 Passport          </li> </ul>"},{"location":"tags/#tag:ad_hoc","title":"ad_hoc","text":"<ul> <li>            D1P2 Prisoner Challenge          </li> <li>            D1P2 Split the Attractions          </li> </ul>"},{"location":"tags/#tag:aho_corasick","title":"aho_corasick","text":"<ul> <li>            Aho-Corasick          </li> </ul>"},{"location":"tags/#tag:binary_search","title":"binary_search","text":"<ul> <li>            D1P1 Two Currencies          </li> </ul>"},{"location":"tags/#tag:bipartite_matching","title":"bipartite_matching","text":"<ul> <li>            K\u0151nig's theorem          </li> </ul>"},{"location":"tags/#tag:bitmask","title":"bitmask","text":"<ul> <li>            D2P2 Council          </li> </ul>"},{"location":"tags/#tag:centroid","title":"centroid","text":"<ul> <li>            D1P2 Split the Attractions          </li> </ul>"},{"location":"tags/#tag:constructive","title":"constructive","text":"<ul> <li>            D1P2 Prisoner Challenge          </li> </ul>"},{"location":"tags/#tag:data_structures","title":"data_structures","text":"<ul> <li>            Aho-Corasick          </li> <li>            D1P1 Arranging Shoes          </li> <li>            D1P1 Two Currencies          </li> <li>            D1P2 Keys          </li> <li>            D1P3 Passport          </li> <li>            D1P3 Radio Towers          </li> <li>            Segment Tree Beats          </li> </ul>"},{"location":"tags/#tag:dfs","title":"dfs","text":"<ul> <li>            D1P2 Split the Attractions          </li> </ul>"},{"location":"tags/#tag:dijkstra","title":"dijkstra","text":"<ul> <li>            D1P3 Passport          </li> <li>            P2 Jakarta Skyscrapers          </li> </ul>"},{"location":"tags/#tag:disjoint_set","title":"disjoint_set","text":"<ul> <li>            D1P2 Keys          </li> </ul>"},{"location":"tags/#tag:divide_and_conquer","title":"divide_and_conquer","text":"<ul> <li>            D1P2 Prisoner Challenge          </li> </ul>"},{"location":"tags/#tag:dp","title":"dp","text":"<ul> <li>            D1P1 Catfish Farm          </li> <li>            D1P2 Prisoner Challenge          </li> <li>            D2P2 Council          </li> <li>            P1 Bali Sculptures          </li> <li>            Tree Optimization          </li> <li>            Tree Optimization 2 (with HLD)          </li> </ul>"},{"location":"tags/#tag:dp_sum_over_subsets","title":"dp_sum_over_subsets","text":"<ul> <li>            D2P2 Council          </li> </ul>"},{"location":"tags/#tag:dp_tree","title":"dp_tree","text":"<ul> <li>            Tree Optimization          </li> <li>            Tree Optimization 2 (with HLD)          </li> </ul>"},{"location":"tags/#tag:euler_tour_technique","title":"euler_tour_technique","text":"<ul> <li>            D1P1 Two Currencies          </li> </ul>"},{"location":"tags/#tag:fft","title":"fft","text":"<ul> <li>            FFT          </li> <li>            FWHT          </li> </ul>"},{"location":"tags/#tag:flow","title":"flow","text":"<ul> <li>            Edmond-Karp algorithm          </li> <li>            Ford\u2013Fulkerson method          </li> <li>            Min Cost Max Flow          </li> </ul>"},{"location":"tags/#tag:graph_traversal","title":"graph_traversal","text":"<ul> <li>            D1P2 Keys          </li> <li>            D1P2 Split the Attractions          </li> </ul>"},{"location":"tags/#tag:graphs","title":"graphs","text":"<ul> <li>            D1P2 Keys          </li> <li>            D1P2 Split the Attractions          </li> <li>            D1P3 Passport          </li> <li>            Edmond-Karp algorithm          </li> <li>            Ford\u2013Fulkerson method          </li> <li>            K\u0151nig's theorem          </li> <li>            Min Cost Max Flow          </li> <li>            P2 Jakarta Skyscrapers          </li> <li>            SCC of Tournament Graph          </li> </ul>"},{"location":"tags/#tag:greedy","title":"greedy","text":"<ul> <li>            D1P1 Arranging Shoes          </li> <li>            D1P2 Split the Attractions          </li> <li>            D1P3 Radio Towers          </li> <li>            D2P1 Mutating DNA          </li> <li>            P1 Bali Sculptures          </li> </ul>"},{"location":"tags/#tag:hld","title":"hld","text":"<ul> <li>            Tree Optimization          </li> <li>            Tree Optimization 2 (with HLD)          </li> </ul>"},{"location":"tags/#tag:implementation","title":"implementation","text":"<ul> <li>            D1P3 Rectangles          </li> </ul>"},{"location":"tags/#tag:kmp","title":"kmp","text":"<ul> <li>            KMP          </li> <li>            Prefix Function          </li> </ul>"},{"location":"tags/#tag:lazyprop","title":"lazyprop","text":"<ul> <li>            Segment Tree Beats          </li> </ul>"},{"location":"tags/#tag:lca","title":"lca","text":"<ul> <li>            D1P1 Two Currencies          </li> </ul>"},{"location":"tags/#tag:math","title":"math","text":"<ul> <li>            FFT          </li> <li>            FWHT          </li> <li>            P1 Strange Device          </li> </ul>"},{"location":"tags/#tag:mcmf","title":"mcmf","text":"<ul> <li>            Min Cost Max Flow          </li> </ul>"},{"location":"tags/#tag:number-theory","title":"number theory","text":"<ul> <li>            P1 Strange Device          </li> </ul>"},{"location":"tags/#tag:offline_queries","title":"offline_queries","text":"<ul> <li>            D1P1 Two Currencies          </li> </ul>"},{"location":"tags/#tag:palindrome_tree","title":"palindrome_tree","text":"<ul> <li>            Eertree          </li> </ul>"},{"location":"tags/#tag:pbs","title":"pbs","text":"<ul> <li>            D1P1 Two Currencies          </li> </ul>"},{"location":"tags/#tag:prefix_sum","title":"prefix_sum","text":"<ul> <li>            D2P1 Mutating DNA          </li> </ul>"},{"location":"tags/#tag:pst","title":"pst","text":"<ul> <li>            D1P1 Two Currencies          </li> <li>            D1P3 Radio Towers          </li> </ul>"},{"location":"tags/#tag:scc","title":"scc","text":"<ul> <li>            D1P2 Keys          </li> <li>            SCC of Tournament Graph          </li> </ul>"},{"location":"tags/#tag:segtree","title":"segtree","text":"<ul> <li>            D1P1 Arranging Shoes          </li> <li>            D1P1 Catfish Farm          </li> <li>            D1P1 Two Currencies          </li> <li>            D1P3 Passport          </li> <li>            D1P3 Radio Towers          </li> <li>            Segment Tree Beats          </li> <li>            Tree Optimization          </li> </ul>"},{"location":"tags/#tag:smaller_to_larger","title":"smaller_to_larger","text":"<ul> <li>            D1P2 Keys          </li> <li>            Tree Optimization          </li> </ul>"},{"location":"tags/#tag:sorting","title":"sorting","text":"<ul> <li>            D1P3 Rectangles          </li> </ul>"},{"location":"tags/#tag:sqrt_decomposition","title":"sqrt_decomposition","text":"<ul> <li>            P2 Jakarta Skyscrapers          </li> </ul>"},{"location":"tags/#tag:stack","title":"stack","text":"<ul> <li>            D1P3 Rectangles          </li> </ul>"},{"location":"tags/#tag:string","title":"string","text":"<ul> <li>            Aho-Corasick          </li> <li>            Eertree          </li> <li>            KMP          </li> <li>            Lyndon Decomposition          </li> <li>            Prefix Function          </li> <li>            Suffix Array &amp; LCP Array          </li> <li>            Suffix Automaton          </li> <li>            Z Function          </li> </ul>"},{"location":"tags/#tag:suffix_array","title":"suffix_array","text":"<ul> <li>            Lyndon Decomposition          </li> <li>            Suffix Array &amp; LCP Array          </li> </ul>"},{"location":"tags/#tag:suffix_tree","title":"suffix_tree","text":"<ul> <li>            Suffix Automaton          </li> </ul>"},{"location":"tags/#tag:tree_set","title":"tree_set","text":"<ul> <li>            D1P3 Radio Towers          </li> </ul>"},{"location":"tags/#tag:trees","title":"trees","text":"<ul> <li>            Aho-Corasick          </li> <li>            D1P1 Two Currencies          </li> <li>            D1P2 Split the Attractions          </li> <li>            Tree Optimization          </li> <li>            Tree Optimization 2 (with HLD)          </li> </ul>"},{"location":"tags/#tag:trie","title":"trie","text":"<ul> <li>            Aho-Corasick          </li> </ul>"},{"location":"tags/#tag:-algorithm","title":"~ algorithm","text":"<ul> <li>            Aho-Corasick          </li> <li>            Biconnected Component          </li> <li>            Edmond-Karp algorithm          </li> <li>            Eertree          </li> <li>            FFT          </li> <li>            FWHT          </li> <li>            Ford\u2013Fulkerson method          </li> <li>            KMP          </li> <li>            K\u0151nig's theorem          </li> <li>            Lyndon Decomposition          </li> <li>            Min Cost Max Flow          </li> <li>            Prefix Function          </li> <li>            Segment Tree Beats          </li> <li>            Suffix Array &amp; LCP Array          </li> <li>            Suffix Automaton          </li> <li>            Z Function          </li> </ul>"},{"location":"tags/#tag:-solution","title":"~ solution","text":"<ul> <li>            APIO 19 P3 Street Lamps          </li> <li>            BOJ 28304 \ub2e4\uc12f \uc6a9\uc0ac\uc758 \uac80          </li> <li>            D1P1 Arranging Shoes          </li> <li>            D1P1 Catfish Farm          </li> <li>            D1P1 Two Currencies          </li> <li>            D1P2 Keys          </li> <li>            D1P2 Prisoner Challenge          </li> <li>            D1P2 Split the Attractions          </li> <li>            D1P3 Passport          </li> <li>            D1P3 Radio Towers          </li> <li>            D1P3 Rectangles          </li> <li>            D2P1 Mutating DNA          </li> <li>            D2P2 Council          </li> <li>            P1 Bali Sculptures          </li> <li>            P1 Strange Device          </li> <li>            P2 Jakarta Skyscrapers          </li> <li>            _          </li> </ul>"},{"location":"tags/#tag:idea","title":"~idea","text":"<ul> <li>            Potential Method          </li> <li>            SCC of Tournament Graph          </li> <li>            Tree Optimization          </li> <li>            Tree Optimization 2 (with HLD)          </li> </ul>"},{"location":"tags/#tag:post","title":"~post","text":"<ul> <li>            OI Review          </li> <li>            SCPC 2025 Round 1          </li> </ul>"},{"location":"algorithms/","title":"Algorithms &amp; Data Structures","text":""},{"location":"algorithms/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Data Structures<ul> <li>Segment Tree Beats</li> </ul> </li> <li>Graphs<ul> <li>Biconnected Component</li> <li>Flows<ul> <li>Ford\u2013Fulkerson method</li> <li>Edmond-Karp algorithm</li> <li>Min Cost Max Flow</li> </ul> </li> <li>Theorems<ul> <li>K\u0151nig's theorem</li> </ul> </li> </ul> </li> <li>Strings<ul> <li>Prefix Function</li> <li>KMP</li> <li>Aho-Corasick</li> <li>Z Function</li> <li>Suffix Array &amp; LCP Array</li> <li>Suffix Automaton</li> <li>Eertree</li> <li>Lyndon Decomposition</li> </ul> </li> <li>Math<ul> <li>Polynomials and Series<ul> <li>FFT</li> <li>FWHT</li> </ul> </li> </ul> </li> </ul>"},{"location":"algorithms/#todo","title":"Todo","text":"<ul> <li>Max Flow Min Cost theorem</li> <li>Sprague - Grundy theorem</li> <li>Dinic's algorithm</li> <li>eertree (paper review)</li> <li>SOS DP</li> <li>CHT (with floor divisions)</li> <li>Li Chao Tree (extended)</li> <li>Linear Programming</li> <li> <p>Alien (with backtracking)</p> </li> <li> <p>k - vertex /edge connected component</p> </li> <li>Menger's theorem</li> <li>well-defineness (maximality) of biconnected component</li> <li>erdos gallai theorem</li> <li>tutte's theorem</li> <li>hall's theorem</li> <li>dilworth's theorem</li> </ul>"},{"location":"algorithms/Data%20Structures/Segment%20Tree%20Beats/algorithm/","title":"Segment Tree Beats","text":"","tags":["data_structures","lazyprop","segtree","~ algorithm"]},{"location":"algorithms/Data%20Structures/Segment%20Tree%20Beats/algorithm/#algorithm","title":"Algorithm","text":"<p>\ub2e4\uc74c \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uc790. (https://www.acmicpc.net/problem/17474)</p> <p>Problem 1</p> <p>\uae38\uc774\uac00 \\(N\\)\uc778 \uc218\uc5f4 \\(A\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c, \ub2e4\uc74c \ucffc\ub9ac\uc640 \uc5c5\ub370\uc774\ud2b8\ub97c \uc218\ud589\ud558\uc5ec\ub77c.</p> <ol> <li>\\(l \\le i \\le r\\)\uc5d0 \ub300\ud558\uc5ec \\(A_i = \\min(A_i, X)\\)\ub85c \ubc14\uafbc\ub2e4.</li> <li>\\(\\max(A_l, A_{l+1}, ..., A_r)\\)\uc744 \ucd9c\ub825\ud55c\ub2e4.</li> <li>\\(A_l+A_{l+1}+...+A_r\\)\uc744 \ucd9c\ub825\ud55c\ub2e4.</li> </ol> <p>\uc6b0\uc120, \uc77c\ubc18\uc801\uc778 segment tree\uc5d0\uc11c\uc758 lazy propagation\uc758 <code>update</code> \ud568\uc218\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \ud615\ud0dc\ub85c \uad6c\ud604\ud560 \uc218 \uc788\ub2e4.</p> <pre><code>void update(int node, int tl, int tr, int l, int r, int k)\n{\n    pushdown(node, tl, tr); // lazy propagation\n    if(r&lt;tl || tr&lt;l) return; // break_condition\n    if(l&lt;=tl &amp;&amp; tr&lt;=r) // tag_condition\n    {\n        putlazy(node, tl, tr, k); // put lazy tag on node\n        pushdown(node, tl, tr);\n        return;\n    }\n    int mid=tl+tr&gt;&gt;1;\n    update(node*2, tl, mid, l, r, k);\n    update(node*2+1, mid+1, tr, l, r, k);\n    pull(node); // pull values from child node\n}\n</code></pre> <p>\uc704 \uad6c\ud604\uc5d0\uc11c <code>break_condition</code>\uacfc <code>tag_condition</code>\uc5d0 \uc9d1\uc911\ud574\ubcf4\uc790. Lazy propagation\uc758 \uae30\ubcf8 \uc544\uc774\ub514\uc5b4\ub294, \ub354 \uc774\uc0c1 \uc5c5\ub370\uc774\ud2b8\uac00 \ud544\uc694 \uc5c6\uc744 \ub54c\ub294 \ubc14\ub85c \uc885\ub8cc\ud558\uace0, \uc5c5\ub370\uc774\ud2b8\ub97c lazy tag\ub97c \ud558\ub098 \ubd99\uc784\uc73c\ub85c\uc11c \ud574\uacb0\ud560 \uc218 \uc788\uc744 \ub54c \ub610\ud55c \ubc14\ub85c \uc885\ub8cc\ud558\ub294 \uac83\uc774\ub2e4. \ub9cc\uc57d \uc5c5\ub370\uc774\ud2b8\ud560 \uad6c\uac04 \\([l, r]\\)\uacfc \ud604\uc7ac \ub178\ub4dc\uc758 \uad6c\uac04 \\([tl, tr]\\)\uc774 \uacb9\uce58\uc9c0 \uc54a\ub294\ub2e4\uba74, \ub354 \uc774\uc0c1 \uc5c5\ub370\uc774\ud2b8\uac00 \ud544\uc694 \uc5c6\uc73c\ub2c8 <code>break_condition</code>\uc740 <code>r&lt;tl || tr&lt;l</code>\uac00 \ub41c\ub2e4. \ubc18\ub300\ub85c, \ub9cc\uc57d \uc5c5\ub370\uc774\ud2b8\ud560 \uad6c\uac04 \\([l, r]\\)\uc774 \ud604\uc7ac \ub178\ub4dc\uc758 \uad6c\uac04 \\([tl, tr]\\)\uc744 \uc644\uc804\ud788 \ud3ec\ud568\ud55c\ub2e4\uba74 \ub354 \uc774\uc0c1 \uc7ac\uadc0 \uc5c6\uc774 \uc774 \uad6c\uac04\uc5d0 \uc804\uccb4\uc801\uc73c\ub85c \uac12\uc744 \uc5c5\ub370\uc774\ud2b8\ud574\uc57c \ud55c\ub2e4\ub294 \uc758\ubbf8\uc774\ub2c8, <code>tag_condition</code>\uc740 <code>l&lt;=tl &amp;&amp; tr&lt;=r</code>\uc774 \ub41c\ub2e4.</p> <p>Algorithm 1</p> <p>\uc77c\ubc18\uc801\uc778 segment tree\uc5d0\uc11c\uc758 lazy propagation\uc758 <code>update</code> \ud568\uc218\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \uc791\ub3d9\ud55c\ub2e4.</p> <p>\uc5c5\ub370\uc774\ud2b8\ud560 \uad6c\uac04 \ubc16\uc758 \ub178\ub4dc\uc778 \uacbd\uc6b0 \uc7ac\uadc0\ub97c \uc885\ub8cc (<code>break_condition</code>), \uad6c\uac04\uc5d0 \uac78\uccd0 \uc788\ub294 \ub178\ub4dc\uc778 \uacbd\uc6b0 \uc7ac\uadc0\ub97c \ubc18\ubcf5\ud558\uba70, \uad6c\uac04 \uc548\uc5d0 \uc644\uc804\ud788 \ud3ec\ud568\ub418\ub294 \ub178\ub4dc\uc778 \uacbd\uc6b0 lazy tag\ub97c \ubd99\uc774\uace0 \uc7ac\uadc0\ub97c \uc885\ub8cc (<code>tag_condition</code>) \ud55c\ub2e4.</p> <pre><code>void update(int node, int tl, int tr, int l, int r, int k)\n{\n    pushdown(node, tl, tr); // lazy propagation\n    if(r&lt;tl || tr&lt;l) return; // break_condition\n    if(l&lt;=tl &amp;&amp; tr&lt;=r) // tag_condition\n    {\n        putlazy(node, tl, tr, k); // put lazy tag on node\n        pushdown(node, tl, tr);\n        return;\n    }\n    int mid=tl+tr&gt;&gt;1;\n    update(node*2, tl, mid, l, r, k);\n    update(node*2+1, mid+1, tr, l, r, k);\n    pull(node); // pull values from child node\n}\n</code></pre> <p>\ud558\uc9c0\ub9cc, \uc77c\ubc18\uc801\uc778 lazy propagation\uc73c\ub85c\ub294 \uc774 \ubb38\uc81c\uc5d0\uc11c \uc694\uad6c\ud558\ub294 \uc5c5\ub370\uc774\ud2b8\uc640 \ucffc\ub9ac\ub97c \ubaa8\ub450 \ucc98\ub9ac\ud560 \uc218 \uc5c6\ub2e4. Segment tree beats\uc5d0\uc11c\ub294, <code>break_condition</code>\uacfc <code>tag_condition</code>\ub97c \uc801\ub2f9\ud788 \uc815\ud558\uc5ec, lazy propagation\ubcf4\ub2e4 \uae4a\uc740 \uc704\uce58\uae4c\uc9c0 \uc7ac\uadc0\ub97c \ubc18\ubcf5\ud558\uc5ec\ub3c4, \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uac00 \ubc14\ub00c\uc9c0 \uc54a\uc74c\uc744 \uc774\uc6a9\ud55c\ub2e4.</p> <p>\uac01 \ub178\ub4dc\ub294 <code>maxv</code>(\ucd5c\ub313\uac12), <code>smax</code>(\ucd5c\ub313\uac12\ubcf4\ub2e4 \uc791\uc740 \uc6d0\uc18c\ub4e4\uc758 \ucd5c\ub313\uac12), <code>sum</code>(\ud569), <code>maxc</code>(\ucd5c\ub313\uac12\uc758 \uac1c\uc218)\ub97c \uad00\ub9ac\ud55c\ub2e4. <code>break_condition</code>\uc740 <code>r&lt;tl || tr&lt;l || tree[node].maxv&lt;=k</code>, \uc989 \uad6c\uac04\uc774 \uacb9\uce58\uc9c0 \uc54a\uac70\ub098, \uad6c\uac04\uc758 \ucd5c\ub313\uac12\uc774 \\(k\\)\ubcf4\ub2e4 \uc791\uac70\ub098 \uac19\uc744 \ub54c\uc774\ub2e4. \uad6c\uac04\uc758 \ucd5c\ub313\uac12\uc774 \\(k\\)\ubcf4\ub2e4 \uc791\uac70\ub098 \uac19\ub2e4\uba74 \uc5c5\ub370\uc774\ud2b8\ub97c \ud574\ub3c4 \uc544\ubb34 \uac12\ub4e4\uc774 \ubcc0\ud558\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0 \ubc14\ub85c \uc885\ub8cc\ud574\ub3c4 \ub41c\ub2e4. <code>tag_condition</code>\uc740 <code>l&lt;=tl &amp;&amp; tr&lt;=r &amp;&amp; tree[node].smax&lt;k</code>, \uc989 \uad6c\uac04 \uc548\uc5d0 \uc644\uc804\ud788 \ud3ec\ud568\ub418\uba70, \ub450 \ubc88\uc9f8 \ucd5c\ub313\uac12\ubcf4\ub2e4 \\(k\\)\uac00 \ud074 \ub54c\uc774\ub2e4. \uad6c\uac04\uc758 \ub450 \ubc88\uc9f8 \ucd5c\ub313\uac12\uc774 \\(k\\)\ubcf4\ub2e4 \ud06c\ub2c8, <code>maxc</code>\ub294 \ubcc0\ud558\uc9c0 \uc54a\uace0 <code>sum</code>\uc740 <code>maxv</code>\uc640 <code>maxc</code>\ub97c \uc774\uc6a9\ud558\uc5ec \uacc4\uc0b0\ud574\uc904 \uc218 \uc788\ub2e4.</p> <p>\ub530\ub77c\uc11c, \uc5c5\ub370\uc774\ud2b8\ud560 \uad6c\uac04 \ubc16\uc758 \ub178\ub4dc\uc5d0\uc11c\ub294 \uc7ac\uadc0\ub97c \uc885\ub8cc, \uad6c\uac04\uc5d0 \uac78\uccd0 \uc788\ub294 \ub178\ub4dc\uc5d0 \ub300\ud574\uc11c\ub294 \uc7ac\uadc0\ub97c \ubc18\ubcf5\ud558\uace0, \uad6c\uac04 \uc548\uc5d0 \uc644\uc804\ud788 \ud3ec\ud568\ub418\ub294 \uacbd\uc6b0 \ub2e4\uc74c\uacfc \uac19\uc774 \uc791\ub3d9\ud55c\ub2e4.</p> <ul> <li>(Case 1) \\(maxv \\le k\\) : \uc7ac\uadc0\ub97c \uc885\ub8cc\ud55c\ub2e4. (<code>break_condition</code>)</li> <li>(Case 2) \\(smax &lt; k &lt; maxv\\) : lazy tag\ub97c \ubd99\uc778 \ud6c4, \\(sum\\)\uc744 \uac31\uc2e0\ud55c \ud6c4 \uc7ac\uadc0\ub97c \uc885\ub8cc\ud55c\ub2e4. (<code>tag_condition</code>)</li> <li>(Case 3) \\(k \\le smax\\) : \uc790\uc2dd \ub178\ub4dc\ub4e4\ub85c \uc7ac\uadc0\ub97c \uacc4\uc18d\ud55c\ub2e4.</li> </ul> <pre><code>void update(int node, int tl, int tr, int l, int r, int k)\n{\n    pushdown(node, tl, tr); // lazy propagation\n    if(r&lt;tl || tr&lt;l || tree[node].maxv&lt;=k) return; // break_condition\n    if(l&lt;=tl &amp;&amp; tr&lt;=r &amp;&amp; tree[node].smax&lt;k) // tag_condition\n    {\n        putlazy(node, tl, tr, k); // put lazy tag on node\n        pushdown(node, tl, tr);\n        return;\n    }\n    int mid=tl+tr&gt;&gt;1;\n    update(node*2, tl, mid, l, r, k);\n    update(node*2+1, mid+1, tr, l, r, k);\n    pull(node); // pull values from child node\n}\n</code></pre> <p>Algorithm 2</p> <p>Segment tree beats\uc5d0\uc11c\uc758 lazy propagation\uc758 <code>update</code> \ud568\uc218\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \uc791\ub3d9\ud55c\ub2e4.</p> <p>\uc5c5\ub370\uc774\ud2b8\ud560 \uad6c\uac04 \ubc16\uc758 \ub178\ub4dc\uc5d0\uc11c\ub294 \uc7ac\uadc0\ub97c \uc885\ub8cc (<code>break_condition</code>), \uad6c\uac04\uc5d0 \uac78\uccd0 \uc788\ub294 \ub178\ub4dc\uc5d0 \ub300\ud574\uc11c\ub294 \uc7ac\uadc0\ub97c \ubc18\ubcf5\ud558\uace0, \uad6c\uac04 \uc548\uc5d0 \uc644\uc804\ud788 \ud3ec\ud568\ub418\ub294 \uacbd\uc6b0 \ub2e4\uc74c\uacfc \uac19\uc774 \uc791\ub3d9\ud55c\ub2e4.</p> <ul> <li>(Case 1) \\(maxv \\le k\\) : \uc7ac\uadc0\ub97c \uc885\ub8cc\ud55c\ub2e4. (<code>break_condition</code>)</li> <li>(Case 2) \\(smax &lt; k &lt; maxv\\) : lazy tag\ub97c \ubd99\uc778 \ud6c4, \\(sum\\)\uc744 \uac31\uc2e0\ud55c \ud6c4 \uc7ac\uadc0\ub97c \uc885\ub8cc\ud55c\ub2e4. (<code>tag_condition</code>)</li> <li>(Case 3) \\(k \\le smax\\) : \uc790\uc2dd \ub178\ub4dc\ub4e4\ub85c \uc7ac\uadc0\ub97c \uacc4\uc18d\ud55c\ub2e4.</li> </ul> <pre><code>void update(int node, int tl, int tr, int l, int r, int k)\n{\n    pushdown(node, tl, tr); // lazy propagation\n    if(r&lt;tl || tr&lt;l || tree[node].maxv&lt;=k) return; // break_condition\n    if(l&lt;=tl &amp;&amp; tr&lt;=r &amp;&amp; tree[node].smax&lt;k) // tag_condition\n    {\n        putlazy(node, tl, tr, k); // put lazy tag on node\n        pushdown(node, tl, tr);\n        return;\n    }\n    int mid=tl+tr&gt;&gt;1;\n    update(node*2, tl, mid, l, r, k);\n    update(node*2+1, mid+1, tr, l, r, k);\n    pull(node); // pull values from child node\n}\n</code></pre>","tags":["data_structures","lazyprop","segtree","~ algorithm"]},{"location":"algorithms/Data%20Structures/Segment%20Tree%20Beats/algorithm/#complexity","title":"Complexity","text":"<p>\uc2dc\uac04\ubcf5\uc7a1\ub3c4 \uc99d\uba85\uc744 \uc704\ud558\uc5ec maximum segment tree\uc5d0\uc11c \uac01 \ub178\ub4dc\uc5d0 \ub300\ud574\uc11c \ub178\ub4dc\uc758 \uac12\uacfc \ubd80\ubaa8\uc758 \uac12\uc774 \ub2e4\ub978 \uc815\uc810\ub4e4\uc5d0\ub9cc tag\ub97c \ubd99\uc774\uace0, \ub098\uba38\uc9c0 \uc815\uc810\uc758 \uac12\uc744 \ubaa8\ub450 \uc9c0\uc6e0\ub2e4\uace0 \uc0dd\uac01\ud558\uc790.</p> <p>Property 1</p> <p>Maximum segment tree\uc5d0\uc11c \uac01 \ub178\ub4dc\uc5d0 \ub300\ud574\uc11c \ub178\ub4dc\uc758 \uac12\uacfc \ubd80\ubaa8\uc758 \uac12\uc774 \ub2e4\ub978 \uc815\uc810\ub4e4\uc5d0\ub9cc tag\ub97c \ubd99\uc774\uace0, \ub098\uba38\uc9c0 \uc815\uc810\uc758 \uac12\uc744 \ubaa8\ub450 \uc9c0\uc6b0\uba74, \ub2e4\uc74c\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> <ul> <li>\ub178\ub4dc \\(v\\)\uac00 \ub098\ud0c0\ub0b4\ub294 \uad6c\uac04\uc758 \\(maxv\\)(\ucd5c\ub313\uac12)\uc744 \uad6c\ud558\uae30 \uc704\ud574\uc11c\ub294, \\(v, par[v], par[par[v]], ...\\)\ub97c \ucc28\ub840\ub300\ub85c \ubcf4\uba70 tag\uac00 \uc788\ub294 \uccab \ubc88\uc9f8 \uc815\uc810\uc758 \uac12\uc744 \uc77d\uc73c\uba74 \ub41c\ub2e4.</li> <li>\ub178\ub4dc \\(v\\)\uac00 \ub098\ud0c0\ub0b4\ub294 \uad6c\uac04\uc758 \\(smax\\)(\ucd5c\ub313\uac12\ubcf4\ub2e4 \uc791\uc740 \uc6d0\uc18c\ub4e4\uc758 \ucd5c\ub313\uac12)\uc744 \uad6c\ud558\uae30 \uc704\ud574\uc11c\ub294 \\(v\\)\uc758 proper subtree\uc758 tag \uc911 \ucd5c\ub300\uac12\uc744 \uc77d\uc73c\uba74 \ub41c\ub2e4.</li> </ul> <p></p> <p>\uc774\uc81c, update \ud568\uc218\ub97c \uc2e4\ud589\ud560 \ub54c tag\uc758 \uc785\uc7a5\uc5d0\uc11c \uc5b4\ub5a4 \ubcc0\ud654\uac00 \uc77c\uc5b4\ub098\ub294\uc9c0 \uad00\ucc30\ud574\ubcf4\uc790.</p> <p>Algorithm 2\uc5d0\uc11c \ud604\uc7ac \ub178\ub4dc\uc758 \uad6c\uac04\uc774 \uc5c5\ub370\uc774\ud2b8\ud560 \uad6c\uac04\uc5d0 \uc644\uc804\ud788 \ud3ec\ud568\ub418\ub294 \uacbd\uc6b0, \uc7ac\uadc0\ub97c \uacc4\uc18d\ud558\ub294 \uc870\uac74\uc740 \\(k \\le smax\\)\uc774\ub2e4. tag\uc758 \uc785\uc7a5\uc5d0\uc11c, \uc774\ub294 Property 1\uc5d0 \uc758\ud574, \ub178\ub4dc\uc758 proper subtree\uc758 tag \uc911 \\(k\\) \uc774\uc0c1\uc778 tag\uac00 \uc788\uc744 \ub54c\ub9cc \uc7ac\uadc0\ub97c \uacc4\uc18d\ud55c\ub2e4\ub294 \uc758\ubbf8\uc774\ub2e4. \ub530\ub77c\uc11c, update \ud568\uc218\ub294 \ub8e8\ud2b8\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uad6c\uac04 \uc548\uc5d0 \uc644\uc804\ud788 \ud3ec\ud568\ub41c tag\ub4e4 \uc911 \\(k\\) \uc774\uc0c1\uc778 tag\uc5d0 \ubaa8\ub450 \ub3c4\ub2ec\ud560 \ub54c\uae4c\uc9c0 \uc7ac\uadc0\ub97c \ubc18\ubcf5\ud55c\ub2e4. \uc774\ud6c4, update \ud568\uc218\uac00 \uc885\ub8cc\ub41c \ud6c4\uc5d0\ub294 \uad6c\uac04 \uc548\uc758 \uac12\ub4e4\uc5d0 \ub300\ud574\uc11c \\(A_i = \\min(A_i, k)\\)\ub97c \uc801\uc6a9\ud558\uc600\uae30 \ub54c\ubb38\uc5d0, \uad6c\uac04 \uc548\uc758 tag\ub4e4 \uc911 \\(k\\) \uc774\uc0c1\uc778 tag\uac00 \ubaa8\ub450 \uc0ad\uc81c\ub418\uace0 \uad6c\uac04\uc758 \ub8e8\ud2b8\uc5d0 \\(k\\)\ub77c\ub294 \uc0c8\ub85c\uc6b4 tag\ub97c \ubd99\uc5ec\uc900\ub2e4.</p> <p>\uc544\ub798 \uadf8\ub9bc\uc740 \uc804\uccb4 \uad6c\uac04\uc5d0 \ub300\ud55c \\(k=4\\)\uc758 update \ud568\uc218\uac00 \uc2e4\ud589\ub420 \ub54c\uc758 \uc608\uc2dc\uc774\ub2e4.</p> <p> </p> <p>Property 2</p> <p>Segment tree beats\uc758 update \ud568\uc218\ub294 \uad6c\uac04 \uc548\uc5d0 \uc644\uc804\ud788 \ud3ec\ud568\ub418\ub294 \ub178\ub4dc\ub4e4\uc5d0 \ub300\ud558\uc5ec \ub8e8\ud2b8\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uad6c\uac04 \uc548\uc5d0 \uc644\uc804\ud788 \ud3ec\ud568\ub41c tag\ub4e4 \uc911 \\(k\\) \uc774\uc0c1\uc778 tag\uc5d0 \ubaa8\ub450 \ub3c4\ub2ec\ud560 \ub54c\uae4c\uc9c0 \uc7ac\uadc0\ub97c \ubc18\ubcf5\ud55c\ub2e4. \uc774\ud6c4, update \ud568\uc218\uac00 \uc885\ub8cc\ub41c \ud6c4\uc5d0\ub294 \uad6c\uac04 \uc548\uc758 tag\ub4e4 \uc911 \\(k\\) \uc774\uc0c1\uc778 tag\uac00 \ubaa8\ub450 \uc0ad\uc81c\ub418\uace0 \uad6c\uac04\uc758 \ub8e8\ud2b8\uc5d0 \\(k\\)\ub77c\ub294 \uc0c8\ub85c\uc6b4 tag\ub97c \ubd99\uc5ec\uc900\ub2e4.</p> <p>Property 2\uc5d0\uc11c \uc2e4\uc81c\ub85c \ubc29\ubb38\ud558\ub294 \uc815\uc810\ub4e4\uc758 \uac1c\uc218\uc758 ammortized complexity\ub97c Potential Method\ub97c \uc774\uc6a9\ud558\uc5ec \uad6c\ud558\uc790. \ud604\uc7ac segment tree\uc758 \uc0c1\ud0dc\ub97c \\(S\\)\ub77c \ud560 \ub54c potential function \\(\\Phi(S)\\)\ub97c \uc815\uc758\ud558\uc790.</p> <p>Definition 1</p> <p>\\(\\Phi(S):=\\) maximum segment tree\uc5d0\uc11c Property 1\uacfc \uac19\uc774 tag\ub97c \ubd99\uc600\uc744 \ub54c, \uac01 tag\uc758 \uae4a\uc774\uc758 \ud569</p> <p>\uc774\uc81c, update \ud568\uc218\ub97c \uc2e4\ud589\ud560 \ub54c\uc758 ammortized \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub97c \ubd84\uc11d\ud574\ubcf4\uc790. \uad6c\uac04 \uc548\uc5d0 \uc644\uc804\ud788 \ud3ec\ud568\ub41c tag\ub4e4 \uc911 \\(k\\) \uc774\uc0c1\uc778 tag\uc758 \uac1c\uc218\ub97c \\(P\\)\uac1c\ub77c \ud558\uc790.</p> <p>\uc5c5\ub370\uc774\ud2b8\ud560 \uad6c\uac04 \ubc16\uc758 \ub178\ub4dc\uc5d0\uc11c\ub294 \uc7ac\uadc0\ub97c \uc885\ub8cc, \uad6c\uac04\uc5d0 \uac78\uccd0 \uc788\ub294 \ub178\ub4dc\uc5d0 \ub300\ud574\uc11c\ub294 \uc7ac\uadc0\ub97c \ubc18\ubcf5\ud55c\ub2e4. \uc774 \uacfc\uc815\uc5d0\uc11c \ubc29\ubb38\ud558\ub294 \ub178\ub4dc\uc758 \uc218\ub294 \uc77c\ubc18\uc801\uc778 segment tree\uc640 \ub611\uac19\uc774 \ucffc\ub9ac\ub2f9 \ucd5c\ub300 \\(O(\\log N)\\)\uc774\ub2e4. \uad6c\uac04 \uc548\uc5d0 \uc644\uc804\ud788 \ud3ec\ud568\ub418\ub294 \ub178\ub4dc \\(node\\)\ub97c \ub9cc\ub098\uba74, \uc784\uc2dc\ub85c \\(node\\)\uc758 \uc2e4\uc81c \uac12(maximum segment tree\uc5d0\uc11c \\(node\\)\uc758 \uac12)\uc5d0 \ud574\ub2f9\ud558\ub294 tag\ub97c \ubd99\uc774\uace0 \uc2dc\uc791\ud55c\ub2e4. \uc774\ud6c4, \uc544\ub798\ub85c \ub0b4\ub824\uac00 \\(P\\)\uac1c\uc758 tag\uc5d0 \ubaa8\ub450 \ub3c4\ub2ec\ud560 \ub54c\uae4c\uc9c0 \uc7ac\uadc0\ub97c \ubc18\ubcf5\ud55c\ub2e4. \uc774 \ub54c \ucd94\uac00\ub85c \ubc29\ubb38\ud558\ub294 \ub178\ub4dc\uc758 \uc218\ub294 \\(O(P\\log N)\\)\uac1c\uc774\ub2e4. \uc7ac\uadc0\ub97c \uc885\ub8cc\ud55c \ud6c4 \ub2e4\uc2dc \uc62c\ub77c\uc624\uba74\uc11c, \\(P\\)\uac1c\uc758 tag\ub97c \ubaa8\ub450 \uc0ad\uc81c\ud55c \ud6c4 \uc774\uc804\uc5d0 \ubd99\uc600\ub358 \ubd88\ud544\uc694\ud55c tag\ub4e4\uae4c\uc9c0 \ubaa8\ub450 \uc815\ub9ac\ud558\uba70 \uc62c\ub77c\uc628\ub2e4. \uc774 \ub54c \uc0ad\uc81c\ub418\ub294 tag\uc758 \uc218\ub294 \\(P\\)\uac1c\ub85c, \\(\\Phi(S)\\)\ub294 \\(O(P\\log N)\\)\ub9cc\ud07c \uac10\uc18c\ud55c\ub2e4.</p> <p>\uc704 \uacfc\uc815\uc744 \uc815\ub9ac\ud558\uba74, \uc77c\ubc18\uc801\uc778 segment tree\uc640 \ub611\uac19\uc774 \ucffc\ub9ac\ub2f9 \ucd5c\ub300 \\(O(\\log N)\\)\uac1c\uc758 \ub178\ub4dc\ub97c \ubc29\ubb38\ud558\uba70, \ucd94\uac00\ub85c \ubc29\ubb38\ud558\ub294 \ub178\ub4dc\ub4e4\uc740 \\(T_{actual}(o)=P\\log N\\), \\(\\varDelta \\Phi(S)=-P\\log N\\)\uc774\ub2c8, \\(T_{ammortized}(o)=\\log N\\)\uc774\ub2e4. \ub530\ub77c\uc11c, segment tree beats\uc758 update \ud568\uc218\ub294 \uac01 \ucffc\ub9ac\ub2f9 ammortized \\(O(\\log N)\\)\uc5d0 \uc791\ub3d9\ud55c\ub2e4.</p> <p>Property 3</p> <p>update \ud568\uc218\ub97c \uc2e4\ud589\ud560 \ub54c \uad6c\uac04 \uc548\uc5d0 \uc644\uc804\ud788 \ud3ec\ud568\ub41c tag\ub4e4 \uc911 \\(k\\) \uc774\uc0c1\uc778 tag\uc758 \uac1c\uc218\ub97c \\(P\\)\uac1c\ub77c \ud558\uc790.</p> <p>update \ud568\uc218\uc5d0\uc11c\ub294 segment tree\uc640 \ub611\uac19\uc774 \ucffc\ub9ac\ub2f9 \ucd5c\ub300 \\(O(\\log N)\\)\uac1c\uc758 \ub178\ub4dc\ub97c \ubc29\ubb38\ud558\uba70, \ucd94\uac00\ub85c \ubc29\ubb38\ud558\ub294 \ub178\ub4dc\ub4e4\uc740 \\(T_{actual}(o)=P\\log N\\), \\(\\varDelta \\Phi(S)=-P\\log N\\)\uc774\ub2c8, \\(T_{ammortized}(o)=\\log N\\)\uc774\ub2e4. \ub530\ub77c\uc11c, segment tree beats\uc758 update \ud568\uc218\ub294 \uac01 \ucffc\ub9ac\ub2f9 ammortized \\(O(\\log N)\\)\uc5d0 \uc791\ub3d9\ud55c\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(Q\\log N)\\)</p> <p>\uaf2d \uc774\uc640 \uac19\uc740 segment tree beats\uac00 \uc544\ub2c8\ub354\ub77c\ub3c4, segment tree \uc704\uc5d0 \ud2b9\uc815 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uc5ec\ub7ec tag\ub4e4\uc774 \uc788\uace0, update \ud568\uc218\uc5d0\uc11c \ud2b9\uc815 tag\ub4e4\uc758 \uc9d1\ud569 \\(S\\)\ub97c \ubaa8\ub450 \ud3ec\ud568\ud558\ub294 \uac00\uc7a5 \uc791\uc740 subtree\ub97c \ubc29\ubb38\ud558\uba70, \ubc29\ubb38 \ud6c4 \\(S\\)\uc758 \ubaa8\ub4e0 tag\ub4e4\uc774 \uc0ad\uc81c\ub41c\ub2e4\uba74 segment tree beats\uc640 \uac19\uc740 \ub17c\ub9ac\ub85c ammortized \\(O(Q\\log N)\\)\uc758 \uc2dc\uac04\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Property 4</p> <p>\uaf2d \uc774\uc640 \uac19\uc740 segment tree beats\uac00 \uc544\ub2c8\ub354\ub77c\ub3c4, segment tree \uc704\uc5d0 \ud2b9\uc815 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uc5ec\ub7ec tag\ub4e4\uc774 \uc788\uace0, update \ud568\uc218\uc5d0\uc11c \ud2b9\uc815 tag\ub4e4\uc758 \uc9d1\ud569 \\(S\\)\ub97c \ubaa8\ub450 \ud3ec\ud568\ud558\ub294 \uac00\uc7a5 \uc791\uc740 subtree\ub97c \ubc29\ubb38\ud558\uba70, \ubc29\ubb38 \ud6c4 \\(S\\)\uc758 \ubaa8\ub4e0 tag\ub4e4\uc774 \uc0ad\uc81c\ub41c\ub2e4\uba74 segment tree beats\uc640 \uac19\uc740 \ub17c\ub9ac\ub85c ammortized \\(O(Q\\log N)\\)\uc758 \uc2dc\uac04\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p>","tags":["data_structures","lazyprop","segtree","~ algorithm"]},{"location":"algorithms/Data%20Structures/Segment%20Tree%20Beats/algorithm/#reference","title":"Reference","text":"<ul> <li>https://codeforces.com/blog/entry/57319</li> <li>https://koosaga.com/307</li> </ul>","tags":["data_structures","lazyprop","segtree","~ algorithm"]},{"location":"algorithms/Graphs/Biconnected%20Component/algorithm/","title":"Biconnected Component","text":"","tags":["~ algorithm"]},{"location":"algorithms/Graphs/Biconnected%20Component/algorithm/#definition","title":"Definition","text":"<p>Definition 1</p> <p>Biconnected graph\ub294 2\uac1c \uc774\uc0c1\uc758 \uc815\uc810\uc744 \uac16\uace0 \uc788\uc73c\uba70, 1\uac1c\uc758 \uc815\uc810\uc744 \uc81c\uac70\ud558\uc5ec\ub3c4 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub294 \ubb34\ubc29\ud5a5 \uadf8\ub798\ud504\uc774\ub2e4. \uc989, 2\uac1c \uc774\uc0c1\uc758 \uc815\uc810\uc744 \uac16\uace0 \uc788\ub294 \ub2e8\uc808\uc810\uc774 \uc5c6\ub294 \ubb34\ubc29\ud5a5 \uc5f0\uacb0\uadf8\ub798\ud504\uc774\ub2e4.</p> <p>Definition 2</p> <p>Biconnected component\ub294 maximal biconnected subgraph\uc774\ub2e4. \uc989, \uc8fc\uc5b4\uc9c4 \uadf8\ub798\ud504\uc758 biconnected subgraph \uc911, \ud3ec\ud568\ub418\uc9c0 \uc54a\uc740 \uc5b4\ub5a4 \uc815\uc810 \ud639\uc740 \uac04\uc120\uc744 \ud558\ub098\ub77c\ub3c4 \ucd94\uac00\ud558\uba74 biconnected subgraph\uac00 \uc544\ub2c8\uac8c \ub418\ub294 subgraph\ub97c \uc758\ubbf8\ud55c\ub2e4.</p> <p>\uc77c\ubc18\uc801\uc73c\ub85c \uadf8\ub798\ud504 \\(G(V, E)\\)\uc758 subgraph\ub294 \uc815\uc810 \uc9d1\ud569\uc758 \ubd80\ubd84\uc9d1\ud569, \uac04\uc120 \uc9d1\ud569\uc758 \ubd80\ubd84\uc9d1\ud569\uc73c\ub85c \uad6c\uc131\ub41c \\(G'(V', E')\\) \\((V' \\subseteq V, E' \\subseteq E)\\)\uc744 \uc758\ubbf8\ud558\uba70, \ud2b9\ud788 \\(E'\\)\uc5d0 \uc18d\ud558\ub294 \uac04\uc120\uc758 \uc591 \ub05d \uc815\uc810\ub4e4\uc740 \ubaa8\ub450 \\(V'\\)\uc5d0 \uc18d\ud574 \uc788\uc5b4\uc57c \ud55c\ub2e4. \uc815\uc758\uc5d0 \uc758\ud574 \\(E'\\)\uc5d0 \uc18d\ud558\ub294 \uc5b4\ub5a4 \uac04\uc120\uc758 \uc591 \ub05d\uc810\uc5d0\ub3c4 \ud3ec\ud568\ub418\uc9c0 \uc54a\ub294 \uc815\uc810\ub4e4 \ub610\ud55c \\(V'\\)\uc5d0 \uc18d\ud560 \uc218 \uc788\uc9c0\ub9cc, biconnected subgraph\ub294 \uc5f0\uacb0\ub418\uc5b4 \uc788\uc5b4\uc57c \ud558\ub2c8, \\(V'\\)\uc740 \ubaa8\ub450 \\(E'\\)\uc5d0 \uc18d\ud558\ub294 \uac04\uc120\uc758 \uc591 \ub05d \uc815\uc810\ub4e4\ub85c \uad6c\uc131\ub41c \uc9d1\ud569\uc774\ub2e4. \ub530\ub77c\uc11c \\(V'\\)\ub294 \\(E'\\)\uc5d0 \uc758\ud558\uc5ec \uc815\uc758\ub418\uace0, \uc55e\uc73c\ub85c biconnected component\ub294 \uac04\uc120\ub4e4\uc758 \uc9d1\ud569\uc774\ub77c\uace0 \uc0dd\uac01\ud55c\ub2e4.</p>","tags":["~ algorithm"]},{"location":"algorithms/Graphs/Biconnected%20Component/algorithm/#equivalence-relation","title":"Equivalence Relation","text":"<p>\uac19\uc740 biconnected component\uc5d0 \ud3ec\ud568\ub418\ub294 \uac04\uc120\ub4e4\uc758 \uc131\uc9c8\uc744 \ud655\uc778\ud558\uae30 \uc704\ud558\uc5ec \ub2e4\uc74c\uacfc \uac19\uc740 equivalence relation\uc744 \uc815\uc758\ud55c\ub2e4.</p> <p>Definition 3</p> <p>\uac04\uc120 \uc9d1\ud569 \\(E\\)\uc5d0 \ub300\ud558\uc5ec, \ub2e4\uc74c\uacfc \uac19\uc740 equivalence relation \\(\\sim\\)\uc744 \uc815\uc758\ud558\uc790.</p> <p>\\(e_1, e_2 \\in E\\) \uc77c \ub54c, \\(e_1 \\sim e_2\\)\uc77c \ud544\uc694\ucda9\ubd84\uc870\uac74\uc740 \"\\(e_1=e_2\\)\uc774\uac70\ub098, \\(e_1\\)\uacfc \\(e_2\\)\ub97c \ub3d9\uc2dc\uc5d0 \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074\uc774 \uc874\uc7ac\ud55c\ub2e4.\"\uc774\ub2e4.</p> <p>Proof</p> <p>Definition 3\uc758 relation \\(\\sim\\)\uc774 equivalence relation\uc784\uc744 \uc99d\uba85\ud558\uc790.</p> <ol> <li>(Reflexivity) \uc815\uc758\uc5d0 \uc758\ud574 \\(e \\sim e\\)\uac00 \uc131\ub9bd\ud55c\ub2e4.</li> <li>(Symmetricity) \\(e_1 \\sim e_2\\)\ub77c\uba74, \\(e_2 \\sim e_1\\) \ub610\ud55c \uc790\uba85\ud558\uac8c \uc131\ub9bd\ud55c\ub2e4.</li> <li>(Transitiviy) \uc11c\ub85c \ub2e4\ub978 \\(e_1, e_2, e_3 \\in E\\)\uc5d0 \ub300\ud558\uc5ec \\(e_1 \\sim e_2\\), \\(e_2 \\sim e_3\\)\ub77c\uba74, \\(e_1 \\sim e_3\\)\uac00 \uc131\ub9bd\ud568\uc744 \ubcf4\uc774\uc790.   \uc989, \\(e_1\\), \\(e_2\\)\ub97c \ub3d9\uc2dc\uc5d0 \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074 \\(C_1\\)\uac00 \uc874\uc7ac\ud558\uace0, \\(e_2\\), \\(e_3\\)\ub97c \ub3d9\uc2dc\uc5d0 \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074 \\(C_2\\)\uac00 \uc874\uc7ac\ud560 \ub54c, \\(e_1\\)\uacfc \\(e_3\\)\ub97c \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074 \\(C\\)\uac00 \uc874\uc7ac\ud568\uc744 \ubcf4\uc774\uba74 \ub41c\ub2e4.   \ub9cc\uc57d \\(C_1\\)\uc5d0 \\(e_3\\)\uac00 \ud3ec\ud568\ub41c\ub2e4\uba74, \\(C=C_1\\)\uc5d0 \\(e_1\\), \\(e_2\\), \\(e_3\\)\uac00 \ubaa8\ub450 \uc874\uc7ac\ud558\ub2c8 \uc131\ub9bd\ud55c\ub2e4.   \ud3ec\ud568\ub418\uc9c0 \uc54a\ub294 \uacbd\uc6b0, \uc544\ub798 \uadf8\ub9bc\ucc98\ub7fc \\(C_1\\)\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc744 \uc77c\ub82c\ub85c \ub098\uc5f4\ud558\uba74, \uc218\uc5f4 \uc0c1\uc758 \uc5b4\ub5a4 \uc815\uc810 \\(u\\), \\(v\\)\ub97c \ub05d \uc815\uc810\uc73c\ub85c \ud558\uba70 \\(e_3\\)\ub97c \ud3ec\ud568\ud558\ub294, \\(C_1\\)\uacfc\ub294 \uac04\uc120\uc744 \uacf5\uc720\ud558\uc9c0 \uc54a\ub294 \uacbd\ub85c\uac00 \uc874\uc7ac\ud55c\ub2e4.   \uc774\uc81c, \\(C_1\\)\uacfc \\(P\\)\uc758 \uac04\uc120\ub4e4\ub9cc\uc744 \uc774\uc6a9\ud558\uc5ec \\(e_1\\), \\(e_3\\)\uc758 \uac04\uc120\uc744 \ubaa8\ub450 \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074 \\(C\\)\ub97c \uc0dd\uc131\ud560 \uc218 \uc788\ub2e4.</li> </ol> <p>\uc774\uc81c, Definition 2\ub85c \uc815\uc758\ub41c biconnected component\uc640 Definition 3\uc758 equivalence relation\uc5d0\uc11c \uc815\uc758\ub41c equivalence class\uac00 \uc0ac\uc2e4 \uac19\uc74c\uc744 \ubcf4\uc778\ub2e4.</p> <p>Property 1</p> <p>Definition 2\ub85c \uc815\uc758\ub41c biconnected component\ub4e4\ub85c \ucabc\uac1c\uc9c4 \uac04\uc120 \uc9d1\ud569\ub4e4\uacfc, Definition 3\uc758 equivalence relation\uc5d0\uc11c \uc815\uc758\ub41c equivalence class\ub85c \ucabc\uac1c\uc9c4 \uac04\uc120 \uc9d1\ud569\ub4e4\uc740 \uac19\ub2e4.</p> <p>\ubaa8\ub4e0 \uac04\uc120 \\(e\\)\uc5d0 \ub300\ud558\uc5ec, \\(E_1\\)\uc744 \\(e\\)\ub97c \ud3ec\ud568\ud558\ub294 equivalence class, \\(E_2\\)\ub97c \\(e\\)\ub97c \ud3ec\ud568\ud558\ub294 biconnected component\ub77c \ud558\uba74 \\(E_1 = E_2\\)\uc774\ub2e4.</p> <p>Proof</p> <p>(equivalence class \\(\\Rightarrow\\) biconnected component) Equivalence class \\(E_1\\)\uc5d0 \ub2e8\uc808\uc810 \\(v\\)\uac00 \uc874\uc7ac\ud55c\ub2e4\uace0 \uac00\uc815\ud558\uc790. \\(v\\)\ub97c \uc81c\uac70\ud558\uc600\uc744 \ub54c 2\uac1c \uc774\uc0c1\uc758 \ucef4\ud3ec\ub10c\ud2b8\ub85c \ucabc\uac1c\uc9c0\ub294\ub370, \uc774 \ub54c \\(v\\)\uc640 \uc778\uc811\ud55c \uc815\uc810\ub4e4 \uc911 \uc11c\ub85c \ub2e4\ub978 \ucef4\ud3ec\ub10c\ud2b8\uc5d0 \uc18d\ud558\uac8c \ub418\ub294 \uc815\uc810\uc744 2\uac1c \uc7a1\uc544 \\(a\\), \\(b\\)\ub77c \ud558\uc790. \uac04\uc120 \\((v, a)\\), \\((v, b)\\)\ub97c \ub3d9\uc2dc\uc5d0 \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074\uc774 \uc874\uc7ac\ud55c\ub2e4\uba74, \\(v\\)\ub97c \uc81c\uac70\ud558\uc600\uc744 \ub54c \\(a\\)\uc640 \\(b\\)\uac00 \uac19\uc740 \ucef4\ud3ec\ub10c\ud2b8\uc5d0 \uc18d\ud574\uc57c \ud55c\ub2e4. \ubaa8\uc21c\uc774 \ubc1c\uc0dd\ud558\uc600\uc73c\ub2c8, \\(E_1\\)\uc5d0\ub294 \ub2e8\uc808\uc810\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uace0, \ub530\ub77c\uc11c \uc774\ub294 biconnected component\uc774\ub2e4. \\((E_1 \\subseteq E_2)\\)</p> <p>(equivalence class \\(\\Leftarrow\\) biconnected component) Menger's theorem\uc5d0 \uc758\ud558\uba74 biconnected component (2-vertex connected subgraph)\uc758 \uc778\uc811\ud558\uc9c0 \uc54a\uc740 \uc784\uc758\uc758 \ub450 \uc815\uc810 \\(x\\), \\(y\\)\uc5d0 \ub300\ud558\uc5ec, \\(x\\)\uc640 \\(y\\)\ub97c \uc5f0\uacb0\ud558\ub294 2\uac1c\uc758 internally disjoint path\uac00 \uc874\uc7ac\ud55c\ub2e4. Biconnected component \\(E_2\\)\uc758 \uc784\uc758\uc758 \ub450 \uac04\uc120 \\(e_1\\), \\(e_2\\)\uc5d0 \ub300\ud558\uc5ec, \uac01\uac01 \\(x\\), \\(y\\)\ub97c \uc0ac\uc774\uc5d0 \uc0bd\uc785\ud558\uc5ec \ucabc\uac20 \uc0c8\ub85c\uc6b4 \uadf8\ub798\ud504\ub97c \uc0dd\uac01\ud558\uc790. \uc774 \uadf8\ub798\ud504 \ub610\ud55c \ub2e8\uc808\uc810\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc73c\ub2c8 biconnected component\uc774\uace0, menger's theorem\uc5d0 \ub530\ub77c \\(x\\)\uc640 \\(y\\)\ub97c \uc5f0\uacb0\ud558\ub294 2\uac1c\uc758 internally disjoint path\uac00 \uc874\uc7ac\ud55c\ub2e4. \uc774 \ub450 path\ub97c \ud569\ud558\uace0, \\(x\\)\uc640 \\(y\\)\uc5d0 \uc778\uc811\ud55c \uac04\uc120\ub4e4\uc744 \uc81c\uac70\ud55c \ud6c4 \\(e_1\\), \\(e_2\\)\ub97c \ucd94\uac00\ud558\uba74 \\(e_1\\)\uacfc \\(e_2\\)\ub97c \ub3d9\uc2dc\uc5d0 \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074\uc744 \uc0dd\uc131\ud560 \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, \\(E_2\\)\ub294 equivalence relation\uc758 \uc870\uac74\uc744 \ub9cc\uc871\ud55c\ub2e4. \\((E_2 \\subseteq E_1)\\)</p> <p>Property 1\uc5d0 \uc758\ud558\uc5ec, biconnected component\ub97c \uc815\uc758\ud560 \ub54c, maximal biconnected subgraph\ub85c \uc815\uc758\ud558\uae30\ubcf4\ub2e4\ub294 \uc704\uc640 \uac19\uc774 \uc815\uc758\ub41c equivalence class\ub85c \uc815\uc758\ud558\ub294 \uac83\uc774 \ud3b8\ub9ac\ud560 \ub54c\uac00 \ub9ce\ub2e4.</p>","tags":["~ algorithm"]},{"location":"algorithms/Graphs/Biconnected%20Component/algorithm/#property","title":"Property","text":"<p>Property 2</p> <p>Biconnected graph\uc5d0\ub294 \ub2e8\uc808\uc810\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4.</p> <p>Biconnected graph\uc5d0\ub294 \ub2e8\uc808\uc120\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4. \ub2e8, \uc815\uc810\uc774 2\uac1c\uc778 \uc5f0\uacb0\ub41c \uadf8\ub798\ud504\ub294 \uc608\uc678\uc774\ub2e4.</p> <p>Proof</p> <p>Biconnected graph\uc5d0 \ub2e8\uc808\uc810\uc774 \uc5c6\uc74c\uc740 \uc815\uc758\uc5d0 \uc758\ud574 \uc790\uba85\ud558\ub2e4.</p> <p>Biconnected graph\uc5d0 \ub2e8\uc808\uc120 \\((u, v)\\)\uac00 \uc788\ub2e4\uace0 \uac00\uc815\ud558\uc790. \uc815\uc810\uc758 \uac1c\uc218\uac00 3\uac1c \uc774\uc0c1\uc774\ub77c\uba74, \\(u\\), \\(v\\)\uc911 \uc801\uc5b4\ub3c4 \ud55c \uc815\uc810 (\\(u\\)\ub77c \ud558\uc790.)\uc740 \ub2e4\ub978 \uc815\uc810 \\(w\\)\uc640 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub2e4. \\(u\\)\ub97c \uc81c\uac70\ud558\uba74 \\(v\\)\uc640 \\(w\\)\ub294 \uc5f0\uacb0\uc774 \ub04a\uae30\ub2c8 \\(u\\)\ub294 \ub2e8\uc808\uc810\uc774\ub2e4. \ubaa8\uc21c\uc774 \ubc1c\uc0dd\ud558\uace0, \ub530\ub77c\uc11c \uc815\uc810\uc758 \uac1c\uc218\uac00 3 \uc774\uc0c1\uc774\ub77c\uba74 \ub2e8\uc808\uc120\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4.    </p> <p>Property 3</p> <p>\uac19\uc740 biconnected component\uc5d0 \ud3ec\ud568\ub418\ub294 \ub450 \uc815\uc810 \\(v_1, v_2 \\in V\\)\ub97c \ub3d9\uc2dc\uc5d0 \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074\uc774 \uc874\uc7ac\ud55c\ub2e4. \ub2e8, \uc815\uc810\uc774 2\uac1c\uc778 \uc5f0\uacb0\ub41c \uadf8\ub798\ud504\ub294 \uc608\uc678\uc774\ub2e4.</p> <p>\uac19\uc740 biconnected component\uc5d0 \ud3ec\ud568\ub418\ub294 \ub450 \uac04\uc120 \\(e_1, e_2 \\in E\\)\ub97c \ub3d9\uc2dc\uc5d0 \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074\uc774 \uc874\uc7ac\ud55c\ub2e4. \ub2e8, \uc815\uc810\uc774 2\uac1c\uc778 \uc5f0\uacb0\ub41c \uadf8\ub798\ud504\ub294 \uc608\uc678\uc774\ub2e4.</p> <p>Proof</p> <p>\ub9cc\uc57d \\(v_1\\), \\(v_2\\)\ub97c \uc5f0\uacb0\ud558\ub294 \uac04\uc120\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4\uba74, menger's theorem\uc5d0 \uc758\ud574 \\(v_1\\), \\(v_2\\)\ub97c \uc5f0\uacb0\ud558\ub294 2\uac1c\uc758 internally disjoint path\uac00 \uc874\uc7ac\ud558\uace0, \uc774 \uc790\uccb4\uac00 \\(v_1\\), \\(v_2\\)\ub97c \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074\uc774\ub2e4. \ub9cc\uc57d \\(v_1\\), \\(v_2\\)\ub97c \uc5f0\uacb0\ud558\ub294 \uac04\uc120 \\(e\\)\uac00 \uc874\uc7ac\ud55c\ub2e4\uba74, \\(e\\)\ub294 \ub2e8\uc808\uc120\uc774 \uc544\ub2c8\ub2c8, \\(e\\)\ub97c \uc81c\uac70\ud588\uc744 \ub54c \\(v_1\\), \\(v_2\\)\ub97c \uc5f0\uacb0\ud558\ub294 \uacbd\ub85c\uac00 \uc874\uc7ac\ud558\uace0, \uc774 \uacbd\ub85c\uc640 \\(e\\)\ub97c \ud569\uce58\uba74 \\(v_1\\), \\(v_2\\)\ub97c \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074\uc774\ub2e4.</p> <p>\ub450 \uac04\uc120 \\(e_1, e_2 \\in E\\)\ub97c \ub3d9\uc2dc\uc5d0 \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074\uc774 \uc874\uc7ac\ud568\uc740 Property 1\uc5d0 \uc758\ud558\uc5ec \uc131\ub9bd\ud55c\ub2e4.</p> <p>Property 4</p> <p>\uc6d0\ub798 \uadf8\ub798\ud504\uc5d0\uc11c \ub2e8\uc808\uc810\uc774 \uc544\ub2cc \uc815\uc810 \\(v\\)\uac00 \uc874\uc7ac\ud55c\ub2e4 \ud558\uc790. \\(v\\)\uc5d0 \uc778\uc811\ud55c \uac04\uc120\ub4e4 \\(e_1, e_2, \\cdots\\)\ub294 \ubaa8\ub450 \uac19\uc740 biconnected component\uc5d0 \ud3ec\ud568\ub41c\ub2e4.  </p> <p>Proof</p> <p>\\(v\\)\uc640 \uc778\uc811\ud55c \ub450 \uac04\uc120 \\(e_i (v, u_i)\\), \\(e_j (v, u_j)\\)\uc5d0 \ub300\ud558\uc5ec \uc0dd\uac01\ud558\uc790. \\(v\\)\uac00 \ub2e8\uc808\uc810\uc774 \uc544\ub2c8\ub2c8, \\(v\\)\ub97c \uc81c\uac70\ud588\uc744 \ub54c \\(u_i\\), \\(u_j\\)\ub97c \uc5f0\uacb0\ud558\ub294 \uacbd\ub85c\uac00 \uc874\uc7ac\ud558\uace0, \uc774 \uacbd\ub85c\uc5d0 \\(e_i\\)\uc640 \\(e_j\\)\ub97c \ud569\uce58\uba74 \\(e_i\\), \\(e_j\\)\ub97c \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074\uc744 \ub9cc\ub4e4 \uc218 \uc788\ub2e4. \\(e_i\\)\uc640 \\(e_j\\)\ub97c \ub3d9\uc2dc\uc5d0 \ud3ec\ud568\ud558\ub294 \ub2e8\uc21c \uc0ac\uc774\ud074\uc774 \uc874\uc7ac\ud558\ub2c8, \\(e_i\\)\uc640 \\(e_j\\)\ub294 \uac19\uc740 biconnected component\uc5d0 \ud3ec\ud568\ub41c\ub2e4.</p> <p>Property 5</p> <p>\uc6d0\ub798 \uadf8\ub798\ud504\uc5d0\uc11c \ub2e8\uc808\uc810 \\(v\\)\uac00 \uc874\uc7ac\ud55c\ub2e4 \ud558\uc790. \\(v\\)\uc5d0 \uc778\uc811\ud55c \uc815\uc810\ub4e4\uc744 \\(v\\)\ub97c \uc0ad\uc81c\ud588\uc744 \ub54c \uac19\uc740 \ucef4\ud3ec\ub10c\ud2b8\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\ub07c\ub9ac \ubb36\uc5b4, \\(i\\)\ubc88\uc9f8 \ucef4\ud3ec\ub10c\ud2b8\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc744 \\(u_{i, 1}, u_{i, 2}, \\cdots\\)\ub77c \ud558\uace0, \\(v\\)\uc640 \\(u_{i, j}\\)\ub97c \uc5f0\uacb0\ud558\ub294 \uac04\uc120\uc744 \\(e_{i, j}\\)\ub77c \ud558\uc790. \uac19\uc740 \ucef4\ud3ec\ub10c\ud2b8\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\uacfc \uc5f0\uacb0\ub41c \uac04\uc120\ub4e4\uc740 \ubaa8\ub450 \uac19\uc740 biconnected component\uc5d0 \ud3ec\ud568\ub418\uace0, \ub2e4\ub978 \ucef4\ud3ec\ub10c\ud2b8\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\uacfc \uc5f0\uacb0\ub41c \uac04\uc120\ub4e4\uc740 \ubaa8\ub450 \ub2e4\ub978 biconnected component\uc5d0 \ud3ec\ud568\ub41c\ub2e4.</p> <p>Proof</p> <p>\uac19\uc740 \\(i\\)\ubc88\uc9f8 \ucef4\ud3ec\ub10c\ud2b8\uc5d0 \uc18d\ud558\ub294 \ub450 \uac04\uc120 \\(e_{i, p}\\), \\(e_{i, q}\\)\ub294 Property 4\uc640 \uac19\uc740 \ub17c\ub9ac\ub85c \uac19\uc740 biconnected component\uc5d0 \ud3ec\ud568\ub41c\ub2e4.</p> <p>\ub2e4\ub978 \\(i\\), \\(j\\)\ubc88\uc9f8 \ucef4\ud3ec\ub10c\ud2b8\uc5d0 \uc18d\ud558\ub294 \ub450 \uac04\uc120 \\(e_{i, p}\\), \\(e_{j, q}\\)\uac00 \uac19\uc740 biconnected component\uc5d0 \uc18d\ud55c\ub2e4\uba74, \uc774\ub97c \ub3d9\uc2dc\uc5d0 \ud3ec\ud568\ud558\ub294 \uc0ac\uc774\ud074\uc774 \uc874\uc7ac\ud574\uc57c \ud558\ub294\ub370, \uc774\ub294 \\(v\\)\ub97c \uc81c\uac70\ud588\uc744 \ub54c \\(u_{i, p}\\)\uc640 \\(u_{j, q}\\)\uac00 \ub2e4\ub978 \ucef4\ud3ec\ub10c\ud2b8\uc5d0 \ud3ec\ud568\ub428\uc5d0 \ubaa8\uc21c\uc774\ub2e4. \ub530\ub77c\uc11c \\(e_{i, p}\\), \\(e_{j, q}\\)\ub294 \ub2e4\ub978 biconnected component\uc5d0 \ud3ec\ud568\ub41c\ub2e4.</p>","tags":["~ algorithm"]},{"location":"algorithms/Graphs/Flows/Edmond-Karp%20algorithm/algorithm/","title":"Edmond-Karp algorithm","text":"","tags":["flow","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Edmond-Karp%20algorithm/algorithm/#algorithm","title":"Algorithm","text":"<p>Ford-Fulkerson method\ub294 \uac00\ub2a5\ud560 \ub54c\uae4c\uc9c0 \\(s\\)\uc5d0\uc11c \\(t\\)\ub85c \uac00\ub294 \uc784\uc758\uc758 \uacbd\ub85c\ub97c \ucc3e\uace0, \ud574\ub2f9 \uacbd\ub85c\ub97c \ub530\ub77c flow\ub97c \ud758\ub9ac\ub294 \ud615\ud0dc\ub85c \uc9c4\ud589\ud55c\ub2e4. \ud558\uc9c0\ub9cc \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uac00 \\(O(EF)\\)\ub85c, pseudopolynomial \ud558\ub2e4\ub294 \ub2e8\uc810\uc774 \uc788\ub2e4.</p> <p>Edmond-Karp algorithm\uc740 \\(s\\)\uc5d0\uc11c \\(t\\)\ub85c \uac00\ub294 \uacbd\ub85c\ub97c BFS\ub97c \uc774\uc6a9\ud558\uc5ec \uac04\uc120\uc744 \ucd5c\uc18c\ud55c\uc73c\ub85c \uc0ac\uc6a9\ud558\ub294 \uacbd\ub85c\ub85c \ud55c\uc815\ud558\uc5ec \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub97c polynomial \ud558\ub3c4\ub85d \ub9cc\ub4e4\uc5b4\uc900\ub2e4.</p> <p>Algorithm 1</p> <p>Flow network \\((G, c, s, t)\\)\uac00 \uc8fc\uc5b4\uc9c4\ub2e4. flow \\(f\\)\ub97c \\(0\\)\uc73c\ub85c \ucd08\uae30\ud654\ud55c \ud6c4, \\(G_f\\)\uc5d0\uc11c \\(s \\rightarrow t\\) \uacbd\ub85c\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc744 \ub54c\uae4c\uc9c0 \\(s \\rightarrow t\\)\uc758 \ucd5c\ub2e8\uacbd\ub85c\ub97c BFS\ub97c \uc0ac\uc6a9\ud558\uc5ec \uad6c\ud558\uace0, \ucd5c\ub2e8\uacbd\ub85c\ub97c \ub530\ub77c capcity\uc758 \ucd5c\uc19f\uac12\uc5d0 \ud574\ub2f9\ud558\ub294 flow \\(f'\\)\ub97c \ucc3e\uace0, \\(f \\leftarrow f+f'\\)\ub85c \uc5c5\ub370\uc774\ud2b8\ud55c\ub2e4. \\(f\\)\uac00 Maximum Flow\uc774\ub2e4.</p> <pre><code>Let (G, c, s, t) be a flow network\nInitialize f &lt;- 0\nWhile t is not reachable from s in G_f :\n    Find the shortest path P from s to t in G_f using BFS\n    Let flow f' be flow with all edges in P with the lowest capacity\n    f &lt;- f + f'\nreturn f\n</code></pre>","tags":["flow","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Edmond-Karp%20algorithm/algorithm/#complexity","title":"Complexity","text":"<p>Edmond-Karp algorithm\uc5d0\uc11c BFS\ub294 \\(O(E)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub9ac\uace0, BFS\uc758 \uc2e4\ud589 \ud69f\uc218 (Algorithm 1\uc758 3\ubc88\uc9f8 while\ubb38\uc758 \uc2e4\ud589 \ud69f\uc218)\uac00 \\(O(VE)\\)\ub85c \uc81c\ud55c\ub428\uc744 \ubcf4\uc77c \uc218 \uc788\ub2e4.</p> <p>Property 1</p> <p>Algorithm 1\uc758 \uc2e4\ud589\uacfc\uc815 \uc911 \\(G_f\\)\uc5d0\uc11c \\(s\\)\uc5d0\uc11c \uc784\uc758\uc758 \uc815\uc810 \\(v\\)\ub85c \uac00\ub294 \ucd5c\ub2e8\uacbd\ub85c\uc758 \uae38\uc774 \\(lvl[v]\\)\ub294 \ub2e8\uc870\uc99d\uac00\ud55c\ub2e4.</p> <p>Proof</p> <p>\uc784\uc758\uc758 \uc2dc\uc810\uc5d0\uc11c \\(G_f\\)\uc758 BFS spanning tree\uc640  \\(s \\rightarrow t\\)\uc758 \ucd5c\ub2e8\uacbd\ub85c\ub97c \\(P\\)\ub77c \ud558\uc790.</p> <p>\\(P\\)\uc5d0 capcity\uc758 \ucd5c\uc19f\uac12\uc5d0 \ud574\ub2f9\ud558\ub294 flow \\(f'\\)\ub97c \ud758\ub824\uc8fc\uace0 \ub09c \ud6c4 \\(G_f\\)\uac00 \uc5b4\ub5bb\uac8c \ubcc0\ud558\ub294\uc9c0 \uad00\ucc30\ud558\uc790. \\(P\\)\uc5d0 \uc18d\ud558\ub294 \ubaa8\ub4e0 \uac04\uc120 \\((u, v)\\)\uc5d0 \ub300\ud558\uc5ec \uc5ed\uac04\uc120 \\((v, u)\\)\uac00 \\(G_f\\)\uc5d0 \ucd94\uac00\ub418\uace0, saturated \ub41c \uc815\ubc29\ud5a5 \uac04\uc120\ub4e4\uc740 \ubaa8\ub450 \uc81c\uac70\ub41c\ub2e4. \uc815\uc758\uc5d0 \uc758\ud574, \\(lvl[u]+1=lvl[v]\\)\ub97c \ub9cc\uc871\ud55c\ub2e4. \uac04\uc120\ub4e4\uc774 \uc0ad\uc81c\ub418\uba74 \uc784\uc758\uc758 \uc815\uc810\uc73c\ub85c\uc758 \ucd5c\ub2e8\uacbd\ub85c\ub294 \ub2e8\uc870\uc99d\uac00\ud558\ub2c8, \ucd94\uac00\ub41c \uac04\uc120\ub4e4\ub85c \uc778\ud558\uc5ec \ucd5c\ub2e8\uacbd\ub85c\uac00 \uac10\uc18c\ud560 \uc218 \uc5c6\uc74c\ub9cc \ubcf4\uc774\uba74 \ub41c\ub2e4. \ud558\uc9c0\ub9cc \ucd94\uac00\ub41c \ubaa8\ub4e0 \uc5ed\uac04\uc120 \\((v, u)\\)\ub294 \ub354 \ud070 \\(lvl[v]\\)\uc5d0\uc11c \ub354 \uc791\uc740 \\(lvl[u]\\)\ub85c \uc774\uc5b4\uc9c0\ub294 \uac04\uc120\uc774\ub2c8, \ucd5c\ub2e8\uacbd\ub85c\uac00 \uac10\uc18c\ud560 \uc218 \uc5c6\ub2e4. \ub530\ub77c\uc11c, \uc784\uc758\uc758 \uc815\uc810 \\(v\\)\ub85c \uac00\ub294 \ucd5c\ub2e8\uacbd\ub85c\uc758 \uae38\uc774 \\(lvl[v]\\)\ub294 \ub2e8\uc870\uc99d\uac00\ud55c\ub2e4.</p> <p></p> <p>Property 2</p> <p>\\(G_f\\)\uc5d0\uc11c \uc5b4\ub5a4 \uac04\uc120 \\((u, v)\\)\uac00 saturated \ub418\uc5b4 \uc0ad\uc81c\ub41c \ud6c4, \ub2e4\uc2dc \\((u, v)\\)\uac00 \ucd94\uac00\ub418\uae30 \uc704\ud574\uc11c\ub294 \\(lvl[u]\\)\uac00 \uc801\uc5b4\ub3c4 \\(2\\) \uc99d\uac00\ud55c\ub2e4.</p> <p>Proof</p> <p>\uc784\uc758\uc758 \uc2dc\uc810\uc5d0\uc11c \\(G_f\\)\uc758 BFS spanning tree\uc640  \\(s \\rightarrow t\\)\uc758 \ucd5c\ub2e8\uacbd\ub85c\ub97c \\(P\\)\ub77c \ud558\uc790. \uc774\uc81c, \\(P\\)\uc5d0 capcity\uc758 \ucd5c\uc19f\uac12\uc5d0 \ud574\ub2f9\ud558\ub294 flow \\(f'\\)\ub97c \ud758\ub9ac\uba74 \\(P\\)\uc758 \uc801\uc5b4\ub3c4 \ud55c \uac1c\uc758 \uac04\uc120\uc740 saturated \ub41c\ub2e4. \uc774 \uac04\uc120\uc744 \\((u, v)\\)\ub77c \ud558\uba74, \uc815\uc758\uc5d0 \uc758\ud574 \\(lvl[u]+1=lvl[v]\\)\ub97c \ub9cc\uc871\ud558\uba70, \uc774\ud6c4 \\(G_f\\)\uc5d0\uc11c \\((u, v)\\)\ub294 \uc0ad\uc81c\ub418\uace0 \uc5ed\uac04\uc120 \\((v, u)\\)\uac00 \ucd94\uac00\ub41c\ub2e4.</p> <p>\ub2e4\uc2dc \\((u, v)\\)\uac00 \ucd94\uac00\ub418\uae30 \uc704\ud574\uc11c\ub294, \uc5b4\ub5a4 \uc2dc\uc810\uc5d0\uc11c \uc0c8\ub85c \ucc3e\ub294 \ucd5c\ub2e8\uacbd\ub85c \\(P'\\)\uc5d0 \\((v, u)\\)\uac00 \ud3ec\ud568\ub418\uc5b4 \uc788\uc5b4\uc57c \ud55c\ub2e4. \\((v, u)\\)\uac00 \\(P'\\)\uc5d0 \ud3ec\ud568\ub418\uae30 \uc704\ud574\uc11c\ub294 \\(lvl'[u]=lvl'[v]+1\\)\uc744 \ub9cc\uc871\ud574\uc57c \ud558\uace0, Property 1\uc5d0 \uc758\ud574 \\(lvl[u] \\le lvl'[u]\\), \\(lvl[v] \\le lvl'[v]\\)\uac00 \uc131\ub9bd\ud55c\ub2e4.</p> \\[lvl[u]+2=lvl[v]+1 \\le lvl'[v]+1 = lvl'[u]\\] <p>\uc704 \uc2dd\uc5d0 \uc758\ud574 \\(lvl[u]\\)\ub294 \uc801\uc5b4\ub3c4 \\(2\\) \uc99d\uac00\ud55c\ub2e4.</p> <p></p> <p>Property 3</p> <p>BFS\uc758 \uc2e4\ud589 \ud69f\uc218 (Algorithm 1\uc758 3\ubc88\uc9f8 while\ubb38\uc758 \uc2e4\ud589 \ud69f\uc218)\ub294 \ucd5c\ub300 \\(O(VE)\\)\ud68c\uc774\ub2e4.</p> <p>Proof</p> <p>\uac01 \uac04\uc120 \\((u, v)\\)\uc5d0 \ub300\ud558\uc5ec \uc774 \uac04\uc120\uc774 \uc0ad\uc81c\ub418\uc5b4 \ub2e4\uc2dc \ub4f1\uc7a5\ud560 \ub54c\ub9c8\ub2e4 \\(lvl[u]\\)\ub294 \uc801\uc5b4\ub3c4 \\(2\\) \uc99d\uac00\ud55c\ub2e4. \ud558\uc9c0\ub9cc, \ucd5c\ub2e8\uacbd\ub85c\uc758 \uae38\uc774\ub294 \ucd5c\ub300 \\(O(V)\\)\uc774\ub2c8 \uac01 \uac04\uc120\uc758 \uc0ad\uc81c \ud69f\uc218\ub294 \ucd5c\ub300 \\(O(V)\\)\ud68c\ub9cc \uac00\ub2a5\ud558\ub2e4.</p> <p>\ud55c\ubc88 BFS\uac00 \uc2e4\ud589\ub420 \ub54c \uc801\uc5b4\ub3c4 \\(1\\)\uac1c\uc758 \uac04\uc120\uc774 \uc0ad\uc81c\ub418\uace0, \ucd1d \uc0ad\uc81c \ud69f\uc218\ub294 \uac01 \uac04\uc120\ub2f9 \\(O(V)\\), \ucd1d \uac04\uc120\uc774 \\(O(E)\\)\uc774\ub2c8 \ucd5c\ub300 \\(O(VE)\\)\ud68c BFS\uac00 \uc2e4\ud589\ub420 \uc218 \uc788\ub2e4.</p> <p>Time Complexity</p> <p>\\(O(VE^2)\\)</p>","tags":["flow","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Edmond-Karp%20algorithm/algorithm/#implementation","title":"Implementation","text":"<pre><code>const int INF = 1e9+7;\n\nstruct Edge\n{\n    int v, w, f, r;\n    // v : vertex number, w : capacity, f : flow, r : reverse edge number\n};\nvector&lt;Edge&gt; adj[MAXN+10];\n\nvoid addEdge(int u, int v, int w)\n{\n    adj[u].push_back({v, w, 0, adj[v].size()});\n    adj[v].push_back({u, 0, 0, adj[u].size()-1});\n}\n\nll bfs(int N, int S, int E)\n{\n    vector&lt;int&gt; dist(N+1), par(N+1);\n    for(int i=1; i&lt;=N; i++) par[i]=-1, dist[i]=-1;;\n\n    queue&lt;int&gt; Q;\n    dist[S]=0; Q.push(S);\n    while(!Q.empty())\n    {\n        int now=Q.front(); Q.pop();\n\n        for(int i=0; i&lt;adj[now].size(); i++)\n        {\n            Edge &amp;nxt = adj[now][i];\n            if(nxt.f==nxt.w) continue;\n            if(dist[nxt.v]!=-1) continue;\n\n            dist[nxt.v]=dist[now]+1;\n            par[nxt.v]=nxt.r;\n            Q.push(nxt.v);\n        }\n    }\n\n    if(dist[E]==-1) return 0;\n\n    int flow=INF;\n\n    int now=E;\n    while(par[now]!=-1)\n    {\n        Edge &amp;nxt = adj[now][par[now]];\n        flow=min(flow, adj[nxt.v][nxt.r].w-adj[nxt.v][nxt.r].f);\n        now=nxt.v;\n    }\n\n    now=E;\n    while(par[now]!=-1)\n    {\n        Edge &amp;nxt = adj[now][par[now]];\n        adj[nxt.v][nxt.r].f+=flow;\n        adj[now][par[now]].f-=flow;\n        now=nxt.v;\n    }\n\n    return flow;\n}\n\nll EdmondKarp(int N, int S, int E)\n{\n    ll ans=0;\n    while(1)\n    {\n        ll t=bfs(N, S, E);\n        if(!t) break;\n        ans+=t;\n    }\n    return ans;\n}\n</code></pre>","tags":["flow","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Edmond-Karp%20algorithm/algorithm/#reference","title":"Reference","text":"<ul> <li>https://cp-algorithms.com/graph/edmonds_karp.html#edmonds-karp-algorithm</li> <li>https://www.cs.cornell.edu/courses/cs4820/2012sp/handouts/edmondskarp.pdf</li> </ul>","tags":["flow","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Ford-Fulkerson%20method/algorithm/","title":"Ford\u2013Fulkerson method","text":"","tags":["flow","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Ford-Fulkerson%20method/algorithm/#flow-network","title":"Flow Network","text":"<p>Flow Network\ub294 \uac01 \uac04\uc120\uc774 \uc74c\uc774 \uc544\ub2cc capacity\ub97c \uac16\ub294 \ubc29\ud5a5 \uadf8\ub798\ud504\uc774\ub2e4.</p> <p>Definition 1</p> <p>\ubc29\ud5a5 \uadf8\ub798\ud504 \\(G=(V, E)\\)\uc758 \ubaa8\ub4e0 \uac04\uc120\uc774 \uc74c\uc774 \uc544\ub2cc capacity \\(c\\) (\\(c : E \\rightarrow \\mathbb{R}_{\\ge 0}\\))\ub97c \uac00\uc9c8 \ub54c \\((G, c)\\)\ub97c Flow Network\ub77c\uace0 \uc815\uc758\ud55c\ub2e4. \uc815\uc810 \\(v \\in V\\)\uc5d0 \ub300\ud558\uc5ec \\(\\delta_{out}(v)\\)\ub294 \\(v\\)\uc5d0\uc11c \ub098\uac00\ub294 \uac04\uc120\uc758 \uc9d1\ud569, \\(\\delta_{in}(v)\\)\ub294 \\(v\\)\ub85c \ub4e4\uc5b4\uc624\ub294 \uac04\uc120\uc758 \uc9d1\ud569\uc774\ub77c \uc815\uc758\ud55c\ub2e4.</p> <p>\uc774\uc81c, flow network\uc5d0 \uc720\ub7c9\uc744 \ud758\ub9ac\uae30 \uc704\ud558\uc5ec, \ub2e4\uc74c\uacfc \uac19\uc774 flow\uac00 \ub9cc\uc871\ud574\uc57c \ud560 \uc131\uc9c8\ub4e4\uc744 \uc815\uc758\ud558\uc790. \uc6b0\uc120, \uc720\ub7c9\uc744 \ud758\ub9b4 \uc815\uc810 source\uc640 \uc720\ub7c9\uc744 \ubc1b\uc744 \uc815\uc810 sink\ub97c \uc815\uc758\ud558\uace0, \uac01 \uac04\uc120\uc758 flow\ub294 \\(0\\) \uc774\uc0c1, capcity \uc774\ud558\uc758 \uac00\uc911\uce58\ub85c \uc0dd\uac01\ud55c\ub2e4. source\uc640 sink\ub97c \uc81c\uc678\ud55c \ub2e4\ub978 \uc815\uc810\ub4e4\uc5d0\uc11c\ub294 flow\ub97c \uc0dd\uc0b0\ud560 \uc218 \uc5c6\uae30 \ub54c\ubb38\uc5d0, \ub4e4\uc5b4\uc624\ub294 flow\uc758 \ud569\uacfc \ub098\uac00\ub294 flow\uc758 \ud569\uc774 0\uc774 \ub418\uc5b4\uc57c \ud55c\ub2e4.</p> <p>Definition 2</p> <p>\uc11c\ub85c \ub2e4\ub978 \ub450 \uc815\uc810 \\(s, t \\in V\\)\ub97c \\(s\\)\ub294 source, \\(t\\)\ub294 sink\ub77c \uc815\uc758\ud558\uc790. Flow \\(f\\) (\\(f: E \\rightarrow \\mathbb{R}\\))\ub294 \ub2e4\uc74c\uc744 \ub9cc\uc871\ud558\ub294 \uac00\uc911\uce58\uc774\ub2e4.</p> <ol> <li>Edge Rule : \\(\\forall e \\in E\\), \\(0 \\le f(e) \\le c(e)\\) \ubaa8\ub4e0 \uac04\uc120\uc758 flow\ub294 \\(0\\)\ubcf4\ub2e4 \ud06c\uac70\ub098 \uac19\uc73c\uba70, \uadf8 \uac04\uc120\uc758 capcity\ub97c \ub118\uc9c0 \uc54a\ub294\ub2e4.</li> <li>Vertex Rule : \\(\\forall v \\in V\\), \\(v \\ne s, t\\), \\(\\displaystyle \\sum_{e \\in \\delta_{in}(v)} f(e)= \\sum_{e \\in \\delta_{out}(v)} f(e)\\) \uac01 \uc815\uc810\uc5d0\uc11c \ub098\uac00\ub294 flow\uc640 \ub4e4\uc5b4\uc624\ub294 flow\uc758 \ucd1d\ud569\uc740 \uac19\ub2e4.</li> </ol> <p>\uc704 \uc815\uc758\uc758 Edge Rule\uacfc Vertex Rule\uc744 \ub9cc\uc871\uc2dc\ud0a4\uae30\ub9cc \ud558\uba74 \ubaa8\ub450 valid flow\uc774\uba70, \uc77c\ubd80 flow\uac00 source\ub098 sink\uc5d0\uc11c \ub098\uc628 \uac83\uc774 \uc544\ub2cc, \uc0ac\uc774\ud074\uc744 \ub530\ub77c \ub3cc\uace0 \uc788\uc5b4\ub3c4 valid flow\uc784\uc5d0 \uc720\uc758\ud558\uc790.</p> <p>\uc774\uc81c Maximum Flow \ubb38\uc81c\ub97c \uc815\uc758\ud558\uae30 \uc704\ud558\uc5ec, flow network\uc758 \uc804\uccb4 flow \uc591\uc744 source\uc5d0\uc11c \ub098\uc624\ub294 flow\uc758 \uc591\uc5d0\uc11c \ub4e4\uc5b4\uc624\ub294 flow\uc758 \uc591\uc744 \ube80, \uc989 source\uac00 \ubc1c\uc0dd\uc2dc\ud0a8 flow\uc758 \uc591\uc73c\ub85c \uc815\uc758\ud558\uc790. Vertex Rule\uc5d0 \uc758\ud558\uc5ec source\uc5d0\uc11c \ubc1c\uc0dd\uc2dc\ud0a8 flow\uc758 \uc591\uc740 sink\uac00 \uc18c\ubaa8\ud55c flow\uc758 \uc591\uacfc \uac19\uc74c\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>Definition 3</p> <p>Flow network \\((G, c, s, t)\\)\uc640 flow \\(f\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c, \uc804\uccb4 flow\ub97c \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\uc758\ud55c\ub2e4.</p> \\[\\displaystyle val(f) = \\sum_{e \\in \\delta_{out}(s)} f(e) - \\sum_{e \\in \\delta_{in}(s)} f(e) = - \\left ( \\sum_{e \\in \\delta_{out}(t)} f(e) - \\sum_{e \\in \\delta_{in}(t)} f(e) \\right)\\] <p>Flow network\uc758 \uc804\uccb4 flow \uc591\uc740 \uc74c\uc218\uac00 \ub420\uc218\ub3c4 \uc788\uc74c\uc5d0 \uc8fc\uc758\ud558\uc790.</p> <p>\uc774\uc81c, Maximum flow \ubb38\uc81c\ub294 \uc804\uccb4 flow\uc758 \ucd5c\ub313\uac12\uc744 \uad6c\ud558\ub294 \ubb38\uc81c\ub85c \uc815\uc758\ud560 \uc218 \uc788\ub2e4.</p> <p>Definition 4</p> <p>Maximum flow \ubb38\uc81c\ub294 Flow network \\((G, c, s, t)\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c, \\(val(f)\\)\ub97c \ucd5c\ub300\ud654\uc2dc\ud0a4\ub294 flow \\(f\\)\ub97c \ucc3e\ub294 \uac83\uc774\ub2e4.</p>","tags":["flow","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Ford-Fulkerson%20method/algorithm/#residual-flow-network","title":"Residual Flow Network","text":"<p>\ub300\ubd80\ubd84\uc758 maximum flow\ub97c \uad6c\ud558\ub294 \uc54c\uace0\ub9ac\uc998\ub4e4\uc740 greedy \uc54c\uace0\ub9ac\uc998\uc774\ub2e4. \uae30\uc874\uc758 flow\uc5d0 Definition 2\uc758 \uc870\uac74\uc744 \ub9cc\uc871\uc2dc\ud0a4\uba70 \\(val(f)\\)\ub97c \uc99d\uac00\uc2dc\ud0ac\uc218 \uc788\ub294 \uc0c8\ub85c\uc6b4 flow\ub97c \ucc3e\uc544 \ud758\ub824 \ubcf4\ub0b8\ub2e4. \ud558\uc9c0\ub9cc, \uc774\uc804\uc5d0 \ud55c \uc120\ud0dd\uc774 \uacb0\uad6d \ub098\uc911\uc5d0 \ucd5c\uc801\ud574\ub97c \ucc3e\uc744 \uc218 \uc5c6\ub3c4\ub85d \ub9cc\ub4e4 \uc218 \uc788\ub2e4\ub294 \ubb38\uc81c\uac00 \uc788\ub2e4.</p> <p></p> <p>\uc704 \uadf8\ub9bc\uacfc \uac19\uc740 \uc608\uc2dc\uc5d0\uc11c, \uc2e4\uc81c maximum flow\ub294 \\(2\\)\uc774\uc9c0\ub9cc, \uc0c9\uce60\ub41c \ubd80\ubd84\uacfc \uac19\uc740 \uc720\ub7c9\uc744 \ud758\ub9ac\uace0 \uc2dc\uc791\ud558\uc600\uc744 \ub54c \ub354 \uc774\uc0c1 flow\ub97c \ucc3e\uc9c0 \ubabb\ud55c\ub2e4. \ub530\ub77c\uc11c greedy \uc54c\uace0\ub9ac\uc998\uc744 \uc801\uc6a9\ud558\uae30 \uc704\ud574\uc11c\ub294, \uc774\uc804\uc5d0 \ud55c \uc120\ud0dd\uc744 \ucde8\uc18c\ud560 \uc218 \uc788\uc5b4\uc57c \ud55c\ub2e4.</p> <p>\uc5b4\ub5a4 valid flow \\(f\\)\ub97c \ub2e4\ub978 valid flow \\(f'\\)\uc73c\ub85c \ubcc0\uacbd\ud558\ub824 \ud560 \ub54c, \uac01 \uac04\uc120\uc5d0 \ucd94\uac00\ub418\ub294 flow\uc758 \uc591 \\(f'-f\\)\uc774 \ub9cc\uc871\ud558\ub294 \uc131\uc9c8\ub4e4\uc744 \\(f\\)\uc758 \uc785\uc7a5\uc5d0\uc11c \uad00\ucc30\ud558\uc790.</p> <p>Definition 5</p> <p>Flow network \\((G, c, s, t)\\)\uc640 flow \\(f\\), \\(f'\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c flow difference of \\(f\\) and \\(f'\\), \\(f'-f\\) (\\(f'-f : E \\rightarrow \\mathbb{R}\\))\ub97c \\((f'-f)(e) = f'(e)-f(e)\\)\ub85c \uc815\uc758\ud55c\ub2e4.</p> <p>Property 1</p> <ol> <li>\\(\\forall e \\in E\\), \\(-f(e) \\le (f'-f)(e) \\le c(e)-f(e)\\)</li> <li>\\(\\forall v \\in V\\), \\(v \\ne s, t\\), \\(\\displaystyle \\sum_{e \\in \\delta_{in}(v)} (f'-f)(e)= \\sum_{e \\in \\delta_{out}(v)} (f'-f)(e)\\)</li> </ol> <p>\\(f'-f\\)\uac00 \uc77c\ubc18\uc801\uc778 flow\uc640 \ub9e4\uc6b0 \ube44\uc2b7\ud55c \uc131\uc9c8\ub4e4\uc744 \uac16\uace0 \uc788\uc74c\uc744 \uc54c \uc218 \uc788\ub2e4. \uc774\uc81c, \uac70\uafb8\ub85c valid flow \\(f\\)\uc5d0 \uc5b4\ub5a4 flow difference \\(g\\)\ub97c \ub354\ud574 valid flow\ub85c \ub9cc\ub4e4\uace0\uc790 \ud55c\ub2e4. Property 1\uc744 \ub9cc\uc871\uc2dc\ud0a4\ub294 \\(g=f'-f\\)\ub97c \ucc3e\uc744 \uc218 \uc788\ub2e4\uba74, \\(f+g\\)\ub294 \uc784\uc758\uc758 valid flow\uac00 \ub428\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>Definition 6</p> <p>Flow network \\((G, c, s, t)\\)\uc640 flow \\(f\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c \\(f\\)\uc758 flow difference, \\(g\\) (\\(g : E \\rightarrow \\mathbb{R}\\))\ub97c \ub2e4\uc74c\uc744 \ub9cc\uc871\ud558\ub294 \uac00\uc911\uce58\ub85c \uc815\uc758\ud55c\ub2e4.</p> <ol> <li>\\(\\forall e \\in E\\), \\(-f(e) \\le g(e) \\le c(e)-f(e)\\)</li> <li>\\(\\forall v \\in V\\), \\(v \\ne s, t\\), \\(\\displaystyle \\sum_{e \\in \\delta_{in}(v)} g(e)= \\sum_{e \\in \\delta_{out}(v)} g(e)\\)</li> </ol> <p>\uc77c\ubc18\uc801\uc778 flow\uc640\ub294 \ub2e4\ub974\uac8c, \\(f\\)\uc758 flow difference\ub294 capacity\uac00 \uc544\ub2cc, \uac00\uc911\uce58\uac00 \\([-f(e), c(e)-f(e)]\\) \uad6c\uac04\uc758 \ud615\ud0dc\ub85c \ub098\ud0c0\ub0a8\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>Property 2</p> <p>Flow network \\((G, c, s, t)\\)\uc640 flow \\(f\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c, \uc784\uc758\uc758 flow \\(f'\\)\uc640 \\(f\\)\uc758 flow difference \\(g\\)\ub294 \uc77c\ub300\uc77c \ub300\uc751\ub41c\ub2e4.</p> \\[ f'-f \\leftrightarrow g \\] <p>\uc989, \uc784\uc758\uc758 \\(f\\)\uc758 flow difference \\(g\\)\uac00 \uc788\uc744 \ub54c, \uc774\ub97c \\(f\\)\uc5d0 \ub354\ud574 \uc0c8\ub85c\uc6b4 flow \\(f'\\)\ub97c \ub9cc\ub4e4\uc5b4\ub0bc \uc218 \uc788\ub2e4.</p> <p>flow difference\uc758 \ubb38\uc81c\ub294, \uc74c\uc758 \uac00\uc911\uce58\ub97c \uac00\uc9c8 \uc218 \uc788\ub2e4\ub294 \uc810\uc774\ub2e4. \uc774 \uc810 \uc774\uc678\uc5d0\ub294 \uc77c\ubc18\uc801\uc778 flow\uc640 \ubaa8\ub450 \ub611\uac19\uc73c\ub2c8, flow difference\ub97c \uc74c \uc544\ub2cc \uac00\uc911\uce58\ub9cc\uc744 \uc774\uc6a9\ud558\uc5ec \ud45c\ud604\ud558\uae30 \uc704\ud558\uc5ec residual flow network\ub97c \uc815\uc758\ud558\uc790. \uc74c\uc758 flow\ub294 \ubc18\ub300 \ubc29\ud5a5\uc758 flow\ub85c \uc0dd\uac01\ud560 \uc218 \uc788\ub2e4.</p> <p>Definition 7</p> <p>Flow network \\((G, c, s, t)\\)\uc640 flow \\(f\\)\uac00 \uc788\uc744 \ub54c, residual flow network \\(G_f\\)\ub97c \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\uc758\ud55c\ub2e4.</p> <p>\\(G_f\\)\uc758 \uc815\uc810 \uc9d1\ud569\uc740 \\(G\\)\uc640 \uac19\uc73c\uba70, \uac01 \uac04\uc120 \\(e=(u, v) \\in E\\)\uc5d0 \ub300\ud558\uc5ec \\((u, v)\\) \ubc29\ud5a5\uc73c\ub85c \\(c(e)-f(e)\\), \\((v, u)\\) \ubc29\ud5a5\uc73c\ub85c \\(-f(e)\\)\uc758 \uac00\uc911\uce58\uc758 \uac04\uc120\uc744 \\(G_f\\)\uc5d0 \ucd94\uac00\ud55c\ub2e4. \uac00\uc911\uce58 \\(0\\)\uc758 \uac04\uc120\uc740 \ubb34\uc2dc\ud560 \uc218 \uc788\ub2e4.</p> <p>\\(G_f\\)\ub294 flow network \uc774\uace0, \\(G_f\\)\uc758 \uc784\uc758\uc758 flow \\(g\\)\ub294 \\(f\\)\uc5d0 \ub354\ud574 \ub2e4\ub978 valid flow \\(f+g\\)\ub97c \ub9cc\ub4e4 \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, \uc5b4\ub5a4 flow \\(f\\)\uac00 \uc815\ud574\uc84c\uc744 \ub54c, \uc784\uc758\uc758 \ub2e4\ub978 valid flow \\(f'\\)\uc640, \\(f\\)\uc758 flow difference, \\(G_f\\)\uc758 \uc784\uc758\uc758 flow \\(g\\)\ub294 \ubaa8\ub450 \uc77c\ub300\uc77c \ub300\uc751\ub41c\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>Property 3</p> <p>Flow network \\((G, c, s, t)\\)\uc640 flow \\(f\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c</p> <ol> <li>\uc784\uc758\uc758 valid flow \\(f'\\)</li> <li>\\(f\\)\uc758 flow difference</li> <li>\\(G_f\\)\uc758 \uc784\uc758\uc758 flow \\(g\\)</li> </ol> <p>\ub294 \uc77c\ub300\uc77c \ub300\uc751\ub41c\ub2e4.</p> <p></p> <p>\\(G\\)\uc758 flow \\(f\\)\uc640 \\(G_f\\)\uc758 \uc784\uc758\uc758 flow \\(g\\)\uc758 \uc77c\ub300\uc77c \ub300\uc751 \uad00\uacc4\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \uc124\uba85\ud560 \uc218 \uc788\ub2e4. \\(G\\)\uc758 flow\ub294 \uac04\uc120 \uac00\uc911\uce58\ub4e4\uc758 \uc120\ud615 \uacb0\ud569\uc774 \ud2b9\uc815 \uac12 \uc774\ud558\ub85c \uc81c\ud55c\ub418\ub294, Linear Programming\uc758 \ud615\ud0dc\ub97c \ub744\uace0 \uc788\uae30 \ub54c\ubb38\uc5d0, \uc784\uc758\uc758 flow\ub97c \\(|E|\\)\ucc28\uc6d0\uc758 \ubca1\ud130\ub85c \ud45c\ud604\ud55c\ub2e4\uba74, \\(f\\)\ub294 convex polyhedron\uc5d0\uc11c\uc758 \uc784\uc758\uc758 \uc810\uc73c\ub85c \uc0dd\uac01\ud560 \uc218 \uc788\ub2e4. \\(G_f\\)\uc758 flow \\(g\\)\ub294 \uac19\uc740 \ub3c4\ud615\uc744 \\(f\\)\uc758 \uc810\uc744 \uc6d0\uc810\uc73c\ub85c \ud3c9\ud589\uc774\ub3d9\ud55c \ubaa8\uc591\uacfc \uac19\ub2e4.</p> <p></p> <p>Property 4</p> <p>\\(G\\)\uc758 \uc784\uc758\uc758 flow\ub294 Linear Programming\uc758 \uc870\uac74\uc5d0 \ubd80\ud569\ud558\ub2c8, \\(|E|\\)\ucc28\uc6d0 convex polyhedron\uc73c\ub85c \uc0dd\uac01\ud560 \uc218 \uc788\ub2e4. \\(G_f\\)\uc758 flow \\(g\\)\ub294 \uac19\uc740 \ub3c4\ud615\uc744 \\(f\\)\uc758 \uc810\uc744 \uc6d0\uc810\uc73c\ub85c \ud3c9\ud589\uc774\ub3d9\ud55c \ubaa8\uc591\uacfc \uac19\ub2e4.</p>","tags":["flow","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Ford-Fulkerson%20method/algorithm/#universal-algorithm-for-maximum-flow","title":"Universal Algorithm for Maximum Flow","text":"<p>Flow \\(f\\)\uac00 maximum flow\uc778\uc9c0 \uc5ec\ubd80\ub97c \\(G_f\\)\uc5d0\uc11c \\(s\\)\uc5d0\uc11c \\(t\\)\ub85c \uac00\ub294 \uacbd\ub85c\uac00 \uc874\uc7ac\ud558\ub294\uc9c0 \uc5ec\ubd80\ub85c \ud655\uc778\ud560 \uc218 \uc788\ub2e4.</p> <p>Property 5</p> <p>\ub2e4\uc74c \ub450 \uba85\uc81c\ub294 \ub3d9\uce58\uc774\ub2e4.  </p> <ul> <li>Flow \\(f\\)\uac00 maximum flow\uc774\ub2e4.  </li> <li>\\(G_f\\)\uc5d0\uc11c \\(s\\)\uc5d0\uc11c \\(t\\)\ub85c \uac00\ub294 \uacbd\ub85c\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4.  </li> </ul> <p>Proof</p> <p>\\(f\\)\uac00 maximum flow\uac00 \uc544\ub2c8\ub77c\uace0 \ud558\uba74, \ub2e4\ub978 maximum flow \\(f'\\)\uc774 \uc874\uc7ac\ud55c\ub2e4. \\(f'-f\\)\ub294 Property 2\uc640 Property 3\uc5d0 \uc758\ud574 flow difference\ub85c \uc77c\ub300\uc77c \ub300\uc751 \uac00\ub2a5\ud558\uace0, \ub530\ub77c\uc11c \\(G_f\\)\uc758 \uc784\uc758\uc758 flow \\(g\\)\uc640 \uc77c\ub300\uc77c \ub300\uc751 \uac00\ub2a5\ud558\ub2e4. \\(val(g)&gt;0\\)\uc774\uc5b4\uc57c \ud558\ub2c8, \\(G_f\\)\uc5d0\uc11c \\(s\\)\uc5d0\uc11c \\(t\\)\ub85c \uac00\ub294 \uacbd\ub85c\uac00 \uc874\uc7ac\ud574\uc57c \ud55c\ub2e4.</p> <p>\\(G_f\\)\uc5d0\uc11c \\(s\\)\uc5d0\uc11c \\(t\\)\ub85c \uac00\ub294 \uacbd\ub85c\uac00 \uc874\uc7ac\ud55c\ub2e4\uba74, \ud574\ub2f9 \uacbd\ub85c\ub97c \ub530\ub77c \uacbd\ub85c\uc758 capcity\uc758 \ucd5c\uc19f\uac12\uc5d0 \ud574\ub2f9\ud558\ub294 flow\ub97c \ud758\ub9b4 \uc218 \uc788\ub2e4. \\(G_f\\)\uc758 valid flow\uc778 \uc774 \uacbd\ub85c\ub97c \\(g\\)\ub77c \ud558\uba74, Property 2\uc640 Property 3\uc5d0 \uc758\ud574 flow difference\ub85c \uc77c\ub300\uc77c \ub300\uc751 \uac00\ub2a5\ud558\uace0, \ub530\ub77c\uc11c \\(f\\)\uc758 \ub2e4\ub978 flow \\(f'\\)\ub85c \uc77c\ub300\uc77c \ub300\uc751 \uac00\ub2a5\ud558\ub2e4. \\(val(g)&gt;0\\)\uc774\ub2c8, \\(val(f')=val(f)+val(g)&gt;val(f)\\), \\(f\\)\ub294 maximum flow\uac00 \uc544\ub2c8\ub2e4.</p> <p>\ub530\ub77c\uc11c \ub2e4\uc74c\uacfc \uac19\uc740 \uc77c\ubc18\uc801\uc778 \uc54c\uace0\ub9ac\uc998\uc73c\ub85c Maximum Flow \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Algorithm 1</p> <p>Flow network \\((G, c, s, t)\\)\uac00 \uc8fc\uc5b4\uc9c4\ub2e4. flow \\(f\\)\ub97c \\(0\\)\uc73c\ub85c \ucd08\uae30\ud654\ud55c \ud6c4, \\(G_f\\)\uc5d0\uc11c \\(s \\rightarrow t\\) \uacbd\ub85c\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc744 \ub54c\uae4c\uc9c0 \\(G_f\\)\uc758 \uc784\uc758\uc758 flow \\(f'\\)\uc744 \ucc3e\uc740 \ud6c4, \\(f \\leftarrow f+f'\\)\ub85c \uc5c5\ub370\uc774\ud2b8\ud55c\ub2e4. \\(f\\)\uac00 Maximum Flow\uc774\ub2e4.</p> <pre><code>Let (G, c, s, t) be a flow network\nInitialize f &lt;- 0\nWhile t is not reachable from s in G_f :\n    Find some flow f' in G_f\n    f &lt;- f + f'\nreturn f\n</code></pre> <p>Maximum Flow \ubb38\uc81c\ub97c \ud574\uacb0\ud558\ub294 \uc5ec\ub7ec \uc54c\uace0\ub9ac\uc998\uc740 \uc704 \ud480\uc774\uc5d0\uc11c \\(G_f\\)\uc758 \uc784\uc758\uc758 \uc591\uc758 flow \\(f'\\)\ub97c \ucc3e\ub294 \ubc29\ubc95\uc744 \uc81c\uc2dc\ud55c\ub2e4. \uac01 \ubc29\ubc95\uc5d0 \ub300\ud558\uc5ec, \ubc18\ubcf5\ubb38\uc774 \uc5b8\uc820\uac00\ub294 \uc885\ub8cc\ud55c\ub2e4\ub294 \uc0ac\uc2e4, \uc989 \\(G_f\\)\uc5d0\uc11c \\(s \\rightarrow t\\) \uacbd\ub85c\uac00 \uc5b8\uc820\uac00\ub294 \ub04a\uae34\ub2e4\ub294 \uac83\uc744 \uc99d\uba85\ud574\uc57c \ud55c\ub2e4.</p>","tags":["flow","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Ford-Fulkerson%20method/algorithm/#ford-fulkerson-method","title":"Ford - Fulkerson Method","text":"<p>Ford-Fulkerson Method\ub294 \\(f'\\)\ub97c \ucc3e\uae30 \uc704\ud558\uc5ec, \\(s\\)\uc5d0\uc11c \\(t\\)\ub85c \uac00\ub294 \uacbd\ub85c\uac00 \uc874\uc7ac\ud55c\ub2e4\ub294 \uac83\uc744 \uc54c\uace0 \uc788\uc73c\ub2c8, \ud574\ub2f9 \uacbd\ub85c\ub97c \ub530\ub77c \uacbd\ub85c\uc758 capcity\uc758 \ucd5c\uc19f\uac12\uc5d0 \ud574\ub2f9\ud558\ub294 flow\ub97c \ud758\ub9ac\uace0 \uc774\ub97c \\(f'\\)\uc774\ub77c \ud55c\ub2e4. \\(G_f\\)\uc5d0\uc11c\ub294 \ubaa8\ub4e0 \uac00\uc911\uce58\uac00 \uc591\uc218\uc774\ub2c8, \uacbd\ub85c\uc758 capcity\uc758 \ucd5c\uc19f\uac12\uc5d0 \ud574\ub2f9\ud558\ub294 flow \ub610\ud55c \uc591\uc218\uc784\uc744 \uc54c \uc218 \uc788\uace0, \uac00\uc911\uce58\uac00 \uc815\uc218, \ud639\uc740 \uc720\ub9ac\uc218 \ub4f1\uc758 countable(isomorphic to \\(\\mathbb{N}\\))\uc774\uba74 \ubc18\ubcf5\ubb38\uc774 \uc885\ub8cc\ud55c\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4. \uc774 \ub54c, \ucd94\uac00 flow\ub97c \ud758\ub9ac\uae30 \uc704\ud558\uc5ec \ubc1c\uacac\ud55c \uacbd\ub85c\ub97c augmenting path\ub77c \ud55c\ub2e4.</p> <p>Algorithm 2</p> <p>Flow network \\((G, c, s, t)\\)\uac00 \uc8fc\uc5b4\uc9c4\ub2e4. flow \\(f\\)\ub97c \\(0\\)\uc73c\ub85c \ucd08\uae30\ud654\ud55c \ud6c4, \\(G_f\\)\uc5d0\uc11c \\(s \\rightarrow t\\) \uacbd\ub85c\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc744 \ub54c\uae4c\uc9c0 \\(s \\rightarrow t\\) \uacbd\ub85c\ub97c \ub530\ub77c capcity\uc758 \ucd5c\uc19f\uac12\uc5d0 \ud574\ub2f9\ud558\ub294 flow \\(f'\\)\ub97c \ucc3e\uace0, \\(f \\leftarrow f+f'\\)\ub85c \uc5c5\ub370\uc774\ud2b8\ud55c\ub2e4. \\(f\\)\uac00 Maximum Flow\uc774\ub2e4.</p> <pre><code>Let (G, c, s, t) be a flow network\nInitialize f &lt;- 0\nWhile t is not reachable from s in G_f :\n    Find a path P from s to t in G_f\n    Let flow f' be flow with all edges in P with the lowest capacity\n    f &lt;- f + f'\nreturn f\n</code></pre> <p>Definition 8</p> <p>\uc0c8\ub85c\uc6b4 flow \\(f'\\)\ub97c \ud758\ub9ac\uae30 \uc704\ud558\uc5ec \\(s \\rightarrow t\\) \uacbd\ub85c\ub97c \ucc3e\uace0, capcity\uc758 \ucd5c\uc19f\uac12\uc5d0 \ud574\ub2f9\ud558\ub294 flow\ub97c \ud758\ub9ac\ub294\ub370, \uc774 \ub54c \uacbd\ub85c\ub97c augmenting path\ub77c \ud55c\ub2e4.</p> <p>\uc2dc\uac04 \ubcf5\uc7a1\ub3c4\ub294 \ucd5c\uc545\uc758 \uacbd\uc6b0\uc5d0\ub294 \uac01 \ubc18\ubcf5\ubb38\uc774 \ud06c\uae30 \\(1\\)\uc758 flow\ub97c \ucc3e\uc73c\uba70, \ud55c\ubc88 flow\ub97c \ucc3e\uae30 \uc704\ud558\uc5ec DFS\ub97c \ub3cc\uc544\uc57c \ud558\ub2c8 \\(O(EF)\\) (\\(F\\)\ub294 maximum flow\uc758 \uc591)\uc758 \uc2dc\uac04\uc774 \uac78\ub9b0\ub2e4.</p> <p>Time Complexity</p> <p>Time Complexity : \\(O(EF)\\)</p>","tags":["flow","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Ford-Fulkerson%20method/algorithm/#reference","title":"Reference","text":"<ul> <li>https://codeforces.com/blog/entry/104960</li> <li>https://cp-algorithms.com/graph/edmonds_karp.html</li> <li>https://en.wikipedia.org/wiki/Ford%E2%80%93Fulkerson_algorithm</li> </ul>","tags":["flow","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Min%20Cost%20Max%20Flow/algorithm/","title":"Minimum Cost Maximum Flow","text":"","tags":["flow","graphs","mcmf","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Min%20Cost%20Max%20Flow/algorithm/#definition","title":"Definition","text":"<p>Minimum cost maximum flow \ubb38\uc81c\ub97c \uc815\uc758\ud558\uae30 \uc704\ud558\uc5ec, flow network\uc5d0 \ub2e4\uc74c\uacfc \uac19\uc774 cost\uc758 \uac1c\ub150\uc744 \uc815\uc758\ud558\uc790.</p> <p>Definition 1</p> <p>Flow network \\((G, c, s, t)\\)\uc640 cost function \\(a\\) (\\(a : E \\rightarrow \\mathbb{R}\\))\uac00 \uc8fc\uc5b4\uc9c8 \ub54c, flow \\(f\\)\uc758 \ube44\uc6a9 cost\ub97c \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\uc758\ud55c\ub2e4.</p> \\[cost(f) = \\sum_{e \\in E} f(e)a(e)\\] <p>\uc0c8\ub85c \ucd94\uac00\ub41c cost\uc758 \uac1c\ub150\uc5d0\ub3c4 \uc804\uacfc \uac19\uc774 residual flow network \\(G_f\\)\ub97c \uad6c\ud560 \uc218 \uc788\ub2e4. \ubc18\ub300 \ubc29\ud5a5 \uac04\uc120\uc758 \uacbd\uc6b0, \uc774\ubbf8 \ub9cc\ub4e4\uc5b4\uc9c4 flow\ub97c \ucde8\uc18c\ud560 \uc218 \uc788\uc5b4\uc57c \ud558\ub2c8, \uc774\ubbf8 \uc0ac\uc6a9\ud55c \uac00\uc911\uce58\ub97c \ub3cc\ub824\ubc1b\uae30 \uc704\ud558\uc5ec \ud574\ub2f9 \uac00\uc911\uce58\uc758 \ubd80\ud638\ub97c \ub4a4\uc9d1\uc5b4 \uc124\uc815\ud55c\ub2e4.</p> <p>Definition 2</p> <p>Flow network \\((G, c, a, s, t)\\)\uc640 flow \\(f\\)\uac00 \uc788\uc744 \ub54c, residual flow network \\(G_f\\)\ub97c \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\uc758\ud55c\ub2e4.</p> <p>\\(G_f\\)\uc758 \uc815\uc810 \uc9d1\ud569\uc740 \\(G\\)\uc640 \uac19\uc73c\uba70, \uac01 \uac04\uc120 \\(e=(u, v) \\in E\\)\uc5d0 \ub300\ud558\uc5ec \\((u, v)\\) \ubc29\ud5a5\uc73c\ub85c \\(c_f(e)=c(e)-f(e)\\), \\(a_f(e)=a(e)\\), \\((v, u)\\) \ubc29\ud5a5\uc73c\ub85c \\(c_f(e)=-f(e)\\), \\(a_f(e)=-a(e)\\) \uc758 capacity\uc640 cost\uc758 \uac04\uc120\uc744 \\(G_f\\)\uc5d0 \ucd94\uac00\ud55c\ub2e4. \uac00\uc911\uce58 \\(0\\)\uc758 \uac04\uc120\uc740 \ubb34\uc2dc\ud560 \uc218 \uc788\ub2e4.</p> <p>Minimum cost maximum flow \ubb38\uc81c\ub294 Maximum Flow\ub97c \uac16\ub294 flow\ub4e4 \uc911, cost\uc758 \ucd5c\uc19f\uac12\uc744 \uad6c\ud558\ub294 \uac83\uc774\ub2e4.</p> <p>Definition 3</p> <p>Minimum Cost Maximum Flow \ubb38\uc81c\ub294 Maximum Flow\ub97c \uac16\ub294 flow\ub4e4 \uc911, cost\uc758 \ucd5c\uc19f\uac12\uc744 \uad6c\ud558\ub294 \uac83\uc774\ub2e4.</p> <p>Property 1</p> <p>Flow network \\((G, c, s, t)\\)\uc640 flow \\(f\\)\uac00 \uc788\uc744 \ub54c, \\(f\\)\ub294 \uc720\ud55c \uac1c\uc758 path\uc640 cycle\ub85c \ubd84\ud574 \uac00\ub2a5\ud558\ub2e4. \uac01 Path\uc640 Cycle\ub4e4\uc740 \uc591\uc758 \uac00\uc911\uce58\ub97c \uac16\uace0 \uc788\uc73c\uba70, \uac01 \uac04\uc120\uc758 \uac00\uc911\uce58\ub294 \uac04\uc120\uc774 \ud3ec\ud568\ub418\ub294 Path\uc640 Cycle\uc758 \uac00\uc911\uce58 \ud569\uacfc \uac19\ub2e4.</p> <p>\ub9cc\uc57d \\(val(f)=0\\)\uc774\ub77c\uba74, path\ub294 \uc5c6\uace0 cycle\ub4e4\ub85c\ub9cc \ubd84\ud574\ub41c\ub2e4.</p> <p></p>","tags":["flow","graphs","mcmf","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Min%20Cost%20Max%20Flow/algorithm/#successive-shortest-path-algorithm","title":"Successive Shortest Path Algorithm","text":"<p>\uc6b0\uc120, \uc6b0\ub9ac\uac00 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 flow network \\((G, c, a, s, t)\\)\ub294 negative cycle\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4\uace0 \uc0dd\uac01\ud55c\ub2e4.</p> <p>\uae30\ubcf8\uc801\uc778 \uc54c\uace0\ub9ac\uc998\uc758 \ud2c0\uc740 Ford-Fulkerson\uacfc Edmond-Karp\uc640 \uac19\uc774 \\(G_f\\)\uc5d0\uc11c \uc5b4\ub5a4 \uacbd\ub85c\ub97c \ucc3e\ub294\ub370, \uc774 \uacbd\ub85c\ub97c \ucd5c\ub2e8\uacbd\ub85c\ub85c \ubc18\ubcf5\ud558\uc5ec \ud0d0\uc0c9\ud55c\ub2e4.</p> <p>Algorithm 1</p> <p>Flow network \\((G, c, a, s, t)\\)\uac00 \uc8fc\uc5b4\uc9c4\ub2e4. flow \\(f\\)\ub97c \\(0\\)\uc73c\ub85c \ucd08\uae30\ud654\ud55c \ud6c4, \\(G_f\\)\uc5d0\uc11c \\(s \\rightarrow t\\) \uacbd\ub85c\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc744 \ub54c\uae4c\uc9c0 \\(s \\rightarrow t\\)\uc758 cost\uc5d0 \ub300\ud55c \ucd5c\ub2e8\uacbd\ub85c\ub97c \uad6c\ud558\uace0, \ucd5c\ub2e8\uacbd\ub85c\ub97c \ub530\ub77c capcity\uc758 \ucd5c\uc19f\uac12\uc5d0 \ud574\ub2f9\ud558\ub294 flow \\(f'\\)\ub97c \ucc3e\uace0, \\(f \\leftarrow f+f'\\)\ub85c \uc5c5\ub370\uc774\ud2b8\ud55c\ub2e4. \\(f\\)\uac00 Minimum Cost Maximum Flow\uc774\ub2e4.</p> <pre><code>Let (G, c, a, s, t) be a flow network\nInitialize f &lt;- 0\nWhile t is not reachable from s in G_f :\n    Find the shortest path P of costs from s to t in G_f\n    Let flow f' be flow with all edges in P with the lowest capacity\n    f &lt;- f + f'\nreturn f\n</code></pre> <p>\uc704 \uc54c\uace0\ub9ac\uc998\uc758 \uc815\ub2f9\uc131\uc744 \ubcf4\uc774\uae30 \uc704\ud558\uc5ec \ub2e4\uc74c 2\uac00\uc9c0 \uc131\uc9c8\uc744 \uc774\uc6a9\ud558\uc790.</p> <p>Property 2</p> <p>Negative cycle\uc774 \uc5c6\ub294 flow network \\((G, c, a, s, t)\\)\uac00 \uc8fc\uc5b4\uc9c0\uace0, \\(G\\)\uc5d0\uc11c \\(s \\rightarrow t\\)\uc758 cost\uc5d0 \ub300\ud55c \ucd5c\ub2e8\uacbd\ub85c\ub97c \\(P\\)\ub77c \ud558\uc790. \\(P\\)\uc5d0 \uc5b4\ub5a4 \uac00\uc911\uce58 \\(\\gamma\\)\ub97c \ud758\ub824\ubcf4\ub0b8 flow\ub97c \\(f\\)\ub77c \ud560 \ub54c, \\(G_f\\) \ub610\ud55c negative cycle\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4.</p> <p>Proof</p> <p>\uc6d0\ub798 negative cycle\uc774 \uc5c6\ub358 \uadf8\ub798\ud504\uc5d0 \\(f\\)\ub97c \ud758\ub9ac\uace0 \ub098\ub2c8 negative cycle\uc774 \uc0dd\uae30\uae30 \uc704\ud574\uc11c\ub294 \\(P\\)\uc5d0 flow\ub97c \ud758\ub9bc\uc73c\ub85c\uc11c \\(G_f\\)\uc5d0 \uc0dd\uc131\ub41c \uc0c8\ub85c\uc6b4 \uac04\uc120\ub4e4\uc744 \ud3ec\ud568\ud558\ub294 negative cycle\uc774 \uc0dd\uaca8\uc57c \ud55c\ub2e4.</p> <p></p> <p>\ud558\uc9c0\ub9cc \uc704 \uadf8\ub9bc\ucc98\ub7fc \\(P\\)\uc5d0 \ud3ec\ud568\ub418\ub294 \\((u, v)\\)\uac00 \uc788\uace0, \\(G_f\\)\uc5d0\uc11c \\((v, u)\\)\ub97c \ud3ec\ud568\ud558\ub294 negative cycle\uc774 \uc0dd\uacbc\ub2e4\uace0 \ud558\uba74, \\(-a+b&lt;0\\)\uc774 \uc131\ub9bd\ud558\uba70, \\(b&lt;a\\)\uac00 \ub41c\ub2e4. \ud558\uc9c0\ub9cc \uc774\ub294 \\(P\\)\uac00 \ucd5c\ub2e8\uacbd\ub85c\uc784\uc5d0 \ubaa8\uc21c\uc774\ub2e4. \uc774\ub7ec\ud55c \ub17c\ub9ac\ub294 negative cycle\uc774 \ud558\ub098\uc758 \uac04\uc120\ub9cc \ud3ec\ud568\ud558\uc9c0 \uc54a\uc744 \ub54c\ub3c4 \uc131\ub9bd\ud558\uba70, \uc5c4\ubc00\ud55c \uc99d\uba85\uc740 Property 1\uc758 decomposition\uc744 \uc774\uc6a9\ud558\uc5ec \ud560 \uc218 \uc788\ub2e4.</p> <p>Property 3</p> <p>Flow network \\((G, c, a, s, t)\\)\uc640 flow \\(f\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c \ub2e4\uc74c \uba85\uc81c\ub294 \ub3d9\uce58\uc774\ub2e4.</p> <ul> <li>\\(G_f\\)\uc5d0\ub294 negative cycle\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4.</li> <li>\\(f\\)\ub294 value \\(val(f)\\)\ub97c \uac16\ub294 flow \uc911 cost\uac00 \ucd5c\uc18c\uc774\ub2e4.</li> </ul> <p>Proof</p> <p>\\(f\\)\uac00 value \\(val(f)\\)\ub97c \uac16\ub294 flow \uc911 cost\uac00 \ucd5c\uc18c\ub77c \uac00\uc815\ud558\uc790. \ub9cc\uc57d \\(G_f\\)\uc5d0 negative cycle \\(C\\)\uac00 \uc874\uc7ac\ud55c\ub2e4\uba74 \\(C\\)\uc5d0 \uc591\uc758 flow\ub97c \ud758\ub9ac\uba74 \uac19\uc740 value\uc774\uc9c0\ub9cc, cost\uac00 \ub354 \uc791\uc740 flow\ub97c \ub9cc\ub4e4 \uc218 \uc788\ub2e4. \uc774\ub294 \\(f\\)\uac00 cost\uac00 \ucd5c\uc18c\uc784\uc5d0 \ubaa8\uc21c\uc774\ub2e4.</p> <p>\\(G_f\\)\uc5d0 negative cycle\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4\uace0 \uac00\uc815\ud558\uc790. \ub9cc\uc57d \\(f\\)\uac00 value \\(val(f)\\)\ub97c \uac16\ub294 flow \uc911 cost\uac00 \ucd5c\uc18c\uac00 \uc544\ub2c8\ub77c\uba74, \uac19\uc740 \\(val(f)\\)\ub97c \uac16\ub294 \ucd5c\uc18c flow \\(f'\\)\uac00 \uc874\uc7ac\ud55c\ub2e4. \\(f'-f\\)\ub294 \\(val(f'-f)=0\\)\uc774\uace0, \\(cost(f'-f)&lt;0\\)\uc774\ub2e4. Property 1\uc5d0 \uc758\ud574 \\(f'-f\\)\ub294 \uc5ec\ub7ec \uac1c\uc758 cycle\ub4e4\ub85c \ubd84\ud574\ub418\uc5b4\uc57c \ud558\ub294\ub370, \\(cost(f'-f)&lt;0\\)\uc774\ub2c8 \uc801\uc5b4\ub3c4 \ud558\ub098\uc758 negative cycle\uc774 \uc874\uc7ac\ud574\uc57c \ud55c\ub2e4.</p> <p>Flow network \\((G, c, a, s, t)\\)\uc5d0 negative cycle\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4\uba74, Property 2\uc5d0 \uc758\ud574 \uacc4\uc18d\ud558\uc5ec augmenting path\ub97c \ucd5c\ub2e8\uacbd\ub85c\ub85c \uc120\ud0dd\ud558\uba74 \\(G_f\\)\uc5d0\ub3c4 negative cycle\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc73c\uba70, Property 3\uc5d0 \uc758\ud574 \uc774\ub294 \ud574\ub2f9 value\uc5d0\uc11c\uc758 minimum cost flow\uc784\uc774 \ubcf4\uc7a5\ub41c\ub2e4. Algorithm 1\uc740 universal algorithm for maximum flow\uc758 \uc77c\uc885\uc774\ub2c8, maximum flow\ub97c \ucc3e\uc744 \uc218 \uc788\uc74c\uc744 \ubcf4\uc7a5\ud560 \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, Maximum Flow\ub97c \uac16\ub294 flow\ub4e4 \uc911, cost\uc758 \ucd5c\uc19f\uac12\uc744 \uc131\uacf5\uc801\uc73c\ub85c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\ucd5c\ub2e8\uacbd\ub85c\ub97c Bellman-Ford \uc54c\uace0\ub9ac\uc998\uc744 \uc774\uc6a9\ud558\uc5ec \uad6c\ud574\uc8fc\uba74 augmenting path\ub97c \ud55c\ubc88 \ud0d0\uc0c9\ud558\ub294\ub370 \\(O(VE)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub9ac\uace0, maximum flow\uc758 \ud06c\uae30\ub97c \\(F\\)\ub77c \ud558\uba74 \uc804\uccb4 \\(O(FVE)\\)\uc774\ub2e4. \ud558\uc9c0\ub9cc \uc2e4\uc81c \uad6c\ud604\uc5d0\uc11c\ub294 SPFA\ub97c \uc774\uc6a9\ud558\uba74 \ud3c9\uade0 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(O(FE)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(FVE)\\) (average : \\(O(FE)\\))</p>","tags":["flow","graphs","mcmf","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Min%20Cost%20Max%20Flow/algorithm/#implementation","title":"Implementation","text":"<pre><code>const int INF = 1e9+7;\n\nstruct Edge\n{\n    int v, w, c, f, r;\n    // v : vertex number, w : capacity, c : cost, f : flow, r : reverse edge number\n};\nvector&lt;Edge&gt; adj[MAXN+10];\n\nvoid addEdge(int u, int v, int w, int c)\n{\n    adj[u].push_back({v, w, c, 0, adj[v].size()});\n    adj[v].push_back({u, 0, -c, 0, adj[u].size()-1});\n}\n\nll spfa(int N, int S, int E)\n{\n    vector&lt;int&gt; dist(N+1), par(N+1);\n    vector&lt;bool&gt; inque(N+1);\n\n    for(int i=1; i&lt;=N; i++) dist[i]=INF, par[i]=-1, inque[i]=0;\n    queue&lt;int&gt; Q;\n    dist[S]=0; Q.push(S); inque[S]=true;\n    while(!Q.empty())\n    {\n        int now=Q.front(); Q.pop();\n        inque[now]=false;\n\n        for(int i=0; i&lt;adj[now].size(); i++)\n        {\n            Edge &amp;nxt = adj[now][i];\n            if(nxt.f==nxt.w) continue;\n            if(dist[now]+nxt.c&lt;dist[nxt.v])\n            {\n                dist[nxt.v]=dist[now]+nxt.c;\n                par[nxt.v]=nxt.r;\n                if(!inque[nxt.v])\n                {\n                    inque[nxt.v]=true;\n                    Q.push(nxt.v);\n                }\n            }\n        }\n    }\n\n    if(dist[E]==INF) return 0;\n\n    int flow=INF;\n\n    int now=E;\n    while(par[now]!=-1)\n    {\n        Edge &amp;nxt = adj[now][par[now]];\n        flow=min(flow, adj[nxt.v][nxt.r].w-adj[nxt.v][nxt.r].f);\n        now=nxt.v;\n    }\n\n    now=E;\n    while(par[now]!=-1)\n    {\n        Edge &amp;nxt = adj[now][par[now]];\n        adj[nxt.v][nxt.r].f+=flow;\n        adj[now][par[now]].f-=flow;\n        now=nxt.v;\n    }\n\n    return (ll)flow*dist[E];\n}\n\nll mcmf(int N, int S, int E)\n{\n    ll ans=0;\n    while(1)\n    {\n        ll t=spfa(N, S, E);\n        if(!t) break;\n        ans+=t;\n    }\n    return ans;\n}\n</code></pre>","tags":["flow","graphs","mcmf","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Min%20Cost%20Max%20Flow/algorithm/#convexity","title":"Convexity","text":"<p>MCMF\uc758 \uac00\uc7a5 \uc911\uc694\ud55c \uc815\ub9ac\ub294 \ud750\ub974\ub294 value\uc5d0 \ub300\ud55c min cost\uc758 \ud568\uc218 \\(f\\)\uac00 convex \ud55c \ud568\uc218\ub77c\ub294 \uac83\uc774\ub2e4. \uc774\ub97c \uc99d\uba85\ud558\uae30 \uc704\ud574 \ub2e4\uc74c \uc131\uc9c8\uc744 \uc774\uc6a9\ud558\uc790.</p> <p>Property 4</p> <p>Algorithm 1\uc758 \uc2e4\ud589 \uacfc\uc815\uc5d0\uc11c \\(s \\rightarrow t\\)\uc758 cost\uc5d0 \ub300\ud55c \ucd5c\ub2e8\uacbd\ub85c\ub294 \ub2e8\uc870\uc99d\uac00\ud55c\ub2e4.</p> <p>Proof</p> <p>Algorithm 1\uc5d0\uc11c flow \\(f\\), \\(g\\), \\(h\\)\uac00 \uc5f0\uc18d\uc801\uc73c\ub85c \ub4f1\uc7a5\ud558\ub294 flow\ub77c\uace0 \uac00\uc815\ud558\uc790.</p> <ul> <li>\\(G_f\\)\uc5d0\uc11c \ucd5c\ub2e8\uacbd\ub85c \\(P\\)\ub97c \ucc3e\uace0, \\(\\alpha\\)\uc758 flow\ub97c \\(P\\)\ub97c \ub530\ub77c \ud758\ub824 flow \\(g\\)\ub97c \uc5bb\uc5c8\ub2e4.</li> <li>\\(G_g\\)\uc5d0\uc11c \ucd5c\ub2e8\uacbd\ub85c \\(Q\\)\ub97c \ucc3e\uace0, \\(\\beta\\)\uc758 flow\ub97c \\(Q\\)\ub97c \ub530\ub77c \ud758\ub824 flow \\(h\\)\ub97c \uc5bb\uc5c8\ub2e4.</li> </ul> <p></p> <p>\ucd5c\ub2e8\uacbd\ub85c \\(P\\)\ubcf4\ub2e4 \ucd5c\ub2e8\uacbd\ub85c \\(Q\\)\uac00 \ub354 \uc9e7\ub2e4\uba74, \uc704 \uadf8\ub9bc\uacfc \uac19\uc774 (flow, cost) \uadf8\ub798\ud504\uc5d0\uc11c \\(f\\)\uc640 \\(g\\)\ub97c \uc787\ub294 \uc9c1\uc120\uc758 \uae30\uc6b8\uae30\ubcf4\ub2e4 \\(g\\)\uc640 \\(h\\)\ub97c \uc787\ub294 \uc9c1\uc120\uc758 \uae30\uc6b8\uae30\uac00 \ub354 \uc791\uc544\uc57c \ud55c\ub2e4. \ud558\uc9c0\ub9cc \uc774\ub807\ub2e4\uba74 \\(g\\)\ubcf4\ub2e4 \\(f\\)\uc5d0 \\(h-f\\)\ub97c \\(g\\)\uc640 \uac19\uc740 value\ub97c \uac00\uc9c0\ub3c4\ub85d \\(\\frac{\\alpha}{\\alpha+\\beta}\\)\ub97c \uacf1\ud558\uc5ec \ub354\ud55c, \\(f+(h-f)\\frac{\\alpha}{\\alpha+\\beta}\\)\uac00 \ub354 \uc791\uc740 \ube44\uc6a9\uc744 \uac00\uc9c4\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c \\(g\\)\uac00 \ucd5c\uc18c cost flow\uc784\uc5d0 \ubaa8\uc21c\uc774\ub2e4.</p> <p>\uc704 \uc815\ub9ac\ub85c \uc778\ud558\uc5ec (flow, cost) \uadf8\ub798\ud504\ub97c \uadf8\ub9ac\uba74 \uae30\uc6b8\uae30\uac00 \ub2e8\uc870\uc99d\uac00\ud558\ub294, convex \ud55c \uadf8\ub798\ud504\ub97c \ud655\uc778\ud560 \uc218 \uc788\ub2e4.</p> <p>Property 5</p> <p>\uac01 value\uc5d0 \ub300\ud55c minimum cost\ub97c (flow, cost) \uadf8\ub798\ud504\ub85c \ud45c\ud604\ud558\uba74 \uadf8\ub798\ud504\ub294 \uae30\uc6b8\uae30\uac00 \ub2e8\uc870\uc99d\uac00\ud558\ub294 convex\ud55c \ubaa8\uc591\uc774\ub2e4.</p> <p>Flow\uc758 \uc870\uac74\uacfc cost\uc758 \uc2dd\uc774 \ubaa8\ub450 linear programming\uc758 \uc870\uac74\uc774\ub77c \uc0dd\uac01\ud560 \uc218 \uc788\uc73c\ub2c8, flow\uc640 cost\ub97c \ud3ec\ud568\ud55c \ubaa8\ub4e0 \ubcc0\uc218\ub4e4\uc740 convex polyhedron\uc744 \uad6c\uc131\ud55c\ub2e4. Minimum cost flow \ubb38\uc81c\ub294 convex polyhedron\uc744 (flow, cost)\uc758 \uc88c\ud45c\ud3c9\uba74\uc5d0 \uc0ac\uc601\ud55c \ubaa8\uc2b5\uc774\ub2c8, \uc774 \ub610\ud55c convex\ud558\ub2e4\ub294 \uc0ac\uc2e4\uc744 \ub2e4\ub974\uac8c \uc99d\uba85\ud560 \uc218\ub3c4 \uc788\ub2e4.</p> <p>Property 6</p> <p>Flow\uc758 \uc870\uac74\uacfc cost\uc758 \uc2dd\uc774 \ubaa8\ub450 linear programming\uc758 \uc870\uac74\uc774\ub77c \uc0dd\uac01\ud560 \uc218 \uc788\uc73c\ub2c8, flow\uc640 cost\ub97c \ud3ec\ud568\ud55c \ubaa8\ub4e0 \ubcc0\uc218\ub4e4\uc740 convex polyhedron\uc744 \uad6c\uc131\ud55c\ub2e4. Minimum cost flow \ubb38\uc81c\ub294 convex polyhedron\uc744 (flow, cost)\uc758 \uc88c\ud45c\ud3c9\uba74\uc5d0 \uc0ac\uc601\ud55c \ubaa8\uc2b5\uc774\ub2c8, \ub3c4\ud615\uc740 convex\ud558\uace0 y\uc88c\ud45c\uc758 \ucd5c\uc19f\uac12\uc744 \ub530\ub77c \uc9c1\uc120\uc744 \uc774\uc5b4\ub3c4 convex\ud558\ub2e4.</p> <p></p>","tags":["flow","graphs","mcmf","~ algorithm"]},{"location":"algorithms/Graphs/Flows/Min%20Cost%20Max%20Flow/algorithm/#reference","title":"Reference","text":"<ul> <li>https://codeforces.com/blog/entry/105330</li> <li>https://cp-algorithms.com/graph/min_cost_flow.html</li> </ul>","tags":["flow","graphs","mcmf","~ algorithm"]},{"location":"algorithms/Graphs/Theorems/K%C5%91nig%27s%20theorem/algorithm/","title":"K\u0151nig's theorem","text":"","tags":["bipartite_matching","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Theorems/K%C5%91nig%27s%20theorem/algorithm/#definition","title":"Definition","text":"<p>Definition 1</p> <p>Graph \\(G=(V, E)\\)\uc5d0\uc11c matching\uc740 \uac04\uc120\uc758 \ubd80\ubd84\uc9d1\ud569 \\(E' \\subseteq E\\)\ub85c, \ubaa8\ub4e0 \uc120\ud0dd\ub41c \uac04\uc120\ub4e4\uc740 \uc11c\ub85c \uc815\uc810\uc744 \uacf5\uc720\ud558\uc9c0 \uc54a\ub294\ub2e4.</p> <p>Maximum matching\uc740 \ucd5c\ub300 \ud06c\uae30\uc758 matching\uc774\ub2e4.</p> <p>Definition 2</p> <p>Graph \\(G=(V, E)\\)\uc5d0\uc11c vertex cover\uc740 \uc815\uc810\uc758 \ubd80\ubd84\uc9d1\ud569 \\(V' \\subseteq V\\)\ub85c, \ubaa8\ub4e0 \uac04\uc120\uc774 \uc801\uc5b4\ub3c4 \ud558\ub098\uc758 \uc120\ud0dd\ub41c \uc815\uc810\uacfc \uc5f0\uacb0\ub418\uc5b4 \uc788\uc5b4\uc57c \ud55c\ub2e4.</p> <p>Minimum vertex cover\uc740 \ucd5c\uc18c \ud06c\uae30\uc758 vertex cover\uc774\ub2e4.</p> <p>\\(\\phi \\subseteq E\\)\ub3c4 \uc720\ud6a8\ud55c matching\uc774\uace0, \\(V \\subseteq V\\)\ub3c4 \uc720\ud6a8\ud55c vertex cover\uc774\ub2c8, minimum matching\uc774\ub098 maximum vertex cover\uc744 \uad6c\ud558\ub294 \uac83\uc740 \uc758\ubbf8\uac00 \uc5c6\uc74c\uc5d0 \uc720\uc758\ud558\uc790.</p>","tags":["bipartite_matching","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Theorems/K%C5%91nig%27s%20theorem/algorithm/#konigs-theorem_1","title":"K\u0151nig's theorem","text":"<p>Property 1</p> <p>Bipartite graph \\(G=(A \\cup B, E)\\)\uc5d0\uc11c maximum matching\uc758 \uac04\uc120\uc758 \uac1c\uc218\uc640 minimum vertex cover\uc758 \uc815\uc810\uc758 \uac1c\uc218\ub294 \uc77c\uce58\ud55c\ub2e4.</p>","tags":["bipartite_matching","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Theorems/K%C5%91nig%27s%20theorem/algorithm/#proof","title":"Proof","text":"<p>\uc784\uc758\uc758 vertex cover\uc758 \ud06c\uae30\ub294 \uc784\uc758\uc758 matching\uc758 \ud06c\uae30\ubcf4\ub2e4 \ud06c\uac70\ub098 \uac19\ub2e4. \uc784\uc758\uc758 matching\uc744 \uc7a1\uc558\uc744 \ub54c, \uc774 \uadf8\ub798\ud504\uc5d0\uc11c \uc784\uc758\uc758 vertex cover\uc740 matching\uc5d0 \ud3ec\ud568\ub418\ub294 \uac01 \uac04\uc120\uc5d0 \ub300\ud558\uc5ec \uc5f0\uacb0\ud558\ub294 \ub450 \uc815\uc810 \uc911 \uc801\uc5b4\ub3c4 \ud558\ub098\ub294 \uc120\ud0dd\ud574\uc57c \ud558\uae30 \ub54c\ubb38\uc774\ub2e4.</p> <p>Property 2</p> <p>\uc784\uc758\uc758 vertex cover\uc758 \ud06c\uae30\ub294 \uc784\uc758\uc758 matching\uc758 \ud06c\uae30\ubcf4\ub2e4 \ud06c\uac70\ub098 \uac19\ub2e4.</p> <p>\\(\\forall\\) \\(|\\)matching\\(|\\) \\(\\le\\) \\(\\forall\\) \\(|\\)vertex cover\\(|\\)</p> <p>Proof</p> <p>\uc784\uc758\uc758 matching\uc744 \uc7a1\uc558\uc744 \ub54c, \uc774 \uadf8\ub798\ud504\uc5d0\uc11c \uc784\uc758\uc758 vertex cover\uc740 matching\uc5d0 \ud3ec\ud568\ub418\ub294 \uac01 \uac04\uc120\uc5d0 \ub300\ud558\uc5ec \uc5f0\uacb0\ud558\ub294 \ub450 \uc815\uc810 \uc911 \uc801\uc5b4\ub3c4 \ud558\ub098\ub294 \uc120\ud0dd\ud574\uc57c \ud558\uae30 \ub54c\ubb38\uc774\ub2e4.</p> <p>Bipartite graph \\(G=(A \\cup B, E)\\)\uc5d0\uc11c \uc774\ubd84\ub9e4\uce6d\uc744 \uad6c\ud558\uae30 \uc704\ud558\uc5ec \ub2e4\uc74c\uacfc \uac19\uc740 flow network\ub97c \uc815\uc758\ud558\uc790.</p> <ul> <li>Source \\(s\\)\uc5d0\uc11c \\(A\\)\uc758 \ubaa8\ub4e0 \uc815\uc810\uc73c\ub85c \uac00\ub294 capacity \\(1\\)\uc758 \uac04\uc120\uc774 \uc788\ub2e4.</li> <li>\\(B\\)\uc758 \ubaa8\ub4e0 \uc815\uc810\uc5d0\uc11c sink \\(t\\)\ub85c \uac00\ub294 capacity \\(1\\)\uc758 \uac04\uc120\uc774 \uc788\ub2e4.</li> <li>\\(A\\)\uc640 \\(B\\) \uc0ac\uc774\uc5d0\ub294 \\(E\\)\uc758 \uac01 \uac04\uc120 \\((a, b)\\)\uc5d0 \ub300\ud558\uc5ec capcity \\(\\infty\\)\uc758 \uac04\uc120\uc774 \uc788\ub2e4.</li> </ul> <p>\uc704 flow network\uc5d0\uc11c maximum flow\ub97c \uad6c\ud558\uba74 \uc120\ud0dd\ub418\ub294 \uac04\uc120\ub4e4\uc740 \\(A\\)\uc758 \uac01 \uc815\uc810\uc774 \ucd5c\ub300 \ud55c\ubc88, \\(B\\)\uc758 \uac01 \uc815\uc810\uc774 \ucd5c\ub300 \ud55c\ubc88 \ub4f1\uc7a5\ud558\ub2c8 maximum matching\uc774\ub2e4.</p> <p>\uc5ec\uae30\uc11c max flow min cut theorem\uc744 \uc0ac\uc6a9\ud558\uba74 maximum flow\ub97c \uad6c\ud55c \ud6c4 residual flow network \\(G_f\\)\uc5d0\uc11c source \\(s\\)\uc5d0\uc11c \ub3c4\ub2ec \uac00\ub2a5\ud55c \uc815\uc810\ub4e4\uc744 \uc9d1\ud569 \\(S\\)(\\(s \\in S\\)), \ub3c4\ub2ec \ubd88\uac00\ub2a5\ud55c \uc815\uc810\ub4e4\uc744 \uc9d1\ud569 \\(T\\)(\\(t \\in T\\))\ub85c \ub098\ub204\uba74 \\((S, T)\\)\ub294 minimum cut\uc774\ub2e4.</p> <p>\ub610\ud55c, \uc784\uc758\uc758 minimum cut \\((S, T)\\)\uc5d0 \ub300\ud574 \\(A\\)\uc5d0\uc11c \\(S\\)\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(A_S\\), \\(T\\)\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(A_T\\), \\(B\\)\uc5d0\uc11c \\(S\\)\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(B_S\\), \\(T\\)\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(B_T\\)\ub85c \ud45c\ud604\ud558\uc790. \uc815\uc758\uc5d0 \uc758\ud574 \\(|A_T|+|B_S|\\)\uac00 minimum cut\uc758 \ud06c\uae30\uc774\ub2e4.</p> \\[A_S = S \\cap A, A_T = T \\cap A, B_S = B \\cap S, B_T = B \\cap T\\] <p>Definition 3</p> <p>Bipartite graph \\(G=(A \\cup B, E)\\)\uc5d0\uc11c \uc774\ubd84\ub9e4\uce6d\uc744 \uad6c\ud558\uae30 \uc704\ud558\uc5ec \ub2e4\uc74c\uacfc \uac19\uc740 flow network\ub97c \uc815\uc758\ud558\uc790.</p> <ul> <li>Source \\(s\\)\uc5d0\uc11c \\(A\\)\uc758 \ubaa8\ub4e0 \uc815\uc810\uc73c\ub85c \uac00\ub294 capacity \\(1\\)\uc758 \uac04\uc120\uc774 \uc788\ub2e4.</li> <li>\\(B\\)\uc758 \ubaa8\ub4e0 \uc815\uc810\uc5d0\uc11c sink \\(t\\)\ub85c \uac00\ub294 capacity \\(1\\)\uc758 \uac04\uc120\uc774 \uc788\ub2e4.</li> <li>\\(A\\)\uc640 \\(B\\) \uc0ac\uc774\uc5d0\ub294 \\(E\\)\uc758 \uac01 \uac04\uc120 \\((a, b)\\)\uc5d0 \ub300\ud558\uc5ec capcity \\(\\infty\\)\uc758 \uac04\uc120\uc774 \uc788\ub2e4.</li> </ul> <p>\uc704 flow network\uc758 \uc784\uc758\uc758 minimum cut \\((S, T)\\)\uc5d0 \ub300\ud574 \\(A\\)\uc5d0\uc11c \\(S\\)\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(A_S\\), \\(T\\)\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(A_T\\), \\(B\\)\uc5d0\uc11c \\(S\\)\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(B_S\\), \\(T\\)\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(B_T\\)\ub85c \ud45c\ud604\ud558\uc790.</p> \\[A_S = S \\cap A, A_T = T \\cap A, B_S = B \\cap S, B_T = B \\cap T\\] <p>Property 3</p> <p>Bipartite graph \\(G=(A \\cup B, E)\\)\uc5d0\uc11c maximum matching\uc758 \ud06c\uae30\ub294 Definition 1\uacfc \uac19\uc774 \uc815\uc758\ub41c flow network\uc5d0\uc11c\uc758 maximum flow\uc758 \uac12\uacfc \uac19\ub2e4. max flow min cut theorem\uc5d0 \uc758\ud574 \uc774\ub294 \uac19\uc740 flow network\uc5d0\uc11c\uc758 mininum cut\uc758 \ud06c\uae30\uc640 \uac19\uc73c\uba70, \uc774\ub294 \\(|A_T|+|B_S|\\)\uc774\ub2e4.</p> <p></p> <p>\\(A_S\\)\uc640 \\(B_T\\) \uc0ac\uc774\uc5d0\ub294 \uac04\uc120\uc774 \uc5c6\uc74c\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4. \ub9cc\uc57d \uac04\uc120\uc774 \uc874\uc7ac\ud55c\ub2e4\uba74 capcity\uac00 \\(\\infty\\)\uc774\ub2c8 cut\uc758 \ud06c\uae30\ub3c4 \\(\\infty\\)\uac00 \ub41c\ub2e4.</p> <p>Property 4</p> <p>\\(A_S\\)\uc640 \\(B_T\\) \uc0ac\uc774\uc5d0\ub294 \uac04\uc120\uc774 \uc5c6\ub2e4. \ubaa8\ub4e0 \uac04\uc120\ub4e4\uc740 \\((A_S, B_S)\\), \\((A_T, B_S)\\), \\((A_T, B_T)\\) \uc0ac\uc774\uc5d0\ub9cc \uc874\uc7ac\ud55c\ub2e4.</p> <p>Proof</p> <p>\ub9cc\uc57d \\(A_S\\)\uc640 \\(B_T\\) \uc0ac\uc774\uc5d0 \uac04\uc120\uc774 \uc874\uc7ac\ud55c\ub2e4\uba74 capcity\uac00 \\(\\infty\\)\uc774\ub2c8 cut\uc758 \ud06c\uae30\ub3c4 \\(\\infty\\)\uac00 \ub41c\ub2e4. \uc774\ub294 \\((S, T)\\)\uac00 \uc784\uc758\uc758 minimum cut\uc784\uc5d0 \ubaa8\uc21c\uc774\ub2e4.</p> <p>\uc704 Property 4\ub85c\ubd80\ud130 \\(A_T \\cup B_S\\)\ub294 vertex cover\uc784\uc744 \uc54c \uc218 \uc788\ub2e4. \ub9cc\uc57d \\(A_T \\cup B_S\\)\uc758 \uc815\uc810\ub4e4\uacfc \uc778\uc811\ud558\uc9c0 \uc54a\uc740 \uac04\uc120\uc774 \uc788\ub2e4\uba74 \uc774 \uac04\uc120\uc740 \\(A_S\\)\uc640 \\(B_T\\)\ub97c \uc5f0\uacb0\ud558\ub294 \uac04\uc120\uc774\uc5b4\uc57c \ud558\ub294\ub370, Property 4\uc5d0 \uc758\ud558\uc5ec \uc774\ub7ec\ud55c \uac04\uc120\uc740 \uc874\uc7ac\ud560 \uc218 \uc5c6\ub2e4.</p> <p>Property 5</p> <p>\\(A_T \\cup B_S\\)\ub294 vertex cover\uc774\ub2e4.</p> <p>Proof</p> <p>\\(A_T \\cup B_S\\)\uac00 vertex cover\uac00 \uc544\ub2c8\ub77c\uace0 \uac00\uc815\ud558\uba74, \\(A_T \\cup B_S\\)\uc758 \uc815\uc810\ub4e4\uacfc \uc778\uc811\ud558\uc9c0 \uc54a\uc740 \uac04\uc120\uc774 \uc788\uc5b4\uc57c \ud55c\ub2e4. \uadf8\ub807\ub2e4\uba74 \uc774 \uac04\uc120\uc740 \\(A_S\\)\uc640 \\(B_T\\)\ub97c \uc5f0\uacb0\ud558\ub294 \uac04\uc120\uc774\uc5b4\uc57c \ud558\ub294\ub370, Property 4\uc5d0 \uc758\ud558\uc5ec \uc774\ub7ec\ud55c \uac04\uc120\uc740 \uc874\uc7ac\ud560 \uc218 \uc5c6\ub2e4.</p> <p>\uc704 \uc0ac\uc2e4\ub4e4\uc744 \uc885\ud569\ud558\uba74, Property 3\uc5d0 \uc758\ud574 maximum matching\uc758 \ud06c\uae30\ub294 \\(|A_T|+|B_S|\\)\uc640 \uac19\uace0, Property 5\uc5d0 \uc758\ud574 \uc2e4\uc81c \\(|A_T|+|B_S|\\)\uc758 \ud06c\uae30\uc758 vertex cover \\(A_T \\cup B_S\\)\uc774 \uc874\uc7ac\ud55c\ub2e4. Property 2\uc5d0 \uc758\ud574 \uc784\uc758\uc758 vertex cover\uc758 \ud06c\uae30\ub294 \uc784\uc758\uc758 matching\uc758 \ud06c\uae30\ubcf4\ub2e4 \ud06c\uac70\ub098 \uac19\uc740\ub370, maximum matching\uc758 \ud06c\uae30\uc640 \uac19\uc740 vertex cover \\(A_T \\cup B_S\\)\uc744 \ucc3e\uc558\uc73c\ub2c8, \uc774\uac83\uc774 minimum vertex cover\uc774\uace0, maximum matching\uc758 \ud06c\uae30\ub294 minimum vertex cover\uc758 \ud06c\uae30\uc640 \uac19\ub2e4\ub294 \uacb0\ub860\uc744 \uc5bb\uc744 \uc218 \uc788\ub2e4.</p> <p>\ub610\ud55c, \uc2e4\uc81c minimum vertex cover\uc758 \uc9d1\ud569\uc744 \uad6c\ud558\uae30 \uc704\ud574\uc11c\ub294 maximum flow\ub97c \uba3c\uc800 \uad6c\ud574, minimum cut \\(S\\), \\(T\\)\ub97c \uc2e4\uc81c\ub85c \uad6c\ud55c \ud6c4, \\(A_T \\cup B_S\\)\ub97c \uad6c\ud558\uba74 \ub41c\ub2e4\ub294 \uac83\ub3c4 \uc54c \uc218 \uc788\ub2e4.</p>","tags":["bipartite_matching","graphs","~ algorithm"]},{"location":"algorithms/Graphs/Theorems/K%C5%91nig%27s%20theorem/algorithm/#reference","title":"Reference","text":"<ul> <li>https://en.wikipedia.org/wiki/K%C5%91nig%27s_theorem_%28graph_theory%29</li> <li>https://codeforces.com/blog/entry/105697</li> </ul>","tags":["bipartite_matching","graphs","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FFT/algorithm/","title":"FFT (Fast Fourier Transform)","text":"<p>FFT (Fast Fourier Transform)\ub294 \ub2e4\ud56d\uc2dd \uacf1\uc148\uc744 \\(O(N\\log N)\\)\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uc5d0 \ud558\ub294 \uc54c\uace0\ub9ac\uc998\uc774\ub2e4.</p> \\[ \\begin{gather} A(x) = \\sum_{i=0}^{n-1} a_i x^i = a_0 + a_1 x + a_2 x^2 + \\cdots + a_{n-1} x^{n-1} \\\\ B(x) = \\sum_{i=0}^{n-1} b_i x^i = b_0 + b_1 x + b_2 x^2 + \\cdots + b_{n-1} x^{n-1} \\\\ A(x) \\cdot B(x) = \\sum_{i=0}^{n-1} \\sum_{j=0}^{n-1} a_i b_j x^{i+j} \\end{gather} \\]","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FFT/algorithm/#idea","title":"Idea","text":"<p>\uae30\ubcf8\uc801\uc778 \uc544\uc774\ub514\uc5b4\ub294 \ub2e4\uc74c\uacfc \uac19\ub2e4.</p> <p>\ud2b9\uc815 \uac12\ub4e4 \\(x_0, x_1, \\cdots, x_{n-1}\\)\uc5d0 \ub300\ud558\uc5ec \ub2e4\ud56d\uc2dd\uc5d0 \ub300\uc785\ud55c \uac12\ub4e4 \\(A(x_0), A(x_1), \\cdots, A(x_{n-1})\\)\uc744 \uc54c\uace0 \uc788\ub2e4\uace0 \uc0dd\uac01\ud558\uc790. \ub2e4\ud56d\uc2dd \\(A(x)=\\displaystyle \\sum_{i=0}^{n-1}a_ix^i=a_0+a_1x+a_2x^2+\\cdots+a_{n-1}x^{n-1}\\)\uc5d0\uc11c \uc774\ub294 \ubbf8\uc9c0\uc218\uac00 \\(n\\)\uac1c\uc778 \uc120\ud615 \uc5f0\ub9bd\ubc29\uc815\uc2dd\uc73c\ub85c \uc0dd\uac01\ud558\uc5ec, \ubbf8\uc9c0\uc218 \\(a_0, a_1, \\cdots, a_{n-1}\\)\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\uc6b0\ub9ac\uac00 \uad6c\ud558\uace0 \uc2f6\uc740 \uac83\uc740 \\(A(x) \\cdot B(x)\\)\uc758 \uacc4\uc218\ub4e4\uc774\ub2c8, \uac70\uafb8\ub85c \ud2b9\uc815 \uac12\ub4e4 \\(x_0, x_1, \\cdots, x_{n-1}\\)\uc5d0 \ub300\ud558\uc5ec \\(A(x_0)B(x_0), A(x_1)B(x_1), \\cdots, A(x_{n-1})B(x_{n-1})\\)\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4\uba74, \uc704 \ubc29\ubc95\uc744 \ud65c\uc6a9\ud558\uc5ec \uc5ed\uc73c\ub85c \\(A(x) \\cdot B(x)\\)\uc758 \uacc4\uc218\ub4e4\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <ol> <li>\\(x_0, x_1, \\cdots, x_{n-1}\\)\uc5d0 \ub300\ud558\uc5ec \ub2e4\ud56d\uc2dd\uc758 \uacc4\uc218 \\(a_0, a_1, \\cdots, a_{n-1}\\)\uc744 \uc54c\uace0 \uc788\uc744 \ub54c \ub2e4\ud56d\uc2dd\uc5d0 \ub300\uc785\ud55c \uac12\ub4e4 \\(A(x_0), A(x_1), \\cdots, A(x_{n-1})\\) \uad6c\ud558\uae30</li> <li>\\(x_0, x_1, \\cdots, x_{n-1}\\)\uc5d0 \ub300\ud558\uc5ec \ub2e4\ud56d\uc2dd\uc5d0 \ub300\uc785\ud55c \uac12\ub4e4 \\(A(x_0), A(x_1), \\cdots, A(x_{n-1})\\)\ub97c \uc54c\uace0 \uc788\uc744 \ub54c \ub2e4\ud56d\uc2dd\uc758 \uacc4\uc218 \\(a_0, a_1, \\cdots, a_{n-1}\\) \uad6c\ud558\uae30</li> </ol> <p>\uc774\uc81c, \uc704 \ub450 \uac00\uc9c0 \uc791\uc5c5\uc744 \\(O(N\\log N)\\)\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uc5d0 \uc2e4\ud589\ud560 \uc218 \uc788\ub294 \uc54c\uace0\ub9ac\uc998\uacfc, \uc801\ub2f9\ud55c \\(x_0, x_1, \\cdots, x_{n-1}\\)\uc744 \uc120\ud0dd\ud558\uba74 \ub41c\ub2e4.</p>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FFT/algorithm/#dft-discrete-fourier-transform","title":"DFT (Discrete Fourier Transform)","text":"\\[\\omega_n=e^{\\frac{2\\pi i}{n}}=\\cos\\frac{2\\pi}{n}+i\\sin\\frac{2\\pi}{n}\\] <p>\\(n\\)-th root of unity, \\(\\omega_n\\)\uc744 \uc0dd\uac01\ud558\uc790. \\(\\omega_n\\)\uc740 \ub2e4\uc74c \ub450 \uc131\uc9c8\uc744 \ub9cc\uc871\ud55c\ub2e4.</p> <p>Property 1</p> \\[\\omega_n^n=1\\] <p>Property 2</p> <p>\\(\\omega_n^0, \\omega_n^1, \\cdots, \\omega_n^{n-1}\\)\uc740 \ubaa8\ub450 \uc11c\ub85c \ub2e4\ub974\ub2e4. \\(\\omega_n^k=e^{\\frac{2\\pi ik}{n}}=\\cos\\frac{2\\pi k}{n}+i\\sin\\frac{2\\pi k}{n}\\)</p> <p>Property 3</p> \\[\\displaystyle \\sum_{i=0}^{n-1} \\omega_n^i = \\omega_n^0 + \\omega_n^1 + \\cdots + \\omega_n^{n-1} = \\frac{1 - \\omega_n^n}{1 - \\omega_n} = 0\\] <p>\ub2e4\ud56d\uc2dd\uc5d0 \ub300\uc785\ud560 \uac12\ub4e4 \\(x_0, x_1, \\cdots, x_{n-1}\\)\ub85c, \\(\\omega_n^0, \\omega_n^1, \\cdots, \\omega_n^{n-1}\\)\ub97c \uc120\ud0dd\ud588\uc744 \ub54c\uc758 \ud568\uc22b\uac12\ub4e4\uc744 \\(DFT\\)\ub85c \ud45c\ud604\ud558\uc790. \ub610\ud55c, \\(DFT\\)\uc758 \uc5ed\ud568\uc218\ub97c \\(IDFT\\)\ub77c \uc815\uc758\ud558\uc790.</p> <p>Definition 1</p> <p>\\(DFT(a_0, a_1, \\cdots, a_{n-1})=(A(\\omega_n^0), A(\\omega_n^1), \\cdots, A(\\omega_n^{n-1}))=(y_0, y_1, \\cdots, y_{n-1})\\)</p> <p>Definition 2</p> <p>\\(IDFT(y_0, y_1, \\cdots, y_{n-1})=IDFT(A(\\omega_n^0), A(\\omega_n^1), \\cdots, A(\\omega_n^{n-1}))=(a_0, a_1, \\cdots, a_{n-1})\\)</p> <p>DFT\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \ud589\ub82c\uacf1\uc758 \ud615\ud0dc\ub85c \ud45c\ud604\ud560 \uc218 \uc788\ub2e4.</p> \\[ \\displaystyle y_j = \\sum_{i=0}^{n-1} a_i \\omega_n^{ij} \\] \\[ DFT(a_0, a_1, \\cdots, a_{n-1})=(A(\\omega_n^0), A(\\omega_n^1), \\cdots, A(\\omega_n^{n-1}))=(y_0, y_1, \\cdots, y_{n-1}) \\] \\[ = \\begin{bmatrix}     \\omega_n^{0 \\cdot 0} &amp; \\omega_n^{0 \\cdot 1} &amp; \\omega_n^{0 \\cdot 2} &amp; \\dots &amp; \\omega_n^{0 \\cdot (n-1)} \\\\     \\omega_n^{1 \\cdot 0} &amp; \\omega_n^{1 \\cdot 1} &amp; \\omega_n^{1 \\cdot 2} &amp; \\dots &amp; \\omega_n^{1 \\cdot (n-1)} \\\\     \\omega_n^{2 \\cdot 0} &amp; \\omega_n^{2 \\cdot 1} &amp; \\omega_n^{2 \\cdot 2} &amp; \\dots &amp; \\omega_n^{2 \\cdot (n-1)} \\\\     \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\     \\omega_n^{(n-1) \\cdot 0} &amp; \\omega_n^{(n-1) \\cdot 1} &amp; \\omega_n^{(n-1) \\cdot 2} &amp; \\dots &amp; \\omega_n^{(n-1) \\cdot (n-1)}  \\end{bmatrix} \\begin{bmatrix}     a_0 \\\\         a_1 \\\\     a_2 \\\\     \\vdots \\\\     a_{n-1} \\end{bmatrix} = \\begin{bmatrix}     y_0 \\\\         y_1 \\\\     y_2 \\\\     \\vdots \\\\     y_{n-1} \\end{bmatrix} \\] \\[ W= \\begin{bmatrix}     \\omega_n^{ij} \\end{bmatrix}_{0 \\le i, j &lt; n} \\] <p>\\(IDFT\\)\ub97c \uad6c\ud558\uae30 \uc704\ud574 \\(DFT\\) \ud589\ub82c \\(W\\)\uc758 \uc5ed\ud589\ub82c\uc744 \uad6c\ud558\uba74 \ub2e4\uc74c\uacfc \uac19\ub2e4.</p> \\[ W^{-1}= \\frac{1}{n} \\begin{bmatrix}     \\omega_n^{-ij} \\end{bmatrix}_{0 \\le i, j &lt; n} \\] <p>Property 4</p> \\[ W= \\begin{bmatrix}     \\omega_n^{ij} \\end{bmatrix}_{0 \\le i, j &lt; n} \\] \\[ W^{-1}= \\frac{1}{n} \\begin{bmatrix}     \\omega_n^{-ij} \\end{bmatrix}_{0 \\le i, j &lt; n} \\] <p>Proof</p> <p>\\(W'=\\frac{1}{n}\\begin{bmatrix}\\omega_n^{-ij}\\end{bmatrix}_{0 \\le i, j &lt; n}\\)</p> <p>\\(\\displaystyle \\begin{bmatrix} W \\times W' \\end{bmatrix}_{i, j} = \\frac{1}{n} \\sum_{k=0}^{n-1} \\omega_n^{ik} \\omega_n^{-kj} = \\frac{1}{n} \\sum_{k=0}^{n-1} \\omega_n^{k(i-j)} = \\frac{1}{n} \\sum_{k=0}^{n-1} (\\omega_n^{(i-j)})^k\\)</p> <ol> <li> <p>\\(i \\ne j\\) \\(\\displaystyle \\frac{1}{n} \\sum_{k=0}^{n-1} (\\omega_n^{(i-j)})^k = \\frac{1}{n} \\frac{1 - \\omega_n^{n(i-j)}}{1 - \\omega_n^{(i-j)}}=0\\)</p> </li> <li> <p>\\(i = j\\) \\(\\displaystyle \\frac{1}{n} \\sum_{k=0}^{n-1} (\\omega_n^{(i-j)})^k = \\frac{1}{n} \\sum_{k=0}^{n-1} 1 = 1\\)</p> </li> </ol> <p>\\(\\therefore W \\times W' = I_n, W^{-1}=W'\\)</p> \\[ \\displaystyle a_j = \\frac{1}{n}\\sum_{i=0}^{n-1} y_i \\omega_n^{-ij} \\] <p>\ub530\ub77c\uc11c, \\(IDFT\\)\ub294 \\(DFT\\)\uc758 \\(\\omega_n\\)\uc744 \\(\\omega_n^{-1}\\)\ub85c \ubc14\uafd4\uc900 \ud6c4, \uacb0\uacfc\uac12\uc5d0 \\(\\frac{1}{n}\\)\uc744 \uacf1\ud574\uc8fc\uba74 \ub41c\ub2e4.</p>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FFT/algorithm/#fft-fast-fourier-transform_1","title":"FFT (Fast Fourier Transform)","text":"<p>\\(DFT\\)\ub97c \ube60\ub974\uac8c \uad6c\ud558\uae30 \uc704\ud574\uc11c Cooley-Tukey algorithm\uc744 \uc0ac\uc6a9\ud55c\ub2e4.</p> <p>\ubd84\ud560 \uc815\ubcf5\uc744 \ud558\uae30 \uc704\ud574, \\(n\\)\uc740 \\(2\\)\uc758 \uac70\ub4ed\uc81c\uacf1\uc758 \ud615\ud0dc\ub77c \uac00\uc815\ud55c\ub2e4. \ub9cc\uc57d \uadf8\ub807\uc9c0 \uc54a\uc740 \uacbd\uc6b0, \\(n\\)\uc774 \\(2\\)\uc758 \uac70\ub4ed\uc81c\uacf1\uc774 \ub420 \ub54c \uae4c\uc9c0 \\(0\\)\uc744 \ucc44\uc6cc\ub123\uc5b4\uc8fc\uba74 \ub41c\ub2e4.</p> \\[ A(x)=\\displaystyle \\sum_{i=0}^{n-1}a_ix^i=a_0+a_1x+a_2x^2+\\cdots+a_{n-1}x^{n-1} \\] <p>\uc704 \ub2e4\ud56d\uc2dd \\(A(x)\\)\uc5d0\uc11c \uc9dd\uc218 \ubc88\uc9f8 \uacc4\uc218\ub4e4\uc744 \ubaa8\uc544 \ub9cc\ub4e0 \ub2e4\ud56d\uc2dd\uc744 \\(A_0(x)\\), \ud640\uc218 \ubc88\uc9f8 \uacc4\uc218\ub4e4\uc744 \ubaa8\uc544 \ub9cc\ub4e0 \ub2e4\ud56d\uc2dd\uc744 \\(A_1(x)\\)\ub77c\uace0 \ud558\uc790.</p> \\[ \\begin{gather} A_0(x)=\\displaystyle \\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}x^i=a_0+a_2x+a_4x^2+\\cdots+a_{n-2}x^{\\frac{n}{2}-1} \\\\ A_1(x)=\\displaystyle \\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}x^i=a_1+a_3x+a_5x^2+\\cdots+a_{n-1}x^{\\frac{n}{2}-1} \\end{gather} \\] <p>Definition 3</p> <p>\ub2e4\ud56d\uc2dd \\(A(x)\\)\uc5d0\uc11c \uc9dd\uc218 \ubc88\uc9f8 \uacc4\uc218\ub4e4\uc744 \ubaa8\uc544 \ub9cc\ub4e0 \ub2e4\ud56d\uc2dd\uc744 \\(A_0(x)\\), \ud640\uc218 \ubc88\uc9f8 \uacc4\uc218\ub4e4\uc744 \ubaa8\uc544 \ub9cc\ub4e0 \ub2e4\ud56d\uc2dd\uc744 \\(A_1(x)\\)\ub77c\uace0 \ud55c\ub2e4.  </p> \\[ \\begin{gather} A_0(x)=\\displaystyle \\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}x^i=a_0+a_2x+a_4x^2+\\cdots+a_{n-2}x^{\\frac{n}{2}-1} \\\\ A_1(x)=\\displaystyle \\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}x^i=a_1+a_3x+a_5x^2+\\cdots+a_{n-1}x^{\\frac{n}{2}-1} \\end{gather} \\] \\[ \\begin{gather} DFT(A_0(x))=((y_0)_0, (y_0)_1, (y_0)_2, \\cdots, (y_0)_{\\frac{n}{2}-1}) \\\\ DFT(A_1(x))=((y_1)_0, (y_1)_1, (y_1)_2, \\cdots, (y_1)_{\\frac{n}{2}-1}) \\end{gather} \\] <p>\uc704 \uc2dd\ub4e4\uc5d0\uc11c \ub2e4\uc74c\uacfc \uac19\uc740 \uc0ac\uc2e4\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4.</p> \\[ A(x)=A_0(x^2)+xA_1(x^2) \\] <p>Property 5</p> \\[ A(x)=A_0(x^2)+xA_1(x^2) \\] <p>\uc774 \ub54c, \\(A(x)\\)\uc758 \\(DFT\\)\uc5d0\uc11c\ub294 \\(\\omega_n\\)\uc744 \uc0ac\uc6a9\ud558\uc9c0\ub9cc, \\(A_0(x)\\), \\(A_1(x)\\)\uc758 \\(DFT\\)\uc5d0\uc11c\ub294 \\(\\omega_{\\frac{n}{2}}\\)\ub97c \uc0ac\uc6a9\ud55c\ub2e4\ub294 \uc810\uc5d0 \uc8fc\uc758\ud558\uc790. \\(\\omega_n\\)\uacfc \\(\\omega_{\\frac{n}{2}}\\) \uc0ac\uc774\uc5d0\ub294 \ub2e4\uc74c \uad00\uacc4\uac00 \uc131\ub9bd\ud55c\ub2e4.</p> \\[ \\omega_n^2=\\omega_{\\frac{n}{2}}, \\omega_n^{\\frac{n}{2}}=-1 \\] <p>Property 6</p> \\[ \\omega_n^2=\\omega_{\\frac{n}{2}}, \\ \\omega_n^{\\frac{n}{2}}=-1 \\] <p>\uc774\uc81c, \\(DFT(A_0)\\), \\(DFT(A_1)\\)\ub97c \uc774\uc6a9\ud558\uc5ec \\(DFT(A)\\)\ub97c \uad6c\ud558\uc790.</p> <ol> <li>\uc55e\uc758 \\(\\frac{n}{2}\\)\uac1c\uc758 \\(y_k\\) \\(y_k=A(\\omega_n^k)=A_0(\\omega_n^{2k})+\\omega_n^kA_1(\\omega_n^{2k})=A_0(\\omega_{\\frac{n}{2}}^k)+\\omega_n^kA_1(\\omega_{\\frac{n}{2}}^k)=(y_0)_k+\\omega_n^k(y_1)_k\\)</li> <li>\ub4a4\uc758 \\(\\frac{n}{2}\\)\uac1c\uc758 \\(y_{k+\\frac{n}{2}}\\) \\(y_{k+\\frac{n}{2}}=A(\\omega_n^{k+\\frac{n}{2}})=A_0(\\omega_n^{2k+n})+\\omega_n^{k+\\frac{n}{2}}A_1(\\omega_n^{2k+n})=A_0(\\omega_{\\frac{n}{2}}^k)-\\omega_n^kA_1(\\omega_{\\frac{n}{2}}^k)\\) \\(=(y0)_k-\\omega_n^k(y1)_k\\)</li> </ol> <p>\ub530\ub77c\uc11c \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\ub9ac\ud560 \uc218 \uc788\ub2e4.</p> \\[ \\begin{gather} y_k=(y_0)_k+\\omega_n^k(y_1)_k \\\\ y_{k+\\frac{n}{2}}=(y_0)_k-\\omega_n^k(y_1)_k \\\\ (k=0, 1, \\cdots, \\frac{n}{2}-1) \\end{gather} \\] <p>Property 7</p> \\[ \\begin{gather} y_k=(y_0)_k+\\omega_n^k(y_1)_k \\\\ y_{k+\\frac{n}{2}}=(y_0)_k-\\omega_n^k(y_1)_k \\\\ (k=0, 1, \\cdots, \\frac{n}{2}-1) \\end{gather} \\] <p>\\(DFT(A_0)\\), \\(DFT(A_1)\\)\ub97c \uad6c\ud588\ub2e4\uba74, \\(O(N)\\)\uc758 \uc2dc\uac04\uc5d0 \\(DFT(A)\\)\ub97c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Algorithm 1</p> <p>\\(n\\)\uc774 \\(2\\)\uc758 \uac70\ub4ed\uc81c\uacf1\uc774 \uc544\ub2c8\ub77c\uba74, \\(0\\)\uc744 \ub4a4\uc5d0 \ucc44\uc6cc\ub123\uc5b4 \\(2\\)\uc758 \uac70\ub4ed\uc81c\uacf1\uc73c\ub85c \ub9cc\ub4e4\uc5b4\uc900\ub2e4. \\(DFT(A)\\)\uc5d0\uc11c \uc9dd\uc218 \ubc88\uc9f8 \uacc4\uc218\ub4e4\uacfc \ud640\uc218 \ubc88\uc9f8 \uacc4\uc218\ub4e4\uc744 \uac01\uac01 \ubd84\ub9ac\ud558\uc5ec \\(DFT(A_0)\\)\uacfc \\(DFT(A_1)\\)\uc744 \uc7ac\uadc0\uc801\uc73c\ub85c \uad6c\ud55c\ub2e4. Property 7\uc758 \uc2dd\uc744 \uc774\uc6a9\ud558\uc5ec \\(DFT(A_0)\\), \\(DFT(A_1)\\)\uc758 \uacb0\uacfc\ub97c \ud569\uccd0\uc900\ub2e4.</p> <p>\ub530\ub77c\uc11c \uc704 \ubd84\ud560\uc815\ubcf5 \uc54c\uace0\ub9ac\uc998\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(T(N)=2T(\\frac{N}{2})+O(N)\\)\uc73c\ub85c, \\(O(N\\log N)\\)\uc774\ub2e4.</p> <p>Time Complexity</p> <p>Time Complexity : \\(O(N\\log N)\\)</p>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FFT/algorithm/#in-place-computation","title":"In-Place Computation","text":"<p>\ub9cc\uc57d, \ucc98\uc74c\ubd80\ud130 \ubc30\uc5f4\uc744 \ubcf4\uc558\uc744 \ub54c \uc9dd\uc218 \ubc88\uc9f8 \uacc4\uc218\ub4e4\uc740 \uc67c\ucabd\uc5d0, \ud640\uc218 \ubc88\uc9f8 \uacc4\uc218\ub4e4\uc740 \uc624\ub978\ucabd\uc5d0 \ucabc\uac1c\uc5b4\uc838 \uc788\ub2e4\uba74 \uc7ac\uadc0 \uacfc\uc815\uc5d0\uc11c \uac12\ub4e4\uc744 \ucd94\uac00 \ubc30\uc5f4\uc744 \ub9cc\ub4e4\uc5b4\uc11c \uc791\uc5c5\ud560 \ud544\uc694\uac00 \uc5c6\uac70\ub098 \ub354 \ub098\uc544\uac00 \uc7ac\uadc0 \uc790\uccb4\ub97c \ud558\uc9c0 \uc54a\uc544\ub3c4 \ub420 \uc218 \uc788\ub2e4.</p> <p>\uc7ac\uadc0\uc758 \uccab \ub2e8\uacc4\uc5d0\uc11c, \\(0\\)\ubc88\uc9f8 \ube44\ud2b8\uac00 \\(0\\)\uc778 \uc218\ub4e4\uc740 \uc67c\ucabd\uc73c\ub85c, \\(1\\)\uc778 \uc218\ub4e4\uc740 \uc624\ub978\ucabd\uc73c\ub85c \ubc30\uce58\ub41c\ub2e4. \uc774\ub7ec\ud55c \uacfc\uc815\uc774 \ubc18\ubcf5\ub418\uba74, \uacb0\uad6d \uc7ac\ubc30\uc5f4\uc740 \uac01 \uc218\ub4e4\uc758 \ube44\ud2b8\ub97c \ub4a4\uc9d1\uc5c8\uc744 \ub54c \uc99d\uac00\ud558\ub294 \uc21c\uc11c\ub300\ub85c \ubc30\uce58\ub428\uc744 \uc54c \uc218 \uc788\ub2e4. \uc774\ub7ec\ud55c \uc21c\uc5f4\uc744 bit-reversal permutation\uc774\ub77c \ud55c\ub2e4. \uad6c\ud604\uc740 \ub2e8\uc21c\ud788 \\(x\\)\uc758 \ube44\ud2b8\ub97c \ub4a4\uc9d1\uc740 \uc218\uac00 \\(y\\)\uc77c \ub54c \\(x&lt;y\\)\uc774\uba74 \\(a_x\\)\uc640 \\(a_y\\)\ub97c swap\ud574\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\ub2e4\uc74c\uc740 \\(n=8\\)\uc77c \ub54c\uc758 \uc608\uc2dc\uc774\ub2e4.</p> \\[ (((a_0, a_4), (a_2, a_6)), ((a_1, a_5), (a_3, a_7))) \\] <p>\uc704 \uc544\uc774\ub514\uc5b4\ub97c \ud1b5\ud574 \uc7ac\uadc0 \uc5c6\uc774, \ubc18\ubcf5\ub9cc\uc73c\ub85c\ub3c4 Property 7\uc744 \uc774\uc6a9\ud558\uc5ec \ud55c \ubc30\uc5f4 \ub0b4\uc5d0\uc11c \uacc4\uc0b0\uc744 \ud560 \uc218 \uc788\ub2e4. Property 7\uc5d0\uc11c \\(y_k\\)\uc640 \\(y_{k+\\frac{n}{2}}\\)\ub97c \uacc4\uc0b0\ud558\uae30 \uc704\ud558\uc5ec \ud544\uc694\ud55c \uac12\uc774, \ud604\uc7ac \uc791\uc5c5\ud558\ub294 \ubc30\uc5f4\uc5d0 \ud574\ub2f9\ud558\ub294 \uce78 \\(k\\), \\(k+\\frac{n}{2}\\)\uc5d0 \ub4e4\uc5b4 \uc788\ub294 \\((y_0)_k\\)\uc640 \\((y_1)_k\\)\uc774\ub2c8, \\(k\\)\ub97c \uc99d\uac00\uc2dc\ucf1c \ub098\uac00\uba70 \ubc30\uc5f4\uc744 \uac31\uc2e0\uc2dc\ud0a4\uba74 \ub41c\ub2e4.</p> <p>Algorithm 2</p> <p>\\(n\\)\uc774 \\(2\\)\uc758 \uac70\ub4ed\uc81c\uacf1\uc774 \uc544\ub2c8\ub77c\uba74, \\(0\\)\uc744 \ub4a4\uc5d0 \ucc44\uc6cc\ub123\uc5b4 \\(2\\)\uc758 \uac70\ub4ed\uc81c\uacf1\uc73c\ub85c \ub9cc\ub4e4\uc5b4\uc900\ub2e4. \\(x\\)\uc758 \ube44\ud2b8\ub97c \ub4a4\uc9d1\uc740 \uc218\uac00 \\(y\\)\uc77c \ub54c \\(x&lt;y\\)\uc774\uba74 \\(a_x\\)\uc640 \\(a_y\\)\ub97c swap\ud574\uc8fc\uc5b4 \uacc4\uc218 \ubc30\uc5f4\uc758 bit-reversal permutation\uc744 \uc5bb\ub294\ub2e4. \uad6c\uac04\uc758 \uae38\uc774\ub97c \\(2^0, 2^1, \\cdots\\)\ub85c \ub298\ub824 \uac00\uba70 \uc778\uc811\ud55c \ub450 \uad6c\uac04\uc744 \ud558\ub098\ub85c \ud569\uccd0\uc900\ub2e4. \uc774 \ub54c Property 7\uc5d0\uc11c \\(y_k\\)\uc640 \\(y_{k+\\frac{n}{2}}\\)\ub97c \uacc4\uc0b0\ud558\uae30 \uc704\ud558\uc5ec \ud544\uc694\ud55c \uac12\uc774, \ud604\uc7ac \uc791\uc5c5\ud558\ub294 \ubc30\uc5f4\uc5d0 \ud574\ub2f9\ud558\ub294 \uce78 \\(k\\), \\(k+\\frac{n}{2}\\)\uc5d0 \ub4e4\uc5b4 \uc788\ub294 \\((y_0)_k\\)\uc640 \\((y_1)_k\\)\uc784\uc744 \uc774\uc6a9\ud558\uc5ec, \\(k\\)\ub97c \uc99d\uac00\uc2dc\ucf1c \ub098\uac00\uba70 \ubc30\uc5f4\uc744 \uac31\uc2e0\uc2dc\ud0a8\ub2e4.</p>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FFT/algorithm/#implementation","title":"Implementation","text":"<pre><code>typedef complex&lt;double&gt; cd;\nconst double PI = acos(-1);\n\nvoid fft(vector&lt;cd&gt; &amp;A, bool inv)\n{\n    int N=A.size(), B=31-__builtin_clz(N);\n    for(int i=0; i&lt;N; i++)\n    {\n        int rev=0;\n        for(int j=0; j&lt;B; j++) rev&lt;&lt;=1, rev|=(i&gt;&gt;j)&amp;1;\n        if(rev&gt;i) swap(A[rev], A[i]);\n    }\n\n    for(int i=1; i&lt;N; i&lt;&lt;=1)\n    {\n        cd w(cos(PI/i), (inv ? -1 : 1)*sin(PI/i));\n        for(int j=0; j&lt;N; j+=i+i)\n        {\n            cd s(1, 0);\n            for(int k=0; k&lt;i; k++)\n            {\n                cd a=A[j+k], b=A[j+i+k]*s;\n                A[j+k]=a+b; A[j+i+k]=a-b;\n                s*=w;\n            }\n        }\n    }\n    if(inv) for(int i=0; i&lt;N; i++) A[i]/=N;\n}\n</code></pre>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FFT/algorithm/#ntt-number-theoretic-transform","title":"NTT (Number Theoretic Transform)","text":"<p>FFT\uc5d0\uc11c \ub2e4\ud56d\uc2dd\uc5d0 \ub300\uc785\ud560 \\(x_0, x_1, \\cdots, x_{n-1}\\)\uc73c\ub85c \\(\\omega_n^0, \\omega_n^1, \\cdots, \\omega_n^{n-1}\\)\uc744 \uc120\uc815\ud55c \uc774\uc720\ub294 \uc704\uc5d0\uc11c \uc0ac\uc6a9\ud55c \ub2e4\uc591\ud55c \uc131\uc9c8\ub4e4\uc744 \ub9cc\uc871\uc2dc\ud0a4\uae30 \uc704\ud568\uc774\uc5c8\ub2e4. \uadf8 \uc911\uc5d0\uc11c\ub3c4, \ud2b9\ud788 \ub2e4\ub978 \uc131\uc9c8\ub4e4\ub85c \ud45c\ud604\ud560 \uc218 \uc5c6\uc5c8\ub358, \ud544\uc218\uc801\uc778 \uc131\uc9c8\ub4e4\uc740 Property 1\uacfc Property 2\uc774\ub2e4.</p> <p>\uc774\uc81c, \uc218\uc758 \ubc94\uc704\ub97c \ubcf5\uc18c\uc218 \\(\\mathbb{C}\\)\uc5d0\uc11c \uc815\uc218 \ub098\uba38\uc9c0 \\(\\mathbb{Z}_p\\)\ub85c \ubc14\uafd4\ubcf4\uc790. \ub9c8\ucc2c\uac00\uc9c0\ub85c, \\(\\mathbb{Z}_p\\)\uc5d0\uc11c\ub3c4 Property 1\uacfc Property 2\ub97c \ub9cc\uc871\ud558\ub294 \uc5b4\ub5a0\ud55c \\(\\omega_n\\)\uc744 \ucc3e\uc744 \uc218 \uc788\ub2e4\uba74, FFT\ub97c \uadf8\ub300\ub85c \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4.</p> <p>\\(p\\)\uac00 \uc18c\uc218\uc77c \ub54c, \\(n\\)-th primitive root of unity modulo \\(p\\) \\(\\omega_n\\)\uc774 \uc874\uc7ac\ud560 \ud544\uc694\ucda9\ubd84\uc870\uac74\uc740 \\(n \\ | \\ p-1\\)\uc774\ub2e4.</p> <p>Property 8</p> <p>\\(p\\)\uac00 \uc18c\uc218\uc77c \ub54c, \"\\(n\\)-th primitive root of unity modulo \\(p\\)\" \\(\\omega_n\\)\uc774 \uc874\uc7ac\ud560 \ud544\uc694\ucda9\ubd84\uc870\uac74\uc740 \\(n \\ | \\ p-1\\)\uc774\ub2e4.</p> <p>\ubaa8\ub4e0 \uc18c\uc218\ub294 root of unity modulo \\(p\\) \uc6d0\uc2dc\uadfc \\(\\omega=\\omega_{p-1}\\)\uac00 \uc874\uc7ac\ud55c\ub2e4. \uc6d0\uc2dc\uadfc\uc744 \uc27d\uac8c \uad6c\ud558\ub294 \ubc29\ubc95\uc740 \uc544\uc9c1 \uc54c\ub824\uc9c0\uc9c0 \uc54a\uc558\ub2e4. \uc6d0\uc2dc\uadfc \\(\\omega\\)\ub97c \uc54c\uace0 \uc788\uc744 \ub54c, \\(n \\ | \\ p-1\\)\uc778 \\(n\\)\uc5d0 \ub300\ud558\uc5ec \\(\\omega_n=\\omega^{\\frac{p-1}{n}}\\)\uc73c\ub85c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> \\[ \\omega_n=\\omega^{\\frac{p-1}{n}} \\] \\[ \\omega_n^n=(\\omega^{\\frac{p-1}{n}})^n=\\omega^{p-1}\\equiv 1 \\] <p>Property 9</p> <p>\\(p\\)\uac00 \uc18c\uc218\uc77c \ub54c, root of unity modulo \\(p\\) \uc6d0\uc2dc\uadfc \\(\\omega=\\omega_{p-1}\\)\uac00 \uc874\uc7ac\ud55c\ub2e4. \uc6d0\uc2dc\uadfc \\(\\omega\\)\ub97c \uc54c\uace0 \uc788\uc744 \ub54c, \\(n \\ | \\ p-1\\)\uc778 \\(n\\)\uc5d0 \ub300\ud558\uc5ec \\(\\omega_n=\\omega^{\\frac{p-1}{n}}\\)\uc73c\ub85c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\uc6d0\uc2dc\uadfc\uc744 \ubaa8\ub97c \ub54c, \uc5b4\ub5a4 \uc218\uac00 \uc6d0\uc2dc\uadfc\uc778\uc9c0 \ud655\uc778\ud558\uae30 \uc704\ud574\uc11c\ub294 \\(a^{p-1} \\equiv 1\\), \\(d \\ | \\ p-1, d \\ne p-1\\)\uc778 \ubaa8\ub4e0 \uc57d\uc218 \\(d\\)\uc5d0 \ub300\ud574\uc11c\ub294 \\(a^d \\not\\equiv 1\\)\uc778\uc9c0 \ud655\uc778\ud574\uc8fc\uba74 \ub41c\ub2e4. \ub300\ubd80\ubd84\uc758 \uacbd\uc6b0 \\(3\\) \ub610\ub294 \\(5\\)\uac00 \uc6d0\uc2dc\uadfc\uc774\ub2e4.</p> <p>\ud2b9\ud788, \\(p=a \\cdot 2^k + 1\\) \uaf34\uc77c \ub54c, \\(n=2^m\\) (\\(m \\le k\\))\uc774\uba74 \\(n \\ | \\ p-1\\)\uc774\ub2c8 NTT\ub97c \uc801\uc6a9\ud558\uae30\uac00 \uc544\uc8fc \uc88b\ub2e4.</p> <p>\ub2e4\uc74c\uc740 \uba87 \uac00\uc9c0 \uc18c\uc218\ub4e4\uacfc \uc6d0\uc2dc\uadfc\uc758 \uc608\uc2dc\uc774\ub2e4.</p> \\[ p=a \\times 2^b + 1 \\] \\(p\\) \\(a\\) \\(b\\) \\(\\omega\\) 998,244,353 119 23 3 2,281,701,377 17 27 3 2,483,027,969 37 26 3 2,113,929,217 63 25 5 104,857,601 25 22 3 1,092,616,193 521 21 3","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FFT/algorithm/#implementation_1","title":"Implementation","text":"<pre><code>const ll MOD = 998244353;\nconst ll _W = 3;\n\nll mypow(ll x, ll y)\n{\n    ll ret=1;\n    for(; y&gt;0; y&gt;&gt;=1, x=x*x%MOD)\n    {\n        if(y&amp;1) ret=ret*x%MOD;\n    }\n    return ret;\n}\n\nll myinv(ll x) { return mypow(x, MOD-2); }\n\nvoid fft(vector&lt;ll&gt; &amp;A, bool inv)\n{\n    int N=A.size(), B=31-__builtin_clz(N);\n    for(int i=0; i&lt;N; i++)\n    {\n        int rev=0;\n        for(int j=0; j&lt;B; j++) rev&lt;&lt;=1, rev|=(i&gt;&gt;j)&amp;1;\n        if(rev&gt;i) swap(A[rev], A[i]);\n    }\n\n    for(int i=1; i&lt;N; i&lt;&lt;=1)\n    {\n        ll w=mypow(_W, (MOD-1)/(i+i));\n        if(inv) w=myinv(w);\n        for(int j=0; j&lt;N; j+=i+i)\n        {\n            ll s=1;\n            for(int k=0; k&lt;i; k++)\n            {\n                ll a=A[j+k], b=A[j+i+k]*s%MOD;\n                A[j+k]=(a+b)%MOD; A[j+i+k]=(a-b+MOD)%MOD;\n                s=s*w%MOD;\n            }\n        }\n    }\n    ll t=myinv(N);\n    if(inv) for(int i=0; i&lt;N; i++) A[i]=A[i]*t%MOD;\n}\n</code></pre>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FFT/algorithm/#reference","title":"Reference","text":"<ul> <li>https://cp-algorithms.com/algebra/fft.html</li> <li>https://algoshitpo.github.io/2020/05/20/fft-ntt/</li> <li>https://codeforces.com/blog/entry/111371</li> <li>https://codeforces.com/blog/entry/43499</li> </ul>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FWHT/algorithm/","title":"FWHT (Fast Walsh Hadamard Transform)","text":"<p>FFT\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \ud615\ud0dc\uc758 convolution\uc744 \\(O(N\\log N)\\)\uc5d0 \uacc4\uc0b0\ud560 \uc218 \uc788\uac8c \ud574\uc900\ub2e4.</p> \\[ c_i = \\sum_{j+k=i} a_j \\cdot b_k \\] <p>FWHT\ub294 \uc774\ub97c \ub354 \ud655\uc7a5\ud558\uc5ec, convolution\uc758 \ud615\ud0dc\uac00 \ub367\uc148\uc774 \uc544\ub2cc, bitwise xor, bitwise and, bitwise or \ub4f1\uc758 \ub2e4\uc591\ud55c \uc5f0\uc0b0\ub4e4 \\(\\star\\) \uc5d0 \ub300\ud558\uc5ec \uac00\ub2a5\ud558\uac8c \ud558\ub294 \uc54c\uace0\ub9ac\uc998\uc774\ub2e4.</p> \\[ c_i = \\sum_{j \\star k=i} a_j \\cdot b_k \\]","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FWHT/algorithm/#extension-of-fft","title":"Extension of FFT","text":"","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FWHT/algorithm/#dft-as-matrix-multiplication","title":"DFT as Matrix Multiplication","text":"<p>\uc6b0\uc120, DFT\ub97c \ub2e4\ud56d\uc2dd\uc5d0 \ub300\uc785\ud560 \uac12\ub4e4 \\(x_0, x_1, \\cdots, x_{n-1}\\)\ub85c, \\(\\omega_n^0, \\omega_n^1, \\cdots, \\omega_n^{n-1}\\)\ub97c \uc120\ud0dd\ud588\uc744 \ub54c\uc758 \ud568\uc22b\uac12\uc744 \uad6c\ud558\ub294 \uacfc\uc815\uc73c\ub85c \uc0dd\uac01\ud558\uc9c0 \ub9d0\uace0, \ud589\ub82c\uacf1\uc758 \uac1c\ub150\uc73c\ub85c \uc0dd\uac01\ud558\uc790.</p> \\[ DFT(a_0, a_1, \\cdots, a_{n-1})=(A(\\omega_n^0), A(\\omega_n^1), \\cdots, A(\\omega_n^{n-1}))=(y_0, y_1, \\cdots, y_{n-1}) \\] \\[ = \\begin{bmatrix}     \\omega_n^{0 \\cdot 0} &amp; \\omega_n^{0 \\cdot 1} &amp; \\omega_n^{0 \\cdot 2} &amp; \\dots &amp; \\omega_n^{0 \\cdot (n-1)} \\\\     \\omega_n^{1 \\cdot 0} &amp; \\omega_n^{1 \\cdot 1} &amp; \\omega_n^{1 \\cdot 2} &amp; \\dots &amp; \\omega_n^{1 \\cdot (n-1)} \\\\     \\omega_n^{2 \\cdot 0} &amp; \\omega_n^{2 \\cdot 1} &amp; \\omega_n^{2 \\cdot 2} &amp; \\dots &amp; \\omega_n^{2 \\cdot (n-1)} \\\\     \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\     \\omega_n^{(n-1) \\cdot 0} &amp; \\omega_n^{(n-1) \\cdot 1} &amp; \\omega_n^{(n-1) \\cdot 2} &amp; \\dots &amp; \\omega_n^{(n-1) \\cdot (n-1)}  \\end{bmatrix} \\begin{bmatrix}     a_0 \\\\         a_1 \\\\     a_2 \\\\     \\vdots \\\\     a_{n-1} \\end{bmatrix} = \\begin{bmatrix}     y_0 \\\\         y_1 \\\\     y_2 \\\\     \\vdots \\\\     y_{n-1} \\end{bmatrix} \\] \\[ W= \\begin{bmatrix}     \\omega_n^{ij} \\end{bmatrix}_{0 \\le i, j &lt; n} \\] <p>\uc774 \ub54c, DFT matrix \\(W\\)\ub294 \ub2e4\uc74c \uc870\uac74\uc744 \ub9cc\uc871\ud55c\ub2e4.</p> \\[ c_i = \\sum_{j+k=i} a_j \\cdot b_k \\] \\[ W \\begin{bmatrix}     a_0 \\\\         a_1 \\\\     a_2 \\\\     \\vdots \\\\     a_{n-1} \\end{bmatrix} \\cdot W \\begin{bmatrix}     b_0 \\\\         b_1 \\\\     b_2 \\\\     \\vdots \\\\     b_{n-1} \\end{bmatrix} = W \\begin{bmatrix}     c_0 \\\\         c_1 \\\\     c_2 \\\\     \\vdots \\\\     c_{n-1} \\end{bmatrix} \\] <p>\uc784\uc758\uc758 \uc5f0\uc0b0 \\(\\star\\)\uc5d0 \ub300\ud574\uc11c\ub3c4 \uc704\uc640 \uac19\uc740 \uc131\uc9c8\uc744 \ub9cc\uc871\ud558\ub294 \ud589\ub82c(invertible matrix) \\(T\\)\ub97c \ucc3e\uc744 \uc218 \uc788\ub2e4\uba74, \ub2e4\ud56d\uc2dd\uc5d0 \\(\\omega_n^0, \\omega_n^1, \\cdots, \\omega_n^{n-1}\\)\ub97c \ub300\uc785\ud55c \ud568\uc22b\uac12\ub4e4\uc744 \uc758\ubbf8\ud558\ub294 DFT matrix \\(W\\)\ub294 \uc544\ub2c8\uc9c0\ub9cc, DFT\uc640 \uac19\uc740 \ub17c\ub9ac\ub97c \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4.</p> \\[ c_i = \\sum_{j \\star k=i} a_j \\cdot b_k \\] \\[ T \\begin{bmatrix}     a_0 \\\\         a_1 \\\\     a_2 \\\\     \\vdots \\\\     a_{n-1} \\end{bmatrix} \\cdot T \\begin{bmatrix}     b_0 \\\\         b_1 \\\\     b_2 \\\\     \\vdots \\\\     b_{n-1} \\end{bmatrix} = T \\begin{bmatrix}     c_0 \\\\         c_1 \\\\     c_2 \\\\     \\vdots \\\\     c_{n-1} \\end{bmatrix} \\] <p>Property 1</p> \\[ c_i = \\sum_{j \\star k=i} a_j \\cdot b_k \\] \\[ T \\begin{bmatrix}     a_0 \\\\         a_1 \\\\     a_2 \\\\     \\vdots \\\\     a_{n-1} \\end{bmatrix} \\cdot T \\begin{bmatrix}     b_0 \\\\         b_1 \\\\     b_2 \\\\     \\vdots \\\\     b_{n-1} \\end{bmatrix} = T \\begin{bmatrix}     c_0 \\\\         c_1 \\\\     c_2 \\\\     \\vdots \\\\     c_{n-1} \\end{bmatrix} \\] <p>\uc784\uc758\uc758 \uc5f0\uc0b0 \\(\\star\\)\uc5d0 \ub300\ud558\uc5ec \uc704 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ud589\ub82c(invertible matrix) \\(T\\)\ub97c \ucc3e\uc744 \uc218 \uc788\ub2e4\uba74, DFT\uc640 \uac19\uc740 \ub17c\ub9ac\ub97c \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4.</p>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FWHT/algorithm/#multidimensional-dft","title":"MultiDimensional DFT","text":"<p>DFT\ub294 \ub2e4\ud56d\uc2dd \\(A(x)\\)\uc5d0 \ud2b9\uc815 \uac12\ub4e4\uc744 \ub300\uc785\ud558\uc5ec \uadf8 \ud568\uc22b\uac12\ub4e4\ub85c \ubcc0\ud658\ud55c\ub2e4. \uc77c\ubcc0\uc218 \ub2e4\ud56d\uc2dd \\(A(x)\\)\uac00 \uc544\ub2cc, \uc774\ubcc0\uc218 \ub2e4\ud56d\uc2dd \\(A(x, y)\\), \ud639\uc740 \ubcc0\uc218\uac00 \\(n\\)\uac1c \uc788\ub294 \ub2e4\ud56d\uc2dd \\(A(x_0, x_1, \\cdots, x_{n-1})\\)\uc5d0 \ub300\ud574\uc11c\ub3c4 \ubcc0\uc218\uc5d0 \ud2b9\uc815 \uac12\ub4e4\uc744 \ub300\uc785\ud558\uc5ec \uadf8 \ud568\uc22b\uac12\ub4e4\ub85c \ubcc0\ud658\ud560 \uc218 \uc788\ub2e4.</p> <p>\uad6c\uccb4\uc801\uc73c\ub85c MultiDimensional DFT\ub97c \uc815\uc758\ud558\uae30 \uc704\ud558\uc5ec \ub2e4\uc74c\uc744 \uc815\uc758\ud558\uc790.</p> <p>Definition 1</p> <p>\\(A\\)\uac00 \\(m \\times n\\) \ud589\ub82c, \\(B\\)\uac00 \\(p \\times q\\) \ud589\ub82c\uc77c \ub54c \\(A\\)\uc640 \\(B\\)\uc758 kronecker product \\(A \\otimes B\\)\ub97c \ub2e4\uc74c\uacfc \uac19\uc740 \ud06c\uae30 \\(mp \\times nq\\)\uc758 block matrix\ub85c \uc815\uc758\ud55c\ub2e4.</p> \\[ A \\bigotimes B =  \\begin{bmatrix}     a_{11}B &amp; a_{12}B &amp; a_{13}B &amp; \\dots &amp; a_{1n}B \\\\     a_{21}B &amp; a_{22}B &amp; a_{23}B &amp; \\dots &amp; a_{2n}B \\\\     a_{31}B &amp; a_{32}B &amp; a_{33}B &amp; \\dots &amp; a_{3n}B \\\\     \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\     a_{m1}B &amp; a_{m2}B &amp; a_{m3}B &amp; \\dots &amp; a_{mn}B \\\\ \\end{bmatrix} \\] <p>Kronecker product \uc5d0\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \uc131\uc9c8\ub4e4\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> <p>Property 2</p> \\[(A \\otimes B) \\otimes C = A \\otimes (B \\otimes C)\\] \\[(A \\otimes B)(C \\otimes D) = (AC \\otimes BD)\\] \\[(A \\otimes B)^{-1} = (A^{-1} \\otimes B^{-1})\\] <p>Definition 2</p> <p>\ub2e4\ud56d\uc2dd \\(A(x_0, x_1, \\cdots, x_{n-1})\\)\uc774 \ub2e4\uc74c\uacfc \uac19\ub294 \uacc4\uc218\ub4e4\uc744 \uac16\ub294\ub2e4.</p> \\[ A(x_0, x_1, \\cdots, x_{n-1}) =  \\sum_{i_0=0}^{m_0} \\sum_{i_1=0}^{m_1} \\sum_{i_2=0}^{m_2} \\cdots \\sum_{i_{n-1}=0}^{m_{n-1}} a_{i_0, i_1, i_2, \\cdots, i_{n-1}} x_0^{i_0} x_1^{i_1} x_2^{i_2} \\cdots x_{n-1}^{i_{n-1}} \\] <p>\uc774 \ub54c, \ub2e4\ud56d\uc2dd\uc758 vector form\uc744 \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\uc758\ud55c\ub2e4.</p> <p>\\(\\overrightarrow{a}_{0, 1, 2, \\cdots, n-1}=\\) \ub2e4\ud56d\uc2dd\ub4e4\uc758 \uacc4\uc218 \\(a_{i_0, i_1, i_2, \\cdots, i_{n-1}}\\)\ub97c \\((i_0, i_1, i_2, \\cdots, i_{n-1})\\)\uc5d0 \ub300\ud55c \uc0ac\uc804\uc21c\uc73c\ub85c \uc77c\ub82c\ub85c \ubc30\uc5f4\ud55c \ubca1\ud130.</p> \\[ \\overrightarrow{a}_{0, 1, 2, \\cdots, n-1} =  \\begin{bmatrix}     a_{0, 0, 0, \\cdots, 0} \\\\     a_{0, 0, 0, \\cdots, 1} \\\\     a_{0, 0, 0, \\cdots, 2} \\\\     \\vdots \\\\      a_{m_0-1, m_1-1, m_2-1, \\cdots, m_{n-1}-1} \\end{bmatrix} \\] <p>\ub2e4\ud56d\uc2dd\uc758 vector form\uc740 \ub2e4\uc74c\uacfc \uac19\uc774 \uc7ac\uadc0\uc801\uc73c\ub85c \ud574\uc11d\ud560 \uc218 \uc788\ub2e4.</p> \\[ \\overrightarrow{a}_{0, 1, 2, \\cdots, n-1} =  \\begin{bmatrix}     a_{0, 0, 0, \\cdots, 0} \\\\     a_{0, 0, 0, \\cdots, 1} \\\\     a_{0, 0, 0, \\cdots, 2} \\\\     \\vdots \\\\      a_{m_0-1, m_1-1, m_2-1, \\cdots, m_{n-1}-1} \\end{bmatrix} \\] \\[ = \\begin{bmatrix}     \\begin{bmatrix}         a_{0, 0, 0, \\cdots, 0} \\\\         a_{0, 0, 0, \\cdots, 1} \\\\         \\vdots \\\\          a_{0, m_1-1, m_2-1, \\cdots, m_{n-1}-1}     \\end{bmatrix} \\\\     \\begin{bmatrix}         a_{1, 0, 0, \\cdots, 0} \\\\         a_{1, 0, 0, \\cdots, 1} \\\\         \\vdots \\\\          a_{1, m_1-1, m_2-1, \\cdots, m_{n-1}-1}     \\end{bmatrix} \\\\     \\vdots \\\\     \\begin{bmatrix}         a_{m_0-1, 0, 0, \\cdots, 0} \\\\         a_{m_0-1, 0, 0, \\cdots, 1} \\\\         \\vdots \\\\          a_{m_0-1, m_1-1, m_2-1, \\cdots, m_{n-1}-1}     \\end{bmatrix} \\\\ \\end{bmatrix} = \\begin{bmatrix}     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_0 \\\\     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_1 \\\\     \\vdots \\\\     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_{m_0-1} \\end{bmatrix} \\] <p>Property 3</p> \\[ \\overrightarrow{a}_{0, 1, 2, \\cdots, n-1} = \\begin{bmatrix}     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_0 \\\\     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_1 \\\\     \\vdots \\\\     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_{m_0-1} \\end{bmatrix} \\] <p>\uc774\uc81c 1\ucc28\uc6d0 DFT\ub97c \ubc18\ubcf5\uc801\uc73c\ub85c \uc801\uc6a9\ud558\uc5ec \ub2e4\ucc28\uc6d0\uc73c\ub85c \ud655\uc7a5\ud558\uc790. \\(T_0, T_1, \\cdots, T_{n-1}\\)\uc744 \ubcc0\uc218 \\(x_0, x_1, \\cdots x_{n-1}\\)\uc5d0 \ub300\ud558\uc5ec Property 1\uc744 \ub9cc\uc871\ud558\ub294 \ud589\ub82c\uc774\ub77c \ud558\uc790. \uc804\uccb4 \ub2e4\ud56d\uc2dd\uc5d0 \ub300\ud55c \ubcc0\ud658 \ud589\ub82c \\(T\\)\ub97c \ub2e4\uc74c\uacfc \uac19\uc774 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> \\[ T=T_0 \\otimes T_1 \\otimes T_2 \\cdots \\otimes T_{n-1} \\] <p>\ud3b8\uc758\ub97c \uc704\ud574 \ub2e4\uc74c\uc744 \uc815\uc758\ud558\uc790.</p> \\[T'=T_1 \\otimes T_2 \\cdots \\otimes T_{n-1}\\] \\[(\\overrightarrow{y}_{1, 2, \\cdots, n-1})_k = (T_1 \\otimes T_2 \\cdots \\otimes T_{n-1}) (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_k = T'(\\overrightarrow{a}_{1, 2, \\cdots, n-1})_k\\] <p>Definition 3</p> \\[T'=T_1 \\otimes T_2 \\cdots \\otimes T_{n-1}\\] \\[(\\overrightarrow{y}_{1, 2, \\cdots, n-1})_k = (T_1 \\otimes T_2 \\cdots \\otimes T_{n-1}) (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_k = T'(\\overrightarrow{a}_{1, 2, \\cdots, n-1})_k\\] \\[ (T_0 \\otimes T_1 \\otimes T_2 \\cdots \\otimes T_{n-1}) \\ \\overrightarrow{a}_{0, 1, 2, \\cdots, n-1} = (T_0 \\otimes T') \\begin{bmatrix}     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_0 \\\\     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_1 \\\\     \\vdots \\\\     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_{m_0-1} \\end{bmatrix} \\] \\[ =\\begin{bmatrix}     (T_0)_{0,0} T' &amp; (T_0)_{0,1} T' &amp; \\dots &amp; (T_0)_{0, m_0-1} T' \\\\     (T_0)_{1,0} T' &amp; (T_0)_{1,1} T' &amp; \\dots &amp; (T_0)_{1, m_0-1} T' \\\\     \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\     (T_0)_{m_0-1,0} T' &amp; (T_0)_{m_0-1,1} T' &amp; \\dots &amp; (T_0)_{m_0-1, m_0-1} T' \\\\ \\end{bmatrix} \\begin{bmatrix}     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_0 \\\\     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_1 \\\\     \\vdots \\\\     (\\overrightarrow{a}_{1, 2, \\cdots, n-1})_{m_0-1} \\end{bmatrix} \\] \\[ =\\begin{bmatrix}     (T_0)_{0,0}(\\overrightarrow{y}_{1, 2, \\cdots, n-1})_0 + (T_0)_{0,1}(\\overrightarrow{y}_{1, 2, \\cdots, n-1})_1 + \\cdots + (T_0)_{0,m_0-1}(\\overrightarrow{y}_{1, 2, \\cdots, n-1})_{m_0-1}\\\\     (T_0)_{1,0}(\\overrightarrow{y}_{1, 2, \\cdots, n-1})_0 + (T_0)_{1,1}(\\overrightarrow{y}_{1, 2, \\cdots, n-1})_1 + \\cdots + (T_0)_{1,m_0-1}(\\overrightarrow{y}_{1, 2, \\cdots, n-1})_{m_0-1}\\\\     \\vdots \\\\     (T_0)_{m_0-1,0}(\\overrightarrow{y}_{1, 2, \\cdots, n-1})_0 + (T_0)_{m_0-1,1}(\\overrightarrow{y}_{1, 2, \\cdots, n-1})_1 + \\cdots + (T_0)_{m_0-1,m_0-1}(\\overrightarrow{y}_{1, 2, \\cdots, n-1})_{m_0-1}\\\\ \\end{bmatrix} \\] \\[ = T_0 \\  \\begin{bmatrix}     (\\overrightarrow{y}_{1, 2, \\cdots, n-1})_0 \\\\     (\\overrightarrow{y}_{1, 2, \\cdots, n-1})_1 \\\\     \\vdots \\\\     (\\overrightarrow{y}_{1, 2, \\cdots, n-1})_{m_0-1} \\end{bmatrix} =\\overrightarrow{y}_{0, 1, 2, \\cdots, n-1} \\] <p>\uc774 \ub54c, \ub9c8\uc9c0\ub9c9 \uc2dd\uc5d0\uc11c \\(T_0\\) \ud589\ub82c\uacfc \\(\\overrightarrow{a}_{0, 1, 2, \\cdots, n-1}\\) \ubca1\ud130\ub97c \\(m_0\\)\uac1c\ub85c \ubb36\uc740 \ubca1\ud130\ub97c \ud589\ub82c \uacf1\uc148 \uc5f0\uc0b0\uc73c\ub85c \uacf1\ud588\ub2e4\ub294 \uac83\uc5d0 \uc8fc\uc758\ud558\uc790.</p> <p>\uc704 \ubcf5\uc7a1\ud55c \uc2dd\ub4e4\uc758 \uc758\ubbf8\ub294 \uacb0\uad6d, \ubcc0\uc218 \\(x_0\\)\ub97c \ubb34\uc2dc\ud55c \ud6c4, \\(x_0\\)\uc758 \ucc28\uc218\uc5d0 \ub530\ub77c \ubd84\ub9ac\ud55c \ub2e4\ud56d\uc2dd \uacc4\uc218\ub4e4\uc5d0 \ub300\ud558\uc5ec \uac01\uac01 DFT\ub97c \ud55c \ud6c4, \uacb0\uacfc \ubca1\ud130\ub97c \ud558\ub098\uc758 \uc218\ucc98\ub7fc \uc0dd\uac01\ud55c \ud6c4 \\(x_0\\)\uc5d0 \ub300\ud55c DFT\ub97c \ud558\uba74 MultiDimensional DFT\ub97c \ud560 \uc218 \uc788\ub2e4\ub294 \uc758\ubbf8\uc774\ub2e4. \ub610\ud55c, \uc804 \uacfc\uc815\uc5d0\uc11c DFT matrix \ub97c \uc0ac\uc6a9\ud55c \uac83\uc774 \uc544\ub2c8\ub77c, Property 1\uc758 \uc131\uc9c8\uc744 \ub9cc\uc871\ud558\ub294 \uc784\uc758\uc758 \ud589\ub82c\uc744 \uc0ac\uc6a9\ud574\ub3c4 \uad1c\ucc2e\ub2e4.</p> <p>Algorithm 1</p> <p>MultiDimensional DFT\ub97c \ud558\uae30 \uc704\ud574\uc120, \uc6b0\uc120 \uccab \ubc88\uc9f8 \ubcc0\uc218 \\(x_0\\)\uc758 \ucc28\uc218\uc5d0 \ub530\ub77c \ubd84\ub9ac\ud55c \ub2e4\ud56d\uc2dd \uacc4\uc218\ub4e4\uc5d0 \ub300\ud558\uc5ec \uac01\uac01 \\(n-1\\)\ucc28\uc6d0 DFT\ub97c \ud55c \ud6c4, \uacb0\uacfc \ubca1\ud130\ub97c \ud558\ub098\uc758 \uc218\ucc98\ub7fc \uc0dd\uac01\ud55c \ud6c4 \\(x_0\\)\uc5d0 \ub300\ud55c DFT\ub97c \ud558\uba74 \ub41c\ub2e4.</p> <p>\uc774\ub54c, DFT \ub300\uc2e0 Property 1\uc758 \uc131\uc9c8\uc744 \ub9cc\uc871\ud558\ub294 \ub2e8\uc21c \ud589\ub82c\uacf1\uc73c\ub85c \uac01 \ub2e8\uacc4\ub97c \uc0dd\uac01\ud574\ub3c4 \ub41c\ub2e4.</p> <p>\ub9c8\uc9c0\ub9c9\uc73c\ub85c, IDFT \ub610\ud55c Property 2\ub97c \ud65c\uc6a9\ud558\uc5ec \\(T\\)\uc758 \uc5ed\ud589\ub82c\uc744 \uc27d\uac8c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> \\[ T^{-1} = T_0^{-1} \\otimes T_1^{-1} \\otimes T_2^{-1} \\cdots \\otimes T_{n-1}^{-1} \\] <p>Property 4</p> \\[ T=T_0 \\otimes T_1 \\otimes T_2 \\cdots \\otimes T_{n-1} \\] \\[ T^{-1} = T_0^{-1} \\otimes T_1^{-1} \\otimes T_2^{-1} \\cdots \\otimes T_{n-1}^{-1} \\]","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FWHT/algorithm/#bitwise-convolution","title":"Bitwise Convolution","text":"<p>bitwise xor, bitwise and, bitwise or \ub4f1\uc758 \uc5ec\ub7ec bitwise operation \ub4e4\uc5d0 convolution\uc744 \uc801\uc6a9\ud558\uae30 \uc704\ud558\uc5ec, \ub2e4\uc74c\uacfc \uac19\uc774 \uc0dd\uac01\ud558\uc790. \ubaa8\ub4e0 \uc5f0\uc0b0\ub4e4\uc774 \uac01 bit\uc5d0 \ub300\ud558\uc5ec \ub3c5\ub9bd\uc801\uc73c\ub85c \ud574\uc11d\ud560 \uc218 \uc788\uc73c\ub2c8, \uac01 bit\ub97c \ub2e4\ud56d\uc2dd\uc758 \ubcc0\uc218\uc640 \uc77c\ub300\uc77c \ub300\uc751\uc2dc\ud0ac \uc218 \uc788\ub2e4. \uc608\ub97c \ub4e4\uc5b4, \uc77c\ubc18\uc801\uc778 DFT\uc5d0\uc11c \\(a_5 = p\\)\uc600\ub2e4\uba74 \uc774\ub97c \\(px^5\\)\uc73c\ub85c \ud45c\ud604\ud588\uc9c0\ub9cc, bitwise DFT\uc5d0\uc11c\ub294 \\(px_2^1x_1^0x_0^1\\) (\\(5=101_{(2)}\\))\uc758 \ud56d\uc73c\ub85c \ud45c\ud604\ub41c\ub2e4.</p> <p>\ub530\ub77c\uc11c, \uac01 bit\ub97c \uc758\ubbf8\ud558\ub294 \ub2e4\ubcc0\uc218 \ub2e4\ud56d\uc2dd\uc73c\ub85c \ubc30\uc5f4\uc744 \ud45c\ud604\ud55c \uc774\ud6c4, \uc774\uc81c \uc900 \uc2dd\uc5d0 MultiDimensional DFT\ub97c \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4. \uac01 bit\uc5d0 \uc801\uc6a9\ud560 \uc5f0\uc0b0 (xor, and, or)\uc774 \ubaa8\ub450 \ub3d9\uc77c\ud558\ub2c8 \ud06c\uae30 \\(2 \\times 2\\)\uc778 \ud55c bit\uc5d0\ub9cc \uc801\uc6a9\ub420 \uc218 \uc788\ub294 \ud589\ub82c \\(T\\)\ub97c \ucc3e\uc740 \ud6c4, \\(T \\otimes T \\otimes T \\cdots \\otimes T\\)\uc640 \uac19\uc774 \ubc18\ubcf5\uc801\uc73c\ub85c kronecker product\ub97c \ucde8\ud558\uba74 DFT\uac12\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\uc774\uc81c, \uac01 \uc5f0\uc0b0\uc5d0 \ub300\ud558\uc5ec \uac01\uac01 \ud589\ub82c \\(T\\)\ub97c \ucc3e\uc544\uc8fc\uae30\ub9cc \ud558\uba74 \ub41c\ub2e4.</p> <p>xor\uc758 \uc608\ub97c \ub4e4\uba74 Property 1\uc758 \uc2dd\uc744 \ud480\uc5b4 \uc4f0\uba74 \ub2e4\uc74c\uacfc \uac19\ub2e4.</p> \\[ T_{\\oplus} \\begin{bmatrix}     p_0 \\\\ p_1 \\end{bmatrix} \\cdot T_{\\oplus} \\begin{bmatrix}     q_0 \\\\ q_1 \\end{bmatrix} = T_{\\oplus} \\begin{bmatrix}     p_0q_0+p_1q_1 \\\\ p_0q_1+p_1q_0 \\end{bmatrix} \\] <p>\uc704 \uc131\uc9c8\uc744 \ub9cc\uc871\ud558\ub294 invertible matrix\ub97c \ucc3e\uc73c\uba74 \\(T_{\\oplus}\\)\ub97c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> \\[ T_{\\oplus}= \\begin{bmatrix}     1 &amp; 1 \\\\ 1 &amp; -1 \\end{bmatrix}, \\ T_{\\oplus}^{-1}= \\frac{1}{2} \\begin{bmatrix}     1 &amp; 1 \\\\ 1 &amp; -1 \\end{bmatrix} \\] \\[ T_{\\&amp;}= \\begin{bmatrix}     0 &amp; 1 \\\\ 1 &amp; 1 \\end{bmatrix}, \\ T_{\\&amp;}^{-1}= \\begin{bmatrix}     -1 &amp; 1 \\\\ 1 &amp; 0 \\end{bmatrix} \\] \\[ T_{|}= \\begin{bmatrix}     1 &amp; 0 \\\\ 1 &amp; 1 \\end{bmatrix}, \\ T_{|}^{-1}= \\begin{bmatrix}     1 &amp; 0 \\\\ -1 &amp; 1 \\end{bmatrix} \\] <p>Property 5</p> \\[ T_{\\oplus}= \\begin{bmatrix}     1 &amp; 1 \\\\ 1 &amp; -1 \\end{bmatrix}, \\ T_{\\oplus}^{-1}= \\frac{1}{2} \\begin{bmatrix}     1 &amp; 1 \\\\ 1 &amp; -1 \\end{bmatrix} \\] \\[ T_{\\&amp;}= \\begin{bmatrix}     0 &amp; 1 \\\\ 1 &amp; 1 \\end{bmatrix}, \\ T_{\\&amp;}^{-1}= \\begin{bmatrix}     -1 &amp; 1 \\\\ 1 &amp; 0 \\end{bmatrix} \\] \\[ T_{|}= \\begin{bmatrix}     1 &amp; 0 \\\\ 1 &amp; 1 \\end{bmatrix}, \\ T_{|}^{-1}= \\begin{bmatrix}     1 &amp; 0 \\\\ -1 &amp; 1 \\end{bmatrix} \\] <p>\uc2dc\uac04 \ubcf5\uc7a1\ub3c4\ub294 \\(\\log N\\)\ucc28\uc6d0 DFT\uc774\uace0, \uac01 \ucc28\uc6d0\uc774 \ud06c\uae30 \\(2\\)\uc778 \ud589\ub82c\uacf1\uc774\ubbc0\ub85c \\(O(N\\log N)\\)\uc774\ub2e4.</p> <p>Time Complexity</p> <p>Time Complexity : \\(O(N\\log N)\\)</p>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FWHT/algorithm/#xor-convolution","title":"XOR Convolution","text":"<p>(\ub2e4\ub978 \uad00\uc810\uc758 \ud574\uc11d)</p> <p>bitwise xor \uc5f0\uc0b0\uc740 \\(\\mathbb{Z}_2^k\\)\uc0c1\uc5d0\uc11c\uc758 \ub367\uc148 \uc5f0\uc0b0\uacfc \ub3d9\uc77c\ud558\ub2e4.</p> \\[ T_{\\oplus}= \\begin{bmatrix}     1 &amp; 1 \\\\ 1 &amp; -1 \\end{bmatrix}, \\ T_{\\oplus}^{-1}= \\frac{1}{2} \\begin{bmatrix}     1 &amp; 1 \\\\ 1 &amp; -1 \\end{bmatrix} \\] <p>\uc704 \ud589\ub82c\uc744 \ub2e4\uc74c\uacfc \uac19\uc774 \ud574\uc11d\ud560 \uc218 \uc788\ub2e4. \uc77c\ubc18\uc801\uc778 DFT\uc5d0\uc11c \\(\\omega_2=-1\\)\uc774\ub2c8, \\(T_{\\oplus}\\)\ub294 \uc0ac\uc2e4 \ud06c\uae30 \\(2\\)\uc758 DFT matrix\uc640 \ub3d9\uc77c\ud558\ub2e4. \ud558\uc9c0\ub9cc \ud06c\uae30 \\(2\\)\uc778 \ubca1\ud130\ub97c DFT\ud558\uc5ec convolution\ud558\uae30 \uc704\ud574\uc11c\ub294 \ud06c\uae30 \\(3\\)\uc774\uc0c1\uc758 \uacf5\uac04\uc774 \ud544\uc694\ud558\uc9c0\ub9cc, \ud06c\uae30 \\(2\\)\uc758 \ud589\ub82c\uc744 \uc120\ud0dd\ud558\uc600\uae30 \ub54c\ubb38\uc5d0 \\(x^2\\)\uc5d0 \ud574\ub2f9\ud558\ub294 \uac12\uc740 \ub2e4\uc2dc \\(x^0\\)\uacfc \uac19\uac8c \ucde8\uae09\ub418\uace0, \uc774\ub294 \uc0ac\uc2e4 \\(\\mathbb{Z}_2\\)\uc0c1\uc5d0\uc11c\uc758 \ub367\uc148, \uc989 xor\uc774 \uc6d0\ud558\ub294 \uc5f0\uc0b0\uc744 \uad6c\ud604\ud558\uc600\ub2e4\uace0 \ud574\uc11d\ud560 \uc218 \uc788\ub2e4.</p> <p>\uc774\ub97c \ub354 \uc77c\ubc18\ud654\ud558\uba74, \\(\\mathbb{Z}_2\\)\uc0c1\uc5d0\uc11c\uc758 \ub367\uc148 \uc5f0\uc0b0\uc778 bitwise xor\uc5d0\uc11c \\(\\omega_2\\)\ub85c \uad6c\uc131\ub41c \ud06c\uae30 \\(2\\)\uc758 DFT matrix\ub97c \uc0ac\uc6a9\ud588\ub358 \uac83\ucc98\ub7fc, \\(\\mathbb{Z}_k\\)\uc0c1\uc5d0\uc11c\uc758 \ub367\uc148 \uc5f0\uc0b0\uc5d0\uc11c\ub294 \\(\\omega_k\\)\ub85c \uad6c\uc131\ub41c \ud06c\uae30 \\(k\\)\uc758 DFT matrix\ub97c \uc0ac\uc6a9\ud558\uba74 \uad6c\ud560 \uc218 \uc788\ub2e4.</p>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FWHT/algorithm/#and-or-convolution","title":"AND / OR Convolution","text":"<p>(\ub2e4\ub978 \uad00\uc810\uc758 \ud574\uc11d)</p> <p>bitwise and\uc5f0\uc0b0\uc740 bitwise or\uc5f0\uc0b0\uc758 \uc5ec\uc9d1\ud569\uc73c\ub85c \ud574\uc11d\ud560 \uc218 \uc788\uc73c\ub2c8, bitwise or\uc5f0\uc0b0\uc5d0 \ub300\ud574\uc11c\ub9cc \uc11c\uc220\ud55c\ub2e4. bitwise or\uc5f0\uc0b0\uc740 \\(\\mathbb{Z}_2^k\\)\uc0c1\uc5d0\uc11c\uc758 max \uc5f0\uc0b0, \ud639\uc740 \ud569\uc9d1\ud569 \uc5f0\uc0b0\uacfc \ub3d9\uc77c\ud558\ub2e4.</p> \\[ T_{|}= \\begin{bmatrix}     1 &amp; 0 \\\\ 1 &amp; 1 \\end{bmatrix}, \\ T_{|}^{-1}= \\begin{bmatrix}     1 &amp; 0 \\\\ -1 &amp; 1 \\end{bmatrix} \\] <p>\uc704 \ud589\ub82c\uc740 \ud06c\uae30 \\(2\\)\uc778 \ubca1\ud130\uc5d0 \ub300\ud55c \ub204\uc801\ud569\uc744 \ucde8\ud558\ub294 \ud589\ub82c\uc774\uace0, \uc5ed\ud589\ub82c\uc740 \uac70\uafb8\ub85c \ub204\uc801\ud569\uc758 \uc5ed\uc5f0\uc0b0, \uc989 \ucc28\uc774\uac12 \ubc30\uc5f4\uc744 \ucde8\ud558\ub294 \ud589\ub82c\uc774\ub2e4. \ubaa8\ub4e0 \ube44\ud2b8\ub97c \ubaa8\uc544\ub193\uace0 \ubcf4\uba74, \uacb0\uad6d \ud2b9\uc815 \uc9d1\ud569\uc758 \ubd80\ubd84\uc9d1\ud569\uc744 \ubaa8\ub450 \uc21c\ud68c\ud558\uc5ec \ub354\ud558\ub294, Sum of Subset\uc744 \ucde8\ud558\ub294 \uc5f0\uc0b0\uc784\uc744 \uc54c \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c OR convolution\uc740 \uac01 \ubc30\uc5f4 \\(a\\), \\(b\\)\uc5d0 \ub300\ud558\uc5ec Sum of Subset\uc744 \ucde8\ud55c \ud6c4 \uacf1\ud558\uc5ec \ubc30\uc5f4 \\(c'\\)\uc744 \uad6c\ud558\uace0, Sum of Subset\uc758 \uc5ed\uc5f0\uc0b0\uc744 \ud1b5\ud574 \ucd5c\uc885 \ubc30\uc5f4 \\(c\\)\ub97c \uad6c\ud55c\ub2e4\uace0 \uc694\uc57d\ud560 \uc218 \uc788\ub2e4.</p> \\[ c_i = \\sum_{j \\cup k=i} a_j \\cdot b_k \\] \\[ c'_i = \\sum_{j \\subseteq i}c_j = \\sum_{j \\cup k \\subseteq i} a_j \\cdot b_k = \\sum_{j \\subseteq i \\wedge k \\subseteq i} a_j \\cdot b_k = \\sum_{j \\subseteq i} a_j \\cdot \\sum_{k \\subseteq i} b_k \\] <p>\uc704 \uc2dd\uc744 \ud1b5\ud574\uc11c\ub3c4 \uadf8 \uc815\ub2f9\uc131\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4. OR convolution\uc744 \uad6c\ud604\ud558\uba74, SOS DP\ub97c \ud1b5\ud574 \uc704 \uc2dd\uc744 \uc9c1\uc811 \uacc4\uc0b0\ud558\ub294 \uac83\uacfc \ub3d9\uc77c\ud55c \uc791\uc5c5\uc744 \ud55c\ub2e4.</p> <p>\uc774\ub97c \ub354 \uc77c\ubc18\ud654\ud558\uba74, \\(\\mathbb{Z}_2\\)\uc0c1\uc5d0\uc11c\uc758 max \uc5f0\uc0b0\uc778 bitwise or\uc5d0\uc11c Sum of Subset\uc744 \ucde8\ud588\ub358 \uac83\ucc98\ub7fc, \\(\\mathbb{Z}_k\\)\uc0c1\uc5d0\uc11c\uc758 max \uc5f0\uc0b0\uc5d0\uc11c\ub294 \ud06c\uae30 \\(k\\)\uc778 \ub204\uc801\ud569\uc744 \ud558\ub294 Sum of Subset\uc744 \uad6c\ud55c\ub2e4\uace0 \uc694\uc57d\ud560 \uc218 \uc788\ub2e4.</p>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FWHT/algorithm/#implementation","title":"Implementation","text":"<p>\ub2e4\uc74c\uc740 XOR Convolution\uc5d0 \ub300\ud55c \uad6c\ud604 \ucf54\ub4dc\uc774\ub2e4. AND / OR Convolution \ub610\ud55c, \ud589\ub82c \\(T\\)\ub9cc \ub2e4\ub974\uac8c \uad6c\ud604\ud574\uc8fc\uba74 \ub428\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>\ub610\ud55c, \uc2e4\uc81c \uad6c\ud604\uc740 FFT\uc640 \ub9e4\uc6b0 \uc720\uc0ac\ud558\uc9c0\ub9cc, \uadf8 \ub3d9\uc791 \uc6d0\ub9ac\ub294 \ud06c\uae30 \\(2\\)\uc758 FFT\ub97c \ube44\ud2b8\uc758 \uac1c\uc218\ub9cc\ud07c \uc313\uc544 MultiDimensional FFT\ub97c \ud558\ub294 \uac83\uc784\uc5d0 \uc8fc\uc758\ud558\uc790.</p> <pre><code>void DFT(vector&lt;ll&gt; &amp;A, bool inv)\n{\n    int N=A.size();\n    for(int i=1; i&lt;N; i&lt;&lt;=1)\n    {\n        for(int j=0; j&lt;N; j+=i+i)\n        {\n            for(int k=0; k&lt;i; k++)\n            {\n                ll a=A[j+k], b=A[j+i+k];\n                A[j+k]=a+b;\n                A[j+i+k]=a-b;\n                if(inv) A[j+k]/=2, A[j+i+k]/=2;\n            }\n        }\n    }\n}\n</code></pre>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Math/Polynomials%20and%20Series/FWHT/algorithm/#reference","title":"Reference","text":"<ul> <li>https://codeforces.com/blog/entry/43499</li> <li>https://codeforces.com/blog/entry/71899</li> <li>https://codeforces.com/blog/entry/115438</li> </ul>","tags":["fft","math","~ algorithm"]},{"location":"algorithms/Strings/Aho-Corasick/algorithm/","title":"Aho-Corasick algorithm","text":"<p>Aho-Corasick \uc54c\uace0\ub9ac\uc998\uc740 \ubb38\uc790\uc5f4 \\(S\\)\uc5d0\uc11c \ubb38\uc790\uc5f4 \\(T_1\\), \\(T_2\\), \\(\u2026\\), \\(T_k\\) \uc758 \ub4f1\uc7a5\uc744 \ud55c \ubc88\uc5d0 \uac80\uc0c9\ud558\ub294 \uc54c\uace0\ub9ac\uc998\uc774\ub2e4.</p> <p>KMP Algorithm\uc758 \ubb38\uc790\uc5f4 \\(T\\)\uc5d0 \ub300\ud55c Prefix Function (Failure Function)\uacfc \ube44\uc2b7\ud558\uac8c, Aho-Corasick Algorithm\uc5d0\uc11c\ub294 \ubb38\uc790\uc5f4 \\(T_1, T_2, \\cdots, T_k\\) \ub4e4\uc758 Trie\ub97c \uad6c\uc131\ud558\uace0, \uc774 Trie \uc704\uc5d0\uc11c\uc758 Suffix Link (Failure Link)\ub97c \uc5f0\uacb0\ud55c\ub2e4.</p>","tags":["aho_corasick","data_structures","string","trees","trie","~ algorithm"]},{"location":"algorithms/Strings/Aho-Corasick/algorithm/#algorithm","title":"Algorithm","text":"<p>\uc6b0\uc120, \ubb38\uc790\uc5f4 \\(T_1, T_2, \\cdots, T_k\\) \ub4e4\uc744 \ud558\ub098\uc529 Trie\uc5d0 \uc0bd\uc785\ud55c\ub2e4. \uc644\uc131\ub41c Trie\uc758 \uac04\uc120\uc5d0\ub294 \ubb38\uc790\uac00 \uc801\ud600 \uc788\uace0, \uac01 \uc815\uc810\uc740 \\(T_1, T_2, \\cdots, T_k\\)\ub4e4\uc758 prefix\ub97c \uc758\ubbf8\ud55c\ub2e4. \ubb38\uc790\uc5f4\uc758 \uc54c\ud30c\ubcb3\uc774 \\(O(C)\\)\uac1c \uc788\uc744 \ub54c, Trie\ub97c \uc0dd\uc131\ud558\ub294 \uc2dc\uac04 \ubcf5\uc7a1\ub3c4\ub294 \\(O(|T_1|+|T_2|+\\cdots+|T_k|)=O(M)\\), \uacf5\uac04 \ubcf5\uc7a1\ub3c4\ub294 \\(O(MC)\\)\uc774\ub2e4.</p> <p>\uc774\uc81c, Trie\uc758 \uac01 \ub178\ub4dc\uc5d0\uc11c Suffix Link (Failure Link) \ub97c \uacb0\uc815\ud55c\ub2e4.</p> <p>Definition 1</p> <p>\uac01 \ub178\ub4dc\uc758 suffix link (failure link)\ub97c \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\uc758\ud55c\ub2e4.</p> <p>\\(fail[v]:=\\) \\(v\\)\uc758 \ub178\ub4dc\uac00 \uc758\ubbf8\ud558\ub294 prefix\uc758 proper suffix \uc911, Trie\uc5d0 \uc874\uc7ac\ud558\ub294 prefix\uc640 \ub3d9\uc77c\ud55c \uac83 \uc911 \ucd5c\ub300 \uae38\uc774\uc758 prefix\ub85c\uc758 \ub9c1\ud06c </p> <p>Trie\uc758 \ub8e8\ud2b8 \ub178\ub4dc\uc640 \ub8e8\ud2b8 \ub178\ub4dc\uc758 \uc790\uc2dd \ub178\ub4dc\ub4e4\uc758 fail \ub9c1\ud06c\ub294 \ub8e8\ud2b8 \ub178\ub4dc\ub85c \uc815\uc758\ud55c\ub2e4.</p> <p>\\(fail[v]\\)\ub97c \uad6c\ud558\uae30 \uc704\ud558\uc5ec, \\(fail[par[v]]\\), \\(fail[fail[par[v]]]\\), \\(\u2026\\)\uc758 \uc790\uc2dd \uac04\uc120\uc5d0 \\(v\\)\uac00 \uc758\ubbf8\ud558\ub294 prefix\uc758 \ub9c8\uc9c0\ub9c9 \ubb38\uc790 \\(c\\)\uac00 \uc874\uc7ac\ud558\ub294\uc9c0 \ud655\uc778\ud558\uace0, \uc790\uc2dd \ubb38\uc790 \\(c\\)\uac00 \uc874\uc7ac\ud558\ub294 \uac00\uc7a5 \uccab \ubc88\uc9f8 \ub178\ub4dc\uc758 \\(c\\)\uc5d0 \ud574\ub2f9\ud558\ub294 \uc790\uc2dd \ub178\ub4dc\uac00 \\(fail[v]\\)\uc758 \uac12\uc774 \ub41c\ub2e4.</p> <p>\uc774\ub97c \uc774\ubbf8 \uacc4\uc0b0\ud55c \uac12\ub4e4\uc744 \ud65c\uc6a9\ud558\uc5ec \uad6c\ud558\uae30 \uc704\ud574\uc11c, Trie\uc758 \uac01 \ub178\ub4dc\ub4e4\uc744 BFS\ub97c \ud1b5\ud574 \ub8e8\ud2b8\uc5d0\uc11c \uac00\uae4c\uc6b4 \uc815\uc810\ubd80\ud130 \ud558\ub098\uc529 \\(fail[v]\\)\ub97c \uacc4\uc0b0\ud55c\ub2e4.  \\(fail[par[v]]\\), \\(fail[fail[par[v]]]\\), \\(\u2026\\)\ub294 \ubaa8\ub450 \\(v\\)\ubcf4\ub2e4 \uae4a\uc774\uac00 \uc791\uc740 \uc815\uc810\ub4e4\uc774\uae30 \ub54c\ubb38\uc5d0 BFS \uacfc\uc815\uc5d0\uc11c \uc774\ubbf8 \uadf8 \uac12\ub4e4\uc774 \uad6c\ud574\uc9c4 \uc815\uc810\ub4e4\uc774\ub2e4.</p> <p>Prefix Function \uc758 \uc2dc\uac04 \ubcf5\uc7a1\ub3c4\uc640 \ub3d9\uc77c\ud558\uac8c, \uc2e4\ud328 \ud568\uc218 \ub178\ub4dc\uc758 \uc804\uc774\uc758 \uae4a\uc774\ub97c \uc0dd\uac01\ud558\uba74 \ub8e8\ud2b8\uc5d0\uc11c \ub9ac\ud504 \ub178\ub4dc\uae4c\uc9c0 \ub0b4\ub824\uac08 \ub54c \\(fail[v]\\)\uc758 \uae4a\uc774\ub294 \ucd5c\ub300 \\(|T_k|\\)\ubc88 \uc99d\uac00, \ucd5c\ub300 \\(|T_k|\\)\ubc88 \uac10\uc18c\ud558\ub2c8, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(O(|T_1|+|T_2|+...+|T_k|)=O(M)\\)\uc5d0 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Algorithm 1</p> <p>\ubb38\uc790\uc5f4 \\(T_1, T_2, \\cdots, T_k\\) \ub4e4\uc744 \ud558\ub098\uc529 Trie\uc5d0 \uc0bd\uc785\ud55c\ub2e4.</p> <p>\uc774\ud6c4, BFS\ub97c \ud558\uba70 \ub8e8\ud2b8\uc5d0\uc11c \uac00\uae4c\uc6b4 \ub178\ub4dc\ubd80\ud130 \ubcf4\uba70 \\(fail[v]\\)\ub97c \uacb0\uc815\ud55c\ub2e4. \\(fail[v]\\)\ub97c \uad6c\ud558\uae30 \uc704\ud558\uc5ec, \\(fail[par[v]]\\), \\(fail[fail[par[v]]]\\), \\(\u2026\\)\uc758 \uc790\uc2dd \uac04\uc120\uc5d0 \\(v\\)\uac00 \uc758\ubbf8\ud558\ub294 prefix\uc758 \ub9c8\uc9c0\ub9c9 \ubb38\uc790 \\(c\\)\uac00 \uc874\uc7ac\ud558\ub294\uc9c0 \ud655\uc778\ud558\uace0, \uc790\uc2dd \ubb38\uc790 \\(c\\)\uac00 \uc874\uc7ac\ud558\ub294 \uac00\uc7a5 \uccab \ubc88\uc9f8 \ub178\ub4dc\uc758 \\(c\\)\uc5d0 \ud574\ub2f9\ud558\ub294 \uc790\uc2dd \ub178\ub4dc\ub97c \\(fail[v]\\)\ub85c \uacb0\uc815\ud55c\ub2e4.</p> <p>\uc774\ud6c4, \uc704\uc5d0\uc11c \uad6c\ud55c Trie\uc640 Suffix Link (Failure Link)\ub97c \ubc14\ud0d5\uc73c\ub85c, \ube44\uad50\ud558\ub824\uace0 \ud558\ub294 \ubb38\uc790\uc5f4 \\(S\\)\uc758 \uac01 \ubb38\uc790\ub97c \ud558\ub098\uc529 \ubcf4\uba70 \ud0d0\uc0c9\ud55c\ub2e4. \uc2dc\uc791 \ub178\ub4dc\ub294 \ub8e8\ud2b8\uc5d0\uc11c \uc2dc\uc791\ud558\uba70, \\(S\\)\uc758 \ubb38\uc790\ub97c \ud558\ub098\uc529 \ubcf4\uba70, \ud604\uc7ac \ub178\ub4dc\uc758 \uc790\uc2dd \ubb38\uc790 \uac04\uc120\uc774 \uc874\uc7ac\ud558\uba74, \uadf8 \ub178\ub4dc\ub85c \uc774\ub3d9\ud558\uace0, \uc874\uc7ac\ud558\uc9c0 \uc54a\uc73c\uba74, \uc874\uc7ac\ud560 \ub54c\uae4c\uc9c0 Suffix Link\ub97c \ud0c0\uace0 \uc774\ub3d9\ud558\uba70 \ube44\uad50\ub97c \ubc18\ubcf5\ud55c\ub2e4. \uc989, Trie\uc5d0\uc11c \uc790\uc2dd \uac04\uc120\uc774 \uc874\uc7ac\ud558\uba74 \uc790\uc2dd\uc73c\ub85c \uc774\ub3d9\ud558\uace0, \uac04\uc120\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc73c\uba74 Suffix Link\ub97c \ud0c0\uace0 \uc774\ub3d9\ud558\ub294 Automaton\uc744 \uc0dd\uc131\ud558\uace0, \uc774 Automaton \uc704\uc5d0\uc11c \\(S\\)\uc758 \ubb38\uc790\ub4e4\uc744 \ud558\ub098\uc529 \ubcf4\uba70 \uc0c1\ud0dc\ub97c \uc804\uc774\ud55c\ub2e4.</p> <p>\\(S\\)\uc758 \ud2b9\uc815 \ubb38\uc790\uae4c\uc9c0 \uc9c4\ud589\ud55c \ud6c4, \ud604\uc7ac Trie\uc5d0\uc11c \ubcf4\uace0 \uc788\ub294 \ub178\ub4dc \\(v\\)\uac00 \uac16\ub294 \uc758\ubbf8\ub294, \\(v\\)\uc5d0 \ud574\ub2f9\ud558\ub294 prefix\uac00 \ud604\uc7ac \ubcf4\uace0 \uc788\ub294 \\(S\\)\uc758 prefix\uc758 proper suffix \uc911 Trie\uc5d0 \uc874\uc7ac\ud558\ub294 prefix\uc640 \ub3d9\uc77c\ud55c \uac83\ub4e4 \uc911 \ucd5c\ub300 \uae38\uc774\ub97c \uac16\ub294 \uac83\uc774\ub2e4.</p> <p>Algorithm 2</p> <p>\uc644\uc131\ub41c Trie\uc640 Suffix Link (Failure Link)\ub97c \ubc14\ud0d5\uc73c\ub85c, \ube44\uad50\ud558\ub824\uace0 \ud558\ub294 \ubb38\uc790\uc5f4 \\(S\\)\uc758 \uac01 \ubb38\uc790\ub97c \ud558\ub098\uc529 \ubcf4\uba70 \ud0d0\uc0c9\ud55c\ub2e4.</p> <p>\uc2dc\uc791 \ub178\ub4dc\ub294 \ub8e8\ud2b8\uc5d0\uc11c \uc2dc\uc791\ud558\uba70, \\(S\\)\uc758 \ubb38\uc790\ub97c \ud558\ub098\uc529 \ubcf4\uba70, \ud604\uc7ac \ub178\ub4dc\uc758 \uc790\uc2dd \ubb38\uc790 \uac04\uc120\uc774 \uc874\uc7ac\ud558\uba74, \uadf8 \ub178\ub4dc\ub85c \uc774\ub3d9\ud558\uace0, \uc874\uc7ac\ud558\uc9c0 \uc54a\uc73c\uba74, \uc874\uc7ac\ud560 \ub54c\uae4c\uc9c0 Suffix Link\ub97c \ud0c0\uace0 \uc774\ub3d9\ud558\uba70 \ube44\uad50\ub97c \ubc18\ubcf5\ud55c\ub2e4.</p> <p>\uc2dc\uac04 \ubcf5\uc7a1\ub3c4\ub294 KMP \uc54c\uace0\ub9ac\uc998\uacfc \ub3d9\uc77c\ud558\uac8c, Automaton \uc704\uc5d0\uc11c\uc758 \ud0d0\uc0c9\uc740 \\(O(N+M)\\)\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub85c \uc0c1\ud0dc\ub97c \uc804\uc774\ud560 \uc218 \uc788\ub2e4.</p> <p>\ud558\uc9c0\ub9cc \ud2b9\uc815 \uc704\uce58 \\(i\\)\uc5d0\uc11c \ub05d\ub098\ub294 prefix\uc758 suffix\uc640 \ub9e4\uce6d\ub418\ub294 \\(T_i\\)\uac00 \uc5ec\ub7ec \uac1c \uc788\uc744 \uc218 \uc788\uc74c\uc5d0 \uc8fc\uc758\ud558\uc790. \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ubaa8\ub4e0 \\(T_i\\)\ub4e4\uc740 suffix link\ub97c \ud0c0\uace0 \uc62c\ub77c\uac00\uba74\uc11c, terminal node \uc778\uc9c0 \ud655\uc778\ud574\uc8fc\uba74 \ub41c\ub2e4. \uc774 \uacfc\uc815\uc740 Automaton \uc704\uc5d0\uc11c\uc758 \ud0d0\uc0c9\uc5d0 \ud3ec\ud568\ub418\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub97c \\(O(N+M)\\)\uc5d0\uc11c \\(O(Nmax|T_i|+M)\\)\uc73c\ub85c \uc99d\uac00\uc2dc\ud0a8\ub2e4. \uc774\ub97c \ubc29\uc9c0\ud558\uae30 \uc704\ud574\uc11c\ub294, suffix link\ub97c \ub530\ub77c \uc62c\ub77c\uac00\uba74\uc11c \ub9cc\ub098\ub294 \uccab \ubc88\uc9f8 terminal node\ub97c \uc800\uc7a5\ud558\uba74 \ub418\ub294\ub370, \uc774\ub97c terminal link\uc5d0 \uc800\uc7a5\ud55c\ub2e4. \uc704 \ucd5c\uc801\ud654\ub97c \ud1b5\ud558\uc5ec \uc2e4\uc81c \ub9e4\uce6d\ub418\ub294 \uacbd\uc6b0\uc758 \uc218\uc5d0 \ub300\ud574\uc11c\ub9cc \ud0d0\uc0c9\ud560 \uc218 \uc788\ub3c4\ub85d jump\ud560 \uc218 \uc788\uace0, \\(O(N+M+ans)\\)\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Definition 2</p> <p>\uac01 \ub178\ub4dc \\(v\\)\uc5d0\uc11c suffix link\ub97c \ud0c0\uace0 \uc62c\ub77c\uac00\uba74\uc11c \ub9cc\ub098\ub294 \uccab \ubc88\uc9f8 terminal node\ub97c terminal link\ub85c \uc5f0\uacb0\ud55c\ub2e4.</p> <p>\uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(N+M+ans)\\), \uacf5\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(N+MK)\\)\uc774\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N+M+ans)\\) Space Complexity : \\(O(N+MK)\\)</p> <p></p> <p>\u201ca\u201d, \u201cab\u201d, \u201cbc\u201d, \u201cbca\u201d, \u201cc\u201d, \u201ccaa\u201d\uac00 \ubb38\uc790\uc5f4 \\(T_1\\), \\(T_2\\), \\(\u2026\\), \\(T_k\\)\uc77c \ub54c Trie\ub97c \ub098\ud0c0\ub0b8 \uadf8\ub9bc\uc774\ub2e4. \ud30c\ub780\uc0c9 \uac04\uc120\uc774 failure Link, \ucd08\ub85d\uc0c9 \uac04\uc120\uc774 suffix Link\ub97c \uc758\ubbf8\ud55c\ub2e4.</p>","tags":["aho_corasick","data_structures","string","trees","trie","~ algorithm"]},{"location":"algorithms/Strings/Aho-Corasick/algorithm/#implementation","title":"Implementation","text":"<pre><code>// par[v] = parent of node v\n// fail[v] = failure link of node v\n// suf[v] = suffix link of node v\nstruct Node\n{\n    int par, fail, suf;\n    vector&lt;int&gt; chd;\n    Node()\n    {\n        par=fail=suf=-1;\n        chd=vector&lt;int&gt;(26, -1);\n    }\n};\n\nint root;\nvector&lt;Node&gt; NS;\n\nint newNode()\n{\n    NS.push_back(Node());\n    return NS.size()-1;\n}\n\n// Make trie of dictionary SV\n// Determine par[v] for all nodes, suf[v] for terminal nodes\nvoid makeTrie(vector&lt;string&gt; SV) // SV[0], SV[1], ... is 0-based\n{\n    root=newNode();\n    NS[root].par=root; NS[root].fail=root; NS[root].suf=root;\n\n    for(auto &amp;S : SV)\n    {\n        int now=root;\n        for(auto c : S)\n        {\n            if(NS[now].chd[c-'a']==-1)\n            {\n                int nxt=NS[now].chd[c-'a']=newNode();\n                NS[nxt].par=now;\n            }\n            now=NS[now].chd[c-'a'];\n        }\n        NS[now].suf=now;\n    }\n}\n\n// Determine fail[v], suf[v] for all nodes\nvoid bfs()\n{\n    queue&lt;int&gt; Q;\n    Q.push(root);\n    while(!Q.empty())\n    {\n        int now=Q.front(); Q.pop();\n        for(int i=0; i&lt;26; i++) if(NS[now].chd[i]!=-1)\n        {\n            int nxt=NS[now].chd[i];\n            if(now==root) NS[nxt].fail=root;\n            else\n            {\n                int p;\n                for(p=NS[now].fail; p!=root; p=NS[p].fail) if(NS[p].chd[i]!=-1) break;\n                if(NS[p].chd[i]==-1) NS[nxt].fail=root;\n                else NS[nxt].fail=NS[p].chd[i];\n            }\n\n            if(NS[nxt].suf==-1) NS[nxt].suf=NS[NS[nxt].fail].suf;\n            Q.push(nxt);\n        }\n    }\n}\n\n// Find occurences of TV[0], TV[1], ... in S\n// AhoCorasick(S = \"mississippi\", TV = [\"ss\", \"sis\", \"ippi\", \"pp\"]) = [3, 5, 6, 9, 10]\nvector&lt;int&gt; AhoCorasick(string S, vector&lt;string&gt; TV) // S, TV[0], TV[1], ... is 0-based\n{\n    vector&lt;int&gt; ans;\n\n    makeTrie(TV);\n    bfs();\n\n    int now=root;\n    for(int i=0; i&lt;S.size(); i++)\n    {\n        for(; now!=root &amp;&amp; NS[now].chd[S[i]-'a']==-1; now=NS[now].fail);\n        if(NS[now].chd[S[i]-'a']!=-1) now=NS[now].chd[S[i]-'a'];\n\n        // now is matching node in trie with S[0...i]\n        // your code goes here\n\n        if(NS[now].suf!=root) ans.push_back(i); // Ending position of occurences in S\n    }\n    return ans;\n}\n</code></pre>","tags":["aho_corasick","data_structures","string","trees","trie","~ algorithm"]},{"location":"algorithms/Strings/Aho-Corasick/algorithm/#reference","title":"Reference","text":"<ul> <li>https://cp-algorithms.com/string/aho_corasick.html</li> </ul>","tags":["aho_corasick","data_structures","string","trees","trie","~ algorithm"]},{"location":"algorithms/Strings/Eertree/algorithm/","title":"Eertree (Palindrome Tree)","text":"<p>Eertree (Palindrome Tree)\ub294 \ubb38\uc790\uc5f4 \\(S\\)\uc758 \ubaa8\ub4e0 palindrome\uc778 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc744 \ud6a8\uc728\uc801\uc73c\ub85c \uad00\ub9ac\ud558\uae30 \uc704\ud55c \uc790\ub8cc\uad6c\uc870\uc774\ub2e4. \uae30\ubcf8\uc801\uc778 \uad6c\uc870\ub294 suffix automaton\uacfc \ube44\uc2b7\ud558\uace0, KMP\uc758 failure tree\uc640\ub3c4 \uc720\uc0ac\ud55c \ubd80\ubd84\uc774 \uc788\ub2e4.</p>","tags":["string","palindrome_tree","~ algorithm"]},{"location":"algorithms/Strings/Eertree/algorithm/#property","title":"Property","text":"<p>Property 1</p> <p>\uae38\uc774 \\(N\\)\uc758 \ubb38\uc790\uc5f4 \\(S\\)\uc758 \uc11c\ub85c \ub2e4\ub978 \ubaa8\ub4e0 palindrome\uc778 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc740 \ucd5c\ub300 \\(N\\)\uac1c\uc774\ub2e4. \uc55e\uc5d0\uc11c\ubd80\ud130 \ubb38\uc790\ub97c \ud558\ub098\uc529 \ucd94\uac00\ud574 \ub098\uac08 \ub54c, \\(i\\)\ubc88\uc9f8 \ubb38\uc790\uc758 \ucd94\uac00\ub85c \uc778\ud574 \uc0c8\ub85c \uc0dd\uae38 \uc218 \uc788\ub294 palindrome\uc740 \ucd5c\ub300 \\(1\\)\uac1c\uc774\uba70 \uc774\ub294 \\(S[1...i]\\)\uc758 suffix \uc911 \uac00\uc7a5 \uae34 palindrome\uc774\ub2e4.</p> <p>Proof</p> <p>\uc55e\uc5d0\uc11c\ubd80\ud130 \ubb38\uc790\ub97c \ud558\ub098\uc529 \ucd94\uac00\ud574 \ub098\uac08 \ub54c, \\(i\\)\ubc88\uc9f8 \ubb38\uc790\uc758 \ucd94\uac00\ub85c \uc778\ud574 \\(2\\)\uac1c\uc758 \uc11c\ub85c \ub2e4\ub978 palindrome\uc778 \ubd80\ubd84\ubb38\uc790\uc5f4\uc774 \uc0c8\ub85c \uc0dd\uacbc\ub2e4\uace0 \uac00\uc815\ud558\uc790. \uc544\ub798 \uadf8\ub9bc\uacfc \uac19\uc774 palindrome\uc758 \uc131\uc9c8\uc5d0 \uc758\ud574 \ub2e4\ub978 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc740 \uac00\uc7a5 \uae34 \uae38\uc774\uc758 palindrome\uc5d0 \uc758\ud574 \\(i\\)\ubc88\uc9f8 \ubb38\uc790\ub97c \ucd94\uac00\ud558\uae30 \uc804 \uc774\ubbf8 \ub4f1\uc7a5\ud588\ub358 \ubd80\ubd84\ubb38\uc790\uc5f4\uc774\ub2e4. \ub530\ub77c\uc11c, \\(i\\)\ubc88\uc9f8 \ubb38\uc790\ub97c \ucd94\uac00\ud558\uc600\uc744 \ub54c \ucd5c\ub300 \\(1\\)\uac1c\uc758 \uc0c8\ub85c\uc6b4 palindrome\uc778 \ubd80\ubd84\ubb38\uc790\uc5f4\uc774 \ub4f1\uc7a5\ud560 \uc218 \uc788\uace0, \uc804\uccb4 \ubb38\uc790\uc5f4 \\(S\\)\uc758 \uc11c\ub85c \ub2e4\ub978 \ubaa8\ub4e0 palindrome\uc778 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc740 \ucd5c\ub300 \\(N\\)\uac1c\uc774\ub2e4.</p> <p></p>","tags":["string","palindrome_tree","~ algorithm"]},{"location":"algorithms/Strings/Eertree/algorithm/#structure","title":"Structure","text":"<p>Eertree\ub294 \ub2e4\uc74c \uae30\ubcf8 \uc131\uc9c8\ub4e4\uc744 \ub9cc\uc871\ud55c\ub2e4.</p> <p>Property 1</p> <ul> <li>Eertree\ub294 \uc815\uc810 (state)\uc640  Eertree\uc758 \uac01 \ub178\ub4dc\ub294 \ubb38\uc790\uc5f4 \\(S\\)\uc758 \uac01 palindrome\uc778 \ubd80\ubd84\ubb38\uc790\uc5f4\uc5d0 \ud558\ub098\uc529 \ub300\uc751\ub41c\ub2e4.</li> </ul> <p>!!! definition \"Definition </p>","tags":["string","palindrome_tree","~ algorithm"]},{"location":"algorithms/Strings/KMP/algorithm/","title":"KMP (Knuth-Morris-Pratt algorithm)","text":"<p>KMP \uc54c\uace0\ub9ac\uc998\uc740 \uae38\uc774 \\(N\\)\uc758 \ubb38\uc790\uc5f4 \\(S\\)\uc5d0\uc11c \uae38\uc774 \\(M\\)\uc758 \ubb38\uc790\uc5f4 \\(T\\)\uc758 \ubaa8\ub4e0 \ub4f1\uc7a5 \uc704\uce58\ub97c \\(O(N+M)\\)\uc5d0 \ucc3e\ub294 \uc54c\uace0\ub9ac\uc998\uc774\ub2e4. \ubb38\uc790\uc5f4 \ub9e4\uce6d\uc744 \ud558\uae30 \uc704\ud558\uc5ec \\(T\\)\uc758 failure function\uc744 \uba3c\uc800 \uacc4\uc0b0\ud558\uc600\ub2e4\uace0 \uac00\uc815\ud55c\ub2e4.</p>","tags":["kmp","string","~ algorithm"]},{"location":"algorithms/Strings/KMP/algorithm/#algorithm","title":"Algorithm","text":"<p>\ubb38\uc790\uc5f4 \\(S\\)\ub97c \uc55e\uc5d0\uc11c\ubd80\ud130 \ubcf4\uba70, \\(i\\)\ubc88\uc9f8 prefix\uc758 suffix\ub97c \\(S\\)\uc640 \ucd5c\ub300\ud55c \ub9e4\uce6d\uc2dc\ud0a8 \\(T\\)\uc758 \uc704\uce58\ub97c \\(j=match[i]\\)\ub77c \ud558\uc790.</p> <p>\\(i-1\\)\ubc88\uc9f8 \uce78\uc5d0\uc11c \ucd5c\ub300\ub85c \ub9e4\uce6d\ud55c \uc704\uce58\ub97c \\(j=match[i-1]\\)\ub77c \ud560 \ub54c, \\(i\\)\ubc88\uc9f8 \uce78\uc5d0\uc11c \ub9e4\uce6d\ud55c \uc704\uce58 \\(match[i]\\)\ub97c \uad6c\ud558\uc790. \uc6b0\uc120, \\(S[i]=T[j+1]\\)\uc774\uba74, \\(match[i]=j+1\\)\uc774\ub2e4. \ub9cc\uc57d \uadf8\ub807\uc9c0 \uc54a\ub2e4\uba74 \\(j\\)\ub97c \uc62e\uaca8 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub3c4\ub85d \ud574\uc57c\ud558\ub294\ub370, \\(fail\\)\uc758 \uc815\uc758\uc5d0 \uc758\ud574 \uc62e\uae38 \uc218 \uc788\ub294 \uac00\uc7a5 \ud070 \\(j=fail[j]\\)\uc774\ub2e4. \uc774\uc640 \uac19\uc774 \\(j, fail[j], fail[fail[j]], \\cdots\\)\ub97c \ud558\ub098\uc529 \ud655\uc778\ud558\uba70 \\(S[i]=T[j+1]\\)\uc778 \ucd5c\ucd08 \uc704\uce58\ub97c \ubc1c\uacac\ud558\uc5ec \uc62e\uaca8\uc8fc\uba74 \ub41c\ub2e4.</p> <p>Algorithm 1</p> <p>\uae38\uc774 \\(N\\)\uc758 \ubb38\uc790\uc5f4 \\(S\\)\uc5d0\uc11c \uae38\uc774 \\(M\\)\uc758 \ubb38\uc790\uc5f4 \\(T\\)\uc758 \ubaa8\ub4e0 \ub4f1\uc7a5 \uc704\uce58\ub97c \ucc3e\ub294\ub2e4. \\(i\\)\ub97c \uc99d\uac00\uc2dc\ud0a4\uba70 \uac01 \uc704\uce58\uc5d0\uc11c\uc758 \\(match[i]\\)\ub97c \uad6c\ud55c\ub2e4. \\(j=match[i-1]\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec, \\(j\\), \\(j=fail[j]\\), \\(j=fail[fail[j]]\\)\ub97c \ud558\ub098\uc529 \ud655\uc778\ud558\uba70 \\(S[i]=T[j+1]\\)\uc778 \\(j\\)\uac00 \ub4f1\uc7a5\ud558\ub294 \uc21c\uac04 \\(match[i]=j+1\\)\uc774\ub2e4. \ub9cc\uc57d \ub9cc\uc871\ud558\ub294 \\(j\\)\uac00 \uc5c6\ub2e4\uba74 \\(match[i]=0\\)\uc774\ub2e4.</p> <p>\ub9cc\uc57d \\(match[i]=M\\)\uc774\uba74 \\(S\\)\uc758 \ub4f1\uc7a5\uc744 \ud558\ub098 \ubc1c\uacac\ud558\uc600\uace0 \uadf8 \uc704\uce58\ub294 \\([i-M+1, i]\\)\uc774\ub2e4. \uc774\ud6c4, \\(j\\)\ub97c \\(fail[j]\\)\ub85c \ubc14\uafb8\uc5b4\uc900\ub2e4.</p> <p>\uc804\uccb4 \ud0d0\uc0c9 \uacfc\uc815\uc5d0\uc11c \\(i\\)\ub294 \ub2e8\uc870\uc99d\uac00\ud558\uace0, \ud0d0\uc0c9\ud558\ub294 \ubb38\uc790\uc5f4 \\(T\\)\ub97c \uc624\ub978\ucabd\uc73c\ub85c \uc774\ub3d9\uc2dc\ud0a4\ub2c8 \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(N+M)\\)\uc774\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N+M)\\)</p>","tags":["kmp","string","~ algorithm"]},{"location":"algorithms/Strings/KMP/algorithm/#implementation","title":"Implementation","text":"<pre><code>// Get failure function of S\n// getFail(S = \"?ababca\") = [-1, 0, 0, 1, 2, 0, 1]\nvector&lt;int&gt; getFail(string S) // S is 1-based (leading \"?\")\n{\n    int N=S.size()-1;\n    vector&lt;int&gt; fail(N+1);\n\n    fail[0]=-1;\n    for(int i=1; i&lt;=N; i++)\n    {\n        int j=fail[i-1];\n        while(j&gt;=0 &amp;&amp; S[j+1]!=S[i]) j=fail[j];\n        fail[i]=j+1;\n    }\n    return fail;\n}\n\n// Find occurences of T in S\n// KMP(S = \"?aabcbabaaa\", T = \"?aa\") = [1, 8, 9]\nvector&lt;int&gt; KMP(string S, string T) // S, T is 1-based (leading \"?\")\n{\n    int N=S.size()-1, M=T.size()-1;\n    vector&lt;int&gt; fail = getFail(T);\n    vector&lt;int&gt; ans;\n\n    for(int i=1, j=0; i&lt;=N; i++)\n    {\n        while(j&gt;=0 &amp;&amp; T[j+1]!=S[i]) j=fail[j];\n        j++;\n        if(j==M) ans.push_back(i-M+1), j=fail[j];\n    }\n    return ans;\n}\n</code></pre>","tags":["kmp","string","~ algorithm"]},{"location":"algorithms/Strings/KMP/algorithm/#reference","title":"Reference","text":"<ul> <li>https://cp-algorithms.com/string/prefix-function.html</li> <li>https://m.blog.naver.com/kks227/220917078260</li> </ul>","tags":["kmp","string","~ algorithm"]},{"location":"algorithms/Strings/Lyndon%20Decomposition/algorithm/","title":"Lyndon Decomposition","text":"","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Lyndon%20Decomposition/algorithm/#lyndon-word","title":"Lyndon Word","text":"<p>Definition 1</p> <p>\ubb38\uc790\uc5f4 \\(S\\)\uac00 lyndon word (simple word)\ub77c\ub294 \uac83\uc740 \\(S\\)\uac00 \\(S\\)\uc758 \ubaa8\ub4e0 proper suffix\ubcf4\ub2e4 \uc0ac\uc804\uc21c\uc73c\ub85c \uc791\ub2e4\ub294 \uc758\ubbf8\uc774\ub2e4. \uc989, \\(S\\)\uc758 suffix array\ub97c \uad6c\ud588\uc744 \ub54c, \uccab \ubc88\uc9f8 \uce78\uc774 \\(1\\)(\\(S\\) \uc804\uccb4)\uc774\ub2e4.</p> <p>Lyndon word\uc758 \uc608\ub85c\ub294 \"a\", \"ab\", \"aab\", \"abb\", \"abcd\", \"abac\"\uac00 \uc788\ub2e4.</p> <p>Property 1</p> <p>\\(S\\)\uac00 lyndon word\uc77c \ub54c, \\(fail[S]=0\\)\uc774\ub2e4. \uc989, \\(S\\)\uc758 \uc5b4\ub5a4 prefix\uc640 suffix\ub3c4 \ub3d9\uc77c\ud558\uc9c0 \uc54a\ub2e4.</p> <p>Proof</p> <p>\\(S\\)\uc758 prefix\uc640 suffix\uac00 \uac19\uc740 proper suffix \\(S'\\)\uc774 \uc874\uc7ac\ud55c\ub2e4\uace0 \uac00\uc815\ud558\uc790. \\(S\\)\uc640 \\(S'\\)\uc744 \ube44\uad50\ud558\uba74, \uc55e\ubd80\ubd84\uc740 \\(S'\\)\uc73c\ub85c \ub3d9\uc77c\ud558\uace0, \\(S\\)\ub294 \ub4a4\uc5d0 \ubb38\uc790\uc5f4\uc774 \uc774\uc5b4\uc9c0\ub2c8 \uc0ac\uc804\uc21c\uc73c\ub85c \ube44\uad50\ud588\uc744 \ub54c \\(S\\)\uac00 \ub354 \ud06c\ub2e4. \ub530\ub77c\uc11c, \\(S\\)\uac00 lyndon word\uc784\uc5d0 \ubaa8\uc21c\uc774\ub2e4.</p> <p></p> <p></p> <p>Property 2</p> <p>\ub2e4\uc74c \ub450 \uba85\uc81c\ub294 \ub3d9\uce58\uc774\ub2e4.</p> <ul> <li>\\(S\\)\uac00 lyndon word\uc774\ub2e4.</li> <li>\\(S\\)\ub294 \\(S\\)\uc758 \ubaa8\ub4e0 cyclic shift\ubcf4\ub2e4 \uc0ac\uc804\uc21c\uc73c\ub85c \uc791\ub2e4. (\uac19\uc744 \uc218\ub3c4 \uc5c6\ub2e4.)</li> </ul> <p>Proof</p> <p>(\\(\\Rightarrow\\)) \\(S\\)\uac00 lyndon word\ub77c\uace0 \ud558\uace0, \\(S\\)\uc758 proper suffix \\(S'\\)\uc5d0\uc11c \uc2dc\uc791\ud558\ub294 cyclic shift \\(C\\)\ub97c \uc0dd\uac01\ud558\uc790. \\(S&lt;S'\\)\uc774\uace0, Property 1\uc5d0 \uc758\ud574 \\(S\\)\uc640 \\(C\\)\uc744 \uc55e\uc5d0\uc11c\ubd80\ud130 \ube44\uad50\ud558\uc600\uc744 \ub54c \ucd5c\ucd08\ub85c \ub2e4\ub978 \ubb38\uc790\ub294 \\(S'\\)\uc774 \ub05d\ub098\uae30 \uc804\uc5d0 \ub4f1\uc7a5\ud55c\ub2e4. \ub530\ub77c\uc11c, \\(S\\)\uc640 \\(C\\)\uc758 \ub300\uc18c\uad00\uacc4\ub294 \\(S\\)\uc640 \\(S'\\)\uc758 \ub300\uc18c\uad00\uacc4\uc640 \ub3d9\uc77c\ud558\uba70, \\(S&lt;C\\)\uc774\ub2e4.</p> <p></p> <p>(\\(\\Leftarrow\\)) \\(S\\)\ub294 \\(S\\)\uc758 \ubaa8\ub4e0 cyclic shift\ubcf4\ub2e4 \uc0ac\uc804\uc21c\uc73c\ub85c \uc791\ub2e4\uace0 \ud558\uc790. \\(S\\)\uc758 \uc784\uc758\uc758 cyclic shift \\(C\\)\ub97c \uc0dd\uac01\ud558\uba74, \\(C\\)\ub294 \\(S\\)\uc758 suffix \\(S'\\)\uc5d0\uc11c \uc2dc\uc791\ud55c\ub2e4. \\(C\\)\uacfc \\(S\\)\ub97c \uc55e\uc5d0\uc11c\ubd80\ud130 \ube44\uad50\ud558\uc600\uc744 \ub54c \ucd5c\ucd08\ub85c \ub2e4\ub978 \ubb38\uc790\uac00 \\(S'\\)\uc774 \ub05d\ub09c \ud6c4\uc5d0 \ub4f1\uc7a5\ud558\uc600\ub2e4\uace0 \uac00\uc815\ud558\uc790. \uadf8\ub807\ub2e4\uba74 \\(S'\\)\uc740 \\(S\\)\uc758 prefix\uc774\uae30\ub3c4 \ud558\uace0, \\(S=A+S'=S'+B\\)\ub85c \ud45c\ud604\ud560 \uc218 \uc788\ub2e4. \ub610\ud55c, cyclic shift \\(B+S'\\)\uc744 \\(C'\\)\uc774\ub77c \ud45c\ud604\ud558\uba74 \ub2e4\uc74c \uc2dd\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> \\[S&lt;C \\Rightarrow S=S'+B&lt;C=S'+A \\Rightarrow B&lt;A \\Rightarrow B+S'&lt;A+S' \\Rightarrow C'&lt;S\\] <p>\ud558\uc9c0\ub9cc, \uc704 \uc2dd\uc5d0 \uc758\ud574 \\(C'&lt;S\\)\uc774\uace0, \uc774\ub294 \\(S\\)\uac00 \\(S\\)\uc758 \ubaa8\ub4e0 cyclic shift\ubcf4\ub2e4 \uc0ac\uc804\uc21c\uc73c\ub85c \uc791\uc74c\uc5d0 \ubaa8\uc21c\uc774\ub2e4. \ub530\ub77c\uc11c \\(C\\)\uacfc \\(S\\)\ub97c \uc55e\uc5d0\uc11c\ubd80\ud130 \ube44\uad50\ud558\uc600\uc744 \ub54c \ucd5c\ucd08\ub85c \ub2e4\ub978 \ubb38\uc790\ub294 \\(S'\\)\uc774 \ub05d\ub098\uae30 \uc804\uc5d0 \ub4f1\uc7a5\ud558\uace0, \\(S&lt;C\\)\uc774\ub2c8 \\(S&lt;S'\\)\uc774 \uc131\ub9bd\ud55c\ub2e4. \ub530\ub77c\uc11c \\(S\\)\ub294 lyndon word\uc774\ub2e4.</p> <p></p> <p>Property 2\uc5d0 \uc758\ud574, lyndon word\ub294 \"\\(S\\)\uac00 \\(S\\)\uc758 \ubaa8\ub4e0 proper suffix\ubcf4\ub2e4 \uc0ac\uc804\uc21c\uc73c\ub85c \uc791\ub2e4\"\ub294 \uc870\uac74\uc774\ub098 \"\\(S\\)\ub294 \\(S\\)\uc758 \ubaa8\ub4e0 cyclic shift\ubcf4\ub2e4 \uc0ac\uc804\uc21c\uc73c\ub85c \uc791\ub2e4\"\ub294 \uc870\uac74\uc744 \ub9cc\uc871\uc2dc\ud0a4\uba74 \ub41c\ub2e4.</p> <p>Property 3</p> <p>\\(L_1, L_2\\)\uac00 lyndon word\ub77c \ud558\uc790. \ub2e4\uc74c \ub450 \uba85\uc81c\ub294 \ub3d9\uce58\uc774\ub2e4.  </p> <ul> <li>\\(L_1+L_2 &lt; L_2+L_1\\)</li> <li>\\(L_1+L_2\\)\ub294 lyndon word\uc774\ub2e4.</li> </ul> <p>Proof</p> <p>(\\(\\Rightarrow\\)) \\(L_1+L_2\\)\uac00 lyndon word\uc784\uc744 \ubcf4\uc774\uae30 \uc704\ud558\uc5ec \\(L_1+L_2\\)\uc758 \ubaa8\ub4e0 cyclic shift\uc640 \\(L_1+L_2\\)\ub97c \ube44\uad50\ud558\uc790. \\(L_1\\)\uc758 suffix\ub85c \uc2dc\uc791\ud558\ub294 cyclic shift \\(S'\\)\uc758 \uacbd\uc6b0, lyndon word\uc758 \uc815\uc758\uc5d0 \uc758\ud574 \\(L_1&lt;\\text{suff} L_1\\)\uc774\ub2c8 \\(L_1+L_2&lt;S'\\)\uc774\ub2e4. \\(L_2\\)\ub85c \uc2dc\uc791\ud558\ub294 cyclic shift \\(L_2+L_1\\)\uc758 \uacbd\uc6b0, \uac00\uc815\uc5d0 \uc758\ud574\uc11c \\(L_1+L_2 &lt; L_2+L_1\\)\uc774\ub2e4. \\(L_2\\)\uc758 suffix\ub85c \uc2dc\uc791\ud558\ub294 cyclic shift \\(S''\\)\uc758 \uacbd\uc6b0, lyndon word\uc758 \uc815\uc758\uc5d0 \uc758\ud574 \\(L_2&lt;\\text{suff} L_2\\)\uc774\ub2c8 \\(L_1+L_2&lt;L_2+L_1&lt;S''\\)\uc774\ub2e4.</p> <p></p> <p>(\\(\\Leftarrow\\)) \\(L_2+L_1\\)\uc740 \\(L_1+L_2\\)\uc758 cyclic shift\uc774\uace0, \ub530\ub77c\uc11c Property 2\uc5d0 \uc758\ud574 \\(L_1+L_2&lt;L_2+L_1\\)\uc774\ub2e4.</p> <p></p> <p>Property 4</p> <p>\\(L_1, L_2\\)\uac00 lyndon word\ub77c \ud558\uc790. \ub2e4\uc74c \ub450 \uba85\uc81c\ub294 \ub3d9\uce58\uc774\ub2e4.  </p> <ul> <li>\\(L_1&lt;L_2\\)</li> <li>\\(L_1+L_2&lt;L_2+L_1\\)</li> </ul> <p>Proof</p> <p>(\\(\\Rightarrow\\)) \ub9cc\uc57d \\(L_1\\)\uc774 \\(L_2\\)\uc758 prefix\uac00 \uc544\ub2c8\ub77c\uba74, \uc55e\uc5d0\uc11c\ubd80\ud130 \ube44\uad50\ud560 \ub54c \\(L_1\\)\uc640 \\(L_2\\)\uac00 \ub2ec\ub77c\uc9c0\ub294 \uc810\uc740 \\(L_1\\)\uc774 \ub05d\ub098\uae30 \uc804\uc774\ub2c8, \\(L_1+L_2&lt;L_2+L_1\\)\ub3c4 \ub2f9\uc5f0\ud788 \uc131\ub9bd\ud55c\ub2e4. \uc774\uc81c, \\(L_1\\)\uc774 \\(L_2\\)\uac00 prefix, \\(L_2=L_1+S\\)\ub77c\uace0 \uac00\uc815\ud558\uc790. \\(L_1+L_2=L_1+L_1+S\\), \\(L_2+L_1=L_1+S+L_1\\)\uc744 \ube44\uad50\ud558\uba74, \\(L_1+S\\), \\(S+L_1\\)\uc744 \ube44\uad50\ud55c \uac83\uacfc \uac19\uace0 \\(S+L_1\\)\uc740 \\(L_2\\)\uc758 cyclic shift\uc774\uae30 \ub54c\ubb38\uc5d0 Property 2\uc5d0 \uc758\ud574 \\(L_1+S&lt;S+L_1\\)\uac00 \uc131\ub9bd\ud55c\ub2e4. \ub530\ub77c\uc11c \\(L_1+L_2&lt;L_2+L_1\\)\uac00 \uc131\ub9bd\ud55c\ub2e4.</p> <p></p> <p>(\\(\\Leftarrow\\)) \\(L_1+L_2&lt;L_2+L_1\\)\uac00 \uc131\ub9bd\ud55c\ub2e4\uba74 Property 4\uc5d0 \uc758\ud574 \\(L_1+L_2\\)\ub294 lyndon word\uc774\ub2e4. \ub2f9\uc5f0\ud788 \\(L_1&lt;L_1+L_2\\)\uac00 \uc131\ub9bd\ud558\uba70, lyndon word\uc5d0 \uc815\uc758\uc5d0 \uc758\ud574 \\(L_1+L_2&lt;L_2\\)\uac00 \uc131\ub9bd\ud55c\ub2e4. \ub530\ub77c\uc11c \\(L_1&lt;L_1+L_2&lt;L_2\\), \\(L_1&lt;L_2\\)\uc774\ub2e4.</p> <p></p> <p>\ub530\ub77c\uc11c, Property 3\uacfc Property 4\uc5d0 \uc758\ud574 \ub2e4\uc74c\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> <p>Property 5</p> <p>\\(L_1, L_2\\)\uac00 lyndon word\ub77c \ud558\uc790. \\(L_1&lt;L_2\\)\ub77c\uba74 \\(L_1+L_2\\)\ub294 lyndon word\uc774\ub2e4.</p> <p>Property 5\ub294 \ub2e4\uc74c \ubb38\ub2e8\uc5d0\uc11c \ub2e4\ub8f0 lyndon decomposition\uc774 \ubb38\uc790\uc5f4 \\(S\\)\ub97c lyndon word\ub4e4\ub85c \ucabc\uac1c\ub294 minimal decomposition\uc784\uc744 \uc99d\uba85\ud560 \uc218 \uc788\uac8c \ud574\uc900\ub2e4.</p>","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Lyndon%20Decomposition/algorithm/#lyndon-decomposition_1","title":"Lyndon Decomposition","text":"<p>Definition 2</p> <p>\ubb38\uc790\uc5f4 \\(S\\)\uc5d0 \ub300\ud558\uc5ec \\(S\\)\uc758 lyndon decomposition\uc740 \\(S\\)\ub97c \\(S=w_1 w_2 \\cdots w_k\\)\ub85c \ucabc\uac1c, \\(w_1, w_2, \\cdots, w_k\\)\uac00 \ubaa8\ub450 lyndon word\uc774\uba70, \\(w_1 \\ge w_2 \\ge \\cdots \\ge w_k\\)\ub97c \ub9cc\uc871\ud558\uac8c \ud558\ub294 \ubd84\ud560\uc774\ub2e4.</p> <p>Property 6</p> <p>\uc784\uc758\uc758 \ubb38\uc790\uc5f4 \\(S\\)\uc758 lyndon decomposition\uc740 \uc720\uc77c\ud558\uac8c \uc874\uc7ac\ud55c\ub2e4.</p> <p>Proof</p> <p>(Existence) \ubb38\uc790\uc5f4 \\(S\\)\uc758 \uac01 \ubb38\uc790\ub97c \ud558\ub098\uc529 lyndon word\ub4e4\ub85c \uc0dd\uac01\ud560 \uc218 \uc788\ub2e4. (\ud55c \ubb38\uc790\ub85c \uad6c\uc131\ub41c \ubb38\uc790\uc5f4 \ub610\ud55c lyndon word\uc774\ub2e4.) \uc774\uc81c, Property 5\ub97c \uc774\uc6a9\ud558\uc5ec \uc778\uc811\ud55c lyndon word\ub4e4 \uc911 \\(L_1&lt;L_2\\)\ub97c \ub9cc\uc871\ud558\ub294 \ub450 \ubb38\uc790\uc5f4\uc744 \uace8\ub77c \\(L_1+L_2\\)\ub85c \ud569\uccd0\uc8fc\ub294 \uacfc\uc815\uc744 \ubc18\ubcf5\ud558\uc790. \\(L_1+L_2\\) \ub610\ud55c lyndon word \uc774\uae30 \ub54c\ubb38\uc5d0 \ubcd1\ud569 \uacfc\uc815\uc5d0\uc11c \ub4f1\uc7a5\ud558\ub294 \ubaa8\ub4e0 \ubb38\uc790\uc5f4\ub4e4\uc740 lyndon word\uc774\ub2e4. \ub354 \uc774\uc0c1 \uc774 \uacfc\uc815\uc744 \uc2e4\ud589\ud558\uc9c0 \ubabb\ud560 \ub54c \ucabc\uac1c\uc9c4 lyndon word\ub4e4\uc740 \\(w_1 \\ge w_2 \\ge \\cdots \\ge w_k\\)\ub97c \ub9cc\uc871\ud558\ub2c8, lyndon decomposition\uc740 \uc874\uc7ac\ud55c\ub2e4.</p> <p>(Uniqueness) \\(S\\)\uc758 lyndon decomposition\uc774 \uc720\uc77c\ud558\uac8c \uc874\uc7ac\ud568\uc744, \\(S\\)\uc758 \uae38\uc774 \\(len(S)\\)\uc5d0 \ub300\ud55c \uadc0\ub0a9\ubc95\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc99d\uba85\ud558\uc790. \ub9cc\uc57d \\(S\\)\uc758 \uc11c\ub85c \ub2e4\ub978 \ub450 lyndon decomposition \\(S=w_1 w_2 \\cdots w_k\\), \\(S=v_1 v_2 \\cdots v_m\\)\uc774 \uc874\uc7ac\ud558\uace0, \uc77c\ubc18\uc131\uc744 \uc783\uc9c0 \uc54a\uace0 \\(len(w_1) \\le len(v_1)\\)\uc774\ub77c \ud558\uc790. \ub9cc\uc57d \\(len(w_1)=len(v_1)\\)\uc774\uba74 \\(w_1=v_1\\)\uc774\uace0 \uadc0\ub0a9\uc801\uc73c\ub85c \\(S=w_1+S'\\)\uc5d0\uc11c \\(S'\\)\uc758 lyndon decomposition\uc774 unique\ud558\ub2c8 \uc99d\uba85\uc774 \uc885\ub8cc\ub41c\ub2e4. \\(len(w_1)&lt;len(v_1)\\)\ub77c\uba74 \uc544\ub798 \uadf8\ub9bc\uacfc \uac19\uc774 \\(len(w_1)+len(w_2)+\\cdots+len(w_p) \\ge len(v_1)\\)\uc778 \ucd5c\uc18c\uc758 \\(1 &lt; p \\le k\\)\uac00 \uc874\uc7ac\ud55c\ub2e4. \\(w_p\\)\uc758 \uae38\uc774 \\(len(v_1)-(len(w_1)+len(w_2)+\\cdots+len(w_{p-1}))\\)\uc778 prefix\ub97c \\(w_p'\\)\uc774\ub77c \ud558\uba74 \\(w_p' &lt; w_p \\le w_{p-1} \\le \\cdots \\le w_1 &lt; v_1\\)\uc774 \uc131\ub9bd\ud55c\ub2e4. \\(v_1\\)\uc758 suffix\uc778 \\(w_p'\\)\uc5d0 \ub300\ud574 \\(w_p' &lt; v_1\\)\uc778\ub370, \uc774\ub294 \\(v_1\\)\uc774 lyndon word\uc784\uc5d0 \ubaa8\uc21c\uc774\ub2e4. \ub530\ub77c\uc11c lyndon decomposition\uc740 \uc720\uc77c\ud558\ub2e4.</p> <p></p>","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Lyndon%20Decomposition/algorithm/#algorithm","title":"Algorithm","text":"","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Lyndon%20Decomposition/algorithm/#algorithm-using-suffix-array","title":"Algorithm using Suffix Array","text":"<p>\\(S\\)\uac00 lyndon word\ub77c\uba74, \\(S\\)\uc758 suffix array\ub97c \uad6c\ud588\uc744 \ub54c \uccab \ubc88\uc9f8 \uce78\uc774 \\(1\\)(\\(S\\) \uc804\uccb4)\uc784\uc744 \uc0dd\uac01\ud558\uc790. \ubb38\uc790\uc5f4 \\(S\\)\uc758 suffix array\uc5d0\uc11c \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub97c \uc120\ud0dd\ud558\uba74, \ud574\ub2f9 suffix\ub294 lyndon word\uc774\ub2e4. \uadf8\ub807\ub2e4\uba74 \ubc18\ubcf5\uc801\uc73c\ub85c suffix array\uc5d0\uc11c \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub97c \uc81c\uac70\ud574 \ub098\uac00\uba70 lyndon decomposition\uc744 \uad6c\ud560 \uc218 \uc788\uc744\uae4c?</p> <p>Property 7</p> <p>\ubc18\ubcf5\uc801\uc73c\ub85c suffix array\uc5d0\uc11c \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub97c \uc81c\uac70\ud574 \ub098\uac00\uba74 lyndon decomposition\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\ubb38\uc790\uc5f4 \\(S\\)\uc758 lyndon decomposition\uc758 \ub9c8\uc9c0\ub9c9 lyndon word\ub294 \\(S\\)\uc758 suffix array\uc5d0\uc11c \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\uc774\ub2e4.</p> <p>Proof</p> <p>\ubc18\ubcf5\uc801\uc73c\ub85c suffix array\uc5d0\uc11c \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix \\(v_1\\)\ub97c \uc81c\uac70\ud574 \ub098\uac00\uba74 \uac01 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc740 lyndon word\uc784\uc740 \uc790\uba85\ud558\ub2e4. (lyndon word\uc758 \uc815\uc758\uc5d0 \uc758\ud574 \\(v_1\\)\uc758 suffix array\ub97c \uad6c\ud588\uc744 \ub54c, \uccab \ubc88\uc9f8 \uce78\uc774 \\(1\\)(\\(v_1\\) \uc804\uccb4)\uc774\ub2e4.)</p> <p>\uc774\uc81c, \uc62c\ubc14\ub978 lyndon decomposition\uc784\uc744 \ubcf4\uc774\uae30 \uc704\ud574\uc11c \uc704 \uc54c\uace0\ub9ac\uc998\uc73c\ub85c \uc81c\uac70\ud55c \ucc98\uc74c \\(2\\)\uac1c\uc758 suffix\ub97c \uc21c\uc11c\ub300\ub85c \\(v_1, v_2\\)\ub77c \ud558\uc790. Lyndon decomposition\uc758 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub824\uba74 \\(v_2 \\ge v_1\\)\uc5ec\uc57c \ud558\uace0, \uc774 \uc0ac\uc2e4\ub9cc \ubcf4\uc778\ub2e4\uba74 \uadc0\ub0a9\uc801\uc73c\ub85c \uc99d\uba85\uc774 \uc885\ub8cc\ub41c\ub2e4. \ub9cc\uc57d \\(v_2 &lt; v_1\\)\uc774\ub77c \uac00\uc815\ud558\uc790. Property 5\uc5d0 \uc758\ud574 \\(v_2+v_1\\)\ub294 lyndon word\uc774\uace0, \\(v_2+v_1&lt;v_1\\)\uc774 \uc131\ub9bd\ud55c\ub2e4. \ud558\uc9c0\ub9cc \\(v_2+v_1\\), \\(v_1\\) \ubaa8\ub450 \\(S\\)\uc758 suffix\uc774\uace0, \\(v_1\\)\uc774 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\uc784\uc5d0 \ubaa8\uc21c\uc774\ub2e4. \ub530\ub77c\uc11c, \\(v_2 \\ge v_1\\)\uc774\ub2e4.</p> <p>\uc989, \uc704 \uc54c\uace0\ub9ac\uc998\uc744 \uc2e4\ud589\ud558\uc5ec \uc5bb\ub294 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc740 \\(w_1, w_2, \\cdots w_k\\)\uac00 lyndon word\uc774\uba70 \\(w_1 \\ge w_2 \\ge \\cdots \\ge w_k\\)\ub97c \ub9cc\uc871\ud558\uba70, Property 6\uc5d0 \uc758\ud574 \uc774\ub294 \uc720\uc77c\ud55c lyndon decomposition\uc774\ub2e4. \ub610\ud55c, \ubb38\uc790\uc5f4 \\(S\\)\uc758 lyndon decomposition\uc758 \ub9c8\uc9c0\ub9c9 lyndon word\ub294 \\(S\\)\uc758 suffix array\uc5d0\uc11c \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\uc774\ub2e4.</p> <p>\uc784\uc758\uc758 suffix\ub97c \uc81c\uac70\ud55c\ub2e4\uace0 \ud574\uc11c \uc77c\ubc18\uc801\uc73c\ub85c \ub0a8\uc740 suffix\ub4e4\uc758 \uc0ac\uc804\uc21c \uc21c\uc11c\uac00 \ubcc0\ud558\uc9c0 \uc54a\ub294\uac83\uc740 \uc544\ub2c8\ub2e4. \uc608\ub97c \ub4e4\uc5b4, \"abac &lt; ac\"\uc774\uc9c0\ub9cc, c\ub97c \uc81c\uac70\ud55c \ud6c4 \"aba &gt; a\"\uc774\ub2e4. \ud558\uc9c0\ub9cc, \ud604\uc7ac \uc0c1\ud669\uc740 suffix array\uc5d0\uc11c \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub97c \uc81c\uac70\ud574 \ub098\uac00\ub294 \uc0c1\ud669\uc774\ub2e4.</p> <p>Property 8</p> <p>\ubb38\uc790\uc5f4 \\(S\\)\uc758 suffix array\uc5d0\uc11c \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix \\(T\\)\ub97c \uc81c\uac70\ud558\uba74, \ub0a8\uc740 \ubb38\uc790\uc5f4 \\(S'\\)\uc758 suffix\ub4e4\uc758 \uc0ac\uc804\uc21c \uc21c\uc11c\ub294 \ubcc0\ud558\uc9c0 \uc54a\ub294\ub2e4.</p> <p>Proof</p> <p>\\(S'\\)\uc5d0\uc11c \uc0ac\uc804\uc21c \uc704\uce58\uad00\uacc4\uac00 \ub4a4\ubc14\ub010 \ub450 suffix\ub97c \\(P_1\\), \\(P_2\\)\ub77c \ud558\uc790. \uc989, \\(S'\\)\uc5d0\uc11c\ub294 \\(P_1&lt;P_2\\)\uc774\uc9c0\ub9cc \\(S\\)\uc5d0\uc11c\ub294 \\(P_1+T&gt;P_2+T\\)\uc774\ub2e4. \ub9cc\uc57d \\(P_1\\)\uc774 \\(P_2\\)\uc758 prefix\uac00 \uc544\ub2c8\ub77c\uba74 \\(P_1+T\\)\uc640 \\(P_2+T\\)\uc758 \ub300\uc18c\uad00\uacc4\ub3c4 \\(P_1\\)\uacfc \\(P_2\\)\uc758 \ub300\uc18c\uad00\uacc4\uc640 \uac19\uc544\uc57c \ud55c\ub2e4. \uc989, \\(P_1\\)\uc740 \\(P_2\\)\uc758 prefix\uc5ec\uc57c \ud558\ub294\ub370, \\(S'\\)\uc5d0\uc11c \uae38\uc774 \\(len(P_2)-len(P_1)\\)\uc778 suffix\ub97c \\(P_3\\)\ub77c \ud558\uc790. \\(P_1\\)\uc740 \\(P_2\\)\uc758 prefix\uc774\uae30 \ub54c\ubb38\uc5d0 \\(P_1+T\\)\uc640 \\(P_2+T\\)\uc758 \ub300\uc18c\uad00\uacc4\ub294 \\(T\\)\uc640 \\(P_3+T\\)\uc758 \ub300\uc18c\uad00\uacc4\uc640 \uac19\uace0, \\(T\\)\uac00 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 suffix\uc774\uae30 \ub54c\ubb38\uc5d0 \\(T&lt;P_3+T\\)\uac00 \uc131\ub9bd\ud55c\ub2e4. \uc774\ub294 \\(P_1+T&gt;P_2+T\\)\uc5d0 \ubaa8\uc21c\uc774\ub2e4. \ub530\ub77c\uc11c, \ub0a8\uc740 \ubb38\uc790\uc5f4 \\(S'\\)\uc758 suffix\ub4e4\uc758 \uc0ac\uc804\uc21c \uc21c\uc11c\ub294 \ubcc0\ud558\uc9c0 \uc54a\ub294\ub2e4.</p> <p>\ub530\ub77c\uc11c, \uc804\uccb4 \ubb38\uc790\uc5f4 \\(S\\)\uc758 suffix array\ub97c \uad6c\ud55c \ud6c4, \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix \\(T\\)\ub97c \uc81c\uac70\ud558\uace0, \ud604\uc7ac\uc758 suffix array \uc704\uc5d0\uc11c \ub0a8\uc740 prefix\uc5d0 \ub300\ud558\uc5ec \uc774\ub97c \ubc18\ubcf5\ud558\uba74 \\(S\\)\uc758 lyndon decomposition\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 suffix array\ub97c \uad6c\ud558\ub294 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(O(N)\\) \ud639\uc740 \\(O(N\\log N)\\)\uacfc \uac19\ub2e4.</p> <p>Algorithm 1</p> <p>\uc804\uccb4 \ubb38\uc790\uc5f4 \\(S\\)\uc758 suffix array\ub97c \uad6c\ud55c \ud6c4, \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix \\(T\\)\ub97c \uc81c\uac70\ud558\uace0, \ud604\uc7ac\uc758 suffix array \uc704\uc5d0\uc11c \ub0a8\uc740 prefix\uc5d0 \ub300\ud558\uc5ec \uc774\ub97c \ubc18\ubcf5\ud558\uba74 \\(S\\)\uc758 lyndon decomposition\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N)\\) or \\(O(N\\log N)\\)</p>","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Lyndon%20Decomposition/algorithm/#duval-algorithm","title":"Duval Algorithm","text":"<p>Definition 3</p> <p>\ubb38\uc790\uc5f4 \\(T\\)\uac00 pre-lyndon word\ub77c\ub294 \uac83\uc740 \\(w\\)\ub294 lyndon word, \\(\\overline{w}\\)\ub294 \\(w\\)\uc758 prefix\uc77c \ub54c \\(T=ww \\cdots w \\overline{w}\\)\uc758 \ud615\ud0dc\ub85c \ud45c\ud604\ud560 \uc218 \uc788\ub2e4\ub294 \uac83\uc774\ub2e4. (\\(\\overline{w}\\)\ub294 \ube48 \ubb38\uc790\uc5f4\uc77c \uc218 \uc788\ub2e4.)</p> <p>Duval algorithm\uc740 lyndon decomposition\uc744 \ubb38\uc790\ub97c \ud558\ub098\uc529 \ucd94\uac00\ud558\uba70 incremental \ud558\uac8c \uad6c\ud55c\ub2e4. \ubb38\uc790\uc5f4 \\(S\\)\uc758 \uc0c1\ud0dc\ub294 \\(s_1s_2s_3\\)\ub85c \ud45c\ud604\ud560 \uc218 \uc788\uace0, \\(s_1\\)\uc740 \uc774\ubbf8 lyndon decomposition\uc744 \ucc3e\uc558\uace0 \ud655\uc815\ud55c \uc0c1\ud0dc, \\(s_2\\)\ub294 \ud604\uc7ac \ud0d0\uc0c9\ud558\uace0 \uc788\ub294 \uc911\uc778 pre-lyndon word, \\(s_3\\)\ub294 \uc544\uc9c1 \ud0d0\uc0c9\ud558\uc9c0 \uc54a\uc740 \uc0c1\ud0dc\uc784\uc744 \uc758\ubbf8\ud55c\ub2e4. \uc54c\uace0\ub9ac\uc998\uc740 \ubc18\ubcf5\uc801\uc73c\ub85c \uc544\uc9c1 \ud0d0\uc0c9\ud558\uc9c0 \uc54a\uc740 \\(s_3\\)\uc758 \uccab \ubc88\uc9f8 \ubb38\uc790\ub97c \uaebc\ub0b4 \\(s_2\\)\uc5d0 \ucd94\uac00\ud558\ub824\uace0 \ud55c\ub2e4. \\(i\\)\ub294 \\(s_2\\)\uc758 \uccab \ubc88\uc9f8 \uc704\uce58, \\(j\\)\ub294 \\(s_3\\)\uc758 \uccab \ubc88\uc9f8 \uc704\uce58, \\(k\\)\ub294 \uc0c8\ub85c\uc6b4 \ubb38\uc790\ub97c \ucd94\uac00\ud560 \ub54c \uc544\uc9c1 \\(s_2\\)\uac00 pre-lyndon word\uc778\uc9c0 \ube44\uad50\ud558\uae30 \uc704\ud55c \\(s_2\\) \uc911\uc758 \uc704\uce58\ub97c \uc758\ubbf8\ud55c\ub2e4. \uc0c8\ub85c \ucd94\uac00\ud560 \ubb38\uc790 \\(s[j]\\)\uc640 \\(s[k]\\)\ub97c \ube44\uad50\ud558\uc5ec \uacb0\uacfc\uc5d0 \ub530\ub77c \ub2e4\uc74c\uacfc \uac19\uc774 \uc791\ub3d9\ud55c\ub2e4.</p> <p>(Case 1) \\(s[j]=s[k]\\) \\(s_2\\)\uc5d0 \\(s[j]\\)\ub97c \ucd94\uac00\ud558\uace0 \ub09c \ud6c4\uc5d0\ub3c4 pre-lyndon word\uc774\ub2c8, \\(j\\)\uc640 \\(k\\)\ub97c \\(1\\) \uc99d\uac00\uc2dc\ud0a8\ub2e4.</p> <p>(Case 2) \\(s[j]&gt;s[k]\\) \\(s_2\\)\uc5d0 \\(s[j]\\)\ub97c \ucd94\uac00\ud558\uace0 \ub098\uba74 pre-lyndon word\uc774 \uc544\ub2cc, lyndon word\uac00 \ub41c\ub2e4. \ub530\ub77c\uc11c \\(s_2+s[j]\\) \uc804\uccb4\ub97c \ud558\ub098\uc758 lyndon word\ub85c \ucde8\uae09\ud558\uace0 \ub2e4\uc74c\ubd80\ud130\ub294 \ube44\uad50\ub97c \\(s_2\\)\uc758 \uccab \uc704\uce58\ubd80\ud130 \ub2e4\uc2dc \ud55c\ub2e4. \\(j\\)\ub294 \\(1\\) \uc99d\uac00\uc2dc\ud0a4\uace0, \\(k\\)\ub294 \ub2e4\uc2dc \\(s_2\\)\uc758 \uccab \ubc88\uc9f8 \uc704\uce58\uc778 \\(i\\)\ub85c \ucd08\uae30\ud654\uc2dc\ud0a8\ub2e4.</p> <p>(Case 3) \\(s[j]&lt;s[k]\\) \\(s_2\\)\uc5d0 \\(s[j]\\)\ub97c \ucd94\uac00\ud558\uace0 \ub098\uba74 \ub354 \uc774\uc0c1 pre-lyndon\ub3c4, lyndon word\ub3c4 \uc544\ub2c8\uac8c \ub41c\ub2e4. \uc774\uc81c \uc9c0\uae08\uae4c\uc9c0 \ucc3e\uc740 \\(s_2\\)\uc758 lyndon word\ub4e4 (\\(s_2=ww \\cdots w \\overline{w}\\)\uc5d0\uc11c \\(ww \\cdots w\\))\ub97c \\(s_1\\)\uc5d0 \ub123\uc5b4\uc8fc\uace0 \ube44\uad50\ub97c \uacc4\uc18d\ud558\uba74 \ub41c\ub2e4. \\(w\\)\uc758 \uae38\uc774\ub294 \\(j-k\\)\uac00 \ub418\uace0, \ub530\ub77c\uc11c \\(i\\)\uc5d0\uc11c\ubd80\ud130 \uae38\uc774 \\(j-k\\)\uc529 lyndon word\ub4e4\uc744 \\(s_1\\)\uc5d0 \ub123\uc5b4\uc8fc\uba74 \ub41c\ub2e4.</p> <p>Algorithm 1</p> <p>Lyndon decomposition\uc744 \ubb38\uc790\ub97c \ud558\ub098\uc529 \ucd94\uac00\ud558\uba70 incremental \ud558\uac8c \uad6c\ud55c\ub2e4. \ubb38\uc790\uc5f4 \\(S\\)\uc758 \uc0c1\ud0dc\ub294 \\(s_1s_2s_3\\)\ub85c \ud45c\ud604\ud560 \uc218 \uc788\uace0, \\(s_1\\)\uc740 \uc774\ubbf8 lyndon decomposition\uc744 \ucc3e\uc558\uace0 \ud655\uc815\ud55c \uc0c1\ud0dc, \\(s_2\\)\ub294 \ud604\uc7ac \ud0d0\uc0c9\ud558\uace0 \uc788\ub294 \uc911\uc778 pre-lyndon word, \\(s_3\\)\ub294 \uc544\uc9c1 \ud0d0\uc0c9\ud558\uc9c0 \uc54a\uc740 \uc0c1\ud0dc\uc784\uc744 \uc758\ubbf8\ud55c\ub2e4. \uc54c\uace0\ub9ac\uc998\uc740 \ubc18\ubcf5\uc801\uc73c\ub85c \uc544\uc9c1 \ud0d0\uc0c9\ud558\uc9c0 \uc54a\uc740 \\(s_3\\)\uc758 \uccab \ubc88\uc9f8 \ubb38\uc790\ub97c \uaebc\ub0b4 \\(s_2\\)\uc5d0 \ucd94\uac00\ud558\ub824\uace0 \ud55c\ub2e4. \\(i\\)\ub294 \\(s_2\\)\uc758 \uccab \ubc88\uc9f8 \uc704\uce58, \\(j\\)\ub294 \\(s_3\\)\uc758 \uccab \ubc88\uc9f8 \uc704\uce58, \\(k\\)\ub294 \uc0c8\ub85c\uc6b4 \ubb38\uc790\ub97c \ucd94\uac00\ud560 \ub54c \uc544\uc9c1 \\(s_2\\)\uac00 pre-lyndon word\uc778\uc9c0 \ube44\uad50\ud558\uae30 \uc704\ud55c \\(s_2\\) \uc911\uc758 \uc704\uce58\ub97c \uc758\ubbf8\ud55c\ub2e4. \uc0c8\ub85c \ucd94\uac00\ud560 \ubb38\uc790 \\(s[j]\\)\uc640 \\(s[k]\\)\ub97c \ube44\uad50\ud558\uc5ec \uacb0\uacfc\uc5d0 \ub530\ub77c \ub2e4\uc74c\uacfc \uac19\uc774 \uc791\ub3d9\ud55c\ub2e4.</p> <ul> <li>\\(s[j]=s[k]\\) : \\(j\\)\uc640 \\(k\\)\ub97c \\(1\\) \uc99d\uac00\uc2dc\ud0a8\ub2e4.</li> <li>\\(s[j]&gt;s[k]\\) : \\(j\\)\ub294 \\(1\\) \uc99d\uac00\uc2dc\ud0a4\uace0, \\(k\\)\ub294 \ub2e4\uc2dc \\(s_2\\)\uc758 \uccab \ubc88\uc9f8 \uc704\uce58\uc778 \\(i\\)\ub85c \ucd08\uae30\ud654\uc2dc\ud0a8\ub2e4.</li> <li>\\(s[j]&lt;s[k]\\) : \\(i\\)\uc5d0\uc11c\ubd80\ud130 \uae38\uc774 \\(j-k\\)\uc529 lyndon word\ub4e4\uc744 \\(s_1\\)\uc5d0 \ub123\uc5b4\uc8fc\uace0, \\(i\\)\uac00 \\(k\\)\ubcf4\ub2e4 \ucee4\uc9c0\uba74 \uc911\uc9c0\ud55c\ub2e4.</li> </ul> <p>\uc54c\uace0\ub9ac\uc998\uc758 \ub3d9\uc791 \uacfc\uc815\uc5d0\uc11c lyndon word\ub97c \ubd84\ud560\ud574 \ub0b4\ub294 \uacfc\uc815\uc740 \ub2e4 \ud569\ud574\uc11c \\(O(N)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub9b0\ub2e4. \ud558\uc9c0\ub9cc \uc774 \uc678\uc758 \ucd94\uac00 \uc2dc\uac04\uc774 \uc18c\ubaa8\ub418\ub294 \ubd80\ubd84\uc740 \ubc14\ub85c \\(s_2=ww \\cdots w \\overline{w}\\)\uc5d0\uc11c \\(w\\)\ub4e4\uc740 \\(s_1\\)\uc5d0 \ub123\uc5b4\uc8fc\ub294\ub370, \\(\\overline{w}\\)\uc740 \ud0d0\uc0c9\uc740 \ud558\uc9c0\ub9cc \ub2e4\uc74c \ubc18\ubcf5\uc5d0\uc11c \ub2e4\uc2dc \uace0\ub824\ub41c\ub2e4\ub294 \uc810\uc774\ub2e4. \ud558\uc9c0\ub9cc \\(len(\\overline{w}) \\le len(w)\\)\uc774 \uc131\ub9bd\ud558\ub2c8, \ub9e4\ubc88 \ucd94\uac00\ub85c \ubcf4\ub294 \\(\\overline{w}\\)\uc758 \uae38\uc774\uc758 \ud569\uc740 \\(O(N)\\)\uc744 \ub118\uc9c0 \uc54a\ub294\ub2e4. \ub530\ub77c\uc11c \uc804\uccb4 \\(O(N)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub9b0\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N)\\)</p>","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Lyndon%20Decomposition/algorithm/#implementation","title":"Implementation","text":"<pre><code>vector&lt;pii&gt; lyndon(int N, string &amp;S)\n{\n    vector&lt;pii&gt; lyndon;\n    for(int i=1; i&lt;=N; )\n    {\n        int j=i+1, k=i;\n        for(; j&lt;=N; j++)\n        {\n            if(S[j]==S[k]) k++;\n            else if(S[j]&gt;S[k]) k=i;\n            else break;\n        }\n        for(; i&lt;=k; i+=j-k)\n        {\n            lyndon.push_back({i, i+j-k-1}); // S[i...(i+j-k-1)] is lyndon word\n        }\n    }\n    return lyndon;\n}\n</code></pre>","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Lyndon%20Decomposition/algorithm/#application","title":"Application","text":"","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Lyndon%20Decomposition/algorithm/#lyndon-decomposition-for-all-prefixes","title":"Lyndon Decomposition for All Prefixes","text":"<p>\ubaa8\ub4e0 prefix\uc5d0 \ub300\ud55c lyndon decomposition\uc744 \ub2e4 \uad6c\ud558\uae30 \uc704\ud574\uc120 Property 7\uc5d0 \uc758\ud574 \ubaa8\ub4e0 prefix \\(\\text{pref}(S)\\)\uc5d0 \ub300\ud574 \\(\\text{pref}(S)\\)\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub97c \uad6c\ud558\uba74 \ub41c\ub2e4. \uc774\ub97c \uad6c\ud55c\ub2e4\uba74, \ud2b8\ub9ac\uc640 \uac19\uc740 \ud615\ud0dc\ub85c \uadc0\ub0a9\uc801\uc73c\ub85c \ub0a8\uc740 prefix\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub97c \uad6c\ud574\ub098\uac00\uba70 \ubaa8\ub4e0 prefix\uc5d0 \ub300\ud55c lyndon decomposition\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Incremental \ud558\uac8c lyndon decomposition\uc744 \uad6c\ud558\ub294 duval algorithm\uc744 \uc751\uc6a9\ud558\uc5ec \ubaa8\ub4e0 prefix \\(\\text{pref}(S)\\)\uc5d0 \ub300\ud574 \\(\\text{pref}(S)\\)\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub97c \uad6c\ud558\uc790. \\(S[1 \\cdots j]\\)\uc5d0 \ub300\ud574 duval algorithm\uc740 pre-lyndon word \\(s_2=ww \\cdots w \\overline{w}\\)\uc744 \uad00\ub9ac\ud55c\ub2e4.</p> <p>(Case 1) \\(\\overline{w}\\)\uac00 \ube44\uc5b4 \uc788\ub2e4\uba74, \\(S[1 \\cdots j]\\)\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub294 \\(w\\)\uc774\ub2e4.</p> <p>(Case 2) \\(\\overline{w}\\)\uac00 \ube44\uc5b4 \uc788\uc9c0 \uc54a\ub2e4\uba74 \\(S[1 \\cdots j]\\)\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub294 \\(\\overline{w}\\)\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\uc774\ub2e4. \ud558\uc9c0\ub9cc \uc774 \uac12\uc740 \ub2e4\uc2dc \uad6c\ud560 \ud544\uc694 \uc5c6\uc774, \uc774\ub294 dp\ub97c \uc774\uc6a9\ud558\uc5ec \uc774\ubbf8 \uacc4\uc0b0\ub41c \uac12\uc744 \uc7ac\ud65c\uc6a9\ud560 \uc218 \uc788\ub2e4. \\(j'=j-len(w)\\)\uc744 \uacc4\uc0b0\ud560 \ub54c\uc758 \\(\\overline{w}'\\) \ub610\ud55c \\(\\overline{w}\\)\uc640 \uac19\uae30 \ub54c\ubb38\uc5d0, \\(j\\)\uc5d0\uc11c\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub294 \\(j-len(w)\\)\uc5d0\uc11c\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\uc640 \uac19\ub2e4.</p> <p>Algorithm 2</p> <p>\ubaa8\ub4e0 prefix\uc5d0 \ub300\ud55c lyndon decomposition\uc744 \ub2e4 \uad6c\ud558\uae30 \uc704\ud574\uc120 Property 7\uc5d0 \uc758\ud574 \ubaa8\ub4e0 prefix \\(\\text{pref}(S)\\)\uc5d0 \ub300\ud574 \\(\\text{pref}(S)\\)\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub97c \uad6c\ud558\uba74 \ub41c\ub2e4. \uc774\ub97c \uad6c\ud55c\ub2e4\uba74, \ud2b8\ub9ac\uc640 \uac19\uc740 \ud615\ud0dc\ub85c \uadc0\ub0a9\uc801\uc73c\ub85c \ub0a8\uc740 prefix\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub97c \uad6c\ud574\ub098\uac00\uba70 \ubaa8\ub4e0 prefix\uc5d0 \ub300\ud55c lyndon decomposition\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\\(S[1 \\cdots j]\\)\uc5d0 \ub300\ud574 duval algorithm\uc740 pre-lyndon word \\(s_2=ww \\cdots w \\overline{w}\\)\uc744 \uad00\ub9ac\ud55c\ub2e4. \uc54c\uace0\ub9ac\uc998\uc744 \uc9c4\ud589\ud558\uba70, \ubaa8\ub4e0 prefix \\(\\text{pref}(S)\\)\uc5d0 \ub300\ud574 \\(\\text{pref}(S)\\)\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub97c dp\ub97c \uc774\uc6a9\ud558\uc5ec \uad6c\ud55c\ub2e4.</p> <p>(Case 1) \\(\\overline{w}\\)\uac00 \ube44\uc5b4 \uc788\ub2e4\uba74, \\(S[1 \\cdots j]\\)\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub294 \\(w\\)\uc774\ub2e4.</p> <p>(Case 2) \\(\\overline{w}\\)\uac00 \ube44\uc5b4 \uc788\uc9c0 \uc54a\ub2e4\uba74 \\(S[1 \\cdots j]\\)\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\ub294 \\(\\overline{w}\\)\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\uc774\ub2e4. \uc774 \uac12\uc740 \\(j-len(w)\\)\uc5d0\uc11c\uc758 \uc0ac\uc804\uc21c\uc73c\ub85c \uac00\uc7a5 \uc791\uc740 suffix\uc640 \uac19\ub2e4.</p> <p>\uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \uc77c\ubc18\uc801\uc778 duval algorithm\uacfc \ub3d9\uc77c\ud558\uac8c \\(O(N)\\)\uc774\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N)\\)</p>","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Lyndon%20Decomposition/algorithm/#implementation_1","title":"Implementation","text":"<pre><code>vector&lt;int&gt; lyndon(int N, string &amp;S)\n{\n    vector&lt;int&gt; dp(N+1);\n    for(int i=1; i&lt;=N; )\n    {\n        dp[i]=1;\n        int j=i+1, k=i;\n        for(; j&lt;=N; j++)\n        {\n            if(S[j]==S[k])\n            {\n                dp[j]=dp[k];\n                k++;\n            }\n            else if(S[j]&gt;S[k])\n            {\n                dp[j]=j-i+1;\n                k=i;\n            }\n            else break;\n        }\n        for(; i&lt;=k; i+=j-k);\n    }\n    return dp;\n}\n</code></pre>","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Lyndon%20Decomposition/algorithm/#reference","title":"Reference","text":"<ul> <li>https://cp-algorithms.com/string/lyndon_factorization.html</li> <li>https://codeforces.com/blog/entry/106725</li> </ul>","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Prefix%20Function/algorithm/","title":"Prefix Function (Failure Function)","text":"","tags":["kmp","string","~ algorithm"]},{"location":"algorithms/Strings/Prefix%20Function/algorithm/#definition","title":"Definition","text":"<p>Definition 1</p> <p>\\(fail[i] := S[1 \\cdots i]\\)\uc758 prefix \uc640 suffix \uac00 \ub3d9\uc77c\ud55c proper prefix\uc758 \ucd5c\ub300 \uae38\uc774 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 proper prefix\uac00 \uc5c6\uc73c\uba74 \\(fail[i]=0\\), \\(fail[0]=-1\\)</p> <p>\uc815\uc758\uc5d0 \uc758\ud574, \\(fail[1]=0\\)\uc774\uba70 \\(fail[0]\\)\uc740 \uc815\uc758\ub418\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0, \\(fail[0]=-1\\)\uc774\ub77c\uace0 \uc0dd\uac01\ud558\uc790.</p> <p>\uc608\ub97c \ub4e4\uc5b4, \u201cabcabcd\u201d \uc758 \uc2e4\ud328 \ud568\uc218\ub294 [0, 0, 0, 1, 2, 3, 0] \uc774\uace0, \u201caabaaab\u201d\uc758 \uc2e4\ud328 \ud568\uc218\ub294 [0, 1, 0, 1, 2, 2, 3] \uc774\ub2e4.</p>","tags":["kmp","string","~ algorithm"]},{"location":"algorithms/Strings/Prefix%20Function/algorithm/#property","title":"Property","text":"<p>Property 1</p> \\[fail[i]+1\u2265fail[i+1]\\] <p>Proof</p> <p>\\(fail[i+1]\\)\uc5d0\uc11c \ub9c8\uc9c0\ub9c9 \ubb38\uc790\ub97c \uc81c\uac70\ud558\uba74, \uc989 \uae38\uc774 \\(fail[i+1]-1\\)\uc758 prefix\ub294 \\(S[1 \\cdots i]\\)\uc758 prefix \uc774\uace0, \ub3d9\uc2dc\uc5d0 suffix \uc774\ub2e4. \uc989, \\(fail[i]\\)\uc758 \uc870\uac74\uc744 \ubaa8\ub450 \ub9cc\uc871\ud558\ub2c8, \ucd5c\ub313\uac12\uc778 \\(fail[i]\\)\ub294 \\(fail[i+1]-1\\)\ubcf4\ub2e4\ub294 \ud06c\uac70\ub098 \uac19\uc544\uc57c \ud55c\ub2e4.</p> <p></p> <p>\uc774\ub294 \\(i\\)\ub97c \uc99d\uac00\uc2dc\ud0ac \ub54c\ub9c8\ub2e4 \\(fail[i+1]\\)\ub294 \ucd5c\ub300 \\(1\\)\uc99d\uac00\ud560 \uc218 \uc788\ub2e4\ub294 \uc758\ubbf8\uc774\ub2e4. \ub530\ub77c\uc11c \\(fail[i]\\)\ub97c \\(1\\)\ubd80\ud130 \\(N\\)\uae4c\uc9c0 \uacc4\uc0b0\ud558\uba74 \\(fail[i]\\)\ub294 \ucd5c\ub300 \\(N\\)\ubc88 \uc99d\uac00, \ucd5c\ub300 \\(N\\)\ubc88 \uac10\uc18c\ud568\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>Property 2</p> <p>\\(fail\\)\uc758 \uc815\uc758\uc5d0\uc11c \u201c\ucd5c\ub300\u201d \uc870\uac74\uc744 \ubb34\uc2dc\ud55c, \uc989 \\(S[1 \\cdots i]\\)\uc758 prefix \uc640 suffix \uac00 \ub3d9\uc77c\ud55c proper prefix\uc758 \uae38\uc774\ub4e4\uc758 \uc9d1\ud569\uc744 \\(F[i]\\)\ub77c \ud558\uc790. \\(F[i]\\)\ub294 \\(fail[i], fail[fail[i]], fail[fail[fail[i]]], \\cdots\\) \uc758 \ud615\ud0dc\ub85c \uad6c\uc131\ub41c\ub2e4.</p> <p></p> <p>Proof</p> <p>\\(F[i]\\)\ub97c \uadc0\ub0a9\uc801\uc73c\ub85c \uad6c\ud558\uae30 \uc704\ud558\uc5ec \\(j&lt;i\\)\uc778 \ubaa8\ub4e0 \\(j\\)\uc5d0 \ub300\ud558\uc5ec \\(F[j]\\)\ub97c \uad6c\ud588\ub2e4\uace0 \uc0dd\uac01\ud558\uc790. \\(x \\in F[i]\\)\ub77c\uace0 \ud558\uba74 \\(fail\\)\uc758 \uc815\uc758\uc560 \uc758\ud574 \\(x \\leq fail[i]\\)\uc774\uba70, \uc704 \uadf8\ub9bc\uacfc \uac19\uc774 \\(x=fail[i]\\)\uc774\uac70\ub098 \\(x \\in F[fail[i]]\\)\uac00 \uc131\ub9bd\ud574\uc57c \ud55c\ub2e4. \ub530\ub77c\uc11c \\(F[i] = F[fail[i]] \\cup {fail[i]}\\)\uac00 \uc131\ub9bd\ud558\uba70, \uc774\ub294 \\(F[i]={fail[i], fail[fail[i]], \\cdots}\\)\uacfc \uac19\uc740 \uad6c\uc870\uc784\uc744 \uc758\ubbf8\ud55c\ub2e4.</p> <p>\uc704 \uc131\uc9c8\uc740 \\(i\\)\uc5d0\uc11c \\(fail[i]\\)\ub85c \uac00\ub294 \uac04\uc120\uc744 \uc774\uc5c8\uc744 \ub54c, \ub9cc\ub4e4\uc5b4\uc9c0\ub294 \uad6c\uc870\uac00 \ud2b8\ub9ac\uc774\uba70 \\(F[i]\\)\ub97c \uad6c\ud558\uae30 \uc704\ud574\uc11c\ub294 \\(i\\)\uc758 \uc870\uc0c1\ub4e4\uc758 \uc9d1\ud569\uc744 \uad6c\ud558\uba74 \ub428\uc744 \uc758\ubbf8\ud55c\ub2e4. \uc55e\uc73c\ub85c \uc774 \ud2b8\ub9ac\ub97c Failure Tree\ub77c \ubd80\ub974\uae30\ub85c \ud55c\ub2e4.</p>","tags":["kmp","string","~ algorithm"]},{"location":"algorithms/Strings/Prefix%20Function/algorithm/#algorithm","title":"Algorithm","text":"<p>\\(fail[i]\\)\ub97c \uad6c\ud558\uae30 \uc704\ud558\uc5ec \\(j&lt;i\\)\uc778 \ubaa8\ub4e0 \\(j\\)\uc5d0 \ub300\ud558\uc5ec \\(fail[j]\\)\ub97c \uad6c\ud588\ub2e4\uace0 \uc0dd\uac01\ud558\uc790. \\(x=fail[i]\\)\ub77c\uba74 \\(x-1 \\in F[i-1]\\)\uc774\ub2c8, \uac70\uafb8\ub85c \\(j \\in F[i-1]\\)\uc778 \ubaa8\ub4e0 \\(j\\)\uc5d0 \ub300\ud558\uc5ec \ud070 \uc21c\uc11c\ub300\ub85c \\(j+1 \\in F[i]\\)\uc778\uc9c0 \ud655\uc778\ud574\uc8fc\uba74 \ub41c\ub2e4. \uc774\ub294 \ub2e8\uc21c\ud788 \\(S[j+1]=S[i]\\)\uc778\uc9c0 \ud655\uc778\ud574\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\ub530\ub77c\uc11c \ub2e4\uc74c\uacfc \uac19\uc740 \ubc29\ubc95\uc73c\ub85c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Algorithm 1</p> <p>\\(i\\)\ub97c \uc99d\uac00\uc2dc\ucf1c\uac00\uba70 \\(fail[i]\\)\ub97c \uad6c\ud55c\ub2e4. \\(j=fail[i-1], fail[fail[i-1]], \\cdots\\)\ub97c \ud558\ub098\uc529 \ud655\uc778\ud558\uba70, \\(S[j+1]=S[i]\\)\uc778 \\(j\\)\uac00 \ub4f1\uc7a5\ud558\ub294 \uc21c\uac04 \\(fail[i]=j+1\\)\uc774\ub2e4. \ub9cc\uc57d \ub9cc\uc871\ud558\ub294 \\(j\\)\uac00 \uc5c6\ub2e4\uba74 \\(fail[i]=0\\)\uc774\ub2e4.</p> <p>Property 1\uacfc \uac19\uc774 \\(fail[i]\\)\ub294 \ucd5c\ub300 \\(N\\)\ubc88 \uc99d\uac00, \ucd5c\ub300 \\(N\\)\ubc88 \uac10\uc18c\ud558\ub2c8, \uc704\uc640 \uac19\uc740 \uc54c\uace0\ub9ac\uc998\uc73c\ub85c \\(O(N)\\) \uc2dc\uac04\uc5d0 \ubaa8\ub4e0 \\(fail[i]\\)\ub97c \uad6c\ud560 \uc218 \uc788\ub2e4. \uc774\ub294 \\(S\\)\uc5d0\uc11c \\(S\\)\ub97c \ucc3e\ub294 KMP \uc54c\uace0\ub9ac\uc998\uc744 \uc0dd\uac01\ud588\uc744 \ub54c, \ubb38\uc790\uc5f4\uc744 \ucd5c\ub300 \\(N\\)\uce78 \ubc00\uc5b4\uac00\uba70 \ud0d0\uc0c9\ud558\ub2c8 \\(O(N)\\)\uc774\ub77c\uace0 \uc0dd\uac01\ud574\ub3c4 \ub41c\ub2e4.</p> <p>Time Complexity</p> <p>Time Complexity : \\(O(N)\\)</p>","tags":["kmp","string","~ algorithm"]},{"location":"algorithms/Strings/Prefix%20Function/algorithm/#implementation","title":"Implementation","text":"<pre><code>// Get failure function of S\n// getFail(S = \"?ababca\") = [-1, 0, 0, 1, 2, 0, 1]\nvector&lt;int&gt; getFail(string S) // S is 1-based (leading \"?\")\n{\n    int N=S.size()-1;\n    vector&lt;int&gt; fail(N+1);\n\n    fail[0]=-1;\n    for(int i=1; i&lt;=N; i++)\n    {\n        int j=fail[i-1];\n        while(j&gt;=0 &amp;&amp; S[j+1]!=S[i]) j=fail[j];\n        fail[i]=j+1;\n    }\n    return fail;\n}\n</code></pre>","tags":["kmp","string","~ algorithm"]},{"location":"algorithms/Strings/Prefix%20Function/algorithm/#reference","title":"Reference","text":"<ul> <li>https://cp-algorithms.com/string/prefix-function.html</li> </ul>","tags":["kmp","string","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Array%20%26%20LCP%20Array/algorithm/","title":"Suffix Array &amp; LCP Array","text":"","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Array%20%26%20LCP%20Array/algorithm/#suffix-array","title":"Suffix Array","text":"<p>\uc811\ubbf8\uc0ac \ubc30\uc5f4(Suffix Array)\ub294 \ubb38\uc790\uc5f4 \\(S\\)\uc758 \ubaa8\ub4e0 \uc811\ubbf8\uc0ac\ub97c lexicographic \uc21c\uc11c\ub85c \uc815\ub82c\ud55c \ubc30\uc5f4\uc774\ub2e4. \uc2e4\uc81c \uc811\ubbf8\uc0ac\ub97c \uc800\uc7a5\ud558\uae30\uc5d0\ub294 \ub108\ubb34 \ub9ce\uc740 \uacf5\uac04\uc774 \ud544\uc694\ud558\ub2c8, \ub300\uc2e0 \uc811\ubbf8\uc0ac\uac00 \uc2dc\uc791\ud558\ub294 \uc704\uce58\ub97c \uc800\uc7a5\ud55c\ub2e4.</p> <p>\uc608\ub97c \ub4e4\uc5b4, \ubb38\uc790\uc5f4 \\(S\\)=\"GATAGACA\"\uc758 Suffix Array\ub294 \\(SA[i]=\\)[8, 6, 4, 2, 7, 5, 1, 3]\uc774\ub2e4.</p> \\(SA[i]\\) suffix 8 A 6 ACA 4 AGACA 2 ATAGACA 7 CA 5 GACA 1 GATAGACA 3 TAGACA","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Array%20%26%20LCP%20Array/algorithm/#manber-myers-algorithm","title":"Manber-Myers Algorithm","text":"<p>Manber-Myers Algorithm\uc740 \ucd1d \\(O(\\log N)\\)\uac1c\uc758 \ub2e8\uacc4\ub85c \uad6c\uc131\ub418\ub294\ub370, \uac01 \ub2e8\uacc4\uc5d0\uc11c \uc811\ubbf8\uc0ac\ub4e4\uc744 \uc55e\uc758 \\(2^i\\)\uac1c \ubb38\uc790\ub9cc \uc774\uc6a9\ud558\uc5ec \uc815\ub82c\ud55c\ub2e4. \uc989, \ucc98\uc74c\uc5d0\ub294 \\(1\\)\uac1c\uc758 \ubb38\uc790\ub9cc \ubcf4\uace0 \uc815\ub82c\ud55c \ud6c4, \uc774 \uacb0\uacfc\ub97c \uc774\uc6a9\ud558\uc5ec \\(2\\)\uac1c, \\(4\\)\uac1c, \\(\\cdots\\)\uc758 \ubb38\uc790\uc5d0 \ub300\ud558\uc5ec \uc815\ub82c\ud55c\ub2e4.</p>","tags":["string","suffix_array","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Automaton/algorithm/","title":"Suffix Automaton","text":"<p>\ubb38\uc790\uc5f4 \\(S\\)\uc758 \ubaa8\ub4e0 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc744 \ud6a8\uc728\uc801\uc73c\ub85c \uad00\ub9ac\ud558\uae30 \uc704\ud55c \uc790\ub8cc\uad6c\uc870\ub85c, suffix array\ub098 suffix tree\uac00 \uc788\ub2e4. Suffix automaton\uc740 \uac01 \uac04\uc120\uc5d0 \ubb38\uc790\uac00 \ud558\ub098\uc529 \uc801\ud78c DAG (Directed Acyclic Graph)\ub97c \ub9cc\ub4e4\uc5b4, DAG \uc704\uc5d0\uc11c\uc758 \uc784\uc758\uc758 \uacbd\ub85c\uac00 \\(S\\)\uc758 \ubd80\ubd84\ubb38\uc790\uc5f4\uacfc \ub300\uc751\ub418\ub3c4\ub85d \\(S\\)\uc758 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc744 \uc555\ucd95\ud558\uc5ec \ud45c\ud604\ud55c \uc790\ub8cc\uad6c\uc870\uc774\ub2e4.</p>","tags":["string","suffix_tree","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Automaton/algorithm/#structure","title":"Structure","text":"<p>Suffix automaton\uc740 DFA (deterministic finite automaton)\ub85c, \ub2e4\uc74c \uae30\ubcf8 \uc131\uc9c8\ub4e4\uc744 \ub9cc\uc871\ud55c\ub2e4.</p> <p>Property 1</p> <ul> <li>Suffix automaton\uc740 \uc815\uc810 (state)\uc640 \uac04\uc120 (transition)\uc73c\ub85c \uad6c\uc131\ub41c DAG (Directed Acyclic Graph)\uc774\ub2e4.</li> <li>\uc815\uc810\ub4e4 \uc911 \ud558\ub098\uc758 \uc815\uc810\uc740 initial state\uc774\uba70, \ubaa8\ub4e0 \ub2e4\ub978 \uc815\uc810\ub4e4\uc740 \uc774 \uc815\uc810\uc73c\ub85c\ubd80\ud130 \ub3c4\ub2ec\uc774 \uac00\ub2a5\ud558\ub2e4.</li> <li>\uac01 \uac04\uc120(transition)\uc5d0\ub294 \ud558\ub098\uc758 \ubb38\uc790\uac00 \uc801\ud600 \uc788\uace0, \ud55c \uc815\uc810\uc5d0\uc11c \ub098\uac00\ub294 \uc11c\ub85c \ub2e4\ub978 \uac04\uc120\ub4e4\uc5d0\ub294 \uc11c\ub85c \ub2e4\ub978 \ubb38\uc790\uac00 \uc801\ud600 \uc788\ub2e4.</li> <li>Initial state\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uac04\uc120\uc744 \ub530\ub77c \uc774\ub3d9\ud558\ub294 \uc784\uc758\uc758 \uacbd\ub85c\ub294 \ubaa8\ub450 \uc11c\ub85c \ub2e4\ub978 \\(S\\)\uc758 \ubd80\ubd84\ubb38\uc790\uc5f4\uc774\uace0, \\(S\\)\uc758 \ubaa8\ub4e0 \ubd80\ubd84\ubb38\uc790\uc5f4\uc740 \uc784\uc758\uc758 \uacbd\ub85c\uc5d0 \uc815\ud655\ud788 \ud55c\ubc88 \ub4f1\uc7a5\ud55c\ub2e4.</li> <li>\uba87 \uac1c\uc758 \uc815\uc810\ub4e4\uc740 terminal state\uc774\uba70, initial state\uc5d0\uc11c terminal state\ub85c \uac00\ub294 \uc784\uc758\uc758 \uacbd\ub85c\ub294 \ubaa8\ub450 \uc11c\ub85c \ub2e4\ub978 \\(S\\)\uc758 suffix\uc774\uace0, \\(S\\)\uc758 \ubaa8\ub4e0 suffix\ub294 initial state\uc5d0\uc11c terminal state\ub85c \uac00\ub294 \uacbd\ub85c\uc5d0 \uc815\ud655\ud788 \ud55c\ubc88 \ub4f1\uc7a5\ud55c\ub2e4.</li> </ul> <p>Suffix tree\uc640\ub294 \ub2e4\ub974\uac8c, \uac01 \uc815\uc810\uc774 \ud558\ub098\uc758 \ubd80\ubd84\ubb38\uc790\uc5f4\uc744 \uc758\ubbf8\ud558\ub294 \uac83\uc774 \uc544\ub2c8\ub77c, initial state\uc5d0\uc11c \uc2dc\uc791\ud558\ub294 \uc784\uc758\uc758 \uacbd\ub85c\uac00 \ud558\ub098\uc758 \ubd80\ubd84\ubb38\uc790\uc5f4\uc744 \uc758\ubbf8\ud558\ub294 \uac83\uc784\uc5d0 \uc8fc\uc758\ud558\uc790. \uc989, \ud55c \uc815\uc810\uc73c\ub85c \uac00\ub294 \uc5ec\ub7ec \uac1c\uc758 \uacbd\ub85c\uac00 \uc874\uc7ac\ud560 \uc218 \uc788\uc73c\uba70 \ubaa8\ub450 \uc11c\ub85c \ub2e4\ub978 \ubd80\ubd84\ubb38\uc790\uc5f4\uc744 \uc758\ubbf8\ud55c\ub2e4.</p>","tags":["string","suffix_tree","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Automaton/algorithm/#end-position","title":"End Position","text":"<p>Definition 1</p> <p>\\(endpos(t):=\\) \\(S\\)\uc5d0\uc11c \ubd80\ubd84\ubb38\uc790\uc5f4 \\(t\\)\ub97c \ubaa8\ub450 \ucc3e\uc558\uc744 \ub54c \uac00\ub2a5\ud55c \ub05d\uc810\uc758 \uc704\uce58\uc758 \uc9d1\ud569 \\(t\\)\uac00 \ube48 \ubb38\uc790\uc5f4\uc778 \uacbd\uc6b0 \\(endpos(\\phi)=\\{ 0, 1, 2, \\cdots, |S| \\}\\), \\(t\\)\uac00 \\(S\\)\uc758 \ubd80\ubd84\ubb38\uc790\uc5f4\uc774 \uc544\ub2cc \uacbd\uc6b0 \\(endpos(t)=\\phi\\)</p> <p>\uc608\ub97c \ub4e4\uc5b4, \\(S=\\)\"abbcdbcbcd\", \\(t=\\)\"bcd\"\uc77c \ub54c \\(S\\)\uc5d0\uc11c \\(t\\)\ub97c \ubaa8\ub450 \ucc3e\uc73c\uba74 \"ab[bcd]bc[bcd]\"\uac00 \ub418\uc5b4 \ub05d \uc704\uce58\ub294 \"abbcd|bcbcd|\", \\(endpos(t)=\\{5, 10\\}\\)\uc774 \ub41c\ub2e4. \\(t\\)\uac00 \ube48 \ubb38\uc790\uc5f4\uc77c \uacbd\uc6b0 \ub05d \uc704\uce58\ub294 \ubaa8\ub4e0 \uce78\uc774 \ub420 \uc218 \uc788\uc73c\ub2c8 \"|a|b|b|c|d|b|c|b|c|d|\"\uc5d0\uc11c \\(endpos(\\phi)=\\{ 0, 1, 2, \\cdots, 10 \\}\\)\uc784\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>Suffix automaton\uc5d0\uc11c \uac01 \uc815\uc810(state)\uac00 \uc758\ubbf8\ud558\ub294 \uac83\uc740 \ubc14\ub85c \uc774 \uc815\uc810\uc73c\ub85c \ub300\uc751\ub418\ub294 \ubaa8\ub4e0 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc758 \\(endpos\\) \uc9d1\ud569\uc774 \uac19\ub2e4\ub294 \uac83\uc774\ub2e4.</p> <p>Property 2</p> <p>Suffix automaton\uc5d0\uc11c \uac01 \uc815\uc810(state)\ub85c \ub300\uc751\ub418\ub294 \ubaa8\ub4e0 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc758 \\(endpos\\) \uc9d1\ud569\uc774 \uac19\ub2e4.</p> <p>\uc989, \\(endpos\\) \uc9d1\ud569\uc758 \ub3d9\uc77c\uc131 \uc5ec\ubd80\ub294 equivalence relation\uc774\uba70, suffix automaton\uc5d0\uc11c \uac01 \uc815\uc810(state)\uc740 \uc774\uc5d0 \ub300\ud55c equivalence class\uc774\ub2e4.</p> <p>\ub2e4\uc74c \uad00\ucc30\ub4e4\uc744 \ud1b5\ud574 \\(endpos\\) \uc9d1\ud569\ub4e4\uc758 equivalence class\uac00 \uc5b4\ub5bb\uac8c \uad6c\uc131\ub418\uc5b4 \uc788\ub294\uc9c0 \uc54c\uc544\ubcf4\uc790.</p> <p>Property 3</p> <p>\\(S\\)\uc758 \uc11c\ub85c \ub2e4\ub978 \ub450 \ubd80\ubd84\ubb38\uc790\uc5f4 \\(p\\)\uc640 \\(q\\)\uac00 \\(endpos(p)=endpos(q)\\), \\(len(p) \\ge len(q)\\)\uc774\uba74 \\(q\\)\ub294 \\(p\\)\uc758 suffix\uc774\ub2e4.</p> <p>Proof</p> <p>\\(endpos\\) \uc9d1\ud569\uc774 \uac19\uc73c\ub2c8, \\(p\\)\ub294 \\(endpos\\) \uc9d1\ud569\uc758 \uc784\uc758\uc758 \uc704\uce58\uc5d0\uc11c\ubd80\ud130 \uc67c\ucabd\uc73c\ub85c \\(|p|\\)\ub9cc\ud07c \uc774\ub3d9\ud558\uc5ec \uc5bb\uc744 \uc218 \uc788\uace0, \\(q\\) \ub610\ud55c \uadf8 \uc704\uce58\uc5d0\uc11c\ubd80\ud130 \uc67c\ucabd\uc73c\ub85c \\(|q|\\)\ub9cc\ud07c \uc774\ub3d9\ud558\uc5ec \uc5bb\uc744 \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c \\(p\\)\uc640 \\(q\\)\ub294 \ub05d\uc810\uc744 \uacf5\uc720\ud558\uace0 \uc788\ub294 \ud615\ud0dc\uc774\uace0, \\(q\\)\ub294 \\(p\\)\uc758 suffix\uc774\ub2e4.</p> <p></p> <p>Property 4</p> <p>\\(S\\)\uc758 \ubd80\ubd84\ubb38\uc790\uc5f4 \\(p\\), \\(q\\)\uc5d0 \ub300\ud558\uc5ec \\(endpos(p)\\), \\(endpos(q)\\)\uc758 \uad00\uacc4\ub294 \ub2e4\uc74c\uacfc \uac19\ub2e4.</p> <ul> <li>\\(q\\)\uac00 \\(p\\)\uc758 suffix : \\(endpos(p) \\subseteq endpos(q)\\)</li> <li>otherwise : \\(endpos(p) \\cap endpos(q) = \\phi\\)</li> </ul> <p>\uac01 \\(endpos\\) \uc9d1\ud569\uc740 \uc644\uc804\ud55c \ud3ec\ud568\uad00\uacc4\uac70\ub098, \uad50\uc9d1\ud569\uc774 \ube44\uc5b4\uc788\ub294 laminar set family\uc758 \ud615\ud0dc\ub97c \uc774\ub8ec\ub2e4.</p> <p>Proof</p> <p>\ub9cc\uc57d \ub450 \ubd80\ubd84\ubb38\uc790\uc5f4 \\(p\\), \\(q\\)\uc758 \\(endpos(p)\\), \\(endpos(q)\\)\uac00 \uad50\uc9d1\ud569\uc744 \uac16\ub294\ub2e4\uba74 \uc704 Property 3\uc640 \uac19\uc740 \ub17c\ub9ac\ub85c \\(p\\)\uc640 \\(q\\)\ub294 \uc11c\ub85c suffix \uad00\uacc4\uc774\ub2e4. \\(q\\)\uac00 \\(p\\)\uc758 suffix\ub77c\uba74, \ubaa8\ub4e0 \\(p\\)\uc758 \ub4f1\uc7a5 \uc704\uce58\uc5d0 \\(q\\)\ub3c4 \ub4f1\uc7a5\ud558\ub2c8, \\(endpos(p) \\subseteq endpos(q)\\)\ub77c\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, \ubaa8\ub4e0 \\(endpos\\)\ub294 \uc644\uc804\ud788 \ud3ec\ud568\ub418\uac70\ub098, \uad50\uc9d1\ud569\uc774 \ube44\uc5b4\uc788\ub294 laminar set family\uc758 \ud615\ud0dc\ub97c \uc774\ub8ec\ub2e4.</p> <p>Property 5</p> <p>\\(S=endpos(p)=endpos(q)\\)\ub97c \ub9cc\uc871\ud558\ub294 \ucd5c\ub300 \uae38\uc774 \ubd80\ubd84\ubb38\uc790\uc5f4\uc744 \\(p\\), \ucd5c\uc18c \uae38\uc774 \ubd80\ubd84\ubb38\uc790\uc5f4\uc744 \\(q\\)\ub77c\uace0 \ud560 \ub54c, \uae38\uc774 \\(p\\) \uc774\ud558 \\(q\\) \uc774\uc0c1\uc778 \\(p\\)\uc758 suffix \\(r\\) \ub610\ud55c \\(S=endpos(r)\\)\uc744 \ub9cc\uc871\ud55c\ub2e4.</p> <p>\uc989, \uac19\uc740 \\(endpos\\) \uc9d1\ud569\uc744 \uac16\ub294 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc758 \uae38\uc774\ub294 \ud558\ub098\uc758 \uad6c\uac04\uc744 \uc774\ub8e8\uba70, \ubaa8\ub450 \\(endpos\\) \uc9d1\ud569\uc758 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uac00\uc7a5 \uae34 \ubd80\ubd84\ubb38\uc790\uc5f4 \\(p\\)\uc758 suffix\uc758 \ud615\ud0dc\uc774\ub2e4.</p> <p>Proof</p> <p>Property 3\uc5d0 \uc758\ud574 \\(q\\)\ub294 \\(p\\)\uc758 suffix\uc774\uace0, \uae38\uc774 \\(p\\) \uc774\ud558 \\(q\\) \uc774\uc0c1\uc778 \\(p\\)\uc758 suffix \\(r\\)\uc740 Property 4\uc5d0 \uc758\ud574 \\(endpos(p) \\subseteq endpos(r) \\subseteq endpos(q)\\)\uac00 \uc131\ub9bd\ud558\uc5ec \\(S=endpos(p)=endpos(q)=endpos(r)\\), \uc989 \\(r\\) \ub610\ud55c \uac19\uc740 \\(endpos\\)\ub97c \uac16\ub294\ub2e4. \ub530\ub77c\uc11c \uac19\uc740 \\(endpos\\) \uc9d1\ud569\uc744 \uac16\ub294 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc758 \uae38\uc774\ub294 \ud558\ub098\uc758 \uad6c\uac04\uc744 \uc774\ub8ec\ub2e4.</p> <p>\\(endpos\\) \uc9d1\ud569\ub4e4\uc758 equivalence class\uc758 \ud615\ud0dc\ub294 Property 5\uc640 \uac19\uc774 \uc815\ub9ac\ud560 \uc218 \uc788\ub2e4.</p> <p>\ud3b8\uc758\ub97c \uc704\ud574 \uac00\uc7a5 \uae34 \ubd80\ubd84\ubb38\uc790\uc5f4\uacfc \uac00\uc7a5 \uc9e7\uc740 \ubd80\ubd84\ubb38\uc790\uc5f4\uc744 \ub2e4\uc74c\uacfc \uac19\uc740 \ud615\ud0dc\ub85c \uc815\uc758\ud558\uc790.</p> <p>Definition 2</p> <p>\uc815\uc810 \\(v\\)\uc5d0 \ub300\uc751\ub418\ub294 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4 \uc911 \uac00\uc7a5 \uae34 \uac83\uc744 \\(longest(v)\\), \uadf8 \uae38\uc774\ub97c \\(len(v)\\), \uac00\uc7a5 \uc9e7\uc740 \uac83\uc744 \\(shortest(v)\\), \uadf8 \uae38\uc774\ub97c \\(minlen(v)\\)\ub77c \uc815\uc758\ud55c\ub2e4.</p>","tags":["string","suffix_tree","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Automaton/algorithm/#suffix-link","title":"Suffix Link","text":"<p>Definition 3</p> <p>\\(link(v):=\\) \uc815\uc810 \\(v\\)\uc5d0 \ub300\uc751\ub418\ub294 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4 \uc911 \uac00\uc7a5 \uae34 \uac83\uc744 \\(w\\)\ub77c \ud560 \ub54c, \\(w\\)\uc758 suffix \uc911 \ub2e4\ub978 \\(endpos\\) \uc9d1\ud569\uc744 \uac16\ub294 \uac00\uc7a5 \uae34 suffix\uc640 \ub300\uc751\ub418\ub294 \uc815\uc810</p> <p>Initial state\uc758 suffix link\ub294 \uac00\uc0c1\uc758 \\(-1\\)\ubc88 \uc815\uc810\uc73c\ub85c \uc815\uc758\ud55c\ub2e4.</p> <p>Property 5\uc5d0\uc11c \uac01 \uc815\uc810\uc5d0 \ub300\uc751\ub418\ub294 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc740 \uac00\uc7a5 \uae34 \ubd80\ubd84\ubb38\uc790\uc5f4\uc744 \\(w\\)\ub77c \ud560 \ub54c, \uae38\uc774 \\(|w|, |w|-1, |w|-2, \\cdots\\)\uc778 \\(w\\)\uc758 suffix\uc758 \ud615\ud0dc\ub85c \ub098\ud0c0\ub09c\ub2e4\ub294 \uc0ac\uc2e4\uc744 \uc54c \uc218 \uc788\uc5c8\ub2e4. \uc774\ub807\uac8c \uae38\uc774\ub97c \uacc4\uc18d \uc904\uc5ec\ub098\uac00\uba74 \uc5b4\ub290 \uc21c\uac04\ubd80\ud130\ub294 \\(endpos\\) \uc9d1\ud569\uc774 \ubc14\ub00c\ub294\ub370, \uad6c\uccb4\uc801\uc73c\ub85c\ub294 suffix\uc758 \uae38\uc774\uac00 \uc904\uc5b4\ub4e4\uc218\ub85d \\(endpos\\) \uc9d1\ud569\uc774 \ub354 \ucee4\uc9c4\ub2e4. \\(endpos\\) \uc9d1\ud569\uc774 \ubc14\ub00c\ub294 \uc21c\uac04 \ubc14\ub010 \uc815\uc810\uc744 suffix link \\(link(v)\\)\ub85c \ud45c\ud604\ud55c\ub2e4.</p> <p>Property 6</p> <p>\\(v\\)\uc5d0\uc11c \\(link(v)\\)\ub85c \uac04\uc120\uc744 \uc774\uc5b4\uc8fc\uba74 initial state\ub97c \ub8e8\ud2b8\ub85c \ud558\ub294 \ud2b8\ub9ac\uac00 \ub41c\ub2e4.</p> <p>\uc774 \ud2b8\ub9ac\ub294 \\(endpos\\) \uc9d1\ud569\uc758 \ud3ec\ud568\uad00\uacc4\ub97c \ub098\ud0c0\ub0b4\ub294 \ud2b8\ub9ac\uc640 \ub3d9\uc77c\ud558\ub2e4.</p> <p>\ub610\ud55c, \uc815\uc758\uc5d0 \uc758\ud574 \ub2e4\uc74c\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> <p>Property 7</p> \\[len(link(v))+1=minlen(v)\\] <p>\ub2e4\uc74c\uc740 \ubb38\uc790\uc5f4 \"abcbc\"\uc5d0 \ub300\ud55c suffix automaton\uacfc suffix link\uc758 \uc608\uc2dc\uc774\ub2e4. \uac01 \uc815\uc810\uc5d0\ub294 \\(longest(v)\\)\uac00 \uc801\ud600 \uc788\ub2e4.</p> <p></p>","tags":["string","suffix_tree","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Automaton/algorithm/#algorithm","title":"Algorithm","text":"<p>\uc9c0\uae08\uae4c\uc9c0 \uc815\uc758\ud55c \\(endpos\\)\uc640 \\(link(v)\\)\ub97c \uc774\uc6a9\ud558\uba74 suffix automaton\uc744 \uad6c\uc131\ud558\ub294 \ub290\ub9b0 \uc54c\uace0\ub9ac\uc998\uc744 \uad6c\uc0c1\ud560 \uc218 \uc788\ub2e4. \ucc98\uc74c\uc5d0 \ube48 \ubb38\uc790\uc5f4 \\(p=\\phi\\), \\(endpos(p)=\\{ 0, 1, 2, \\cdots, |S| \\}\\)\uc778 \uc0c1\ud0dc\ub85c initial state\uc5d0\uc11c \uc2dc\uc791\ud55c\ub2e4. \uc774\ud6c4, \\(endpos\\)\uc704\uce58 \ub2e4\uc74c\uc5d0 \uc62c \uc218 \uc788\ub294 \ubb38\uc790\ub4e4\uc774 \uc774 \uc815\uc810\uc5d0\uc11c \ub098\uac00\ub294 \uac04\uc120\ub4e4\uc5d0 \uc801\ud788\uac8c \ub41c\ub2e4. \uac01 \ubb38\uc790 \\(c\\)\uc5d0 \ub300\ud574, \uc0c8\ub85c\uc6b4 \ubd80\ubd84\ubb38\uc790\uc5f4 \\(p'=p+c\\), \uc0c8\ub85c\uc6b4 \\(endpos(p')=\\) \\(endpos(p)\\)\uc758 \ub05d\uc5d0 \ubb38\uc790 \\(c\\)\ub97c \ubd99\uc600\uc744 \ub54c \ubc14\ub00c\ub294 \\(endpos\\)\ub85c \uc815\uc758\ud55c\ub2e4. \uac19\uc740 \\(endpos\\) \uc9d1\ud569\uc744 \uac16\ub294 \uc815\uc810\uc740 \ud55c \uc815\uc810\uc73c\ub85c \ubb36\uc5b4\uc8fc\uba74 suffix automaton\uc740 \uc644\uc131\ub41c\ub2e4. \uc644\uc131\ub41c DAG\uc5d0\uc11c \uc815\uc810 \\(v\\)\ub85c \uac00\ub294 \ucd5c\uc7a5\uacbd\ub85c\uac00 \\(longest(v)\\), \ucd5c\ub2e8\uacbd\ub85c\uac00 \\(shortest(v)\\)\ub97c \uc758\ubbf8\ud558\uace0, \uc774 \uc815\ubcf4\ub97c \uc774\uc6a9\ud558\uc5ec \\(shortest(v)\\)\uc758 \uac00\uc7a5 \uc55e \ubb38\uc790\ub97c \uc81c\uac70\ud55c \ubd80\ubd84\ubb38\uc790\uc5f4\uc744 \\(longest(w)\\)\ub85c \uac16\ub294 \uc815\uc810 \\(w\\)\ub85c \\(link(v)\\)\ub97c \uc774\uc5b4\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\ubb3c\ub860, \uc704 \ubc29\ubc95\uc740 \uc2dc\uac04\uc774 \ub290\ub9b0 \ube44\ud6a8\uc728\uc801\uc778 \uc54c\uace0\ub9ac\uc998\uc774\ub2e4. Suffix automaton\uc744 \uad6c\ud558\ub294 \ud6a8\uc728\uc801\uc778 \uc54c\uace0\ub9ac\uc998\uc740 \ube48 \ubb38\uc790\uc5f4\uc5d0\uc11c\ubd80\ud130 \uc2dc\uc791\ud558\uc5ec \ubb38\uc790\ub97c \ud558\ub098\uc529 \ucd94\uac00\ud574 \ub098\uac00\ub294 incremental\ud55c \uc54c\uace0\ub9ac\uc998\uc758 \ud615\ud0dc\uc774\ub2e4.</p> <p>\ucc98\uc74c\uc5d0\ub294 \ube48 \ubb38\uc790\uc5f4\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uadf8\ub798\ud504\uc5d0\ub294 initial state \\(t_0\\)\ub9cc \uc874\uc7ac\ud558\uace0, \\(len(t_0)=0\\), \\(link(t_0)=-1\\)\uc774\ub2e4. \uc5ec\uae30\uc11c \uc0c8\ub85c\uc6b4 \ubb38\uc790 \\(c\\)\ub97c \ucd94\uac00\ud588\uc744 \ub54c \uadf8\ub798\ud504\uac00 \uc5b4\ub5bb\uac8c \ubcc0\ud560\uc9c0 \uc0dd\uac01\ud574\ubcf4\uc790. \\(c\\)\ub97c \ucd94\uac00\ud558\uae30 \uc9c1\uc804 \ubb38\uc790\uc5f4 \uc804\uccb4\uc5d0 \ub300\uc751\ub418\ub358 \uc815\uc810\uc744 \\(last\\)\ub77c \ud558\uace0, \uc0c8\ub85c\uc6b4 \uc815\uc810 \\(cur\\)\uc744 \ub9cc\ub4e4\uc5b4 \uc774 \uc815\uc810\uc744 \\(c\\)\ub97c \ucd94\uac00\ud55c \uc774\ud6c4 \uc804\uccb4 \ubb38\uc790\uc5f4\uc5d0 \ub300\uc751\ub418\ub294 \uc815\uc810\uc774\ub77c \ud558\uc790. \uc790\uc5f0\uc2a4\ub7fd\uac8c \\(len(cur)=len(last)+1\\)\uc774 \ub41c\ub2e4.</p> <p>\\(cur\\)\ub85c \uac04\uc120 \\(c\\)\ub97c \uc774\uc6a9\ud558\uc5ec \uc5f0\uacb0\ub418\ub294 \uc815\uc810\ub4e4\uc740, \\(c\\)\ub97c \ucd94\uac00\ud558\uae30 \uc804 \uc804\uccb4 \ubb38\uc790\uc5f4\uc758 suffix\ub97c \uc758\ubbf8\ud558\ub294 \uc815\uc810\ub4e4\uc774\ub2c8, \\(v=last\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \\(link(v)\\)\ub97c \ud0c0\uace0 \uc62c\ub77c\uac00\uba74\uc11c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>(Case 1) \ub9cc\uc57d, \\(v\\)\uc5d0\uc11c \ub098\uac00\ub294 \ubb38\uc790 \\(c\\)\uc758 \uac04\uc120\uc774 \uc5c6\ub2e4\uba74, \uc774 \ubb38\uc790\uc5f4\uc774 \uc9c0\uae08\uae4c\uc9c0\ub294 \ub4f1\uc7a5\ud55c \uc801\uc774 \uc5c6\ub2e4\ub294 \ub73b\uc774\ub2c8 \ubc14\ub85c \\(v\\)\uc5d0\uc11c \\(cur\\)\ub85c \ubb38\uc790 \\(c\\)\uc758 \uac04\uc120\uc744 \uc774\uc5b4\uc8fc\uba74 \ub41c\ub2e4. \uc774 \uacfc\uc815\uc744 \\(v\\)\uc5d0\uc11c \ub098\uac00\ub294 \ubb38\uc790 \\(c\\)\uc758 \uac04\uc120\uc774 \uc774\ubbf8 \uc874\uc7ac\ud560 \ub54c\uae4c\uc9c0 \\(link(v)\\)\ub97c \ud0c0\uace0 \uc62c\ub77c\uac00\uba74\uc11c \ubc18\ubcf5\ud55c\ub2e4. \ub9cc\uc57d \uc774 \uacfc\uc815\uc744 \ubc18\ubcf5\ud558\ub2e4\uac00 initial state \\(t_0\\)\uc5d0 \ub3c4\ucc29\ud558\uba74 \\(cur\\)\uc774 \ubaa8\ub4e0 suffix\uc5d0 \ub2e4 \ub300\uc751\ub418\ub2c8, \uc54c\uace0\ub9ac\uc998\uc744 \uc885\ub8cc\ud558\uace0 \\(link(cur)=t_0\\)\ub85c \uc124\uc815\ud574\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\uc774\uc81c \\(v\\)\uc5d0\uc11c \ub098\uac00\ub294 \ubb38\uc790 \\(c\\)\uc758 \uac04\uc120\uc774 \uc774\ubbf8 \uc788\ub294 \uacbd\uc6b0\ub97c \uc0dd\uac01\ud558\uc790. \ud3b8\uc758\ub97c \uc704\ud574 \ud604\uc7ac \uc815\uc810 \\(v\\)\ub97c \\(p\\), \ubb38\uc790 \\(c\\)\uc758 \uac04\uc120\uc744 \ud0c0\uace0 \uc774\ub3d9\ud55c \uc815\uc810\uc744 \\(q\\)\ub77c \ud558\uc790. \ud604\uc7ac \uc0c1\ud669\uc744 \uc815\ub9ac\ud558\uc790\uba74, \uc774\ubbf8 \\(cur\\)\uc5d0\ub294 \uae38\uc774 \\(len(p)+1\\) (suffix=\\(longest(p)+c\\)) \ucd08\uacfc\uc758 suffix\ub4e4\uc740 \ub300\uc751\uc774 \ub418\uc5b4 \uc788\uace0, \uc815\ud655\ud788 \\(len(p)+1\\) \uc774\ud558\uc758 suffix\ub4e4\uc744 \ub300\uc751\uc2dc\ucf1c\uc57c \ud55c\ub2e4. \ud558\uc9c0\ub9cc \ub9cc\uc57d \\(len(q)&gt;len(p)+1\\)\ub77c\uba74 \\(q\\)\uc5d0\ub294 \ub300\uc751\uc2dc\ucf1c\uc57c\ud560 suffix\ubcf4\ub2e4 \ub354 \uae34 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\ub3c4 \ud3ec\ud568\ud558\uace0 \uc788\uc5b4, \\(len(q)=len(p)+1\\)\uacfc \\(len(q)&gt;len(p)+1\\)\uc778 \uacbd\uc6b0\ub85c case\ub97c \ub098\ub204\uc5b4\uc11c \uc0dd\uac01\ud574\uc57c \ud55c\ub2e4.</p> <p>(Case 2) \ub9cc\uc57d \\(len(p)+1=len(q)\\)\ub77c\uba74, \\(q\\)\uac00 \uc6b0\ub9ac\uac00 \ub300\uc751\uc2dc\ucf1c\uc57c \ud560 \uc815\ud655\ud55c \uc0c1\ud0dc\uc774\ub2e4. \\(q\\)\uc758 \\(endpos\\) \uc9d1\ud569\uc5d0 \ub9c8\uc9c0\ub9c9 \uc778\ub371\uc2a4\uac00 \ucd94\uac00\ub418\ub294 \ud615\ud0dc\uc774\ub2c8, \uadf8\ub798\ud504\uc5d0\uc11c \ubc14\uafd4\uc57c \ud560 \uac83\uc740 \uc774\uc81c \uc5c6\uace0 \\(link(cur)=q\\)\ub85c \uc124\uc815\ud574\uc8fc\uba74 \ub41c\ub2e4.</p> <p></p> <p>(Case 3) \ub9cc\uc57d \\(len(p)+1&lt;len(q)\\)\ub77c\uba74 \uc6b0\ub9ac\uac00 \ub300\uc751\uc2dc\ucf1c\uc57c \ud560 \uc0c1\ud0dc\ub294 \uc544\uc9c1 \uadf8\ub798\ud504\uc5d0 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4. \\(q\\)\uc758 \\(endpos\\) \uc9d1\ud569\uc740 \uae38\uc774\uac00 \\(len(q)\\)\uc778 \ubd80\ubd84\ubb38\uc790\uc5f4\uc5d0 \ub300\uc751\ub418\uc9c0\ub9cc, \ub9c8\uc9c0\ub9c9 \uc778\ub371\uc2a4\ub97c \ud3ec\ud568\ud558\ub294 \\(endpos\\)\ub294 \uae38\uc774\uac00 \\(len(p)+1\\)\uc774\ub2c8 \\(q\\)\uc640\ub294 \\(endpos\\) \uc9d1\ud569\uc774 \ub2e4\ub974\ub2e4. \ub530\ub77c\uc11c, \\(q\\)\ub97c \uae38\uc774 \\(len(p)+1\\)\ub97c \uac16\ub294 \uc0c8\ub85c\uc6b4 \uc815\uc810 \\(clone\\)\uc73c\ub85c \ucabc\uac1c\uc790. \\(len(clone)=len(p)+1\\)\uc774 \ub418\uace0, \uc790\uc5f0\uc2a4\ub7fd\uac8c \\(endpos(q) \\subseteq endpos(clone)\\)\uac00 \ub41c\ub2e4. \\(link(clone)\\)\uc740 \uc6d0\ub798 \\(link(q)\\)\uac00 \uac00\ub9ac\ud0a4\ub358 \uc815\uc810\uc774 \ub418\uace0, \\(link(q)\\)\ub294 \\(clone\\)\uc774 \ub41c\ub2e4. \ub610\ud55c, \\(q\\)\uc5d0\uc11c \ub098\uac00\ub294 \uac04\uc120\ub4e4\uc744 \ubaa8\ub450 \\(clone\\)\uc5d0\uc11c\ub3c4 \ub098\uac08 \uc218 \uc788\ub3c4\ub85d \uc774\uc5b4\uc8fc\uace0, \\(link(cur)=clone\\)\uc73c\ub85c \uc124\uc815\ud574\uc8fc\uba74 \ub41c\ub2e4. \ub9c8\uc9c0\ub9c9\uc73c\ub85c \\(q\\)\ub85c \ub4e4\uc5b4\uc624\ub358 \uc77c\ubd80 \uac04\uc120\ub4e4\uc744 \\(clone\\)\uc73c\ub85c \ubc14\uafb8\uc5b4\uc918\uc57c \ud558\ub294\ub370, \\(p\\)\uc758 suffix\ub4e4\uc5d0\uc11c \\(c\\)\uc758 \uac04\uc120\uc744 \ud0c0\uace0 \uc774\ub3d9\ud558\uba74 \\(q\\)\ub85c \uc624\ub294 \uac04\uc120\ub4e4\uc744 \\(clone\\)\uc73c\ub85c \uc62e\uaca8\uc8fc\uba74 \ub41c\ub2e4. \uc774\ub294 \\(v=p\\)\uc5d0\uc11c\ubd80\ud130 \\(link(v)\\)\ub97c \ud0c0\uace0 \uc774\ub3d9\ud558\uba70 \\(v\\)\uc5d0\uc11c \uac04\uc120 \\(c\\)\ub97c \ud0c0\uace0 \uc774\ub3d9\ud558\uc600\uc744 \ub54c \\(q\\)\uac00 \uc544\ub2cc \uc815\uc810\uc73c\ub85c \uc774\ub3d9\ud558\uae30 \uc804\uae4c\uc9c0 \uac04\uc120\uc744 \\(q\\)\uc5d0\uc11c \\(clone\\)\uc73c\ub85c \ubc14\uafb8\uc5b4\uc900\ub2e4.</p> <p></p> <p>\ub9c8\uc9c0\ub9c9\uc73c\ub85c, \ubaa8\ub4e0 \ubb38\uc790\ub97c \ucd94\uac00\ud55c \ud6c4 \\(last\\)\uc5d0\uc11c suffix link\ub97c \ud0c0\uace0 \uc62c\ub77c\uac00\uba74\uc11c terminal state\ub4e4\uc744 \ubaa8\ub450 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Algorithm 1</p> <p>\ucc98\uc74c\uc5d0, \ube48 \ubb38\uc790\uc5f4\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uadf8\ub798\ud504\uc5d0\ub294 initial state \\(t_0\\)\ub9cc \uc874\uc7ac\ud558\uace0, \\(link(t_0)=-1\\)\uc774\ub2e4.</p> <p>\uc774\uc81c, \uc0c8\ub85c\uc6b4 \ubb38\uc790 \\(c\\)\ub97c \ucd94\uac00\ud560 \ub54c \ub2e4\uc74c\uc744 \uc2e4\ud589\ud55c\ub2e4. \\(c\\)\ub97c \ucd94\uac00\ud558\uae30 \uc9c1\uc804 \ubb38\uc790\uc5f4 \uc804\uccb4\uc5d0 \ub300\uc751\ub418\ub358 \uc815\uc810\uc744 \\(last\\)\ub77c \ud558\uace0, \uc0c8\ub85c\uc6b4 \uc815\uc810 \\(cur\\)\uc744 \ub9cc\ub4e4\uc5b4 \\(len(cur)=len(last)+1\\)\uc774\ub77c \ud55c\ub2e4.</p> <p>\\(v=last\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \\(v\\)\uc5d0\uc11c \ub098\uac00\ub294 \ubb38\uc790 \\(c\\)\uc758 \uac04\uc120\uc774 \uc874\uc7ac\ud558\uae30 \uc804\uae4c\uc9c0 \\(link(v)\\)\ub97c \ud0c0\uace0 \uc62c\ub77c\uac00\uba70, (Case 1) \\(v\\)\uc5d0\uc11c \\(cur\\)\ub85c \ubb38\uc790 \\(c\\)\uc758 \uac04\uc120\uc744 \uc774\uc5b4\uc900\ub2e4. \ub9cc\uc57d \uc774 \uacfc\uc815\uc744 \ubc18\ubcf5\ud558\ub2e4\uac00 initial state \\(t_0\\)\uc5d0 \ub3c4\ucc29\ud558\uba74 \\(link(cur)=t_0\\)\ub85c \uc124\uc815\ud574\uc8fc\uace0 \uc54c\uace0\ub9ac\uc998\uc744 \uc885\ub8cc\ud55c\ub2e4.</p> <p>\\(v\\)\uc5d0\uc11c \ubb38\uc790 \\(c\\)\uc758 \uac04\uc120\uc774 \uc774\ubbf8 \uc788\ub294 \uacbd\uc6b0, \ud604\uc7ac \uc815\uc810 \\(v\\)\ub97c \\(p\\), \ubb38\uc790 \\(c\\)\uc758 \uac04\uc120\uc744 \ud0c0\uace0 \uc774\ub3d9\ud55c \uc815\uc810\uc744 \\(q\\)\ub77c \ud558\uc790. (Case 2) \\(len(p)+1=len(q)\\)\ub77c\uba74 \\(link(cur)=q\\)\ub85c \uc124\uc815\ud574\uc8fc\uace0 \uc54c\uace0\ub9ac\uc998\uc744 \uc885\ub8cc\ud55c\ub2e4.</p> <p>(Case 3) \\(len(p)+1&lt;len(q)\\)\ub77c\uba74 \\(q\\)\ub97c \uae38\uc774 \\(len(p)+1\\)\ub97c \uac16\ub294 \uc0c8\ub85c\uc6b4 \uc815\uc810 \\(clone\\)\uc73c\ub85c \ucabc\uac1c\uace0, \\(q\\)\uc5d0\uc11c \ub098\uac00\ub294 \uac04\uc120\ub4e4\uc744 \ubcf5\uc0ac\ud558\uc5ec \\(clone\\)\uc5d0\uc11c\ub3c4 \ub098\uac08 \uc218 \uc788\ub3c4\ub85d \uc774\uc5b4\uc900\ub2e4. \\(link(clone)\\)\uc740 \uc6d0\ub798 \\(link(q)\\)\uac00 \uac00\ub9ac\ud0a4\ub358 \uc815\uc810\uc73c\ub85c, \\(link(q)\\)\ub294 \\(clone\\)\uc73c\ub85c, \\(link(clone)=cur\\)\uc73c\ub85c \uc124\uc815\ud574\uc900\ub2e4. \\(q\\)\ub85c \ub4e4\uc5b4\uc624\ub358 \uc77c\ubd80 \uac04\uc120\ub4e4\uc744 \\(clone\\)\uc73c\ub85c \ubc14\uafb8\uc5b4\uc8fc\uae30 \uc704\ud558\uc5ec \\(v=p\\)\uc5d0\uc11c\ubd80\ud130 \\(link(v)\\)\ub97c \ud0c0\uace0 \uc774\ub3d9\ud558\uba70 \\(v\\)\uc5d0\uc11c \uac04\uc120 \\(c\\)\ub97c \ud0c0\uace0 \uc774\ub3d9\ud558\uc600\uc744 \ub54c \\(q\\)\uac00 \uc544\ub2cc \uc815\uc810\uc73c\ub85c \uc774\ub3d9\ud558\uae30 \uc804\uae4c\uc9c0 \uac04\uc120\uc744 \\(q\\)\uc5d0\uc11c \\(clone\\)\uc73c\ub85c \ubc14\uafb8\uc5b4\uc900\ub2e4.</p> <p>\ubaa8\ub4e0 \ubb38\uc790\ub97c \ucd94\uac00\ud55c \ud6c4 \\(last\\)\uc5d0\uc11c suffix link\ub97c \ud0c0\uace0 \uc62c\ub77c\uac00\uba74\uc11c terminal state\ub4e4\uc744 \ubaa8\ub450 \uad6c\ud560 \uc218 \uc788\ub2e4.</p>","tags":["string","suffix_tree","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Automaton/algorithm/#complexity","title":"Complexity","text":"<p>Property 8</p> <p>\uae38\uc774 \\(N\\)\uc758 \ubb38\uc790\uc5f4\uc758 suffix automaton\uc758 \uc815\uc810(state)\uc758 \ucd5c\ub300 \uac1c\uc218\ub294 \\(2N-1\\)\uac1c\uc774\ub2e4.</p> <p>Proof</p> <p>Algorithm 1\uc5d0\uc11c \ubb38\uc790\ub97c \\(2\\)\uac1c \ucd94\uac00\ud560 \ub54c\uae4c\uc9c0\ub294 \uac01\uac01 \\(1\\)\uac1c\uc758 \uc815\uc810\ub9cc\uc774 \uc0dd\uc131\ub418\uace0, \uadf8 \uc774\ud6c4\ub294 \ud55c \ubb38\uc790\ub97c \ucd94\uac00\ud560 \ub54c\ub9c8\ub2e4 \ucd5c\ub300 \\(2\\)\uac1c (\\(cur\\), \\(clone\\))\uc774\ub2c8, \uae38\uc774 \\(N\\)\uc758 suffix automaton\uc758 \uc815\uc810\uc758 \uac1c\uc218\ub294 \ucd5c\ub300 \\(2N-1\\)\uac1c\uc774\ub2e4.</p> <p>\ub610\ud55c, Property 4\uc5d0 \uc758\ud574 \\(endpos\\) \uc9d1\ud569\uc740 tree\uc758 \ud615\ud0dc\ub85c \ud45c\ud604\ud560 \uc218 \uc788\uace0, \uc815\uc810\uc758 \uac1c\uc218\ub294 \uc11c\ub85c \ub2e4\ub978 \\(endpos\\) \uc9d1\ud569\uc758 \uac1c\uc218\uc640 \uac19\ub2e4. \uc774 \ud2b8\ub9ac\uc758 \ub9ac\ud504\ub294 \\(\\{ 1, 2, \\cdots, N \\}\\)\uc758 disjoint\ud55c \ubd80\ubd84\uc9d1\ud569\ub4e4\ub85c, \ucd5c\ub300 \\(N\\)\uac1c \uac00\ub2a5\ud558\ub2c8 \ud2b8\ub9ac\uc758 \ub178\ub4dc\uc758 \uc218\ub294 \ucd5c\ub300 \\(2N-1\\)\uac1c\uc774\ub2e4.</p> \\[abbb \\cdots bbb\\] <p>\uc704 \ud615\ud0dc\uc758 \ubb38\uc790\uc5f4\uc774 \uc2e4\uc81c\ub85c \\(2N-1\\)\uac1c\uc758 \uc815\uc810\uc744 \ub9cc\ub4e0\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>Property 9</p> <p>\uae38\uc774 \\(N\\)\uc758 \ubb38\uc790\uc5f4\uc758 suffix automaton\uc758 \uac04\uc120(transition)\uc758 \ucd5c\ub300 \uac1c\uc218\ub294 \\(3N-4\\)\uac1c\uc774\ub2e4.</p> <p>Proof</p> <p>\uc6b0\uc120 \ubb38\uc790 \\(c\\)\uc778 \uac04\uc120 \\((p, q)\\)\uc5d0 \ub300\ud558\uc5ec \\(len(p)+1=len(q)\\)\uc778 \uac04\uc120\ub4e4\uc758 \uac1c\uc218\ub97c \uba3c\uc800 \uc138\uc790. Suffix automaton\uc5d0\uc11c \uc774 \uac04\uc120\ub4e4\ub9cc \uc774\uc6a9\ud558\uba74 longest path\ub97c \uad6c\ud560 \uc218 \uc788\uace0, longest path spanning tree\uc5d0 \uc0ac\uc6a9\ub418\ub294 \uac04\uc120\uc758 \uac1c\uc218\ub294 \ucd5c\ub300 \\(V-1\\)\uac1c, \uc989 \\(2N-2\\)\uac1c\uc774\ub2e4.</p> <p>\\(len(p)+1&lt;len(q)\\)\uc778 \uac04\uc120\uc5d0 \ub300\ud574, \\(u=longest(p)\\)\ub97c initial state\uc5d0\uc11c \\(p\\)\ub85c \uac00\ub294 \ucd5c\uc7a5\uacbd\ub85c \ubb38\uc790\uc5f4, \\(v\\)\ub97c \\(q\\)\uc5d0\uc11c \uc784\uc758\uc758 terminal state\ub85c \uac00\ub294 \ucd5c\uc7a5\uacbd\ub85c \ubb38\uc790\uc5f4\ub85c \uc815\uc758\ud558\uc790. \uc815\uc758\uc5d0 \uc758\ud574 \\(u+c+v\\)\ub294 \\(S\\)\uc758 suffix\uc774\uace0, \uc774 \ubb38\uc790\uc5f4\uc740 longest path spanning tree \uc704\uc758 \uac04\uc120\ub4e4\ub9cc \uc0ac\uc6a9\ud558\ub2c8, \ubaa8\ub450 \ub2e4\ub974\ub2e4. \ud558\uc9c0\ub9cc \uc11c\ub85c \ub2e4\ub978 suffix\ub294 \ucd5c\ub300 \\(N-1\\)\uac1c \ubc16\uc5d0 \uc5c6\uc73c\ub2c8, \uc774\ub7ec\ud55c \ud615\ud0dc\uc758 \uac04\uc120\uc740 \ucd5c\ub300 \\(N-1\\)\uac1c\ubc16\uc5d0 \uc5c6\ub2e4.</p> <p>\ub530\ub77c\uc11c \uc804\uccb4 \uac04\uc120\uc758 \uac1c\uc218\ub294 \ucd5c\ub300 \\(3N-3\\)\uac1c \uc774\ud558\uc774\uace0, \uc815\uc810\uc758 \uac1c\uc218\ub97c \ucd5c\ub300\ud654\ud558\ub294 \uc608\uc2dc\uc5d0\uc11c \uac04\uc120\uc774 \ucd5c\ub300 \\(3N-4\\)\uac1c \ubc16\uc5d0 \ubabb \ub9cc\ub4dc\ub2c8, \uc804\uccb4 \uac04\uc120\uc758 \ucd5c\ub300 \uac1c\uc218\ub294 \\(3N-4\\)\uac1c\uc774\ub2e4.</p> \\[abbb \\cdots bbbc\\] <p>\uc704 \ud615\ud0dc\uc758 \ubb38\uc790\uc5f4\uc774 \uc2e4\uc81c\ub85c \\(3N-4\\)\uac1c\uc758 \uc815\uc810\uc744 \ub9cc\ub4e0\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>\uc704\uc640 \uac19\uc774 \uc815\uc810\uacfc \uac04\uc120\uc758 \ucd5c\ub300 \uac1c\uc218\uac00 \ubaa8\ub450 \\(O(N)\\)\uac1c\uc774\ub2e4. \ub530\ub77c\uc11c Algorithm 1\uc5d0\uc11c \uc815\uc810\uc758 \uc0dd\uc131, \uc0c8\ub85c\uc6b4 \uac04\uc120\uc758 \uc0dd\uc131\uc740 \ucd1d \\(O(N)\\)\uac1c\ubc16\uc5d0 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub294\ub2e4. \uac04\uc120\uc744 \uc0c8\ub86d\uac8c \uc0dd\uc131\ud558\uc9c0\ub294 \uc54a\uc9c0\ub9cc \uc5f0\uc0b0\uc744 \uc2e4\ud589\ud558\ub294 \ubd80\ubd84\uc740 \\(clone\\)\uc744 \ub9cc\ub4e0 \ud6c4 \uc6d0\ub798 \\(q\\)\ub85c \ud5a5\ud558\ub358 \uc77c\ubd80 \uac04\uc120\ub4e4\uc744 \\(clone\\)\uc73c\ub85c \uc62e\uae30\ub294 \ubd80\ubd84\uc774\ub2e4. \ud558\uc9c0\ub9cc \uc774 \uacfc\uc815 \ub610\ud55c \\(O(N)\\)\ubc88 \uc2e4\ud589\ub428\uc744 \uc99d\uba85\ud560 \uc218 \uc788\uace0, \ub530\ub77c\uc11c \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(N)\\)\uc774\ub2e4.</p> <p>\uc774 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \uc54c\ud30c\ubcb3\uc758 \uac1c\uc218 \\(\\Sigma\\)\ub97c \uc0c1\uc218\ub85c \ucde8\uae09\ud558\uc5ec, \uac01 \uc815\uc810\uc5d0\uc11c \ub098\uac00\ub294 \uac04\uc120\ub4e4\uc744 \ud06c\uae30 \\(\\Sigma\\)\uc758 \ubc30\uc5f4\uc5d0 \uc800\uc7a5\ud558\uc600\uc744 \ub54c\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uc774\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N)\\) Space Complexity : \\(O(N\\Sigma)\\) </p> <p>\uac04\uc120\uc744 map\uacfc \uac19\uc740 \uc790\ub8cc\uad6c\uc870\uc5d0 \uc800\uc7a5\ud558\uba74 \uc54c\ud30c\ubcb3\uc758 \uac1c\uc218 \\(\\Sigma\\)\uac00 \uc0c1\uc218\uac00 \uc544\ub2d0 \ub54c\uc5d0\ub3c4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(O(Nlog\\Sigma)\\)\ub85c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(Nlog\\Sigma)\\) Space Complexity : \\(O(N)\\) </p>","tags":["string","suffix_tree","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Automaton/algorithm/#suffix-tree","title":"Suffix Tree","text":"<p>\uae00\uc758 \ucc98\uc74c\uc5d0 \uc5b8\uae09\ud588\ub4ef\uc774, suffix automaton \uc678\uc5d0\ub3c4 suffix array\ub098 suffix tree \ub4f1 \ubd80\ubd84\ubb38\uc790\uc5f4\ub4e4\uc744 \ud6a8\uc728\uc801\uc73c\ub85c \uad00\ub9ac\ud560 \uc218 \uc788\ub294 \uc790\ub8cc\uad6c\uc870\ub4e4\uc774 \uc788\ub2e4. Suffix automaton\uc744 \ud65c\uc6a9\ud558\uba74 suffix tree\ub97c Ukkonen's Algorithm\uc774\ub098 suffix array\ub97c \ud65c\uc6a9\ud558\uc5ec \uad6c\ud558\ub294 \uac83\ubcf4\ub2e4 \ub354 \uc27d\uace0 \ube60\ub974\uac8c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Suffix tree\ub97c \ub2e4\uc2dc \uc5c4\ubc00\ud558\uac8c \uc815\uc758\ud558\uc790.</p> <p>Definition 4</p> <p>Suffix trie\ub294 trie\uc5d0 \\(S\\)\uc758 \ubaa8\ub4e0 suffix\ub97c \uc0bd\uc785\ud55c \uc790\ub8cc\uad6c\uc870\uc774\ub2e4.</p> <p>Suffix tree\ub294 suffix trie\uc5d0\uc11c \uc790\uc2dd \uac04\uc120\uc774 \\(1\\)\uac1c \ubc16\uc5d0 \uc5c6\ub294 \uc815\uc810\uc758 \ubd80\ubaa8 \uac04\uc120\uacfc \uc790\uc2dd \uac04\uc120\uc744 \ud569\uccd0 \uc555\ucd95\ud55c \ud2b8\ub9ac\uc774\ub2e4. \ub530\ub77c\uc11c suffix tree\uc758 \ubaa8\ub4e0 \ub178\ub4dc\ub294 \ub9ac\ud504\uc774\uac70\ub098, \uc790\uc2dd\uc774 \\(2\\)\uac1c \uc774\uc0c1\uc774\ub2e4.</p> <p>Suffix automaton\uc5d0\uc11c \uac01 \uc815\uc810 \\(v\\)\uc5d0 \ub300\ud574 \ub300\uc751\ub418\ub294 \ucd5c\ub300 \uae38\uc774\uc758 \ubb38\uc790\uc5f4 \\(longest(v)\\)\ub294 \ub2e4\uc74c\uc744 \ub9cc\uc871\ud55c\ub2e4. \\(longest(v)\\)\uc758 \uc55e\ucabd\uc5d0 \ud558\ub098\uc758 \ubb38\uc790\ub97c \ucd94\uac00\ud558\uba74 \\(endpos\\) \uc9d1\ud569\uc774 \\(endpos(v)\\)\uc640\ub294 \ub2ec\ub77c\uc57c \ud558\uae30 \ub54c\ubb38\uc5d0, \\(S\\)\uc5d0\uc11c \\(longest(v)\\)\ub97c \ubaa8\ub450 \ucc3e\uc73c\uba74 \uadf8 \uc55e\uc5d0\ub294 \\(0\\)\uac1c, \ud639\uc740 \\(2\\)\uac1c \uc774\uc0c1\uc758 \uc885\ub958\uc758 \ubb38\uc790\uac00 \uc874\uc7ac\ud574\uc57c \ud55c\ub2e4. \ud558\uc9c0\ub9cc \uc774 \uc131\uc9c8\uc740 \\(rev(S)\\)\uc758 suffix tree\uc5d0\uc11c suffix tree\uc5d0 \uc874\uc7ac\ud558\ub294 \ub178\ub4dc \\(u\\)\uac00 \\(0\\)\uac1c, \ud639\uc740 \\(2\\)\uac1c \uc774\uc0c1\uc758 \uc790\uc2dd \ub178\ub4dc\ub97c \uac16\ub294\ub2e4\ub294 \uac83\uacfc \uc644\uc804\ud788 \ub3d9\uce58\uc774\ub2e4. \ub530\ub77c\uc11c Suffix automaton\uc5d0\uc11c \uac01 \uc815\uc810 \\(v\\)\uc5d0 \ub300\ud574 \\(longest(v)\\)\ub97c \ub4a4\uc9d1\uc740 \ubb38\uc790\uc5f4 \\(rev(longest(v))\\)\uc740 \\(rev(S)\\)\uc758 suffix tree\uc5d0 \uc874\uc7ac\ud558\uba70, \uc77c\ub300\uc77c \ub300\uc751\ub428\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>Property 10</p> <p>Suffix automaton\uc5d0\uc11c \uac01 \uc815\uc810 \\(v\\)\uc5d0 \ub300\ud574, \\(S\\)\uc5d0\uc11c \\(longest(v)\\)\ub97c \ucc3e\uc558\uc744 \ub54c \uc55e\uc5d0 \ucd94\uac00\ud560 \uc218 \uc788\ub294 \ubb38\uc790\uc758 \uc885\ub958\ub294 \\(0\\)\uac1c, \ud639\uc740 \\(2\\)\uac1c \uc774\uc0c1\uc774\ub2e4.</p> <p>\\(rev(S)\\)\uc758 suffix tree\uc5d0\uc11c suffix tree\uc5d0 \uc874\uc7ac\ud558\ub294 \uac01 \ub178\ub4dc \\(u\\)\ub294 \\(0\\)\uac1c, \ud639\uc740 \\(2\\)\uac1c \uc774\uc0c1\uc758 \uc790\uc2dd \ub178\ub4dc\ub97c \uac16\uace0, \uc774\ub294 \\(rev(S)\\)\uc5d0\uc11c \\(u\\)\uc5d0 \ub300\uc751\ub418\ub294 \ubd80\ubd84\ubb38\uc790\uc5f4\uc744 \ucc3e\uc558\uc744 \ub54c \ub4a4\uc5d0 \ucd94\uac00\ud560 \uc218 \uc788\ub294 \ubb38\uc790\uc758 \uc885\ub958\ub294 \\(0\\)\uac1c, \ud639\uc740 \\(2\\)\uac1c \uc774\uc0c1\uc784\uc744 \uc758\ubbf8\ud55c\ub2e4.</p> <p>\uc704 \ub450 \uc131\uc9c8\uc740 suffix automaton\uc5d0\uc11c \uac01 \uc815\uc810 \\(v\\)\uc5d0 \ub300\ud574 \\(longest(v)\\)\ub97c \ub4a4\uc9d1\uc740 \ubb38\uc790\uc5f4 \\(rev(longest(v))\\)\uacfc \ub300\uc751\ub418\ub294 \uc815\uc810 \\(u\\)\uac00 \\(rev(S)\\)\uc758 suffix tree\uc5d0 \uc874\uc7ac\ud568\uc744 \uc758\ubbf8\ud558\uba70, suffix automaton\uc758 \uc815\uc810 \\(v\\)\uc640 suffix tree\uc758 \uc815\uc810 \\(u\\)\uac00 \uc77c\ub300\uc77c \ub300\uc751\ub428\uc744 \uc758\ubbf8\ud55c\ub2e4.</p> <p>\ub530\ub77c\uc11c, \ubb38\uc790\uc5f4 \\(S\\)\uc758 suffix automaton\uc758 suffix link\ub97c \uc774\uc5b4 \uc5f0\uacb0\ud55c tree\ub294 \\(S\\)\ub97c \ub4a4\uc9d1\uc740 \ubb38\uc790\uc5f4 \\(rev(S)\\)\uc758 suffix tree\uc640 \uc77c\uce58\ud55c\ub2e4.</p> <p>Property 11</p> <p>\ubb38\uc790\uc5f4 \\(S\\)\uc758 suffix automaton\uc758 suffix link\ub97c \uc774\uc5b4 \uc5f0\uacb0\ud55c tree\ub294 \\(S\\)\ub97c \ub4a4\uc9d1\uc740 \ubb38\uc790\uc5f4 \\(rev(S)\\)\uc758 suffix tree\uc640 \uc77c\uce58\ud55c\ub2e4.</p> <p>\uad6c\uccb4\uc801\uc73c\ub85c, suffix automaton\uc5d0\uc11c \uac01 \uc815\uc810 \\(v\\)\uc5d0 \ub300\uc751\ub418\ub294 \ubd80\ubd84\ubb38\uc790\uc5f4 \\(longest(v)\\)\ub294 \\(rev(S)\\)\uc758 suffix tree\uc5d0\uc11c \\(rev(longest(v))\\)\ub97c \uc758\ubbf8\ud55c\ub2e4.</p> <p></p>","tags":["string","suffix_tree","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Automaton/algorithm/#implementation","title":"Implementation","text":"<pre><code>// len[v] = longest substring corresponding to v\n// link[v] = suffix link of v\n// chd[v] = children node of v in suffix automaton ** NOT SUFFIX TREE **\nstruct Node\n{\n    int len, link;\n    vector&lt;int&gt; chd;\n    Node()\n    {\n        len=0; link=-1;\n        chd=vector&lt;int&gt;(26, -1);\n    }\n};\n\nvector&lt;Node&gt; NS;\n// last, root needs to be initialized\nint last=-1, root=-1;\n\n// Maximum size of NS is 2|S|\n// Maximum number of edge is 3|S|\nint newNode()\n{\n    NS.push_back(Node());\n    return NS.size()-1;\n}\n\n// Insert c into suffix automaton\n// last = last node corresponding to entire string before c\nvoid SA_push(char c)\n{\n    int cur=newNode();\n    NS[cur].len=NS[last].len+1;\n    int p=last;\n    for(; p!=-1 &amp;&amp; NS[p].chd[c-'a']==-1; p=NS[p].link) NS[p].chd[c-'a']=cur;\n\n    if(p==-1) NS[cur].link=0;\n    else\n    {\n        int q=NS[p].chd[c-'a'];\n        if(NS[p].len+1==NS[q].len) NS[cur].link=q;\n        else\n        {\n            int clone=newNode();\n            NS[clone].len=NS[p].len+1;\n            NS[clone].link=NS[q].link;\n            NS[clone].chd=NS[q].chd;\n            for(; p!=-1 &amp;&amp; NS[p].chd[c-'a']==q; p=NS[p].link) NS[p].chd[c-'a']=clone;\n            NS[q].link=clone; NS[cur].link=clone;\n        }\n    }\n\n    last=cur;\n}\n\n// Get suffix automaton of S\n// root = root node of suffix automaton\nvoid getSA(string S) // S is 1-based (leading \"?\")\n{\n    int N=S.size()-1;\n    root=last=newNode();\n    for(int i=1; i&lt;=N; i++) SA_push(S[i]); // last is current node\n}\n\n// Get suffix tree of S\n// Return array of nodes corresponding to each suffix\n// pos[i] = leaf node of S[i...] in suffix tree of S\n// root = root node of suffix tree\nvector&lt;int&gt; getST(string S) // S is 1-based (leading \"?\")\n{\n    int N=S.size()-1;\n    vector&lt;int&gt; pos(N+1);\n\n    root=last=newNode();\n    for(int i=N; i&gt;=1; i--)\n    {\n        SA_push(S[i]);\n        pos[i]=last;\n    }\n    return pos;\n}\n</code></pre>","tags":["string","suffix_tree","~ algorithm"]},{"location":"algorithms/Strings/Suffix%20Automaton/algorithm/#reference","title":"Reference","text":"<ul> <li>https://cp-algorithms.com/string/suffix-automaton.html</li> <li>http://e-maxx.ru/algo/suffix_automata</li> <li>https://koosaga.com/314</li> <li>https://codeforces.com/blog/entry/20861</li> </ul>","tags":["string","suffix_tree","~ algorithm"]},{"location":"algorithms/Strings/Z%20Function/algorithm/","title":"Z Function","text":"","tags":["string","~ algorithm"]},{"location":"algorithms/Strings/Z%20Function/algorithm/#definition","title":"Definition","text":"<p>Definition 1</p> <p>\\(Z[i] := i\\)\uc5d0\uc11c \uc2dc\uc791\ud558\ub294 \\(S\\)\uc758 suffix\uc640 \uc804\uccb4 \ubb38\uc790\uc5f4 \\(S\\)\uc758 longest common prefix\uc758 \uae38\uc774  \\(Z[i] := LCP(S[1 \\cdots ], S[i \\cdots])\\), \\(i \\ge 2\\)\ubd80\ud130 \uc815\uc758\ub418\uace0, \\(Z[1]=0\\)\uc774\ub77c \ud55c\ub2e4.</p> <p>\uc608\ub97c \ub4e4\uc5b4, \"aaaaa\"\uc758 \\(Z\\) \ud568\uc218\ub294 [0, 4, 3, 2, 1], \"aaabaab\"\uc758 \\(Z\\) \ud568\uc218\ub294 [0, 2, 1, 0, 2, 1, 0], \"abacaba\"\uc758 \\(Z\\) \ud568\uc218\ub294 [0, 0, 1, 0, 3, 0, 1]\uc774\ub2e4.</p>","tags":["string","~ algorithm"]},{"location":"algorithms/Strings/Z%20Function/algorithm/#algorithm","title":"Algorithm","text":"<p>\ubb38\uc790\uc5f4\uc744 \uc55e\uc5d0\uc11c\ubd80\ud130 \ubcf4\uba74\uc11c \\(Z\\) Function\uc744 \uad6c\ud558\uace0, \uadf8 \uacfc\uc815\uc5d0\uc11c \uc774\ubbf8 \uad6c\ud55c \uac12\ub4e4\uc744 \ucd5c\ub300\ud55c \uc7ac\ud65c\uc6a9\ud558\uc790. \uc774\ub97c \uc704\ud558\uc5ec \uc9c0\uae08\uae4c\uc9c0 \uacc4\uc0b0\ud55c \\(Z\\) \uac12\ub4e4 \uc911 \uac00\uc7a5 \ub4a4\ucabd \uc704\uce58\uc5d0 \ud574\ub2f9\ud558\ub294 \uac12\uc744 \\(r=pos+Z[pos]-1\\)\uc774\ub77c \ud558\uc790. \\(r\\)\uc758 \uc758\ubbf8\ub294, \uc9c0\uae08\uae4c\uc9c0 \uc6b0\ub9ac\uac00 \uacc4\uc0b0\uc744 \ud558\uba74\uc11c \ud55c\ubc88\uc774\ub77c\ub3c4 \ubcf8 \uc801\uc774 \uc788\ub294 \\(S\\)\uc758 \ucd5c\ub300 \uc704\uce58\uac00 \\(r\\)\uc774\ub77c\ub294 \uac83\uc774\ub2e4. \ub9cc\uc57d \ud604\uc7ac \uc704\uce58 \\(i\\)\uac00 \\(r\\)\ubcf4\ub2e4 \uc791\uac70\ub098 \uac19\uc740, \uc774\ubbf8 \uc2a4\uce94\uc774 \ub41c \uce78\uc774\ub77c\uba74 \uc774\ubbf8 \uacc4\uc0b0\ub41c \uac12\ub4e4\uc744 \uc774\uc6a9\ud558\uc5ec \uacc4\uc0b0\ud558\uace0, \uc0c8\ub85c\uc6b4 \uce78\uc744 \ubd10\uc57c \ud558\ub294 \uc0c1\ud669\uc774\ub77c\uba74 \\(r\\)\uc744 \ud55c\uce78\uc529 \uc99d\uac00\uc2dc\ud0a4\uba70 \ub2f5\uc744 \uad6c\ud558\uc790. \uc774\uc640 \uac19\uc740 \ubc29\ubc95\uc744 \uc0ac\uc6a9\ud558\uba74 \uacb0\uad6d \ubaa8\ub4e0 \uce78\ub4e4\uc740 \ucd5c\ub300 \\(O(1)\\)\ubc88 \uc2a4\uce94\ub418\ub2c8, \\(O(N)\\)\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\uc744 \uac83\uc774\ub2e4.</p> <p></p> <p>\uad6c\uccb4\uc801\uc73c\ub85c, \ud604\uc7ac \uc704\uce58 \\(i\\)\uac00 \\(r\\)\ubcf4\ub2e4 \uc791\uac70\ub098 \uac19\uc740 \uc0c1\ud669\uc774\uba74, \uc704 \uadf8\ub9bc\uacfc \uac19\uc774 \uc6b0\ub9ac\uac00 \\(i\\)\uc5d0\uc11c\ubd80\ud130 \uc2dc\uc791\ud558\uc5ec \uc804\uccb4 \ubb38\uc790\uc5f4\uacfc LCP\ub97c \uad6c\ud558\uace0 \uc2f6\uc740 \ubd80\ubd84\ubb38\uc790\uc5f4\uc774 \uc815\ud655\ud788 \\(S\\)\uc758 \uc55e\ucabd\uc5d0 \uc774\ubbf8 \uc874\uc7ac\ud55c\ub2e4. \ub530\ub77c\uc11c \uc774 \ub54c\uc758 \\(Z\\)\uac12\uc740 \uc774\ubbf8 \uad6c\ud574 \ub193\uc558\uc73c\ubbc0\ub85c \uc7ac\ud65c\uc6a9\ud560 \uc218 \uc788\uace0, \ub9cc\uc57d \uc774 \uac12\uc774 \\(i\\)\uc758 \uc704\uce58\uc5d0\uc11c \uc2dc\uc791\ud558\uc600\uc744 \ub54c \\(r\\)\uc744 \ub118\uc5b4\uac04\ub2e4\uba74 \uadf8 \ub4a4\ucabd\uc758 \uac12\ub4e4\uc740 \uc544\uc9c1 \ud55c\ubc88\ub3c4 \ud655\uc778\ud558\uc9c0 \ubabb\ud588\uae30 \ub54c\ubb38\uc5d0 \ub118\uc5b4\uac00\uc9c0 \ubabb\ud574\uc8fc\ub3c4\ub85d \ud574\uc57c \ud55c\ub2e4.</p> <p>\uc5ec\uae30\uae4c\uc9c0\uac00 \uc6b0\ub9ac\uac00 \uc54c\uace0 \uc788\ub294 \uc815\ubcf4\ub97c \uc7ac\ud65c\uc6a9\ud55c \ubd80\ubd84\uc774\uace0, \uc774\ud6c4 \\(r\\)\uc744 \ub118\uc5b4\uc11c \uc0c8\ub86d\uac8c \uc2a4\uce94\ud558\uc600\uc744 \ub54c \ucd94\uac00\ub85c \uc77c\uce58\ud558\ub294 \ubb38\uc790\ub4e4\uc774 \uc788\uc744 \uc218 \uc788\uc74c\uc73c\ub85c \ubc29\uae08 \uad6c\ud55c \uc7ac\ud65c\uc6a9\uac12\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \ud0d0\uc0c9\uc744 \uc774\uc5b4 \ub098\uac00\uba74 \ub41c\ub2e4.</p> <p>Algorithm 1</p> <p>\\(Z\\) Function\uc744 \uc55e\uc5d0\uc11c\ubd80\ud130 \ud55c \uce78\uc529 \uacc4\uc0b0\ud55c\ub2e4. \uacc4\uc0b0 \uacfc\uc815\uc5d0\uc11c \uc9c0\uae08\uae4c\uc9c0 \uacc4\uc0b0\ud55c \\(Z\\) \uac12\ub4e4 \uc911 \uac00\uc7a5 \ub4a4\ucabd \uc704\uce58\uc5d0 \ud574\ub2f9\ud558\ub294 \uac12\uc744 \\(r=pos+Z[pos]-1\\)\uc774\ub77c \ud558\uc790.</p> <p>\ud604\uc7ac \uc704\uce58 \\(i\\)\uac00 \\(r\\)\ubcf4\ub2e4 \uc791\uac70\ub098 \uac19\uc740 \uc0c1\ud669\uc774\uba74, \\(i\\)\uc5d0\uc11c\ubd80\ud130 \\(r\\)\uae4c\uc9c0\uc758 \ubb38\uc790\uc5f4\uc774 \uc774\ubbf8 \\(S\\)\uc758 \uc55e\ucabd\uc5d0 \uc704\uce58\ud558\uace0 \uc788\uc73c\ub2c8 \uc774\ubbf8 \uad6c\ud588\ub358 \\(Z\\)\uac12\uc744 \uc774\uc6a9\ud558\uc5ec \uc0c8\ub85c\uc6b4 \\(Z\\)\uac12\uc744 \uad6c\ud55c\ub2e4. \uc774 \ub54c \ub9cc\uc57d \uc774 \uac12\uc774 \\(i\\)\uc758 \uc704\uce58\uc5d0\uc11c \uc2dc\uc791\ud558\uc600\uc744 \ub54c \\(r\\)\uc744 \ub118\uc5b4\uac04\ub2e4\uba74 \\(r\\)\uc744 \ub118\uc9c0 \ubabb\ud558\ub3c4\ub85d \ud574\uc900\ub2e4. \uc774\ud6c4 \\(r\\)\uc744 \ub118\uc5b4\uc11c \uc0c8\ub86d\uac8c \uc2a4\uce94\ud558\uc600\uc744 \ub54c \ucd94\uac00\ub85c \uc77c\uce58\ud558\ub294 \ubb38\uc790\ub4e4\uc774 \uc788\uc744 \uc218 \uc788\uc74c\uc73c\ub85c \ubc29\uae08 \uad6c\ud55c \uc7ac\ud65c\uc6a9\uac12\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \ud0d0\uc0c9\uc744 \uc774\uc5b4 \ub098\uac04\ub2e4. \uc791\uc5c5 \ud6c4 \\(pos\\)\ub97c \uac31\uc2e0\ud55c\ub2e4.</p> <p>\uc774\uc640 \uac19\uc740 \uc54c\uace0\ub9ac\uc998\uc758 \ub3d9\uc791 \uacfc\uc815 \uc911 \ud0d0\uc0c9\uc744 \ud560 \ub54c\ub9c8\ub2e4 \\(r\\)\uc774 \ucd5c\uc18c \\(1\\)\uce78\uc529 \uc774\ub3d9\ud558\uba70, \\(r\\)\uc758 \ucd1d \uc774\ub3d9\ud69f\uc218\ub294 \\(O(N)\\)\uc774\ubbc0\ub85c, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub3c4 \\(O(N)\\)\uc774 \ub41c\ub2e4.</p> <p>Time Complexity</p> <p>Time Complexity : \\(O(N)\\)</p>","tags":["string","~ algorithm"]},{"location":"algorithms/Strings/Z%20Function/algorithm/#implementation","title":"Implementation","text":"<pre><code>vector&lt;int&gt; getZ(int N, string &amp;S)\n{\n    vector&lt;int&gt; Z(N+1);\n\n    int pos=1;\n    for(int i=2; i&lt;=N; i++)\n    {\n        if(i&lt;=pos+Z[pos]-1) Z[i]=min(pos+Z[pos]-i, Z[i-pos+1]);\n        for(; i+Z[i]&lt;=N &amp;&amp; S[i+Z[i]]==S[Z[i]+1]; Z[i]++);\n        if(Z[pos]+pos&lt;Z[i]+i) pos=i;\n    }\n    return Z;\n}\n</code></pre>","tags":["string","~ algorithm"]},{"location":"algorithms/Strings/Z%20Function/algorithm/#application","title":"Application","text":"<p>Prefix Function\ub294 \ubb38\uc790\uc5f4 \\(S\\)\uc758 \ubaa8\ub4e0 prefix \\(S[1 \\cdots i]\\)\uc5d0 \ub300\ud558\uc5ec prefix \uc640 suffix \uac00 \ub3d9\uc77c\ud55c proper prefix\uc758 \ucd5c\ub300 \uae38\uc774\ub97c \uad6c\ud558\ub294 \ud568\uc218\uc774\ub2e4. \uc774\ub97c \uc751\uc6a9\ud55c KMP\ub294 \ubb38\uc790\uc5f4 \\(S\\)\uc758 \ubaa8\ub4e0 prefix \\(S[1 \\cdots i]\\)\uc5d0 \ub300\ud558\uc5ec \\(S\\)\uc758 suffix\uc640 \ubb38\uc790\uc5f4 \\(T\\)\uc758 prefix\uac00 \ub3d9\uc77c\ud55c \ucd5c\ub300 \uae38\uc774\ub97c \uad6c\ud558\ub294 \uc54c\uace0\ub9ac\uc998\uc774\ub2e4. \uadf8\ub9ac\uace0, \uc2e4\uc81c\ub85c \uad6c\ud604\uc740 \uac70\uc758 \ub3d9\uc77c\ud558\ub2e4.</p> <p>\uc774\uc640 \uac19\uc740 \ub17c\ub9ac\ub85c, \\(Z\\) Function\uc740 \\(S\\)\uc758 \ubaa8\ub4e0 suffix \\(S[1 \\cdots i]\\)\uc640 \uc804\uccb4 \ubb38\uc790\uc5f4 \\(S\\)\uc758 longest common prefix\uc758 \uae38\uc774\ub97c \uad6c\ud558\ub294 \ud568\uc218\uc774\ub2e4. \uc774\ub97c \uc751\uc6a9\ud558\uba74, \ubb38\uc790\uc5f4 \\(S\\)\uc758 \ubaa8\ub4e0 suffix \\(S[1 \\cdots i]\\)\uc640 \ubb38\uc790\uc5f4 \\(T\\)\uc758 longest common prefix\uc758 \uae38\uc774\ub97c \uad6c\ud560 \uc218 \uc788\ub2e4. \uc774 \ub610\ud55c \uad6c\ud604\uc740 \uac70\uc758 \ub3d9\uc77c\ud558\uba70 \uc774\ubbf8 \uacc4\uc0b0\ub41c \\(T\\)\uc758 \\(Z\\) \uac12\uc744 \uc774\uc6a9\ud558\uc5ec \uacc4\uc0b0\ud574\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\uc774 \uc54c\uace0\ub9ac\uc998\uc744 \uc774\uc6a9\ud558\uba74 KMP\uc640 \ub3d9\uc77c\ud558\uac8c, \\(S\\)\uc5d0\uc11c \\(T\\)\uc758 \ub4f1\uc7a5 \uc704\uce58\ub97c \ubaa8\ub450 \\(O(N+M)\\)\uc5d0 \ucc3e\uc744 \uc218 \uc788\ub2e4.</p> <p>Time Complexity</p> <p>Time Complexity : \\(O(N+M)\\)</p> <pre><code>vector&lt;int&gt; match(int N, int M, string &amp;S, string &amp;T)\n{\n    //Get LCP of all suffixes in S with T\n    vector&lt;int&gt; Z = getZ(M, T);\n    vector&lt;int&gt; F(N+1);\n\n    pos=0;\n    for(int i=1; i&lt;=N; i++)\n    {\n        if(i&lt;=pos+F[pos]-1) F[i]=min(Z[i-pos+1], pos+F[pos]-i);\n        for(; i+F[i]&lt;=N &amp;&amp; F[i]+1&lt;=M &amp;&amp; S[i+F[i]]==T[F[i]+1]; F[i]++);\n        if(pos+F[pos]&lt;i+F[i]) pos=i;\n    }\n    return F;\n}\n</code></pre>","tags":["string","~ algorithm"]},{"location":"algorithms/Strings/Z%20Function/algorithm/#reference","title":"Reference","text":"<ul> <li>https://cp-algorithms.com/string/z-function.html</li> <li>https://codeforces.com/blog/entry/3107</li> </ul>","tags":["string","~ algorithm"]},{"location":"ideas/","title":"Ideas &amp; Techniques","text":""},{"location":"ideas/#table-of-contents","title":"Table of Contents","text":"<ul> <li>SCC of Tournament Graph</li> <li>Potential Method</li> <li>Tree Optimization</li> </ul>"},{"location":"ideas/#todo","title":"Todo","text":"<ul> <li>Tree Optimization 2 (with HLD)</li> <li>O(N^2) tree dp memory optimization with HLD</li> <li>Number of Triangles in Graph</li> <li>graphs without odd / even cycles</li> </ul>"},{"location":"ideas/Potential%20Method/idea/","title":"Potential Method","text":"","tags":["~idea"]},{"location":"ideas/Potential%20Method/idea/#definition","title":"Definition","text":"<p>Ammortized time complexity\ub97c \ubd84\uc11d\ud558\uae30 \uc704\ud558\uc5ec, \ud604\uc7ac \uc790\ub8cc\uad6c\uc870\uc758 \uc0c1\ud0dc\ub97c \ub098\ud0c0\ub0bc \uc218 \uc788\ub294 potential function \\(\\Phi(S)\\)\ub97c \uc815\uc758\ud558\uc790. \\(\\Phi(S)\\)\ub294 \uc790\ub8cc\uad6c\uc870\uac00 \uc774\uc0c1\uc801\uc778 \uc0c1\ud0dc\uc640 \ube44\uad50\ud574 \uc5bc\ub9c8\ub098 \uc5b4\uc9c0\ub7fd\ud600 \uc788\ub294\uc9c0\ub97c \ub098\ud0c0\ub0b4\ub294 \ud568\uc218\ub85c, \ubb3c\ub9ac\uc5d0\uc11c\uc758 \uc704\uce58\uc5d0\ub108\uc9c0\uc640 \uac19\uc740 \uac1c\ub150\uc73c\ub85c \uc0dd\uac01\ud574\ub3c4 \uc88b\ub2e4.</p> <p>Definition 1</p> <ul> <li>\\(\\Phi(S):=\\) \uc790\ub8cc\uad6c\uc870\uac00 \uc0c1\ud0dc \\(S\\)\uc77c \ub54c\uc758 potential function \\((\\Phi : S \\rightarrow \\mathbb{R}_{\\ge 0})\\)</li> <li>\\(T_{\\text{ammortized}}(o)=T_{\\text{actual}}(o)+C \\cdot \\varDelta \\Phi(S) = T_{\\text{actual}}(o)+C \\cdot (\\Phi(S_{\\text{after}})-\\Phi(S_{\\text{before}}))\\)</li> </ul> <p>\uc704 Definition 1\uacfc \uac19\uc774 \\(\\Phi(S)\\)\uc640 \\(T_{\\text{ammortized}}(o)\\)\ub97c \uc815\uc758\ud55c\ub2e4\uba74, \uc5ec\ub7ec \uc5f0\uc0b0\ub4e4 \\(O=\\{o_1, o_2, ..., o_n\\}\\)\uc744 \ubaa8\ub450 \uc2e4\ud589\ud55c \ud6c4\uc758 \uc2e4\uc81c \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(T_{\\text{actual}}(O)\\)\uc758 \uc0c1\ud55c\uc744 ammortized \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(T_{\\text{ammortized}}(O)\\)\ub97c \uc774\uc6a9\ud558\uc5ec \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Property 1</p> <p>\uc5f0\uc0b0\ub4e4 \\(O=\\{o_1, o_2, ..., o_n\\}\\)\uc5d0 \ub300\ud558\uc5ec \uc2e4\uc81c \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub97c \\(T_{\\text{actual}}(O)\\), ammortized \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub97c \\(T_{\\text{ammortized}}(O)\\)\ub77c \ud55c\ub2e4\uba74 \ub2e4\uc74c\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> \\[\\displaystyle T_{\\text{ammortized}}(O) =\\sum_{i=1}^{n} (T_{\\text{actual}}(o_i)+C \\cdot (\\Phi(S_i)-\\Phi(S_{i-1}))) \\] \\[ T_{\\text{ammortized}}(O) =T_{\\text{actual}}(O)+C \\cdot (\\Phi(S_n)-\\Phi(S_0)) \\] \\[T_{\\text{actual}}(O)=T_{\\text{ammortized}}(O)-C \\cdot (\\Phi(S_n)-\\Phi(S_0))\\] <p>\\(\\Phi(S_0)=0\\), \\(\\Phi(S_n) \\ge 0\\)\uc774\ub2c8, \\(T_{\\text{actual}}(O) \\le T_{\\text{ammortized}}(O)\\)\uac00 \uc131\ub9bd\ud55c\ub2e4.</p>","tags":["~idea"]},{"location":"ideas/Potential%20Method/idea/#example","title":"Example","text":"","tags":["~idea"]},{"location":"ideas/Potential%20Method/idea/#multi-pop-stack","title":"Multi-Pop Stack","text":"<p>\uac04\ub2e8\ud55c \uc608\uc2dc\ub85c, \ub2e4\uc74c\uacfc \uac19\uc740 \ub450 \uc5f0\uc0b0\uc744 \uc9c0\uc6d0\ud558\ub294 \uc2a4\ud0dd \\(S\\)\ub97c \uc0dd\uac01\ud558\uc790.</p> <ul> <li>\\(S\\)\uc5d0 \uc0c8\ub85c\uc6b4 \uc6d0\uc18c\ub97c \ud558\ub098 \ucd94\uac00\ud55c\ub2e4.</li> <li>\\(S\\)\uc5d0\uc11c \\(k\\) \\((k \\le |S|)\\)\uac1c\uc758 \uc6d0\uc18c\ub97c \uc81c\uac70\ud55c\ub2e4.</li> </ul> <p>Property 2</p> <p>\uc2a4\ud0dd \\(S\\)\uac00 \ub2e4\uc74c \ub450 \uc5f0\uc0b0\uc744 \uc9c0\uc6d0\ud560 \ub54c, \\(N\\)\uac1c\uc758 \uc5f0\uc0b0\uc758 \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(N)\\)\uc774\ub2e4.</p> <ul> <li>\\(S\\)\uc5d0 \uc0c8\ub85c\uc6b4 \uc6d0\uc18c\ub97c \ud558\ub098 \ucd94\uac00\ud55c\ub2e4.</li> <li>\\(S\\)\uc5d0\uc11c \\(k\\) \\((k \\le |S|)\\)\uac1c\uc758 \uc6d0\uc18c\ub97c \uc81c\uac70\ud55c\ub2e4.</li> </ul> <p>Proof</p> <p>Potential function \\(\\Phi(S)=|S|\\)\uc774\ub77c \ud558\uc790. \uac01 \uacbd\uc6b0\uc5d0 \ub300\ud558\uc5ec \\(T_{\\text{ammortized}}(o)\\)\ub97c \ubd84\uc11d\ud558\uc790.</p> <ul> <li>\\(S\\)\uc5d0 \uc0c8\ub85c\uc6b4 \uc6d0\uc18c\ub97c \ud558\ub098 \ucd94\uac00\ud560 \ub54c\ub294, \\(T_{\\text{actual}}(o)=1\\), \\(\\varDelta \\Phi(S)=1\\)\uc774\ub2c8, \\(T_{\\text{ammortized}}(o)=O(1)\\)</li> <li>\\(S\\)\uc5d0\uc11c \\(k\\) \\((k \\le |S|)\\)\uac1c\uc758 \uc6d0\uc18c\ub97c \uc81c\uac70\ud560 \ub54c\ub294, \\(T_{\\text{actual}}(o)=k\\), \\(\\varDelta \\Phi(S)=-k\\)\uc774\ub2c8, \\(T_{\\text{ammortized}}(o)=O(1)\\)</li> </ul> <p>\ub530\ub77c\uc11c, \uac01 \uc5f0\uc0b0\uc758 ammortized \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uac00 \\(T_{\\text{ammortized}}(o)=O(1)\\)\uc774\ub2c8, \\(T_{\\text{ammortized}}(O)=O(N)\\)\uc774\uace0 \\(T_{\\text{actual}}(O) = O(N)\\)\uc774\ub2e4.</p>","tags":["~idea"]},{"location":"ideas/Potential%20Method/idea/#binary-counter","title":"Binary Counter","text":"<p>\uc218\ub4e4\uc744 \uc774\uc9c4\uc218\ub85c \ud45c\ud604\ud560 \ub54c, \\(x=0\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \\(x\\)\ub97c \\(1\\)\uc529 \uc99d\uac00\uc2dc\ud0a4\ub294 \uc5f0\uc0b0\uc744 \uc0dd\uac01\ud558\uc790. \ud55c \ubc88\uc5d0 \ud55c \uac1c\uc758 \ube44\ud2b8\ub9cc \ubc14\uafc0 \uc218 \uc788\uc744 \ub54c, \uac01 \uc5f0\uc0b0\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uac00 ammortized \\(O(1)\\)\uc784\uc744 \ubcf4\uc774\uc790.</p> <p>Property 3</p> <p>\uc218\ub4e4\uc744 \uc774\uc9c4\uc218\ub85c \ud45c\ud604\ud560 \ub54c, \\(x=0\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \\(x\\)\ub97c \\(1\\)\uc529 \uc99d\uac00\uc2dc\ud0a4\ub294 \uc5f0\uc0b0\uc744 \uc0dd\uac01\ud558\uc790. \ud55c \ubc88\uc5d0 \ud55c \uac1c\uc758 \ube44\ud2b8\ub9cc \ubc14\uafc0 \uc218 \uc788\uc744 \ub54c, \uac01 \uc5f0\uc0b0\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 ammortized \\(O(1)\\)\uc774\ub2e4.</p> <p>Proof</p> <p>Potential function \\(\\Phi(x)=x\\)\uc758 \ucf1c\uc9c4 \ube44\ud2b8\uc758 \uc218\ub77c \ud558\uc790.</p> \\[x= ...0111111_{(2)} \\rightarrow x= ...1000000_{(2)}\\] <p>\uac01 \uc5f0\uc0b0\uc740 \\(0\\)\ubc88\uc9f8 \ube44\ud2b8\ubd80\ud130 \uc5f0\uc18d\ud558\uc5ec \ucf1c\uc838 \uc788\ub294 \ube44\ud2b8\ub4e4\uc744 \ubaa8\ub450 \ub4a4\uc9d1\ub294\ub2e4. \ub530\ub77c\uc11c \\(0\\)\ubc88\uc9f8 \ube44\ud2b8\ubd80\ud130 \uc5f0\uc18d\ud558\uc5ec \ucf1c\uc838 \uc788\ub294 \ube44\ud2b8\ub4e4\uc774 \\(k\\)\uac1c\uc77c \ub54c, \\(T_{\\text{actual}}(o)=k+1\\), \\(\\varDelta \\Phi(S)=-k+1\\)\uc774\ub2c8, \\(T_{\\text{ammortized}}(o)=2\\)\uc774\ub2e4.</p> <p>\ub530\ub77c\uc11c, \uac01 \uc5f0\uc0b0\uc758 ammortized \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uac00 \\(T_{\\text{ammortized}}(o)=O(1)\\)\uc774\ub2c8, \\(N\\)\uac1c\uc758 \uc5f0\uc0b0\uc5d0 \ub300\ud574\uc11c \\(T_{\\text{ammortized}}(O)=O(N)\\)\uc774\uace0 \\(T_{\\text{actual}}(O) = O(N)\\)\uc774\ub2e4.</p>","tags":["~idea"]},{"location":"ideas/Potential%20Method/idea/#dynamic-array","title":"Dynamic Array","text":"<p>C++\uc758 <code>std::vector</code>\uacfc \uac19\uc774 \ud06c\uae30\ub97c \\(1\\)\uc529 \uc99d\uac00\uc2dc\ud0ac \uc218 \uc788\ub294 \ubc30\uc5f4\uc744 \uc0dd\uac01\ud558\uc790. \uc2e4\uc81c \uae38\uc774 \\(n\\)\uc758 dynamic array\ub97c \uad00\ub9ac\ud558\uae30 \uc704\ud558\uc5ec \uc2e4\uc81c\ub85c\ub294 \uae38\uc774 \\(N\\)\uc758 \ubc30\uc5f4\uc5d0 \uac12\ub4e4\uc744 \uc800\uc7a5\ud55c\ub2e4. \ud06c\uae30\ub97c \\(1\\) \uc99d\uac00\uc2dc\ucf1c\uc57c \ub418\ub294 \uc0c1\ud669\uc77c \ub54c \ub2e4\uc74c\uacfc \uac19\uc774 \uc791\ub3d9\ud55c\ub2e4.</p> <ul> <li>\\(n&lt;N\\)\uc774\ub77c\uba74 \uc544\uc9c1 \uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 \uce78\uc774 \ub0a8\uc544 \uc788\uc73c\ub2c8 \\(n\\)\uc744 \\(1\\) \uc99d\uac00\uc2dc\ud0a8\ub2e4.</li> <li>\\(n=N\\)\uc774\ub77c\uba74 \ud06c\uae30 \\(N=2n\\)\uc758 \ubc30\uc5f4\ub85c \ubaa8\ub4e0 \uc218\ub4e4\uc744 \uc62e\uae34 \ud6c4 \\(n\\)\uc744 \\(1\\) \uc99d\uac00\uc2dc\ud0a8\ub2e4.</li> </ul> <p>\uc704 \uc54c\uace0\ub9ac\uc998\uc740 \\(n \\le N \\le 2n\\)\uc774 \uc131\ub9bd\ud558\ub2c8, \uc2e4\uc81c \uae38\uc774 \\(n\\)\uc758 dynamic array\ub97c \uad00\ub9ac\ud558\uae30 \uc704\ud558\uc5ec \\(O(n)\\) \ud06c\uae30\uc758 \uba54\ubaa8\ub9ac\ub9cc \uc0ac\uc6a9\ud568\uc744 \uc54c \uc218 \uc788\ub2e4. \uc774\uc81c \ud06c\uae30\ub97c \\(1\\) \uc99d\uac00\uc2dc\ud0a4\ub294 \uc2dc\uac04\uc774 ammortized \\(O(1)\\)\uc784\uc744 \ubcf4\uc774\uc790.</p> <p>Property 4</p> <p>Dynamic array\uc758 \ud06c\uae30\ub97c \\(1\\) \uc99d\uac00\uc2dc\ud0a4\ub294 \uc5f0\uc0b0\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 ammortized \\(O(1)\\)\uc774\ub2e4.</p> <p>Proof</p> <p>Potential function \\(\\Phi(S)=2n-N\\)\uc774\ub77c \ud558\uc790. \\(n \\le N \\le 2n\\)\uc5d0 \uc758\ud574 \\(\\Phi(S) \\le 0\\)\uc774 \uc131\ub9bd\ud55c\ub2e4. \uac01 \uacbd\uc6b0\uc5d0 \ub300\ud558\uc5ec \\(T_{\\text{ammortized}}(o)\\)\ub97c \ubd84\uc11d\ud558\uc790.</p> <ul> <li>\\(n&lt;N\\)\uc774\ub77c\uba74 \\(T_{\\text{actual}}(o)=1\\), \\(\\varDelta \\Phi(S)=2\\)\uc774\ub2c8, \\(T_{\\text{ammortized}}(o)=O(1)\\)</li> <li>\\(n=N\\)\uc774\ub77c\uba74 \\(T_{\\text{actual}}(o)=3n\\), \\(\\varDelta \\Phi(S)=-n\\)\uc774\ub2c8, \\(C=3\\)\uc73c\ub85c \uc124\uc815\ud558\uba74 \\(T_{\\text{ammortized}}(o)=O(1)\\)</li> </ul> <p>\ub530\ub77c\uc11c, \uac01 \uc5f0\uc0b0\uc758 ammortized \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uac00 \\(T_{\\text{ammortized}}(o)=O(1)\\)\uc774\ub2c8, \\(T_{\\text{ammortized}}(O)=O(N)\\)\uc774\uace0 \\(T_{\\text{actual}}(O) \\le O(N)\\)\uc774\ub2e4.</p>","tags":["~idea"]},{"location":"ideas/Potential%20Method/idea/#application","title":"Application","text":"<p>Splay tree, segment tree beats, kinetic segment tree \ub4f1\uc758 \ub2e4\uc591\ud55c ammortized \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub97c \uac16\ub294 \uc790\ub8cc\uad6c\uc870\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \uc99d\uba85\uc744 potential method\ub97c \uc774\uc6a9\ud558\uc5ec \ud560 \uc218 \uc788\ub2e4.</p> <p>Segment Tree Beats</p> <p>Merging / Splitting Dynamic Segment Trees</p>","tags":["~idea"]},{"location":"ideas/Potential%20Method/idea/#reference","title":"Reference","text":"<ul> <li>https://en.wikipedia.org/wiki/Potential_method</li> <li>https://algoshitpo.github.io/2020/03/23/PotentialMethod/</li> </ul>","tags":["~idea"]},{"location":"ideas/SCC%20of%20Tournament%20Graph/idea/","title":"SCC of Tournament Graph","text":"<p>Definition 1</p> <p>Tournament graph\ub294 \uc815\uc810\uc774 \\(N\\)\uac1c\uc778 \ubb34\ubc29\ud5a5 \uc644\uc804\uadf8\ub798\ud504\uc758 \ubaa8\ub4e0 \uac04\uc120\uc5d0 \ubc29\ud5a5\uc131\uc744 \ubd80\uc5ec\ud55c \ubc29\ud5a5\uadf8\ub798\ud504\uc774\ub2e4. \uc815\uc810 \\(N\\)\uac1c\uc778 tournament graph\uc758 \uac04\uc120\uc740 \ucd1d \\(\\binom{N}{2}\\)\uac1c\uc774\ub2e4.</p> <p>Tournament graph\ub294 \ub9e4\uc6b0 \ubcf5\uc7a1\ud55c \ud615\ud0dc\uc774\ub2c8, \uc774\ub97c \uad6c\uc870\ud654\uc2dc\ud0a4\uae30 \uc704\ud558\uc5ec \uadf8\ub798\ud504\ub97c SCC\ubcc4\ub85c \ubb36\uc5b4 \uc815\ub9ac\ud558\uc790.</p>","tags":["graphs","scc","~idea"]},{"location":"ideas/SCC%20of%20Tournament%20Graph/idea/#property-1","title":"Property 1","text":"<p>Property 1</p> <p>Tournament graph \\(G=(V, E)\\)\ub97c SCC\ubcc4\ub85c \ubb36\uc5b4 \uc704\uc0c1\uc815\ub82c\ud55c \uc21c\uc11c\ub300\ub85c \ub098\uc5f4\ud558\uc790. \uac01 SCC \uc9d1\ud569\uc744 \uc704\uc0c1\uc815\ub82c \uc21c\uc11c\ub300\ub85c \\(S_1, S_2, \\cdots, S_k\\)\ub77c \ud558\uba74 \ub2e4\uc74c\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> \\[\\forall 1 \\le i &lt; j \\le k, \\forall u \\in S_i, \\forall v \\in S_j, (u, v) \\in E\\] <p>\uc989, \uc11c\ub85c \ub2e4\ub978 \ub450 SCC\uc5d0 \uc18d\ud558\ub294 \uc815\uc810 \\((u, v)\\)\uc5d0 \ub300\ud558\uc5ec \\(u\\)\uac00 \uc67c\ucabd \uc9d1\ud569\uc758 \uc815\uc810, \\(v\\)\uac00 \uc624\ub978\ucabd \uc9d1\ud569\uc758 \uc815\uc810\uc774\uba74 \\((u, v)\\) \ubc29\ud5a5\uc758 \uac04\uc120\uc774 \uc874\uc7ac\ud55c\ub2e4.</p> <p></p>","tags":["graphs","scc","~idea"]},{"location":"ideas/SCC%20of%20Tournament%20Graph/idea/#property-2","title":"Property 2","text":"<p>Property 2</p> <p>Tournament graph\uc5d0\ub294 hamiltonian path\uac00 \uc801\uc5b4\ub3c4 \ud558\ub098 \uc874\uc7ac\ud55c\ub2e4.</p> <p>\uc774 hamiltonian path\ub97c \uc77c\ub82c\ub85c \ub098\uc5f4\ud558\uba74, \uc778\uc811\ud55c \uc815\uc810\ub4e4 \uc0ac\uc774\uc5d0 \uc624\ub978\ucabd\uc73c\ub85c \uac00\ub294 \uac04\uc120\uc774 \uc874\uc7ac\ud558\ub294 \ud615\ud0dc\ub85c \ubc30\uc5f4\ud560 \uc218 \uc788\uace0, \uc774 \ub54c \uac01 SCC\ub294 \uc778\uc811\ud55c \uad6c\uac04\uc744 \uc774\ub8ec\ub2e4.</p> <p>Proof</p> <p>\uc815\uc810\ub4e4\uc744 \ud558\ub098\uc529 \ucd94\uac00\ud558\uba70, \uadc0\ub0a9\uc801\uc73c\ub85c hamiltonian path\ub97c \uc720\uc9c0\ud560 \uc218 \uc788\uc74c\uc744 \ubcf4\uc774\uc790. \ud604\uc7ac \uc0c8\ub85c \ucd94\uac00\ud560 \uc815\uc810\uc744 \\(v\\)\ub77c \ud558\uace0, \uc774\ubbf8 \ucd94\uac00\ub41c \uc815\uc810\ub4e4\ub85c \uad6c\uc131\ub41c hamiltonian path\ub97c \uc21c\uc11c\ub300\ub85c \\(u_1, u_2, \\cdots, u_k\\)\ub77c \ud558\uc790. \ub9cc\uc57d \\(u_i \\rightarrow v\\), \\(v \\rightarrow u_{i+1}\\) \uac04\uc120\uc774 \uc874\uc7ac\ud55c\ub2e4\uba74 \\(u_i\\)\uc640 \\(u_{i+1}\\) \uc0ac\uc774\uc5d0 \\(v\\)\ub97c \ucd94\uac00\ud558\uba74 \ub41c\ub2e4. \ub9cc\uc57d \uc704 \uc2dd\uc744 \ub9cc\uc871\ud558\ub294 \\(u_i\\)\uac00 \uc5c6\ub2e4\uba74, \ub9e8 \uc55e\uc774\ub098 \ub9e8 \ub4a4\uc5d0 \\(v\\)\ub97c \ubb34\uc870\uac74 \ucd94\uac00\ud560 \uc218 \uc788\ub2e4. \uc704 \uacfc\uc815\uc744 \ubc18\ubcf5\ud558\uba74 \uadc0\ub0a9\uc801\uc73c\ub85c hamiltonian path\ub97c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p></p>","tags":["graphs","scc","~idea"]},{"location":"ideas/SCC%20of%20Tournament%20Graph/idea/#property-3","title":"Property 3","text":"<p>Property 3</p> <p>Tournament graph\uac00 \\(1\\)\uac1c\uc758 SCC\ub85c \uad6c\uc131\ub418\uc5b4 \uc788\ub2e4\uba74, hamiltonian path \ubfd0\ub9cc \uc544\ub2c8\ub77c hamiltonian cycle\uc774 \uc801\uc5b4\ub3c4 \ud558\ub098 \uc874\uc7ac\ud55c\ub2e4.</p> <p>Tournament graph\ub97c SCC\ubcc4\ub85c \ubd84\ud574\ud558\uace0, \uac01 SCC\uc758 hamiltonian cycle\ub4e4\uc744 \uc21c\uc11c\ub300\ub85c \uc77c\ub82c\ub85c \ub098\uc5f4\ud558\uba74, Property 2\uc5d0 \ucd94\uac00\ub85c \ub2e4\uc74c\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> <ul> <li>\uc778\uc811\ud55c \uc815\uc810\ub4e4 \uc0ac\uc774\uc5d0 \uc624\ub978\ucabd\uc73c\ub85c \uac00\ub294 \uac04\uc120\uc774 \uc874\uc7ac\ud55c\ub2e4.</li> <li>\ud55c SCC \ub0b4\uc5d0\uc11c\ub294 \uac00\uc7a5 \uc624\ub978\ucabd \uc815\uc810\uc5d0\uc11c \uac00\uc7a5 \uc67c\ucabd \uc815\uc810\uc73c\ub85c \uac00\ub294 \uac04\uc120\uc774 \uc874\uc7ac\ud55c\ub2e4.</li> <li>\uac01 SCC\ub294 \uc778\uc811\ud55c \uad6c\uac04\uc744 \uc774\ub8ec\ub2e4.</li> </ul> <p>Proof</p> <p>\uc815\uc810\ub4e4\uc744 \ud558\ub098\uc529 \ucd94\uac00\ud558\uba70, \uc704\uc640 \uac19\uc774 \uac01 SCC\ubcc4 hamiltonian cycle\uc744 \uad00\ub9ac\ud558\uc790. \uc774\uc81c \uc0c8\ub85c\uc6b4 \uc815\uc810 \\(v\\)\uac00 \ucd94\uac00\ub418\uba74, \\(u_i \\rightarrow v\\)\uc778 \uac00\uc7a5 \uc624\ub978\ucabd \\(u_i\\)\uc640 \\(v \\rightarrow u_j\\)\uc778 \uac00\uc7a5 \uc67c\ucabd \\(u_j\\)\uac00 \ud558\ub098\uc758 SCC\ub85c \ubb36\uc774\uac8c \ub41c\ub2e4. \ub9cc\uc57d \ubb36\uc774\ub294 SCC\ub4e4\uc774 \uc5c6\ub2e4\uba74, \ub2e8\uc21c\ud788 \uc0ac\uc774\uc5d0 \\(v\\)\ub97c Property 2\uc640 \uac19\uc774 \ucd94\uac00\ud574\uc8fc\uba74 \ub41c\ub2e4. \\([l, r]\\)\uc758 SCC\ub4e4\uc774 \ud558\ub098\uc758 SCC\ub85c \ubb36\uc774\uac8c \ub420 \ub54c\uc5d0\ub294, \uad6c\uac04\uc758 \uac01 hamiltonian cycle\ub4e4\uc744 \uc21c\uc11c\ub300\ub85c \ub098\uc5f4\ud558\uba74 \uc0c8\ub85c\uc6b4 SCC\uc758 hamiltonian cycle\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4. \uc704 \uacfc\uc815\uc744 \ubc18\ubcf5\ud558\uba74 \uc804\uccb4 \uadf8\ub798\ud504\ub97c hamiltonian cycle\ub4e4\ub85c \ucabc\uac24 \uc218 \uc788\ub2e4.</p> <p></p>","tags":["graphs","scc","~idea"]},{"location":"ideas/SCC%20of%20Tournament%20Graph/idea/#implementation","title":"Implementation","text":"<p>https://www.acmicpc.net/problem/26843 \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud558\uc5ec Property 3\uc758 \uadc0\ub0a9\uc801\uc778 construction\uc744 \\(O(N^2)\\)\uc5d0 \uad6c\ud604\ud55c \uc608\uc2dc\uc774\ub2e4.</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 2000;\n\nint N, adj[MAXN+10][MAXN+10];\nvector&lt;int&gt; ans[MAXN+10];\n\nint main()\n{\n    scanf(\"%d\", &amp;N); \n    for(int i=2; i&lt;=N; i++)\n    {\n        for(int j=1; j&lt;i; j++)\n        {\n            int t;\n            scanf(\"%d\", &amp;t);\n            if(t) adj[j][i]=1, adj[i][j]=0;\n            else adj[j][i]=0, adj[i][j]=1;\n        }\n    }\n\n    vector&lt;vector&lt;int&gt;&gt; V;\n    V.push_back({1});\n    for(int i=2; i&lt;=N; i++)\n    {\n        int l=MAXN+1, r=-1;\n        for(int j=0; j&lt;V.size(); j++)\n        {\n            for(auto it : V[j])\n            {\n                if(adj[i][it]) l=min(l, j);\n                if(adj[it][i]) r=max(r, j);\n            }\n        }\n        if(l&gt;r)\n        {\n            if(l==MAXN+1) V.insert(V.end(), {i});\n            else V.insert(V.begin()+l, {i});\n        }\n        else if(l==r)\n        {\n            for(int j=0; j&lt;V[l].size(); j++)\n            {\n                int k=(j+1)%V[l].size();\n                if(adj[V[l][j]][i] &amp;&amp; adj[i][V[l][k]])\n                {\n                    V[l].insert(V[l].begin()+k, i);\n                    break;\n                }\n            }\n        }\n        else\n        {\n            vector&lt;int&gt; VV;\n            int t=0;\n            for(int j=0; j&lt;V[l].size(); j++)\n            {\n                if(adj[i][V[l][j]])\n                {\n                    t=j;\n                    break;\n                }\n            }\n            for(int j=0; j&lt;V[l].size(); j++) VV.push_back(V[l][(j+t)%V[l].size()]);\n\n            for(int j=l+1; j&lt;r; j++) for(auto it : V[j]) VV.push_back(it);\n\n            for(int j=0; j&lt;V[r].size(); j++)\n            {\n                if(adj[V[r][j]][i])\n                {\n                    t=j;\n                    break;\n                }\n            }\n            for(int j=0; j&lt;V[r].size(); j++) VV.push_back(V[r][(j+t+1)%V[r].size()]);\n\n            VV.push_back(i);\n            V.erase(V.begin()+l, V.begin()+r+1);\n            V.insert(V.begin()+l, VV);\n        }\n    }\n\n    for(int i=0; i&lt;V.size(); i++)\n    {\n        for(int j=0; j+1&lt;V[i].size(); j++) assert(adj[V[i][j]][V[i][j+1]]);\n        if(V[i].size()&gt;1) assert(adj[V[i].back()][V[i][0]]);\n\n        for(int j=0; j&lt;V[i].size(); j++)\n        {\n            int now=V[i][j];\n            for(int k=0; k&lt;V[i].size(); k++) ans[now].push_back(V[i][(j+k)%V[i].size()]);\n            for(int k=i+1; k&lt;V.size(); k++) for(auto it : V[k]) ans[now].push_back(it);\n        }\n    }\n\n    for(int i=1; i&lt;=N; i++)\n    {\n        printf(\"%d \", ans[i].size());\n        for(auto it : ans[i]) printf(\"%d \", it);\n        printf(\"\\n\");\n    }\n}\n</code></pre>","tags":["graphs","scc","~idea"]},{"location":"ideas/Tree%20Optimization/idea/","title":"Tree Optimization","text":"<p>\ub9ce\uc740 Tree DP \ubb38\uc81c\ub4e4\uc758 \uacbd\uc6b0, \uac01 \ub178\ub4dc\uc5d0\uc11c \ud2b9\uc815 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub85c \ub178\ub4dc\ub4e4\uc744 \ud569\uce58\ub294 \uc791\uc5c5\uc744 \ud55c\ub2e4. \uc77c\ubc18\uc131\uc744 \uc783\uc9c0 \uc54a\uace0, \ub178\ub4dc\uc758 \uc790\uc2dd\uc774 3\uac1c \uc774\uc0c1\uc774\ub77c\uba74, \ub354\ubbf8 \ub178\ub4dc\ub97c \ubd80\ubaa8 \ucabd\uc73c\ub85c \uacc4\uc18d \ub9cc\ub4e4\uc5b4 \uc8fc\uba70, \ubaa8\ub4e0 \ud2b8\ub9ac\ub97c \uc774\uc9c4 \ud2b8\ub9ac \ud615\ud0dc\ub85c \ubcc0\ud615\uc2dc\ud0ac \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, \uc774\uc9c4 \ud2b8\ub9ac\uc5d0\uc11c \uc790\uc2dd \ub178\ub4dc \ub450\uac1c\uc758 \uac12\ub9cc\uc744 \ud569\uccd0\uc8fc\ub294 \ubb38\uc81c\ub85c \uc0dd\uac01\ud55c\ub2e4. \uc544\ub798 \uae00\uc5d0\uc11c \\(A, B\\)\ub294 \uc67c\ucabd, \uc624\ub978\ucabd \uc815\uc810\uc744 \uc758\ubbf8\ud558\uba70, \\(sz(A)\\)\ub294 \uc815\uc810 \\(A\\)\uc758 \uc11c\ube0c\ud2b8\ub9ac\uc758 \ud06c\uae30, \\(h(A)\\)\ub294 \uc815\uc810 \\(A\\)\uc758 \uc11c\ube0c\ud2b8\ub9ac\uc758 \ub192\uc774\ub85c \uc815\uc758\ud55c\ub2e4.</p> Time needed to merge \\(A\\), \\(B\\) Time Complexity Property 1 \\(sz(A) \\cdot sz(B)\\) \\(O(N^2)\\) Property 2 \\(min(K, sz(A)) \\cdot min(K, sz(B))\\) \\(O(NK)\\) Property 3 \\(min(sz(A), sz(B))\\) \\(O(N\\log N)\\) Property 4 \\(min(h(A), h(B))\\) \\(O(N)\\) Property 5 \\(sz(A)+sz(B)\\) \\(O(N\\log^2N)\\)","tags":["dp","dp_tree","hld","segtree","smaller_to_larger","trees","~idea"]},{"location":"ideas/Tree%20Optimization/idea/#property-1","title":"Property 1","text":"<p>Property 1</p> <p>\\(A, B\\)\ub97c \ud569\uce58\uae30 \uc704\ud574\uc11c \\(sz(A) \\cdot sz(B)\\)\uc758 \uc2dc\uac04\uc774 \ud544\uc694\ud560 \ub54c, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(O(N^2)\\)\uc5d0 \ud569\uce60 \uc218 \uc788\ub2e4. (KOI18 \uac80\uc740\ub3cc)</p> <p>Proof</p> <p>\\(sz(A) \\cdot sz(B)\\)\uc758 \uac12\uc740 \uc67c\ucabd \uc790\uc2dd\uc758 \uc11c\ube0c\ud2b8\ub9ac\uc758 \ubaa8\ub4e0 \ub178\ub4dc\uc640 \uc624\ub978\ucabd \uc790\uc2dd\uc758 \ubaa8\ub4e0 \uc11c\ube0c\ud2b8\ub9ac\uc758 \ub178\ub4dc\ub97c \uc5f0\uacb0\ud588\uc744 \ub54c \uac04\uc120\uc758 \uc218\uc640 \uac19\ub2e4. \uc774 \ub54c \uc5b4\ub5a0\ud55c \ub450 \uc815\uc810 \\(u\\), \\(v\\)\uac00 \ud569\uccd0\uc9c0\ub294 \uc704\uce58\ub294 \ubc14\ub85c \uadf8 \ub178\ub4dc\uc758 LCA \\(w\\)\uc5d0\uc11c \ud569\uccd0\uc9c0\uac8c \ub41c\ub2e4. \uc989, \uc804\uccb4 \uac01 \ub178\ub4dc\ubcc4 \\(sz(A) \\cdot sz(B)\\)\uc758 \ud569\uc740 \ud2b8\ub9ac\uc5d0\uc11c \uc784\uc758\uc758 \ub450 \ub178\ub4dc\ub97c \uc120\ud0dd\ud558\ub294 \uacbd\uc6b0\uc758 \uc218\uc640 \uac19\uc73c\ub2c8 \\(O(N^2)\\)\uc774\ub2e4.</p> <p>\ud2b8\ub9ac\uc758 \uac01 \uc815\uc810 \\(u\\)\uc5d0 \ub300\ud574 \\(dp[u][i]\\) \\((0 \\le i \\le sz(u))\\)\uc640 \uac19\uc774 \uc11c\ube0c\ud2b8\ub9ac\uc758 \ud06c\uae30\uc5d0 \ud574\ub2f9\ud558\ub294 dp \ud14c\uc774\ube14\uc744 \uad00\ub9ac\ud574\uc57c \ud558\uace0, dp\uc758 \uc804\uc774\uac00 \\((max, +)\\) convolution\uacfc \uac19\uc774 \\(sz(A) \\cdot sz(B)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub9ac\ub294 \ud615\ud0dc\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uac00 \\(O(N^2)\\)\uc784\uc744 \uc54c\ub824\uc900\ub2e4.</p>","tags":["dp","dp_tree","hld","segtree","smaller_to_larger","trees","~idea"]},{"location":"ideas/Tree%20Optimization/idea/#property-2","title":"Property 2","text":"<p>Property 2</p> <p>\\(A\\), \\(B\\)\ub97c \ud569\uce58\uae30 \uc704\ud574\uc11c \\(min(K, sz(A)) \\cdot min(K, sz(B))\\)\uc758 \uc2dc\uac04\uc774 \ud544\uc694\ud560 \ub54c, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(O(NK)\\)\uc5d0 \ud569\uce60 \uc218 \uc788\ub2e4.</p> <p>Proof</p> <p>Property 1\uacfc \uac19\uc740 \ub17c\ub9ac\ub85c \ub450 \ub178\ub4dc \\(u\\), \\(v\\)\uac00 \ud569\uccd0\uc9c0\ub294 LCA \\(w\\)\ub97c \uc0dd\uac01\ud558\uc790. \\(min(K, sz(A))\\)\uc73c\ub85c \uc778\ud574 \uc67c\ucabd \uc11c\ube0c\ud2b8\ub9ac\uc5d0\uc11c\ub294 dfs ordering \uc21c\uc73c\ub85c \ud070 \uc21c\uc11c\ub300\ub85c \\(K\\)\uac1c, \\(min(K, sz(B))\\)\uc73c\ub85c \uc778\ud574 \uc624\ub978\ucabd \uc11c\ube0c\ud2b8\ub9ac\uc5d0\uc11c\ub294 dfs ordering \uc21c\uc73c\ub85c \uc791\uc740 \uc21c\uc11c\ub300\ub85c \\(K\\)\uac1c\ub97c \uc120\ud0dd\ud574 \uc774\uc5b4\uc8fc\ub294 \uacbd\uc6b0\uc758 \uc218\uc640 \uac19\ub2e4. \uc774\ub294 \uc804\uccb4 \uc815\uc810\ub4e4\uc744 dfs ordering \uc21c\uc73c\ub85c \ub098\uc5f4\ud55c \ud6c4 \uac70\ub9ac\uac00 \\(2K\\)\uc774\ud558\uc778 \ub450 \uc815\uc810\uc758 \uacbd\uc6b0\uc758 \uc218\uc640 \uac19\uc73c\ub2c8 \\(O(NK)\\)\uc774\ub2e4.</p> <p>Property 1\uacfc \uac19\uc740 \uc0c1\ud669\uc778\ub370, dp \ud14c\uc774\ube14\uc758 \ud06c\uae30\uac00 \\(K\\)\ub85c \uc81c\ud55c\uc774 \uac78\ub824 \uc788\ub294 \uc0c1\ud669\uc5d0\uc11c \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uac00 \\(O(NK)\\)\uc784\uc744 \uc54c\ub824\uc900\ub2e4.</p>","tags":["dp","dp_tree","hld","segtree","smaller_to_larger","trees","~idea"]},{"location":"ideas/Tree%20Optimization/idea/#property-3","title":"Property 3","text":"<p>Property 3</p> <p>\\(A\\), \\(B\\)\ub97c \ud569\uce58\uae30 \uc704\ud574\uc11c \\(min(sz(A), sz(B))\\)\uc758 \uc2dc\uac04\uc774 \ud544\uc694\ud560 \ub54c, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(O(N\\log N)\\)\uc5d0 \ud569\uce60 \uc218 \uc788\ub2e4. (Small to Large)</p> <p>Proof</p> <p>\uc9d1\ud569\uc5d0\uc11c \ub354 \ud06c\uae30\uac00 \uc791\uc740 \uc9d1\ud569\uc744 \ud070 \uc9d1\ud569\ucabd\uc5d0 \ud569\uccd0\uc8fc\ub294 \uacfc\uc815\uc744 \ubc18\ubcf5\ud560 \ub54c \uc5b4\ub5a4 \uc6d0\uc18c \\(u\\)\uac00 \ub2e4\ub978 \uc9d1\ud569\uc73c\ub85c \uc62e\uaca8\uac00\uae30 \uc704\ud574\uc11c\ub294 \uc9d1\ud569\uc758 \ud06c\uae30\uac00 2\ubc30 \uc774\uc0c1\uc73c\ub85c \ucee4\uc838\uc57c \ud55c\ub2e4. \uc989, \ubaa8\ub4e0 \uc6d0\uc18c\uac00 \uc0c8\ub85c\uc6b4 \uc9d1\ud569\uc73c\ub85c \uc62e\uaca8\uac00\ub294 \ud69f\uc218\uac00 \\(O(\\log N)\\)\uc774\ub2c8, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(N\\log N)\\)\uc774\ub2e4.</p> <p>Property 1\uacfc \uac19\uc740 \uc0c1\ud669\uc778\ub370, dp\uc758 \uc804\uc774\uac00 \ud2b9\uc218\ud55c \ud615\ud0dc\uc5ec\uc11c \\(min(sz(A), sz(B))\\)\uc758 \uc2dc\uac04\uc774 \ud544\uc694\ud558\ub2e4\uba74 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uac00 \\(O(N\\log N)\\)\uc784\uc744 \uc54c\ub824\uc900\ub2e4. \uc608\ub97c \ub4e4\uc5b4, \uac01 \uc815\uc810\uc5d0\uc11c \ud06c\uae30 \\(sz(A)\\)\uc758 \uc790\ub8cc\uad6c\uc870\ub97c \uad00\ub9ac\ud574\uc57c \ud558\uba70, \ub450 \uc815\uc810\uc744 \ud569\uce60 \ub54c \uc791\uc740 \uc790\ub8cc\uad6c\uc870\uc758 \ubaa8\ub4e0 \uc6d0\uc18c\ub97c \ud070 \uc790\ub8cc\uad6c\uc870\uc5d0 \ub123\uc5b4\uc904 \uc218 \uc788\ub2e4\uba74 \uc774\ub97c \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4.</p>","tags":["dp","dp_tree","hld","segtree","smaller_to_larger","trees","~idea"]},{"location":"ideas/Tree%20Optimization/idea/#property-4","title":"Property 4","text":"<p>Property 4</p> <p>\\(A\\), \\(B\\)\ub97c \ud569\uce58\uae30 \uc704\ud574\uc11c \\(min(h(A), h(B))\\)\uc758 \uc2dc\uac04\uc774 \ud544\uc694\ud560 \ub54c, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(O(N)\\)\uc5d0 \ud569\uce60 \uc218 \uc788\ub2e4. (Small to Large in Height)</p> <p>Proof</p> <p>\\(A\\)\uc640 \\(B\\)\uc758 \uc11c\ube0c\ud2b8\ub9ac\uc5d0\uc11c \ub8e8\ud2b8\ubd80\ud130 \uc2dc\uc791\ud558\ub294 \uac00\uc7a5 \uae38\uc774\uac00 \uae34 \uacbd\ub85c, \uc989 \uae38\uc774 \\(h(A), h(B)\\)\uc758 \uacbd\ub85c\uc758 \uc815\uc810\ub4e4\uc744 \uc0c9\uce60\ud558\uc790. \uc77c\ubc18\uc131\uc744 \uc783\uc9c0 \uc54a\uace0 \\(h(A) \\le h(B)\\)\ub77c \ud55c\ub2e4\uba74 \\(A\\)\uc640 \\(B\\)\ub97c \ud569\uce60 \ub54c \\(A\\)\uc5d0\uc11c \uc0c9\uce60\ub41c \uc815\uc810\uc758 \uc218\ub9cc\ud07c \uc2dc\uac04\uc744 \uc18c\ubaa8\ud55c\ub2e4. \uadf8\ub9ac\uace0 \ud569\uce5c \ud6c4\uc5d0\ub294 \\(B\\)\uc758 \uc815\uc810\ub4e4\ub9cc \uc0c9\uc774 \ub0a8\uace0 \\(A\\)\uc758 \uc0c9\uce60\ub41c \uc815\uc810\ub4e4\uc740 \ub354 \uc774\uc0c1 \uac00\uc7a5 \uae34 \uacbd\ub85c\uac00 \uc544\ub2c8\uae30 \ub54c\ubb38\uc5d0 \uc0c9\uc774 \uc5c6\uc5b4\uc9c4\ub2e4. \uc989, \\(A\\)\uc758 \uc0c9\uce60\ub41c \uc815\uc810\ub4e4\uc740 \uc815\ud655\ud788 \\(1\\)\ubc88 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uc5d0 \uc601\ud5a5\uc744 \uc900 \ud6c4 \uc0c9\uc774 \uc5c6\uc5b4\uc9c4\ub2e4. \ub530\ub77c\uc11c, \uac01 \uc815\uc810\uc740 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uc5d0 \ucd5c\ub300 \\(1\\)\ubc88 \uc601\ud5a5\uc744 \ubbf8\uce60 \uc218 \uc788\uace0, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(N)\\)\uc774\ub2e4.</p>","tags":["dp","dp_tree","hld","segtree","smaller_to_larger","trees","~idea"]},{"location":"ideas/Tree%20Optimization/idea/#property-5","title":"Property 5","text":"<p>Property 5</p> <p>\\(A\\), \\(B\\)\ub97c \ud569\uce58\uae30 \uc704\ud574\uc11c \\(sz(A)+sz(B)\\)\uc758 \uc2dc\uac04\uc774 \ud544\uc694\ud560 \ub54c, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(O(N\\log^2N)\\)\uc5d0 \ud569\uce60 \uc218 \uc788\ub2e4. (JOIOC18 Cats or Dogs)</p> <p>\ud2b8\ub9ac\uc5d0\uc11c HLD\ub97c \ud558\uc5ec, \ubaa8\ub4e0 \uac04\uc120\uc744 heavy edge\uc640 light edge\ub85c \uad6c\ubd84\ud55c\ub2e4. \uadf8 \ud6c4, heavy edge\ub85c \uad6c\uc131\ub41c chain\uc5d0 \ub300\ud55c segment tree\ub97c \uad6c\uc131\ud55c\ub2e4. \uc774\uc81c, \uc804\uccb4 \ubb38\uc81c\ub97c \ud480\uae30 \uc704\ud574\uc11c\ub294 \ub8e8\ud2b8\ub97c \ud3ec\ud568\ud558\ub294 \uccb4\uc778\uc5d0\uc11c \uac01 \ub178\ub4dc\ub9c8\ub2e4 heavy edge\ub97c \uc81c\uc678\ud55c light edge\ub85c \ucabc\uac1c\uc9c0\ub294 \uc11c\ube0c\ud2b8\ub9ac\uc5d0 \ub300\ud574\uc11c \uc7ac\uadc0\uc801\uc73c\ub85c \uba3c\uc800 \ubb38\uc81c\ub97c \ud574\uacb0\ud55c\ub2e4. \uc774\uc81c, \uc774 \uccb4\uc778\uc5d0 \ub300\ud55c \ubb38\uc81c\ub294 \ub2e4\uc74c \uacfc\uc815\uc73c\ub85c \ud574\uacb0\ud55c\ub2e4.</p> <ol> <li>\uac01 \ub178\ub4dc\uc758 light edge\uc758 \uac12\ub4e4\uc744 Divide &amp; Conquer\uc744 \uc774\uc6a9\ud558\uc5ec \ud569\uccd0\uc900\ub2e4.</li> <li>Light edge\ub4e4\uc774 \ubaa8\ub450 \ud569\uccd0\uc9c4 \uac01 \ub178\ub4dc\uc5d0 \ub300\ud558\uc5ec \uccb4\uc778\uc758 \uac12\ub4e4\uc744 segment tree\uc640 \uac19\uc774 Divide &amp; Conquer\uc744 \uc774\uc6a9\ud558\uc5ec \ud569\uccd0\uc900\ub2e4.</li> </ol> <p>Proof</p> <p>\ud2b8\ub9ac\uc758 \ud55c \uc815\uc810 \\(u\\)\uc758 \uc785\uc7a5\uc5d0\uc11c \ub8e8\ud2b8\uae4c\uc9c0 \uc62c\ub77c\uac00\uba70 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub97c \uacc4\uc0b0\ud558\uc790. HLD\uc758 \ub17c\ub9ac\uc5d0 \uc758\ud574 \\(u\\)\uac00 \ub8e8\ud2b8\uae4c\uc9c0 \uc62c\ub77c\uac08 \ub54c \ud1b5\uacfc\ud558\ub294 light edge\uc758 \uc218\ub294 \\(O(\\log N)\\)\uac1c\uc774\ub2e4. Light edge\ub97c \ud55c\ubc88 \ud0c0\uace0 \uc62c\ub77c\uac08 \ub54c\ub9c8\ub2e4 Divide &amp; Conquer\uc73c\ub85c \uac12\ub4e4\uc774 \ud55c \ub178\ub4dc\ub85c \ud569\uccd0\uc9c0\uace0, \uc774\ud6c4 \uccb4\uc778\uc758 \uac12\ub4e4 \ub610\ud55c Divide &amp; Conquer\uc73c\ub85c \ud569\uccd0\uc9c4\ub2e4. \uc774\ub807\uac8c light edge\ub97c \ud55c\ubc88 \ud1b5\uacfc\ud558\uace0 heavy chain\ub4e4\uc758 \uac12\uc744 \ud558\ub098\ub85c \ud569\uce58\ub294\ub370 Divide &amp; Conquer\uc5d0\uc11c \uc815\uc810\ub2f9 \\(O(\\log N)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub9ac\ub2c8, \uc815\uc810 \ud558\ub098\ub2f9 \uc804\uccb4 \\(O(\\log^2N)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub9b0\ub2e4. \ub530\ub77c\uc11c, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(N\\log^2N)\\)\uc774\ub2e4.</p> <p>\uc704 \ub0b4\uc6a9\uc744 \uc751\uc6a9\ud558\uc5ec, tree dp\ubb38\uc81c\uc5d0\uc11c update\ub97c \ud574\uc57c \ud560 \ub54c, \uac01 \uc5c5\ub370\uc774\ud2b8\ub97c \\(O(\\log^2N)\\)\uc5d0 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4. \uac01 chain\uc744 \ud569\uce58\ub294 \uacfc\uc815\uc744 segment tree\uc5d0 \uc800\uc7a5\ud558\uc5ec persistent \ud558\uac8c Divide &amp; Conquer\uc744 \uad00\ub9ac\ud560 \uc218 \uc788\ub2e4\uba74, \uac19\uc740 \ub17c\ub9ac\ub85c \ud55c \uc815\uc810\uc774 \ub8e8\ud2b8\uae4c\uc9c0 \uc62c\ub77c\uac00\uba70 \uc790\ub8cc\uad6c\uc870\ub97c \uc5c5\ub370\uc774\ud2b8\ud558\ub294 \uc2dc\uac04\uc774 \\(O(\\log^2N)\\)\uc774\ub2e4.</p>","tags":["dp","dp_tree","hld","segtree","smaller_to_larger","trees","~idea"]},{"location":"ideas/Tree%20Optimization%202%20%28with%20HLD%29/idea/","title":"Tree Optimization 2 (with HLD)","text":"<p>\ub9ce\uc740 Tree DP \ubb38\uc81c\ub4e4\uc758 \uacbd\uc6b0, \ud2b8\ub9ac\uc758 \uac01 \uc815\uc810 \\(u\\)\uc5d0 \ub300\ud574 \\(dp[u][i]\\) \\((0 \\le i \\le sz(u))\\)\uc640 \uac19\uc774 \uc11c\ube0c\ud2b8\ub9ac\uc758 \ud06c\uae30\uc5d0 \ud574\ub2f9\ud558\ub294 dp \ud14c\uc774\ube14\uc744 \uad00\ub9ac\ud574\uc57c \ud55c\ub2e4. \uc774 \ub54c, \uc815\uc810 \\(A\\)\uc640 \\(B\\)\ub97c \ud569\uccd0 \uc0c8\ub85c\uc6b4 dp \ud14c\uc774\ube14\uc758 \uc815\ubcf4\ub97c \uad6c\ud560 \ub54c \ub4dc\ub294 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 (\\(sz(A) \\cdot sz(B)\\), \\(min(sz(A), sz(B))\\), ...) \ub4f1\uc5d0 \ub530\ub77c \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uac00 \ub2ec\ub77c\uc9c0\uac8c \ub41c\ub2e4. \uc774\uc640 \uac19\uc774 \ub450 \uc11c\ube0c\ud2b8\ub9ac\ub97c \ud569\uce60 \ub54c\uc758 \ub2e4\uc591\ud55c \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uc5d0 \ub300\ud55c \uc790\uc138\ud55c \uc124\uba85\uc740 Tree Optimization\uc5d0\uc11c \uc815\ub9ac\ud558\uc600\ub2e4.</p> <p>\\(sz(A) \\cdot sz(B)\\)\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uc5d0 \ub450 \uc11c\ube0c\ud2b8\ub9ac\ub97c \ud569\uce60 \ub54c\ub294, \\(O(N^2)\\) \ud06c\uae30\uc758 dp \ud14c\uc774\ube14\uc744 global\ud558\uac8c \uc120\uc5b8\ud558\uc5ec \uad00\ub9ac\ud560 \uc218 \uc788\ub294\ub370, HLD\ub97c \ud65c\uc6a9\ud558\uc5ec \ub354 \uc791\uc740 \ud06c\uae30\uc758 dp \ud14c\uc774\ube14\uc744 \ud6a8\uc728\uc801\uc73c\ub85c \uad00\ub9ac\ud560 \uc218 \uc788\ub294 \ubc29\ubc95\uc5d0 \ub300\ud558\uc5ec \ub2e4\ub8ec\ub2e4. \ub610\ud55c, \\(min(sz(A), sz(B))\\)\uc758 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uc5d0 \ub450 \uc11c\ube0c\ud2b8\ub9ac\ub97c \ud569\uce60 \ub54c\ub294, \uc7ac\uadc0\uc801\uc73c\ub85c \uc790\ub8cc\uad6c\uc870\ub97c \uc8fc\uace0\ubc1b\uc9c0 \uc54a\uace0, \ud558\ub098\uc758 global\ud55c \uc790\ub8cc\uad6c\uc870\ub97c \uad00\ub9ac\ud558\uc5ec \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub294 \ubc29\ubc95\uc5d0 \ub300\ud558\uc5ec \ub2e4\ub8ec\ub2e4.</p>","tags":["dp","dp_tree","hld","trees","~idea"]},{"location":"ideas/Tree%20Optimization%202%20%28with%20HLD%29/idea/#algorithm-1","title":"Algorithm 1","text":"<p>\\(A, B\\)\ub97c \ud569\uce58\uae30 \uc704\ud574\uc11c \\(sz(A) \\cdot sz(B)\\)\uc758 \uc2dc\uac04\uc774 \ud544\uc694\ud560 \ub54c, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4 \\(O(N^2)\\)\uc5d0 \ud569\uce60 \uc218 \uc788\ub2e4. \uc774 \ub54c, \\(O(N^2)\\) \ud06c\uae30\uc758 dp \ud14c\uc774\ube14\uc744 global\ud558\uac8c \uc120\uc5b8\ud558\uc5ec \uad00\ub9ac\ud558\uc9c0 \ub9d0\uace0, HLD\ub97c \uc774\uc6a9\ud558\uc5ec \ub2e4\uc74c\uacfc \uac19\uc774 \ubb34\uc870\uac74 heavy edge\ub97c \uc6b0\uc120\uc801\uc73c\ub85c \ud0c0\uace0 \ub0b4\ub824\uac00\uba70 dfs\ub97c \ub3cc\uba70 \ub2f5\uc744 \uacc4\uc0b0\ud558\uc790.</p> <p>Algorithm 1</p> <p>Dfs\ub97c \ud558\uba70 \uc21c\uc11c\ub300\ub85c </p>","tags":["dp","dp_tree","hld","trees","~idea"]},{"location":"solutions/","title":"Problem Solving","text":""},{"location":"solutions/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Olympiad<ul> <li>IOI<ul> <li>2022<ul> <li>D1P1 Catfish Farm</li> <li>D1P2 Prisoner Challenge</li> <li>D1P3 Radio Towers</li> </ul> </li> <li>2021<ul> <li>D1P2 Keys</li> <li>D2P1 Mutating DNA</li> </ul> </li> <li>2019<ul> <li>D1P1 Arranging Shoes</li> <li>D1P2 Split the Attractions</li> <li>D1P3 Rectangles</li> </ul> </li> </ul> </li> <li>KOISC</li> <li>JOI</li> <li>JOISC<ul> <li>2023<ul> <li>D1P1 Two Currencies</li> <li>D1P3 Passport</li> <li>D2P2 Council</li> </ul> </li> </ul> </li> <li>JOIOC</li> <li>APIO<ul> <li>2019<ul> <li>P1 Strange Device</li> </ul> </li> <li>2015<ul> <li>P1 Bali Sculptures</li> <li>P2 Jakarta Skyscrapers</li> </ul> </li> </ul> </li> <li>POI</li> <li>KOI</li> </ul> </li> <li>BOJ</li> <li>Codeforces</li> <li>Atcoder</li> </ul>"},{"location":"solutions/#todo","title":"Todo","text":"<ul> <li>BOJ 28304 \ub9c8\ubb34\ub9ac</li> </ul>"},{"location":"solutions/template/","title":"_","text":"","tags":["~ solution"]},{"location":"solutions/template/#problem","title":"Problem","text":"","tags":["~ solution"]},{"location":"solutions/template/#problem-link","title":"Problem Link","text":"","tags":["~ solution"]},{"location":"solutions/template/#summary","title":"Summary","text":"","tags":["~ solution"]},{"location":"solutions/template/#constraints","title":"Constraints","text":"","tags":["~ solution"]},{"location":"solutions/template/#solution","title":"Solution","text":"<p>Observation 1</p> <p>CheckPoint</p> <p>Complexity</p> <p>Time Complexity : \\(O()\\)</p>","tags":["~ solution"]},{"location":"solutions/template/#code","title":"Code","text":"","tags":["~ solution"]},{"location":"solutions/BOJ/28304/solution/","title":"BOJ 28304 \ub2e4\uc12f \uc6a9\uc0ac\uc758 \uac80","text":"","tags":["~ solution"]},{"location":"solutions/BOJ/28304/solution/#problem","title":"Problem","text":"","tags":["~ solution"]},{"location":"solutions/BOJ/28304/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/28304</p>","tags":["~ solution"]},{"location":"solutions/BOJ/28304/solution/#summary","title":"Summary","text":"<p>\uc11c\ub85c \ub2e4\ub978 \uc218\ub4e4\ub85c \uad6c\uc131\ub41c \\(5\\)\uac1c\uc758 \uc218\uc5f4 \\(A_1, A_2, A_3, A_4, A_5\\)\uc774 \uc8fc\uc5b4\uc9c4\ub2e4. \uc6b0\ub9ac\ub294 \ubaa8\ub974\uac8c \\(5\\)\uac1c\uc758 \uc218\uc5f4 \uac01\uac01\uc5d0\uc11c \ud558\ub098\uc758 \uc218 \\(B_i\\)\uac00 \uc120\ud0dd\ub418\uc5b4 \uc788\uace0, \uc6b0\ub9ac\ub294 \uadf8 \uc911\uc5d0 \uac00\uc7a5 \ud070 \uc218\uac00 \uba87 \ubc88\uc9f8 \uc218\uc5f4\uc5d0 \ud3ec\ud568\ub418\uc5b4 \uc788\ub294\uc9c0\ub97c \uc54c\uc544\ub9de\ucdb0\uc57c \ud55c\ub2e4. \uc6b0\ub9ac\uac00 \ud560 \uc218 \uc788\ub294 \uc9c8\ubb38\uc740 \ud2b9\uc815 \uc22b\uc790 \\(X\\)\uc5d0 \ub300\ud558\uc5ec \\(B_1, B_2, B_3, B_4, B_5\\)\uac00 \uac01\uac01 \\(X\\)\ubcf4\ub2e4 \ud070\uc9c0, \uc791\uac70\ub098 \uac19\uc740\uc9c0\ub97c \uc54c \uc218 \uc788\ub2e4. \\(B_i\\)\uac00 \uc5b4\ub5bb\uac8c \uc120\ud0dd\ub418\uc5b4 \uc788\ub294\uc9c0\uc5d0 \ubb34\uad00\ud558\uac8c \ub2f5\uc744 \ub9de\ucd9c \uc218 \uc788\ub294 \uc9c8\ubb38\uc758 \ucd5c\uc18c \ud69f\uc218\ub97c \uad6c\ud558\uc5ec\ub77c.</p>","tags":["~ solution"]},{"location":"solutions/BOJ/28304/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(N=|A_1|+|A_2|+|A_3|+|A_4|+|A_5| \\le 50, 000\\)</li> <li>\\(1 \\le A_{i, j} \\le 10^9\\)</li> </ul>","tags":["~ solution"]},{"location":"solutions/BOJ/28304/solution/#solution","title":"Solution","text":"<p>\uc784\uc758\uc758 \\(X\\)\uc5d0 \ub300\ud558\uc5ec \uc9c8\ubb38\uc744 \ud588\ub2e4\uace0 \uac00\uc815\ud558\uace0, \uc774 \uc9c8\ubb38\uc744 \ud1b5\ud574 \uc5bb\uc744 \uc218 \uc788\ub294 \uc815\ubcf4\uac00 \ubb34\uc5c7\uc778\uc9c0 \uc0dd\uac01\ud558\uc790.</p> <p>\ub9cc\uc57d \\(X\\)\ubcf4\ub2e4 \ud070 \uc218\uac00 \ud558\ub098\ub77c\ub3c4 \uc874\uc7ac\ud558\uba74, \\(X\\)\ubcf4\ub2e4 \uc791\uac70\ub098 \uac19\uc740 \uc218\ub4e4\uc740 \ubaa8\ub450 \ub2f5\uc758 \ud6c4\ubcf4\uc5d0\uc11c \uc81c\uac70\ub41c\ub2e4. \ub610\ud55c, \ub0a8\uc740 \uc218\ub4e4\uc774 \\(X\\)\ubcf4\ub2e4 \ud06c\uac70\ub098 \uac19\ub2e4\ub294 \uc815\ubcf4\ub3c4 \uc54c \uc218 \uc788\ub2e4. \ub9cc\uc57d \ubaa8\ub4e0 \uc218\ub4e4\uc774 \\(X\\)\ubcf4\ub2e4 \uc791\uac70\ub098 \uac19\ub2e4\uba74, \ub0a8\uc740 \ubaa8\ub4e0 \uc218\ub4e4\uc774 \\(X\\) \uc774\ud558\ub77c\ub294 \uc815\ubcf4\ub97c \uc54c \uc218 \uc788\ub2e4.</p> <p>\ub530\ub77c\uc11c, \uc9c8\ubb38\ub4e4\uc744 \ud558\ub294 \uacfc\uc815\uc5d0\uc11c \uc5bb\ub294 \uc815\ubcf4\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \uc694\uc57d\ud560 \uc218 \uc788\ub2e4. \ud604\uc7ac \ub2f5\uc758 \ud6c4\ubcf4\ub294 \\(mask\\)\uc774\uba70, \\(mask\\)\uc758 \uc218\ub4e4\uc740 \\(L\\) \uc774\uc0c1 \\(R\\)\uc774\ud558\uc774\uace0, \\(mask\\)\uc5d0 \ud3ec\ud568\ub418\uc9c0 \uc54a\ub294 \uc218\ub4e4\uc740 \ubaa8\ub450 \\(L\\) \ubbf8\ub9cc\uc774\ub2e4.</p> <p>Observation 1</p> <p>\uc9c8\ubb38\uc744 \ud1b5\ud574 \uc784\uc758\uc758 \uc2dc\uc810\uc5d0\uc11c \uc5bb\uc744 \uc218 \uc788\ub294 \uc815\ubcf4\ub294 \ub2e4\uc74c\uacfc \uac19\ub2e4. \ud604\uc7ac \ub2f5\uc758 \ud6c4\ubcf4\ub294 \\(mask\\)\uc774\uba70, \\(mask\\)\uc758 \uc218\ub4e4\uc740 \\(L\\) \uc774\uc0c1 \\(R\\)\uc774\ud558\uc774\uace0, \\(mask\\)\uc5d0 \ud3ec\ud568\ub418\uc9c0 \uc54a\ub294 \uc218\ub4e4\uc740 \ubaa8\ub450 \\(L\\) \ubbf8\ub9cc\uc774\ub2e4.</p> <p>\ub530\ub77c\uc11c, \\(mask\\), \\(L\\), \\(R\\)\uc744 \uc778\uc790\ub85c \ud558\ub294 dp\ub97c \uc0dd\uac01\ud558\uba74 \uc804\uccb4 \uc0c1\ud0dc\uc758 \uac1c\uc218\uac00 \\(O(2^5N^2)\\)\uac1c\uac00 \ub418\uace0, \uac01 \uc0c1\ud0dc\ub9c8\ub2e4 \\(N\\)\uac1c\uc758 \uc9c8\ubb38\uc744 \ud560 \uc218 \uc788\uc73c\ub2c8 \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(2^5N^3)\\)\uc774 \ub41c\ub2e4.</p> <p>Definition 1</p> <p>\\(dp[mask][L][R]=\\)\ud604\uc7ac \ub2f5\uc758 \ud6c4\ubcf4\ub294 \\(mask\\)\uc774\uba70, \\(mask\\)\uc758 \uc218\ub4e4\uc740 \\(L\\) \uc774\uc0c1 \\(R\\)\uc774\ud558\ub77c\ub294 \uc0ac\uc2e4\uc744 \uc54c \ub54c \ub2f5\uc744 \ub9de\ucd94\uae30 \uc704\ud55c \ucd5c\uc18c \uc9c8\ubb38 \ud69f\uc218  </p> <p>CheckPoint</p> <p>Definition 1\uacfc \uac19\uc774 dp\ub97c \uad6c\uc131\ud558\uba74 \uc0c1\ud0dc\uc758 \uac1c\uc218 \\(O(2^5N^2)\\), \uc9c8\ubb38\uc758 \uac1c\uc218 \\(O(N)\\)\uc73c\ub85c \\(O(2^5N^3)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(2^5N^3)\\)</p> <p>\ub2f5\uc758 \uc0c1\ud55c\uc744 \uc0dd\uac01\ud558\uae30 \uc704\ud558\uc5ec, \\(X\\)\uc5d0 \ub300\ud55c \uc774\ubd84\ud0d0\uc0c9\uc744 \uc2e4\uc2dc\ud558\uba74 \\(X\\)\ubcf4\ub2e4 \ud070 \uac83\uc774 \uc874\uc7ac\ud558\uba74 \uc99d\uac00\uc2dc\ud0a4\uace0, \ubaa8\ub4e0 \uc218\uac00 \\(X\\)\ubcf4\ub2e4 \uc791\uc73c\uba74 \uac10\uc18c\uc2dc\ucf1c \\(O(\\log N)\\)\ubc88\uc758 \uc9c8\ubb38\uc73c\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Observation 2</p> <p>\ub2f5\uc758 \uc0c1\ud55c\uc740 \\(O(\\log N)\\)\uc774\ub2e4.</p> <p>dp\uc758 \uc0c1\ud0dc\ub294 \ub9ce\uc9c0\ub9cc \uac12\uc73c\ub85c \uac00\ub2a5\ud55c \ubc94\uc704\ub294 \uc791\uc73c\ub2c8, \uc778\uc790\uc640 \uac12\uc744 \uad50\ud658\ud558\uc5ec \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub97c \uc904\uc774\uc790.</p> <p>Definition 2</p> <p>\\(dp[mask][L][k]=\\)\ud604\uc7ac \ub2f5\uc758 \ud6c4\ubcf4\ub294 \\(mask\\)\uc774\uba70, \\(mask\\)\uc758 \uc218\ub4e4\uc740 \\(L\\) \uc774\uc0c1 \\(R\\)\uc774\ud558\ub77c\ub294 \uc0ac\uc2e4\uc744 \uc54c \ub54c \ub2f5\uc744 \\(k\\)\ubc88\uc758 \uc9c8\ubb38 \uc774\ub0b4\ub85c \ub9de\ucd9c \uc218 \uc788\uae30 \uc704\ud558\uc5ec \uac00\ub2a5\ud55c \ucd5c\ub300 \\(R\\) </p> <p>\uacfc \uac19\uc774 \uc815\uc758\ud558\uba74 \uc0c1\ud0dc\uc758 \uac1c\uc218\ub97c \\(O(2^5N\\log N)\\)\uae4c\uc9c0 \uc904\uc77c \uc218 \uc788\ub2e4.  </p> <p>CheckPoint</p> <p>Complexity</p> <p>Time Complexity : \\(O()\\)</p>","tags":["~ solution"]},{"location":"solutions/BOJ/28304/solution/#code","title":"Code","text":"","tags":["~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P1%20Bali%20Sculptures/solution/","title":"APIO 15 P1 Bali Sculptures","text":"","tags":["dp","greedy","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P1%20Bali%20Sculptures/solution/#problem","title":"Problem","text":"","tags":["dp","greedy","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P1%20Bali%20Sculptures/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/10846 https://oj.uz/problem/view/APIO15_sculpture</p>","tags":["dp","greedy","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P1%20Bali%20Sculptures/solution/#summary","title":"Summary","text":"<p>\uae38\uc774 \\(N\\)\uc758 \uc218\uc5f4 \\(Y\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c, \uc774 \uc218\uc5f4\uc744 \\(X\\) \\((A \\leq X \\leq B)\\)\uac1c\uc758 \uad6c\uac04\uc73c\ub85c \ucabc\uac1c\uc5b4 \uac01 \uad6c\uac04\ubcc4 \\(Y_i\\)\uc758 \ud569\ub4e4\uc758 bitwise OR\uc744 \ucd5c\uc18c\ud654\ud558\uc5ec\ub77c.</p>","tags":["dp","greedy","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P1%20Bali%20Sculptures/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(1 \\leq N \\leq 2,000\\) </li> <li>\\(1 \\leq A \\leq B \\leq N\\) </li> <li>\\(0 \\leq Y_i \\leq 10^9\\) </li> </ul> <p>Subtask 4 : ** \\(1 \\leq N \\leq 100\\), \\(1 \\leq A \\leq B \\leq N\\) Subtask 5 : ** \\(1 \\leq N \\leq 2,000\\), \\(1 = A \\leq B \\leq N\\)</p>","tags":["dp","greedy","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P1%20Bali%20Sculptures/solution/#solution","title":"Solution","text":"<p>Subtask 4\uc640 Subtask 5\uac00 \uc11c\ub85c\ub97c \ud3ec\ud568\ud558\uc9c0 \uc54a\ub294, \ub450 \uac1c\uc758 \ubb38\uc81c\ub85c \uad6c\uc131\ub418\uc5b4 \uc788\uc74c\uc5d0 \uc720\uc758\ud558\uc790. Subtask 4\uc758 \uacbd\uc6b0, \\(1 \\leq N \\leq 100\\)\uc774\uace0, Subtask 5\uc758 \uacbd\uc6b0 \\(1 \\leq N \\leq 2,000\\)\uc778 \ub300\uc2e0 \\(A=1\\)\ub85c, \uac00\ub2a5\ud55c \uad6c\uac04\uc758 \uac1c\uc218\ub97c \ucd5c\uc18c\ud654 \uc2dc\ucf1c\uc57c \ud55c\ub2e4.</p> <p>\"\\(P[i]:=Y[i]\\)\uc758 \ub204\uc801\ud569 \ubc30\uc5f4\" \uc73c\ub85c \uc815\uc758\ud55c\ub2e4.</p>","tags":["dp","greedy","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P1%20Bali%20Sculptures/solution/#subtask-4","title":"Subtask 4","text":"<ul> <li>\\(1 \\leq N \\leq 100\\), \\(1 \\leq A \\leq B \\leq N\\)</li> </ul> <p>\uc0dd\uac01\ud560 \uc218 \uc788\ub294 \uac00\uc7a5 \uc9c1\uad00\uc801\uc778 \ud480\uc774\ub294 \ub2e4\uc74c\uacfc \uac19\ub2e4.</p> <p>Wrong Solution</p> <p>\\(dp[i][k]:=\\)\\(1 \\sim i\\)\uae4c\uc9c0\uc758 \uc218\ub4e4\uc744 \\(k\\)\uac1c\uc758 \uad6c\uac04\uc73c\ub85c \ucabc\uac24 \ub54c \uac01 \uad6c\uac04\ud569\ub4e4\uc758 bitwise OR \uac12\uc758 \ucd5c\uc19f\uac12 \\(dp[i][k]=min_{j&lt;i} (dp[j][k-1] \\ | \\ (P[i]-P[j]))\\) \uc704 \uc815\uc758\uc640 \uc810\ud654\uc2dd\uc758 DP\ub97c \ud1b5\ud574 \\(O(N^3)\\)\uc5d0 \ub2f5\uc744 \uad6c\ud55c\ub2e4.</p> <p>\ud558\uc9c0\ub9cc, \uc704 \ud480\uc774\ub294 \uc62c\ubc14\ub978 \ub2f5\uc744 \ubcf4\uc7a5\ud558\uc9c0 \uc54a\ub294\ub2e4. DP\uac00 \ucd5c\uc801\ud574\ub97c \ubcf4\uc7a5\ud558\uae30 \uc704\ud574\uc11c\ub294 \uc804\uccb4 \ubb38\uc81c\ub97c \ucd5c\uc801\uc73c\ub85c \ud480\uae30 \uc704\ud574\uc11c \ubd80\ubd84\ubb38\uc81c \ub610\ud55c \ucd5c\uc801\uc73c\ub85c \ud480\uc5b4\uc57c \ud55c\ub2e4\ub294 \ucd5c\uc801 \ubd80\ubd84 \uad6c\uc870\uac00 \uc131\ub9bd\ud574\uc57c \ud55c\ub2e4. \ub9cc\uc57d \uc791\uc740 \ubd80\ubd84\ubb38\uc81c\uc5d0\uc11c \uac00\ub2a5\ud55c \ub2f5\uc774 <code>10(2)</code>\uc640 <code>01(2)</code>\uc600\uace0, \ud070 \uc804\uccb4\ubb38\uc81c\ub85c \uac00\uae30 \uc704\ud574\uc11c\ub294 \uc774 \ub2f5\uc5d0 <code>10(2)</code>\ub97c \ucd94\uac00\ud574\uc57c \ub41c\ub2e4\uace0 \uac00\uc815\ud558\uc790. \uadf8\ub807\ub2e4\uba74 \uc804\uccb4\ubb38\uc81c\uc5d0\uc11c\uc758 \uac12\uc740 \uac01\uac01 <code>10(2)</code>, <code>11(2)</code>\uac00 \ub418\uba70, \uc804\uccb4 \ubb38\uc81c\uc5d0\uc11c\uc758 \ucd5c\uc801\ud574\ub294 <code>10(2)</code>\uc774\ub2e4. \ud558\uc9c0\ub9cc \ubd80\ubd84\ubb38\uc81c\uc5d0\uc11c\uc758 \ucd5c\uc801\ud574\ub294 <code>01(2)</code>\ub85c, \uc774 \ucd5c\uc801\ud574\ub85c \uc804\uccb4\ubb38\uc81c\ub97c \ud480\uba74 <code>11(2)</code>\ub85c, \ucd5c\uc801\ud574\ub97c \uc5bb\uc744 \uc218 \uc5c6\ub2e4. \ub530\ub77c\uc11c \ubb38\uc81c\uc758 \uad6c\uc870\ub294 \ucd5c\uc801 \ubd80\ubd84 \uad6c\uc870\uac00 \uc131\ub9bd\ud558\uc9c0 \uc54a\uc74c\uc744 \uc54c \uc218 \uc788\ub2e4. \ud2b9\ud788, \ub9ce\uc740 \uacbd\uc6b0\uc5d0 bitwise \uc5f0\uc0b0\uc744 \ud560 \ub54c \ucd5c\uc801 \ubd80\ubd84 \uad6c\uc870\uac00 \uc131\ub9bd\ud558\uc9c0 \uc54a\ub294\ub2e4.</p> <p>\ubb38\uc81c\uc758 \ub2f5\uc744 \ucd5c\uace0 \ube44\ud2b8\ubd80\ud130 \ud558\ub098\uc529 \uacb0\uc815\ud574\uac00\ub294 \ud480\uc774\ub97c \uc0dd\uac01\ud558\uc790. \ucd5c\uc801\ud574\uc758 \\(T+1\\)\uc774\uc0c1\uc758 \ube44\ud2b8\ub97c \ub2e4 \uacb0\uc815\ud588\ub2e4\uace0 \uac00\uc815\ud558\uace0 \\(T\\)\ubc88\uc9f8 \ube44\ud2b8\ub97c \uacb0\uc815\ud558\uae30 \uc704\ud558\uc5ec \ub2e4\uc74c\uc758 DP\ub97c \uc0dd\uac01\ud558\uc790.</p> <p>Definition 1</p> <p>\\(T\\)\ub97c \ucd5c\uc0c1\uc704 \ube44\ud2b8\uc5d0\uc11c\ubd80\ud130 \uac10\uc18c\uc2dc\ud0a4\uba70, \ucd5c\uc801\ud574\uc758 \\(T+1\\)\uc774\uc0c1\uc758 \ube44\ud2b8\ub97c \ub2e4 \uacb0\uc815\ud588\ub2e4\uace0 \uac00\uc815\ud558\uace0, \\(T\\)\ubc88\uc9f8 \ube44\ud2b8\uac00 \\(0\\)\uc774 \ub420 \uc218 \uc788\ub294\uc9c0 \ud655\uc778\ud558\uc790. \\(dp[i][k]:=\\)\\(1 \\sim i\\)\uae4c\uc9c0\uc758 \uc218\ub4e4\uc744 \\(k\\)\uac1c\uc758 \uad6c\uac04\uc73c\ub85c \ucabc\uac24 \ub54c \uac01 \uad6c\uac04\ud569\ub4e4\uc744 bitwise OR\ud55c \uac12\ub4e4 \uc911, \\(T+1\\)\uc774\uc0c1\uc758 \ube44\ud2b8\ub294 \uc9c0\uae08\uae4c\uc9c0 \uad6c\ud55c \ucd5c\uc801\ud574\uc640 \ub611\uac19\uc73c\uba70, \\(T\\)\ubc88\uc9f8 \ube44\ud2b8\ub294 \\(0\\)\uc774 \ub418\ub3c4\ub85d \ud560 \uc218 \uc788\ub294\uac00? (<code>True</code> / <code>False</code>)</p> <p>\uc704\uc640 \uac19\uc774 \uc815\uc758\ud55c \ud6c4, \\(dp[j][k-1] (j &lt; i)\\) \uc5d0\uc11c DP\uac12\uc744 \ubc1b\uc544\uc62c \ub54c, \\(P[i]-P[j]\\) \uad6c\uac04\ud569\uc744 bitwise OR\ud568\uc73c\ub85c \uc778\ud574 \uc9c0\uae08\uae4c\uc9c0 \uad6c\ud55c \ucd5c\uc801\ud574\uc758 \uc0c1\uc704 \ube44\ud2b8\uc5d0 \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub294\uc9c0 \ud655\uc778\ud558\uace0, \\(T\\)\ubc88\uc9f8 \ube44\ud2b8\uac00 0\uc774 \ub420 \uc218 \uc788\ub294\uc9c0\ub97c \ud655\uc778\ud558\uc5ec transition\uc744 \ud55c\ub2e4.</p> <p>\uc704 DP\uc758 \uacbd\uc6b0, \uac00\ub2a5/\ubd88\uac00\ub2a5\uc744 \ub530\uc9c0\uace0 \uc788\uae30 \ub54c\ubb38\uc5d0 \ucd5c\uc801 \ubd80\ubd84 \uad6c\uc870\uc5d0 \ub300\ud55c \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub294\ub2e4. \ub610\ud55c, \ucd5c\uc0c1\uc704 \ube44\ud2b8\ubd80\ud130 \uc544\ub798\ucabd\uc73c\ub85c, \ucd5c\uc801\ud574\uc758 \ube44\ud2b8\ub97c \uacb0\uc815\ud574 \ub098\uac00\uace0 \uc788\ub294 \ubc29\uc2dd\uc73c\ub85c \ubb38\uc81c\ub97c \ud574\uacb0\ud558\ub2c8, \ucd5c\uc801\ud574\ub97c \ubb34\uc870\uac74 \ucc3e\uc744 \uc218 \uc788\ub2e4. \\(T\\)\ubc88\uc9f8 \ube44\ud2b8\uac00 \\(0\\)\uc774 \ub420 \uc218 \uc788\ub294\uc9c0 \ud655\uc778\ud558\uae30 \uc704\ud574\uc11c\ub294 \\(dp[N][A], dp[N][A+1], \\cdots, dp[N][B]\\) \uc911\uc5d0 \ucc38\uc778 \uac83\uc774 \uc788\ub294\uc9c0 \ud655\uc778\ud558\uba74 \ub41c\ub2e4.</p> <p>\\(\\log X\\)\uac1c\uc758 \ube44\ud2b8 \uac01\uac01\uc744 \\(O(N^2)\\)\uac1c\uc758 \uc0c1\ud0dc \ud558\ub098\ub97c \\(O(N)\\)\ubc88\uc758 transition\uc73c\ub85c \ubb38\uc81c\ub97c \ud574\uacb0\ud558\ub2c8, \uc804\uccb4 \\(O(N^3\\log X)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>Definition 1\uacfc \uac19\uc774 DP\ub97c \uc815\uc758\ud558\uba74 \ucd5c\uace0 \ube44\ud2b8\ubd80\ud130 \ud558\ub098\uc529 \ucd5c\uc801\ud574\ub97c \uacb0\uc815\ud560 \uc218 \uc788\uace0, \\(O(N^3\\log X)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N^3\\log X)\\)</p>","tags":["dp","greedy","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P1%20Bali%20Sculptures/solution/#subtask-5","title":"Subtask 5","text":"<ul> <li>\\(1 \\leq N \\leq 2,000\\), \\(1 = A \\leq B \\leq N\\)</li> </ul> <p>Subtask 5\uc758 \uacbd\uc6b0 \uac00\ub2a5\ud55c \uad6c\uac04\uc758 \uac1c\uc218\ub97c \ucd5c\uc18c\ud654 \uc2dc\ucf1c\uc57c \ud558\ub294 \ub300\uc2e0 \\(N\\)\uc758 \ud06c\uae30\uac00 \ub298\uc5b4\ub0ac\ub2e4. \uc774\uc81c, \\(dp[i][k]\\)\uc758 <code>True</code> / <code>False</code> DP \ub300\uc2e0, \\(k\\)\ud56d\uc744 DP\uac12\uc73c\ub85c \ubcc0\ud658\ud558\uc5ec \uc870\uac74\uc744 \ub9cc\uc871\ud558\uae30 \uc704\ud55c \uad6c\uac04\uc758 \uac1c\uc218\uc758 \ucd5c\uc19f\uac12\uc744 \uc800\uc7a5\ud558\uc790.</p> <p>Definition 2</p> <p>\\(T\\)\ub97c \ucd5c\uc0c1\uc704 \ube44\ud2b8\uc5d0\uc11c\ubd80\ud130 \uac10\uc18c\uc2dc\ud0a4\uba70, \ucd5c\uc801\ud574\uc758 \\(T+1\\)\uc774\uc0c1\uc758 \ube44\ud2b8\ub97c \ub2e4 \uacb0\uc815\ud588\ub2e4\uace0 \uac00\uc815\ud558\uace0, \\(T\\)\ubc88\uc9f8 \ube44\ud2b8\uac00 \\(0\\)\uc774 \ub420 \uc218 \uc788\ub294\uc9c0 \ud655\uc778\ud558\uc790. \\(dp[i]:=\\)\\(1 \\sim i\\)\uae4c\uc9c0\uc758 \uc218\ub4e4\uc744 \uc5ec\ub7ec \uad6c\uac04\uc73c\ub85c \ucabc\uac24 \ub54c \uac01 \uad6c\uac04\ud569\ub4e4\uc744 bitwise OR\ud55c \uac12\ub4e4 \uc911, \\(T+1\\)\uc774\uc0c1\uc758 \ube44\ud2b8\ub294 \uc9c0\uae08\uae4c\uc9c0 \uad6c\ud55c \ucd5c\uc801\ud574\uc640 \ub611\uac19\uc73c\uba70, \\(T\\)\ubc88\uc9f8 \ube44\ud2b8\ub294 \\(0\\)\uc774 \ub418\ub3c4\ub85d \ud560 \uc218 \uc788\ub294 \uad6c\uac04\uc758 \ucd5c\uc18c \uac1c\uc218</p> <p>transition\uc740 Subtask 4\uc758 \uacbd\uc6b0\uc640 \uac70\uc758 \uc720\uc0ac\ud558\ub2e4. \uc870\uac74\uc744 \ub9cc\uc871\uc2dc\ud0a4\uae30 \ubd88\uac00\ub2a5\ud558\uac70\ub098 \ud544\uc694\ud55c \uad6c\uac04\uc758 \uac1c\uc218\uac00 \\(B\\)\ub97c \ub118\uc5b4\uac00\ub294 \uacbd\uc6b0, \\(dp[i]\\)\uc5d0 \ubb34\ud55c\ud788 \ud070 \uac12\uc744 \ub123\uc5b4 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4. \\(T\\)\ubc88\uc9f8 \ube44\ud2b8\uac00 \\(0\\)\uc774 \ub420 \uc218 \uc788\ub294\uc9c0 \ud655\uc778\ud558\uae30 \uc704\ud574\uc11c\ub294 \\(dp[N]\\)\uc774 \\(B\\)\ubcf4\ub2e4 \uc791\uac70\ub098 \uac19\uc740\uc9c0 \ud655\uc778\ud558\uba74 \ub41c\ub2e4.</p> <p>CheckPoint</p> <p>\uad6c\uac04\uc758 \uac1c\uc218\ub97c \ucd5c\uc18c\ud654\uc2dc\ud0a4\uba74 \ub41c\ub2e4\ub294 \uc810\uc744 \uc774\uc6a9\ud558\uba74 Definition 2\uc640 \uac19\uc774 DP\ub97c \uc218\uc815\ud558\uba74 \ucd5c\uace0 \ube44\ud2b8\ubd80\ud130 \ud558\ub098\uc529 \ucd5c\uc801\ud574\ub97c \uacb0\uc815\ud560 \uc218 \uc788\uace0, \\(O(N^2\\log X)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N^2\\log X)\\)</p>","tags":["dp","greedy","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P1%20Bali%20Sculptures/solution/#code","title":"Code","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 2000;\n\nint N, A, B;\nll Y[MAXN+10], ans=0, dp1[MAXN+10], dp2[MAXN+10][MAXN+10];\n\nint main()\n{\n    scanf(\"%d%d%d\", &amp;N, &amp;A, &amp;B);\n    for(int i=1; i&lt;=N; i++) scanf(\"%lld\", &amp;Y[i]), Y[i]+=Y[i-1];\n\n    ans=(1ll&lt;&lt;46)-1;\n    if(A==1)\n    {\n        for(int i=45; i&gt;=0; i--)\n        {\n            ll now=1ll&lt;&lt;i;\n            ans^=now;\n            for(int j=1; j&lt;=N; j++) dp1[j]=987654321; dp1[0]=0;\n            for(int j=1; j&lt;=N; j++) for(int k=0; k&lt;j; k++) if((ans|(Y[j]-Y[k]))==ans) dp1[j]=min(dp1[j], dp1[k]+1);\n            if(dp1[N]&gt;B) ans|=now;\n        }\n    }\n    else\n    {\n        for(int i=45; i&gt;=0; i--)\n        {\n            ll now=1ll&lt;&lt;i;\n            ans^=now;\n            memset(dp2, 0, sizeof(dp2)); dp2[0][0]=1;\n            for(int j=1; j&lt;=N; j++) for(int k=1; k&lt;=N; k++) for(int p=0; p&lt;j; p++) if((ans|(Y[j]-Y[p]))==ans) dp2[j][k]|=dp2[p][k-1];\n            bool flag=false;\n            for(int j=A; j&lt;=B; j++) flag|=dp2[N][j];\n            if(!flag) ans|=now;\n        }\n    }\n    printf(\"%lld\", ans);\n}\n</code></pre>","tags":["dp","greedy","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P2%20Jakarta%20Skyscrapers/solution/","title":"APIO 15 P2 Jakarta Skyscrapers","text":"","tags":["sqrt_decomposition","dijkstra","graphs","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P2%20Jakarta%20Skyscrapers/solution/#problem","title":"Problem","text":"","tags":["sqrt_decomposition","dijkstra","graphs","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P2%20Jakarta%20Skyscrapers/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/10847 https://oj.uz/problem/view/APIO15_skyscraper</p>","tags":["sqrt_decomposition","dijkstra","graphs","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P2%20Jakarta%20Skyscrapers/solution/#summary","title":"Summary","text":"<p>\\(0, 1, \\cdots, N-1\\)\ubc88\uc758 \\(N\\)\uac1c\uc758 \ube4c\ub529\uc774 \uc788\uace0, \\(0, 1, \\cdots, M-1\\)\ubc88\uc758 \\(M\\)\uba85\uc758 \uc804\ub839\ub4e4\uc774 \uc788\ub2e4. \\(i\\)\ubc88\uc9f8 \uc804\ub839\uc740 \ucc98\uc74c\uc5d0 \\(B_i\\)\ubc88 \ube4c\ub529\uc5d0\uc11c \uc2dc\uc791\ud558\uace0, \ud55c \ubc88\uc758 \uc810\ud504\ub85c \uc815\ud655\ud788 \\(P_i\\)\uac1c\uc758 \ube4c\ub529\uc744 \uac74\ub108\ub6f0\uc5b4 \uc774\ub3d9\ud560 \uc218 \uc788\ub2e4. (\\(x\\)\ubc88 \ube4c\ub529\uc5d0\uc11c \\(x+P_i\\) \\((x+P_i&lt;N)\\)\ubc88 \ube4c\ub529\uc73c\ub85c \uc774\ub3d9, \\(x-P_i\\) \\((x-P_i \\geq 0)\\)\ubc88 \ube4c\ub529\uc73c\ub85c \uc774\ub3d9) \\(0\\)\ubc88 \uc804\ub839\uc774 \\(1\\)\ubc88 \uc804\ub839\uc5d0\uac8c \uc18c\uc2dd\uc744 \uc804\ub2ec\ud558\ub824\uace0 \ud558\uba70, \uc18c\uc2dd\uc744 \uc804\ud574 \ub4e4\uc740 \uc804\ub839\uc740 \ud604\uc7ac \uce78\uc5d0 \uc788\ub294 \ub2e4\ub978 \uc804\ub839\uc5d0\uac8c \uc18c\uc2dd\uc744 \uc804\ub2ec\ud558\uac70\ub098, \ub2e4\ub978 \ube4c\ub529\uc73c\ub85c \ud55c\ubc88 \uc810\ud504\ub97c \ud560 \uc218 \uc788\uc744 \ub54c \ud544\uc694\ud55c \uc810\ud504\uc758 \ucd1d \ud69f\uc218\uc758 \ucd5c\uc19f\uac12\uc744 \uad6c\ud558\uc5ec\ub77c.</p>","tags":["sqrt_decomposition","dijkstra","graphs","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P2%20Jakarta%20Skyscrapers/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(1 \\leq N \\leq 30,000\\) </li> <li>\\(2 \\leq M \\leq 30,000\\) </li> <li>\\(0 \\leq B_i &lt; N\\) </li> <li>\\(1 \\leq P_i \\leq 30,000\\)</li> </ul>","tags":["sqrt_decomposition","dijkstra","graphs","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P2%20Jakarta%20Skyscrapers/solution/#solution","title":"Solution","text":"","tags":["sqrt_decomposition","dijkstra","graphs","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P2%20Jakarta%20Skyscrapers/solution/#subtask-3","title":"Subtask 3","text":"<ul> <li>\\(N \\leq 2,000\\), \\(M \\leq 2,000\\)</li> </ul> <p>\\(i\\)\ubc88\uc9f8 \uc804\ub839\uc740 \\(B_i\\)\ubc88 \ube4c\ub529\uc5d0\uc11c \uc2dc\uc791\ud574\uc11c \\(B_i+kP_i\\) \\((0 \\leq B_i+kP_i &lt; N)\\)\ubc88 \ube4c\ub529\uc73c\ub85c \uc810\ud504\ud560 \uc218 \uc788\uc73c\ub2c8, \\(B_i\\)\ubc88 \uc815\uc810\uc5d0\uc11c \\(B_i+kP_i\\)\ubc88 \uc815\uc810\uc73c\ub85c \uac00\uc911\uce58 \\(|k|\\)\uc758 \uac04\uc120\uc744 \uc774\uc5b4 \uc900\ub2e4. \uc774\uc81c, \ubb38\uc81c\ub294 \\(B_0\\)\ubc88 \uc815\uc810\uc5d0\uc11c \\(B_1\\)\ubc88 \uc815\uc810\uc73c\ub85c \uac00\ub294 \ucd5c\ub2e8\uacbd\ub85c\ub97c \uad6c\ud558\ub294 \uac83\uc774\ub2c8 \ub2e4\uc775\uc2a4\ud2b8\ub77c \uc54c\uace0\ub9ac\uc998\uc744 \uc0ac\uc6a9\ud558\uc5ec \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\uc815\uc810\uc758 \uac1c\uc218\ub294 \\(O(N)\\), \uac04\uc120\uc758 \uac1c\uc218\ub294 \ucd5c\uc545\uc758 \uacbd\uc6b0\uc5d0 \\(O(NM)\\)\uac1c\uae4c\uc9c0 \uac00\ub2a5\ud558\ub2c8, \\(O(ElogV)\\) \ub2e4\uc775\uc2a4\ud2b8\ub77c \uc54c\uace0\ub9ac\uc998\uc744 \uc0ac\uc6a9\ud558\uba74 \\(O(NM\\log N)\\), \\(O(E+V^2)\\) \ub2e4\uc775\uc2a4\ud2b8\ub77c \uc54c\uace0\ub9ac\uc998\uc744 \uc0ac\uc6a9\ud558\uba74 \\(O(NM+N^2)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>\\(B_i\\)\ubc88 \uc815\uc810\uc5d0\uc11c \\(B_i+kP_i\\) \\((0 \\leq B_i+kP_i &lt; N)\\)\ubc88 \uc815\uc810\uc73c\ub85c \uac00\uc911\uce58 \\(|k|\\)\uc758 \uac04\uc120\uc744 \uc774\uc5b4 \ub9cc\ub4e0 \uc815\uc810 \\(O(N)\\)\uac1c, \uac04\uc120 \\(O(NM)\\)\uc778 \uadf8\ub798\ud504\ub97c \uc0dd\uac01\ud558\uc790. \uc774 \uadf8\ub798\ud504\uc5d0\uc11c \ub2e4\uc775\uc2a4\ud2b8\ub77c \uc54c\uace0\ub9ac\uc998\uc73c\ub85c \\(O(N^2+NM)\\)\uc758 \uc2dc\uac04\uc5d0 \ucd5c\ub2e8\uacbd\ub85c\ub97c \uad6c\ud558\uc5ec \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(NM\\log N)\\) or \\(O(N^2+NM)\\)</p>","tags":["sqrt_decomposition","dijkstra","graphs","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P2%20Jakarta%20Skyscrapers/solution/#subtask-5-full","title":"Subtask 5 (Full)","text":"<p>\uc704 \uadf8\ub798\ud504\uc5d0\uc11c \ubd88\ud544\uc694\ud55c \uac04\uc120\uc774 \uc788\ub294\uc9c0 \uc0b4\ud3b4\ubcf4\uc790. \ub9cc\uc57d \uc5b4\ub5a4 \ub450 \\(i\\), \\(j\\)\uac00 \\(P_i=P_j\\)\uc774\uba70, \\(B_i \\equiv B_j \\ (mod \\ P_i)\\), \\(B_i &lt; B_j\\)\ub77c\uace0 \uac00\uc815\ud558\uc790. \uadf8\ub807\ub2e4\uba74 \\(i\\)\ubc88 \uc804\ub839\uc740 \\(j\\)\ubc88 \uc804\ub839\uc758 \uc624\ub978\ucabd\uae4c\uc9c0 \uc774\ub3d9\ud560 \uc77c\uc774 \uc788\uc744 \ub54c, \\(j\\)\ubc88 \uc804\ub839\uc758 \uc704\uce58\uae4c\uc9c0\ub9cc \uc774\ub3d9\ud558\uace0 \\(j\\)\ubc88 \uc804\ub839\ud55c\ud14c \uc18c\uc2dd\uc744 \uc804\ud574\ub3c4 \ub41c\ub2e4. \uac19\uc740 \ubc29\ubc95\uc73c\ub85c \\(j\\)\ubc88 \uc804\ub839 \ub610\ud55c \\(i\\)\ubc88 \uc804\ub839\uc744 \ub118\uc5b4 \uc67c\ucabd\uc73c\ub85c \uc774\ub3d9\ud560 \ud544\uc694\uac00 \uc5c6\ub2e4. \ub530\ub77c\uc11c, \\(i\\)\ubc88 \uc815\uc810\uc5d0\uc11c \ub098\uc624\ub294 \uac04\uc120\uc740 \\(j\\)\ubc88 \uc704\uce58\ub97c \uc624\ub978\ucabd\uc73c\ub85c \ub118\uc9c0 \ubabb\ud558\ub3c4\ub85d \ud558\uace0 \\(j\\)\ubc88 \uc815\uc810\uc5d0\uc11c \ub098\uc624\ub294 \uac04\uc120\uc740 \\(i\\)\ubc88 \uc815\uc810\uc744 \uc67c\ucabd\uc73c\ub85c \ub118\uc9c0 \ubabb\ud558\ub3c4\ub85d \ud560 \uc218 \uc788\ub2e4. \uc704\uc640 \uac19\uc740 \uc555\ucd95\uc740 \\(P_i=P_j\\)\uc774\uace0 \\(B_i \\equiv B_j \\ (mod \\ P_i)\\)\uc778 \ubaa8\ub4e0 \\(i\\), \\(j\\)\ub4e4\uc744 \ud558\ub098\ub85c \ubb36\uc5b4, \uac19\uc740 \uc218\uc758 \uac04\uc120\uc744 \uc0ac\uc6a9\ud574\ub3c4 \ud45c\ud604\ud560 \uc218 \uc788\ub3c4\ub85d \ud574\uc900\ub2e4.</p> <p> </p> <p>Observation 1</p> <p>\uc5b4\ub5a4 \ub450 \\(i\\), \\(j\\)\uac00 \\(P_i=P_j\\)\uc774\uba70, \\(B_i \\equiv B_j \\ (mod \\ P_i)\\), \\(B_i &lt; B_j\\)\uc77c \ub54c, \\(i\\)\ubc88 \uc804\ub839\uc774 \uc624\ub978\ucabd\uc73c\ub85c \\(j\\)\ubc88 \uc804\ub839\uc744 \ub118\uc9c0 \uc54a\uace0, \\(j\\)\ubc88 \uc804\ub839\uc774 \uc67c\ucabd\uc73c\ub85c \\(i\\)\ubc88 \uc804\ub839\uc744 \ub118\uc9c0 \uc54a\ub3c4\ub85d \uc774\ub3d9\ud558\ub294 \ucd5c\uc801\ud574\uac00 \uc874\uc7ac\ud55c\ub2e4.</p> <p>\uc774\ub7ec\ud55c \uc555\ucd95\uc740 \uac04\uc120\uc758 \uac1c\uc218\ub97c \uc5bc\ub9c8\ub098 \ud6a8\uacfc\uc801\uc73c\ub85c \uc904\uc5ec\uc904 \uc218 \uc788\uc744\uae4c? \\(P\\)\uc640 \\(P\\)\ub85c \ub098\ub208 \ub098\uba38\uc9c0\uc778 \\(k\\)\ub97c \uace0\uc815\ud558\uace0 \ub098\uba74, \\(P_i=P\\), \\(B_i \\equiv k \\ (mod \\ P)\\)\uc778 \ubaa8\ub4e0 \\(i\\)\ub4e4\uc744 \uadf8\ub798\ud504\ub85c \ud45c\ud604\ud558\uae30 \uc704\ud574\uc11c\ub294 \\(O(\\frac{N}{P_i})\\)\uac1c\uc758 \uac04\uc120\uc774 \ud544\uc694\ud558\ub2e4. \ub610\ud55c, \\(k\\)\ub294 \\(P\\)\ub85c \ub098\ub208 \ub098\uba38\uc9c0\uc774\ubbc0\ub85c \uc11c\ub85c \ub2e4\ub978 \\(k\\)\ub294 \ucd5c\ub300 \\(P\\)\uac1c \uac00\ub2a5\ud568\uc744 \uc54c \uc218 \uc788\ub2e4. \uc774\uc81c, \ucd5c\uc545\uc758 \uacbd\uc6b0\uc5d0\ub294 \uac01 \uc804\ub839\ub4e4\uc774 \\(P_i=1\\)\uc778 \uac83\uc774 \\(1\\)\uac1c, \\(P_i=2\\)\uc778 \uac83\uc774 \\(2\\)\uac1c, ..., \\(P_i=\\sqrt M\\)\uc778 \uac83\uc774 \\(\\sqrt M\\)\uac1c\uc640 \uac19\uc774 \uc788\uc744 \ub54c\uc774\ub2e4. \\(P_i=1\\)\uc778 \uac83\ub4e4\uc758 \uac04\uc120\uc758 \uac1c\uc218\uc758 \ud569\uc740 \\(\\frac{N}{1} \\cdot 1\\), \\(P_i=2\\)\uc778 \uac83\ub4e4\uc740 \\(\\frac{N}{2} \\cdot 2\\), ..., \\(P_i=\\sqrt M\\)\uc778 \uac83\ub4e4\uc740 \\(\\frac{N}{\\sqrt M} \\cdot \\sqrt{M}\\)\ub85c, \uc804\uccb4 \ud569\uc740 \ub2e4\uc74c\uacfc \uac19\ub2e4.</p> \\[ \\sum_{1 \\leq p \\leq \\sqrt{M}}{\\frac{N}{p} \\cdot p} = O(N\\sqrt{M}) \\] <p>Observation 2</p> <p>\\(P_i=P_j\\)\uc774\uace0 \\(B_i \\equiv B_j \\ (mod \\ P_i)\\)\uc778 \ubaa8\ub4e0 \\(i\\), \\(j\\)\ub4e4\uc744 \ud558\ub098\ub85c \ubb36\uc5b4 \ubd88\ud544\uc694\ud55c \uac04\uc120\ub4e4\uc744 \uc81c\uac70\ud558\uba74, \uc555\ucd95\ub41c \uadf8\ub798\ud504\uc5d0\uc11c \uc0ac\uc6a9\ub418\ub294 \uc804\uccb4 \uac04\uc120\uc758 \uac1c\uc218\ub294 \\(O(N\\sqrt{M})\\)\uac1c\uc774\ub2e4.</p> <p>\uc774\uc81c, \uc704\uc640 \uac19\uc774 \ub9cc\ub4e0 \uc555\ucd95\ub41c \uadf8\ub798\ud504\ub294 \\(O(N)\\)\uac1c\uc758 \uc815\uc810\uacfc \\(O(N\\sqrt{M})\\)\uac1c\uc758 \uac04\uc120\ub4e4\ub85c \uad6c\uc131\ub418\uc5b4 \uc788\uace0, \ub2e4\uc775\uc2a4\ud2b8\ub77c \uc54c\uace0\ub9ac\uc998\uc744 \ud65c\uc6a9\ud558\uba74 \\(O(N\\sqrt{M}\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>Observation 1\uc5d0 \uc758\ud574 Observation 2\uc640 \uac19\uc774 \uadf8\ub798\ud504\ub97c \uc555\ucd95\ud560 \uc218 \uc788\uace0, \uc815\uc810 \\(O(N)\\), \uac04\uc120 \\(O(N\\sqrt{M})\\)\uac1c\uc758 \uc555\ucd95\ub41c \uadf8\ub798\ud504\uc5d0\uc11c \ub2e4\uc775\uc2a4\ud2b8\ub77c \uc54c\uace0\ub9ac\uc998\uc73c\ub85c \\(O(N\\sqrt{M}\\log N)\\)\uc758 \uc2dc\uac04\uc5d0 \ucd5c\ub2e8\uacbd\ub85c\ub97c \uad6c\ud558\uc5ec \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\uad6c\ud604\ud560 \ub54c, \ub2e4\uc775\uc2a4\ud2b8\ub77c\uc758 \uad6c\ud604\uc774 \ucda9\ubd84\ud788 \ube60\ub974\uc9c0 \uc54a\uc73c\uba74 <code>AC</code>\ub97c \ubc1b\uae30 \ud798\ub4dc\ub2c8 \ube60\ub978 \ub2e4\uc775\uc2a4\ud2b8\ub77c\uc758 \uad6c\ud604\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\ub3c4\ub85d \uc8fc\uc758\ud558\uc790.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N\\sqrt{M}\\log N)\\)</p>","tags":["sqrt_decomposition","dijkstra","graphs","~ solution"]},{"location":"solutions/Olympiad/APIO/2015/P2%20Jakarta%20Skyscrapers/solution/#code","title":"Code","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 3e4;\nconst int INF = 1e9;\n\nint N, M, S, E;\nvector&lt;int&gt; A[MAXN+10];\nvector&lt;pii&gt; adj[MAXN+10];\nint dist[MAXN+10];\n\nstruct Queue\n{\n    int u, w;\n    bool operator &lt; (const Queue &amp;p) const { return w&gt;p.w; }\n};\n\nint main()\n{\n    scanf(\"%d%d\", &amp;N, &amp;M);\n    for(int i=1; i&lt;=M; i++)\n    {\n        int b, p;\n        scanf(\"%d%d\", &amp;b, &amp;p);\n        if(i==1) S=b;\n        if(i==2) E=b;\n        A[p].push_back(b);\n    }\n\n    for(int i=1; i&lt;=MAXN; i++)\n    {\n        if(A[i].empty()) continue;\n        vector&lt;vector&lt;int&gt;&gt; V;\n        vector&lt;int&gt; comp;\n        V.resize(i);\n        for(auto it : A[i]) V[it%i].push_back(it);\n        for(auto it : A[i]) comp.push_back(it%i);\n\n        sort(comp.begin(), comp.end());\n        comp.erase(unique(comp.begin(), comp.end()), comp.end());\n\n        for(auto it : comp)\n        {\n            sort(V[it].begin(), V[it].end());\n            for(int j=1; j&lt;V[it].size(); j++)\n            {\n                int now=V[it][j], bef=V[it][j-1];\n                for(int k=bef+i; k&lt;=now; k+=i) adj[bef].push_back({k, (k-bef)/i});\n                for(int k=now-i; k&gt;=bef; k-=i) adj[now].push_back({k, (now-k)/i});\n            }\n            for(int k=V[it].back()+i; k&lt;N; k+=i) adj[V[it].back()].push_back({k, (k-V[it].back())/i});\n            for(int k=V[it][0]-i; k&gt;=0; k-=i) adj[V[it][0]].push_back({k, (V[it][0]-k)/i});\n        }\n    }\n\n    priority_queue&lt;Queue&gt; PQ;\n    for(int i=0; i&lt;N; i++) dist[i]=INF;\n    PQ.push({S, 0}); dist[S]=0;\n\n    while(!PQ.empty())\n    {\n        Queue now=PQ.top(); PQ.pop();\n        if(dist[now.u]&lt;now.w) continue;\n        for(auto nxt : adj[now.u]) if(dist[nxt.first]&gt;now.w+nxt.second) PQ.push({nxt.first, now.w+nxt.second}), dist[nxt.first]=now.w+nxt.second;\n    }\n    if(dist[E]==INF) dist[E]=-1;\n    printf(\"%d\\n\", dist[E]);\n}\n</code></pre>","tags":["sqrt_decomposition","dijkstra","graphs","~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P1%20Strange%20Device/solution/","title":"APIO 19 P1 Strange Device","text":"","tags":["math","number theory","~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P1%20Strange%20Device/solution/#problem","title":"Problem","text":"","tags":["math","number theory","~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P1%20Strange%20Device/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/17634 https://oj.uz/problem/view/APIO19_strange_device</p>","tags":["math","number theory","~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P1%20Strange%20Device/solution/#summary","title":"Summary","text":"<p>\\(x=(t+\\lfloor{\\frac{t}{B}}\\rfloor) \\ (mod \\ A)\\), \\(y=t \\ (mod \\ B)\\) \uc77c \ub54c, \\(t\\)\uc5d0 \ub300\ud55c \uc21c\uc11c\uc30d \\((x, y)\\)\ub97c \uc0dd\uac01\ud558\uc790. \\(t\\)\uc758 \uad6c\uac04\ub4e4 \\([l_i, r_i]\\)\uc774 \\(N\\)\uac1c \uc8fc\uc5b4\uc9c8 \ub54c, \uc801\uc5b4\ub3c4 \ud558\ub098\uc758 \uad6c\uac04\uc5d0 \ud3ec\ud568\ub418\ub294 \ubaa8\ub4e0 \\(t\\)\ub4e4\uc5d0 \ub300\ud558\uc5ec \uac00\ub2a5\ud55c \uc11c\ub85c \ub2e4\ub978 \uc21c\uc11c\uc30d \\((x, y)\\)\uc758 \uac1c\uc218\ub97c \uad6c\ud558\uc5ec\ub77c.</p>","tags":["math","number theory","~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P1%20Strange%20Device/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(N \\leq 10^6\\) </li> <li>\\(1 \\leq A, B \\leq 10^{18}\\) </li> <li>\\(0 \\leq l_i \\leq r_i \\leq 10^{18}\\), \\(r_i &lt; l_{i+1}\\)</li> </ul>","tags":["math","number theory","~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P1%20Strange%20Device/solution/#solution","title":"Solution","text":"<p>\uc6b0\uc120, \\(y\\)\uc758 \uc8fc\uae30\uac00 \\(B\\)\uc784\uc5d0 \ucc29\uc548\ud558\uc5ec \\(t\\)\uac00 \\(B\\)\uc529 \uc99d\uac00\ud568\uc5d0 \ub530\ub77c \uc21c\uc11c\uc30d \\((x, y)\\)\uac00 \uc5b4\ub5bb\uac8c \ubcc0\ud558\ub294\uc9c0 \uad00\ucc30\ud558\uc790. \\(0 \\leq k &lt; B\\)\uc5d0 \ub300\ud558\uc5ec, \\(t=k, k+B, k+2B, \\cdots, k+nB\\)\uc77c \ub54c \\(x\\)\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \ubcc0\ud55c\ub2e4.</p> \\(t\\) \\(x\\ (mod \\ A)\\) \\(k\\) \\(k\\) \\(k+B\\) \\(k+B+1\\) \\(k+2B\\) \\(k+2B+2\\) \\(\\vdots\\) \\(\\vdots\\) \\(k+nB\\) \\(k+nB+n\\) <p>\\(t\\)\uac00 \\(B\\) \uc99d\uac00\ud560 \ub54c\ub9c8\ub2e4 \\(x\\)\ub294 \\((mod \\ A)\\) \uc18d\uc5d0\uc11c \\(B+1\\)\uc529 \uc99d\uac00\ud55c\ub2e4\ub294 \uc0ac\uc2e4\uc744 \uad00\ucc30\ud560 \uc218 \uc788\ub2e4. \uc8fc\uae30\ub97c \uad6c\ud558\uae30 \uc704\ud574 \\(x_k \\equiv x_{k+nB} \\ (mod \\ A)\\)\uc778 \ucd5c\uc18c \\(n\\)\uc744 \uad6c\ud558\uc790.</p> \\[ A \\mid n(B+1) \\ , \\ n=\\frac{A}{gcd(A, B+1)} \\] <p>\uc704 \uacb0\uacfc\ub97c \ud1b5\ud574 \uace0\uc815\ub41c \\(y\\)\uc5d0 \ub300\ud558\uc5ec \uc8fc\uae30\uac00 \\(n=\\frac{A}{gcd(A, B+1)}\\)\uc774\ub2c8, \uac00\ub2a5\ud55c \\(B\\)\uac1c\uc758 \ubaa8\ub4e0 \\(y\\)\uc5d0 \ub300\ud574\uc11c\ub294 \uc804\uccb4 \\(T=\\frac{AB}{gcd(A, B+1)}\\)\uc784\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>Observation 1</p> <p>\\((x, y)\\)\uc758 \uc8fc\uae30\ub294 \\(T=\\frac{AB}{gcd(A, B+1)}\\)\uc774\ub2e4.</p> <p>\uc774\uc81c \\((x, y)\\) \ub300\uc2e0, \\(t \\ (mod \\ T)\\)\ub85c \ub300\uccb4\ud558\uc5ec \uc0dd\uac01\ud574\ub3c4 \ub41c\ub2e4. \ub9cc\uc57d \uc5b4\ub5a4 \uad6c\uac04\uc758 \uae38\uc774\uac00 \\(T\\) \uc774\uc0c1\uc774\uba74, \uc774 \uad6c\uac04 \ud558\ub098\ub9cc\uc73c\ub85c\ub3c4 \\(0 \\sim T-1\\)\uc758 \ubaa8\ub4e0 \uc218\ub4e4\uc744 \ub2e4 \ud3ec\ud568\ud558\ub2c8, \ub2f5\uc740 \\(T\\)\uc774\ub2e4. \ubaa8\ub4e0 \uad6c\uac04\uc758 \uae38\uc774\uac00 \\(T\\) \ubbf8\ub9cc\uc774\uba74, \uac01 \uad6c\uac04\uc740 \\(0 \\sim T-1\\)\uc758 \uc218\ub4e4\uc744 \uc6d0\ud615\uc73c\ub85c \ubc30\uc5f4\ud55c \ubaa8\uc591\uc5d0\uc11c \ud558\ub098\uc758 \uad6c\uac04\uc73c\ub85c \ub300\uc751\ub41c\ub2e4. \\(0\\)\uc744 \uae30\uc900\uc73c\ub85c \uc6d0\ud615 \uad6c\uac04\ub4e4\uc744 \ubaa8\ub450 \ucabc\uac1c\uace0, \uc804\uccb4 \uad6c\uac04\ub4e4\uc744 \uc815\ub82c\ud55c \ud6c4 sweeping\uc744 \ud1b5\ud574 \\(O(N\\log N)\\)\uc5d0 \ud569\uc9d1\ud569\uc758 \ud06c\uae30\ub97c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>Observation 1\uc5d0\uc11c \\((x, y)\\)\uc758 \uc8fc\uae30\uac00 \\(T\\)\uc774\ub2c8 \uc21c\uc11c\uc30d \\((x, y)\\) \ub300\uc2e0 \\(t \\ (mod \\ T)\\)\ub85c \ub300\uccb4\ud560 \uc218 \uc788\ub2e4. \uad6c\uac04 \\([l_i, r_i]\\)\ub294 \\(0 \\sim T-1\\)\uc758 \uc218\ub4e4\uc744 \uc6d0\ud615\uc73c\ub85c \ubc30\uc5f4\ud55c \ubaa8\uc591\uc5d0\uc11c \ud558\ub098\uc758 \uad6c\uac04\uc73c\ub85c \ub300\uc751\uc2dc\ud0ac \uc218 \uc788\uc73c\ub2c8, \\(0\\)\uc744 \uae30\uc900\uc73c\ub85c \uc6d0\ud615 \uad6c\uac04\ub4e4\uc744 \uc120\ud615 \uad6c\uac04\ub4e4\ub85c \ucabc\uac1c\uace0, \uc815\ub82c\ud55c \ud6c4 sweeping\uc744 \ud1b5\ud574 \\(O(N\\log N)\\)\uc5d0 \ud569\uc9d1\ud569\uc758 \ud06c\uae30\ub97c \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\ub9c8\uc9c0\ub9c9\uc73c\ub85c, \\(1 \\leq A, B \\leq 10^{18}\\)\uc774\ub2c8 \\(T=\\frac{AB}{gcd(A, B+1)}\\)\uac00 <code>long long</code> \uc790\ub8cc\ud615\uc758 \ubc94\uc704\ub97c \ubc97\uc5b4\ub0a0 \uc218 \uc788\uc73c\ubbc0\ub85c, \\(min(T, 10^{18})\\)\uc758 \uac12\uc744 \uc0ac\uc6a9\ud558\uc5ec overflow\ub97c \ubc29\uc9c0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N\\log N)\\)</p>","tags":["math","number theory","~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P1%20Strange%20Device/solution/#code","title":"Code","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 1e6;\n\nint N;\nll A, B, L;\npll P[MAXN+10];\n\nmap&lt;ll, ll&gt; M;\n\nvoid addrange(ll l, ll r)\n{\n    M[l]++;\n    M[r+1]--;\n}\n\nint main()\n{\n    scanf(\"%d%lld%lld\", &amp;N, &amp;A, &amp;B);\n    for(int i=1; i&lt;=N; i++) scanf(\"%lld%lld\", &amp;P[i].first, &amp;P[i].second);\n\n    L=__gcd(A, B+1);\n\n    if(A/L&gt;=(ll)1e18/B) L=1e18;\n    else L=A/L*B;\n\n    for(int i=1; i&lt;=N; i++)\n    {\n        ll l=P[i].first, r=P[i].second;\n        if(r-l+1&gt;=L) return !printf(\"%lld\\n\", L);\n        if(l%L&lt;=r%L) addrange(l%L, r%L);\n        else\n        {\n            addrange(l%L, L-1);\n            addrange(0, r%L);\n        }\n    }\n\n    M[L];\n    ll t=0, ans=0;\n    for(auto it=M.begin(); it!=M.end(); it++)\n    {\n        if(it-&gt;first==L) break;\n        t+=it-&gt;second;\n        if(t) ans+=next(it)-&gt;first-it-&gt;first;\n    }\n    printf(\"%lld\\n\", ans);\n}\n</code></pre>","tags":["math","number theory","~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P3%20Street%20Lamps/solution/","title":"APIO 19 P3 Street Lamps","text":"","tags":["~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P3%20Street%20Lamps/solution/#_1","title":"\ubb38\uc81c","text":"","tags":["~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P3%20Street%20Lamps/solution/#_2","title":"\ubb38\uc81c \ub9c1\ud06c","text":"<p>https://www.acmicpc.net/problem/17636 https://oj.uz/problem/view/APIO19_street_lamps</p>","tags":["~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P3%20Street%20Lamps/solution/#_3","title":"\ubb38\uc81c \uc694\uc57d","text":"<p>\\(1, 2, \\cdots, N+1\\)\ubc88\uc758 \\(N+1\\)\uac1c\uc758 \uc815\ub958\uc7a5\uc774 \uc788\uace0, \\(i\\)\ubc88 \uc815\ub958\uc7a5\uacfc \\(i+1\\)\ubc88 \uc815\ub958\uc7a5\uc744 \uc787\ub294 \ub3c4\ub85c\uc5d0\ub294 \uac00\ub85c\ub4f1 \\(i\\)\uac00 \uc788\ub2e4. \\(a\\)\ubc88 \uc815\ub958\uc7a5\uc5d0\uc11c \\(b\\)\ubc88 \uc815\ub958\uc7a5 \\((1 \\leq a &lt; b \\leq N+1)\\)\ub85c \uc774\ub3d9\ud560 \uc218 \uc788\uae30 \uc704\ud574\uc11c\ub294 \ub450 \uc815\ub958\uc7a5 \uc0ac\uc774\uc758 \ubaa8\ub4e0 \uac00\ub85c\ub4f1\ub4e4\uc774 \ub2e4 \ucf1c\uc838 \uc788\uc5b4\uc57c \ud55c\ub2e4. \uc2dc\uc810 \\(0\\)\uc5d0\uc11c\uc758 \ucd08\uae30 \uac00\ub85c\ub4f1\ub4e4\uc758 \uc0c1\ud0dc \\(S\\)\uac00 \ubaa8\ub450 \uc8fc\uc5b4\uc9c0\uace0, \\(1, 2, \\cdots, Q\\)\uc2dc\uac04\uc774 \uc9c0\ub0a0 \ub54c, \ub2e4\uc74c\uc758 \uc5c5\ub370\uc774\ud2b8\ub098 \ucffc\ub9ac\uac00 \ud558\ub098\uc529 \uc8fc\uc5b4\uc9c4\ub2e4.</p> <ul> <li>\\(toggle \\ i\\) : \\(i\\)\ubc88 \uac00\ub85c\ub4f1\uc744 toggle \ud55c\ub2e4.</li> <li>\\(query \\ a \\ b\\) : \uc2dc\uc810 \\(0\\)\uc5d0\uc11c \uc9c0\uae08\uae4c\uc9c0 \\(a\\)\ubc88 \uc815\ub958\uc7a5\uc5d0\uc11c \\(b\\)\ubc88 \uc815\ub958\uc7a5\uae4c\uc9c0 \uc774\ub3d9\ud560 \uc218 \uc788\ub358 \ucd1d \uc2dc\uac04\uc744 \uad6c\ud558\uc5ec\ub77c.</li> </ul>","tags":["~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P3%20Street%20Lamps/solution/#_4","title":"\uc81c\ud55c","text":"<ul> <li>\\(1 \\leq N \\leq 300,000\\)</li> <li>\\(1 \\leq Q \\leq 300,000\\)</li> </ul>","tags":["~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P3%20Street%20Lamps/solution/#_5","title":"\uc785\ub825 / \ucd9c\ub825","text":"<p>Input</p> <p>\\(N\\) \\(Q\\) \\(s_1 s_2 \\cdots s_n\\) (\\(Query \\ 1\\)) (\\(Query \\ 2\\)) \\(\\vdots\\) (\\(Query \\ Q\\))  </p> <ul> <li>\uc2dc\uc810 \\(0\\)\uc5d0 \\(i\\)\ubc88\uc9f8 \uac00\ub85c\ub4f1\uc774 \ucf1c\uc838 \uc788\uc73c\uba74 \\(s_i=1\\), \uaebc\uc838 \uc788\uc73c\uba74 \\(s_i=0\\)</li> <li>(\\(Query \\ k\\)) : \\(toggle \\ i\\) or \\(query \\ a \\ b\\)</li> </ul> <p>Output</p> <p><code>answer for each Query</code> \\(ans_i\\)</p>","tags":["~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P3%20Street%20Lamps/solution/#_6","title":"\ud480\uc774","text":"<p>Observation 1</p> <p>CheckPoint</p> <p>Complexity</p> <p>Time Complexity : \\(O()\\)</p>","tags":["~ solution"]},{"location":"solutions/Olympiad/APIO/2019/P3%20Street%20Lamps/solution/#_7","title":"\ucf54\ub4dc","text":"","tags":["~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P1%20Arranging%20Shoes/solution/","title":"IOI 2019 D1P1 Arranging Shoes","text":"","tags":["data_structures","greedy","segtree","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P1%20Arranging%20Shoes/solution/#problem","title":"Problem","text":"","tags":["data_structures","greedy","segtree","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P1%20Arranging%20Shoes/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/19914 https://oj.uz/problem/view/IOI19_shoes</p>","tags":["data_structures","greedy","segtree","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P1%20Arranging%20Shoes/solution/#summary","title":"Summary","text":"<p>\\(N\\)\ucf24\ub808\uc758 \uc2e0\ubc1c\uc774 \uc788\uace0, \\(i\\)\ubc88\uc9f8 \ud06c\uae30\uc758 \uc2e0\ubc1c\uc758 \uc67c\ucabd \uc2e0\ubc1c\uc758 \ubc88\ud638\ub294 \\(-i\\), \uc624\ub978\ucabd \uc2e0\ubc1c\uc758 \ubc88\ud638\ub294 \\(i\\)\uc774\ub2e4. \ucd1d \\(2N\\)\uac1c\uc758 \uc2e0\ubc1c\ub4e4\uc774 \uc11e\uc5ec \uc788\ub294 \ubc30\uc5f4 \\(A\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c, \uc774 \uc2e0\ubc1c\ub4e4\uc744 \uc9dd\uc774 \ub9de\ub294 \uc2e0\ubc1c\ub4e4\ub07c\ub9ac \ubd99\uc5b4 \uc788\uac8c, \uac19\uc740 \uc9dd\uc5d0\uc11c\ub294 \uc67c\ucabd \uc2e0\ubc1c, \uc624\ub978\ucabd \uc2e0\ubc1c \uc21c\uc11c\ub300\ub85c \ubc30\uc5f4\ud574\uc57c \ud55c\ub2e4. \uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 \uc5f0\uc0b0\uc740 \uc778\uc811\ud55c \ub450 \uc2e0\ubc1c\uc744 swap\ud558\ub294 \uc5f0\uc0b0\uc77c \ub54c, \uc5f0\uc0b0\uc758 \ucd5c\uc18c \ud69f\uc218\ub97c \uad6c\ud558\uc5ec\ub77c.</p> <p></p>","tags":["data_structures","greedy","segtree","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P1%20Arranging%20Shoes/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(N \\le 100,000\\)</li> <li>\\(1 \\le |A_i| \\le N\\) \\((1 \\le i \\le 2N)\\)</li> <li>\\(A_i \\ne A_j\\) \\((1 \\le i &lt; j \\le 2N)\\)</li> </ul>","tags":["data_structures","greedy","segtree","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P1%20Arranging%20Shoes/solution/#solution","title":"Solution","text":"<p>\uc774\uc640 \uac19\uc774 \uc778\uc811\ud55c \ub450 \uc218\ub97c swap\ud558\ub294 \uc5f0\uc0b0\uc744 \ud558\uc5ec \uc218\uc5f4\uc744 \ubcc0\ud658\ud558\ub294 \ubb38\uc81c\ub294, \ucd5c\uc885 \uc0c1\ud0dc\ub97c \uacb0\uc815\ud560 \uc218\ub9cc \uc788\ub2e4\uba74 \ub2e8\uc21c inversion\uc758 \uac1c\uc218\ub97c \uad6c\ud558\ub294 \ubb38\uc81c\ub85c \ubcc0\ud615\ub41c\ub2e4. Inversion\uc758 \uac1c\uc218\ub294 segment tree\ub098 fenwick tree\ub97c \uc774\uc6a9\ud558\uc5ec \\(O(N\\log N)\\)\uc5d0 \uad6c\ud560 \uc218 \uc788\uc73c\ub2c8 \ucd5c\uc801\uc758 \ucd5c\uc885 \uc0c1\ud0dc\ub97c \uacb0\uc815\ud558\ub294 \uac83\uc5d0 \uc9d1\uc911\ud558\uc790.</p> <p>\uc6b0\uc120 \\(i\\)\ubc88\uc9f8 \uc2e0\ubc1c\uc5d0 \ub300\ud558\uc5ec \uc624\ub978\ucabd \uc2e0\ubc1c\uc774 \uc67c\ucabd \uc2e0\ubc1c\uc758 \uc67c\ucabd\uc5d0 \uc704\uce58\ud55c\ub2e4\uba74 \uc774 \ub450 \uc2e0\ubc1c\uc740 swap\ud574\uc57c \ud55c\ub2e4. \uc774 \ub450 \uc2e0\ubc1c\uc774 swap\ub418\ub294 \uc21c\uac04\uc740 \uc5b4\ucc28\ud53c \ub450 \uc2e0\ubc1c\uc774 \ubd99\uc5b4 \uc788\uc5b4\uc57c \ud558\ub2c8, \uac01 \uc2e0\ubc1c\uc758 \uc67c\ucabd, \uc624\ub978\ucabd \uc5ec\ubd80\ub294 \ud06c\uac8c \uc911\uc694\ud558\uc9c0 \uc54a\uace0, \ub9cc\uc57d \uc624\ub978\ucabd \uc2e0\ubc1c\uc774 \uc67c\ucabd \uc2e0\ubc1c\uc758 \uc67c\ucabd\uc5d0 \uc704\uce58\ud55c\ub2e4\uba74 \ub2f5\uc5d0 \\(1\\)\uc744 \ub354\ud574\uc8fc\uae30\ub9cc \ud558\uba74 \ub41c\ub2e4. \uc774\uc81c, \uac01 \uc2e0\ubc1c\uc758 \uc67c\ucabd, \uc624\ub978\ucabd \uc5ec\ubd80\ub294 \ubb34\uc2dc\ud558\uace0 \uc9dd\uc774 \ub9de\ub294 \uc2e0\ubc1c\ub4e4\ub07c\ub9ac \ubd99\uc5b4\uc788\ub3c4\ub85d \ubc30\uc5f4\ud558\uc790.</p> <p>\uac00\uc7a5 \uc67c\ucabd\uc5d0 \uc788\ub294 \uc2e0\ubc1c \\(l\\)\uc744 \uc7a1\uace0, \uc774 \uc67c\ucabd \uc2e0\ubc1c\uc774\ub791 \uac19\uc740 \ud06c\uae30\uc758 \ubc18\ub300\ucabd \uc2e0\ubc1c \\(r\\)\uc744 \uc0dd\uac01\ud558\uc790. \uc774 \ub450 \uc2e0\ubc1c\uc774 \ub9cc\ub098\uae30 \uc704\ud574\uc11c\ub294 \uadf8 \uc0ac\uc774\uc5d0 \uc788\ub358 \ubaa8\ub4e0 \uc2e0\ubc1c\ub4e4\uc740 \ub450 \uc2e0\ubc1c\uc758 \uc0ac\uc774\uc5d0\uc11c \ubc97\uc5b4\ub098\uae30 \uc704\ud558\uc5ec \\(l\\)\uc774\ub098 \\(r\\)\uc911 \uc801\uc5b4\ub3c4 \ud55c\ubc88\uc758 swap\uc774 \ud544\uc694\ud558\ub2e4. \uc774 \ub54c, \uc0ac\uc774\uc5d0 \uc788\ub294 \uc2e0\ubc1c\uc744 \uc67c\ucabd\uc73c\ub85c \ube7c\ub294 \ud589\ub3d9\uc740 \uc55e\uc73c\ub85c \uc788\uc744 \ub2e4\ub978 \uc2e0\ubc1c\ub4e4\uc758 \uc774\ub3d9\uc5d0 \ubc29\ud574\ub9cc \ub41c\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, \ubb34\uc870\uac74 \\(r\\)\uc744 \\(l\\)\ucabd\uc73c\ub85c \ub2f9\uaca8 \uc624\uace0, \uadf8 \uc0ac\uc774\uc5d0 \uc788\ub294 \ub2e4\ub978 \uc2e0\ubc1c\ub4e4\uc740 \uc624\ub974\ucabd\uc73c\ub85c \ube7c\uc918\uc57c \ud55c\ub2e4. \uc774\ud6c4, \uc9dd\uc744 \ub9de\ucd98 \ub450 \uc2e0\ubc1c\uc744 \uc0dd\uac01\ud558\uc9c0 \uc54a\uace0 \ub098\uba38\uc9c0 \ub2e4\ub978 \uc2e0\ubc1c\ub4e4\uc5d0 \ub300\ud558\uc5ec \uac19\uc740 \uc791\uc5c5\uc744 \ud574\uc8fc\uba74 \ub41c\ub2e4.</p> <p>Observation 1</p> <p>\ucd5c\uc801\ud574\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \uad6c\ud560 \uc218 \uc788\ub2e4. \uac00\uc7a5 \uc67c\ucabd \uc2e0\ubc1c\uacfc \uac19\uc740 \ud06c\uae30\uc758 \ubc18\ub300\ucabd \uc2e0\ubc1c\uc744 \uc67c\ucabd \uc704\uce58\uae4c\uc9c0 \ub04c\uace0 \uc628\ub2e4. \uc774\ud6c4, \uac00\uc7a5 \uc67c\ucabd \uc2e0\ubc1c\uc774 \uc624\ub978\ucabd \uc2e0\ubc1c\uc77c \uacbd\uc6b0(\uc591\uc218\uc77c \uacbd\uc6b0) \uc774 \ub450 \uc2e0\ubc1c\uc744 swap\ud55c\ub2e4. \uc67c\ucabd \ub450 \uc2e0\ubc1c\uc744 \uc81c\uac70\ud588\ub2e4\uace0 \uc0dd\uac01\ud558\uace0 \uc774 \uacfc\uc815\uc744 \ubc18\ubcf5\ud55c\ub2e4.</p> <p>Proof</p> <p>\uadc0\ub0a9\uc801\uc73c\ub85c Observation 1\uc774 \ucd5c\uc801\uc784\uc744 \ubcf4\uc774\uc790. \uac00\uc7a5 \uc67c\ucabd\uc5d0 \uc788\ub294 \uc2e0\ubc1c\uc744 \\(l\\), \uc774 \uc67c\ucabd \uc2e0\ubc1c\uc774\ub791 \uac19\uc740 \ud06c\uae30\uc758 \ubc18\ub300\ucabd \uc2e0\ubc1c\uc744 \\(r\\)\uc774\ub77c \ud558\uc790. \uc774 \ub450 \uc2e0\ubc1c\uc774 \ub9cc\ub098\uae30 \uc704\ud574\uc11c\ub294 \uadf8 \uc0ac\uc774\uc5d0 \uc788\ub358 \ubaa8\ub4e0 \uc2e0\ubc1c\ub4e4\uc740 \ub450 \uc2e0\ubc1c\uc758 \uc0ac\uc774\uc5d0\uc11c \ubc97\uc5b4\ub098\uae30 \uc704\ud558\uc5ec \\(l\\)\uc774\ub098 \\(r\\)\uc911 \uc801\uc5b4\ub3c4 \ud55c\ubc88\uc758 swap\uc774 \ud544\uc694\ud558\ub2e4. \ub9cc\uc57d \\(l\\)\uacfc \\(r\\)\uc744 \uac00\uc7a5 \uc55e\uc73c\ub85c \ub2f9\uaca8\uc624\uc9c0 \uc54a\ub294 \ucd5c\uc801\ud574\uac00 \uc874\uc7ac\ud55c\ub2e4\uba74, \uc774 \ucd5c\uc801\ud574\uc5d0\uc11c \ub2e4\ub978 \uc2e0\ubc1c\ub4e4\uc758 \uc0c1\ub300\uc801 \uc704\uce58\ub294 \ubc14\uafb8\uc9c0 \uc54a\uace0 \\(l\\)\uacfc \\(r\\)\uc744 \uac00\uc7a5 \uc55e\uc73c\ub85c \ub2f9\uaca8\uc628 \ud574 \ub610\ud55c \ucd5c\uc801\ud574\uc774\ub2e4. \uc989, \\(l\\)\uacfc \\(r\\)\uc744 \uac00\uc7a5 \uc55e\uc73c\ub85c \ub2f9\uaca8\uc624\ub294 \ubc29\ubc95\uc740 \ubb34\uc870\uac74 \ud544\uc694\ud55c swap\uc758 \uc218\ub9cc \uc0ac\uc6a9\ud558\uace0, \ucd94\uac00\uc801\uc778 swap\uc740 \uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc73c\ub2c8 \ucd5c\uc801\ud574\uc784\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>\uc774\uc81c, \ucd5c\uc801\ud574\uc758 \ud615\ud0dc\ub97c \uad6c\ud588\uc73c\ub2c8 fenwick tree\ub97c \uc774\uc6a9\ud558\uc5ec \ud544\uc694\ud55c swap\uc758 \uc218\ub97c inversion\uc758 \uac1c\uc218\ub85c \\(O(N\\log N)\\)\uc5d0 \uc138\uc8fc\uba74 \ub41c\ub2e4.</p> <p>CheckPoint</p> <p>\ucd5c\uc801\ud574\uac00 Observation 1\uc640 \uac19\uc740 \ud615\ud0dc\uc774\ub2c8, fenwick tree\ub97c \uc774\uc6a9\ud558\uc5ec \ud544\uc694\ud55c swap\uc758 \uc218\ub97c inversion\uc758 \uac1c\uc218\ub85c \\(O(N\\log N)\\)\uc5d0 \uc140 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N\\log N)\\)</p>","tags":["data_structures","greedy","segtree","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P1%20Arranging%20Shoes/solution/#code","title":"Code","text":"<pre><code>#include \"shoes.h\"\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 2e5;\n\nint S[MAXN+10], N;\nvector&lt;int&gt; pos[MAXN+10];\nbool vis[MAXN+10];\nll ans;\n\nstruct BIT\n{\n    int tree[MAXN+10];\n    void update(int i) { for(; i&lt;=N*2; i+=(i&amp;-i)) tree[i]++; }\n    int query(int i) { int ret=0; for(; i&gt;0; i-=(i&amp;-i)) ret+=tree[i]; return ret; }\n    int query(int l, int r) { return query(r)-query(l-1); }\n}bit;\n\nll count_swaps(vector&lt;int&gt; _S)\n{\n    N=_S.size()/2;\n    for(int i=1; i&lt;=2*N; i++) S[i]=_S[i-1];\n\n    for(int i=2*N; i&gt;=1; i--) pos[S[i]+N].push_back(i);\n\n    for(int i=1; i&lt;=2*N; i++)\n    {\n        if(vis[i]) continue;\n        int j=pos[-S[i]+N].back();\n        ans+=j-i-1-bit.query(i, j);\n        pos[S[i]+N].pop_back(); pos[-S[i]+N].pop_back();\n        vis[i]=true; vis[j]=true;\n        bit.update(i); bit.update(j);\n        if(S[i]&gt;0) ans++;\n    }   \n    return ans;\n}\n</code></pre>","tags":["data_structures","greedy","segtree","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P2%20Split%20the%20Attractions/solution/","title":"IOI 2019 D1P2 Split the Attractions","text":"","tags":["ad_hoc","centroid","dfs","graphs","graph_traversal","greedy","trees","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P2%20Split%20the%20Attractions/solution/#problem","title":"Problem","text":"","tags":["ad_hoc","centroid","dfs","graphs","graph_traversal","greedy","trees","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P2%20Split%20the%20Attractions/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/19915 https://oj.uz/problem/view/IOI19_split</p>","tags":["ad_hoc","centroid","dfs","graphs","graph_traversal","greedy","trees","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P2%20Split%20the%20Attractions/solution/#summary","title":"Summary","text":"<p>\uc815\uc810 \\(N\\)\uac1c, \uac04\uc120 \\(M\\)\uac1c\uc778 \ub2e8\uc21c \uc5f0\uacb0 \uadf8\ub798\ud504\uac00 \ud558\ub098 \uc8fc\uc5b4\uc9c4\ub2e4. \\(a+b+c=N\\)\uc778 \uc138 \uc790\uc5f0\uc218 \\(a, b, c\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c, \uc815\uc810\ub4e4\uc744 \ud06c\uae30 \\(a, b, c\\)\uc778 \uc138 \uc9d1\ud569 \\(A, B, C\\)\ub85c \ubd84\ud560\ud558\uc5ec, \uc138 \uc9d1\ud569 \uc911 \uc801\uc5b4\ub3c4 \ub450 \uc9d1\ud569\uc774 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub3c4\ub85d \ud558\ub824\uace0 \ud55c\ub2e4. \uc5b4\ub5a4 \uc9d1\ud569\uc774 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub2e4\ub294 \uac83\uc740, \uc9d1\ud569\uc5d0 \ud3ec\ud568\ub41c \uc815\uc810\ub4e4\ub9cc \uc774\uc6a9\ud558\uc5ec \uc11c\ub85c \uc774\ub3d9 \uac00\ub2a5\ud558\ub2e4\ub294 \uac83\uc744 \uc758\ubbf8\ud55c\ub2e4. \ubd84\ud560\uc774 \uac00\ub2a5\ud55c\uc9c0 \ubd88\uac00\ub2a5\ud55c\uc9c0 \ud310\ubcc4\ud558\uace0, \uac00\ub2a5\ud558\uba74 \ud55c \ubd84\ud560\uc744 \uad6c\ud558\uc5ec\ub77c.</p>","tags":["ad_hoc","centroid","dfs","graphs","graph_traversal","greedy","trees","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P2%20Split%20the%20Attractions/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(3 \\le N \\le 100,000\\)</li> <li>\\(2 \\le M \\le 200,000\\)</li> <li>\\(1 \\le a, b, c, \\le N\\)</li> <li>\\(a+b+c=N\\)</li> <li>multi edge, self loop \ubaa8\ub450 \uc874\uc7ac\ud558\uc9c0 \uc54a\uace0 \uadf8\ub798\ud504\ub294 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub2e4.</li> </ul>","tags":["ad_hoc","centroid","dfs","graphs","graph_traversal","greedy","trees","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P2%20Split%20the%20Attractions/solution/#solution","title":"Solution","text":"<p>\uc6b0\uc120 \uc77c\ubc18\uc131\uc744 \uc783\uc9c0 \uc54a\uace0 \\(a \\le b \\le c\\)\ub77c \uac00\uc815\ud558\uc790. \uc138 \uc9d1\ud569 \uc911 \uc801\uc5b4\ub3c4 \ub450 \uc9d1\ud569\uc774 \uc5f0\uacb0\ub418\uc5b4 \uc788\uc5b4\uc57c \ud558\ub2c8, \uac00\ub2a5\ud558\uba74 \uc791\uc740 \ud06c\uae30\uc758 \uc9d1\ud569\uc778 \\(A, B\\)\uac00 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub294 \uc9d1\ud569\uc778 \uac83\uc774 \ub354 \uc720\ub9ac\ud574 \ubcf4\uc778\ub2e4. \ub9cc\uc57d \ub450 \uc790\uc5f0\uc218 \\(p&lt;q\\)\uc5d0 \ub300\ud558\uc5ec \ud06c\uae30 \\(q\\)\uc778 \uc5f0\uacb0\ub41c \uc9d1\ud569 \\(Q\\)\ub97c \uc7a1\uc744 \uc218 \uc788\ub2e4\uba74, \ud06c\uae30 \\(p\\)\uc778 \uc5f0\uacb0\ub41c \uc9d1\ud569 \\(P\\) \ub610\ud55c \uc7a1\uc744 \uc218 \uc788\ub2e4. \\(Q\\)\uc5d0\uc11c dfs\ub97c \ud558\uba74\uc11c, dfs \ubc29\ubb38 \uc21c\uc11c\ub300\ub85c \ucc98\uc74c \\(p\\)\uac1c\uc758 \uc815\uc810\uc744 \\(P\\)\uc5d0 \ub123\uc5b4\uc8fc\uba74 \ub41c\ub2e4. \ub530\ub77c\uc11c, \ub9cc\uc57d \\(A, B\\)\uac00 \uc544\ub2cc, \\(B, C\\) \ud639\uc740 \\(A, C\\) \uc9d1\ud569\uc774 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub2e4\uba74, \ud070 \uc9d1\ud569\uc758 \uc6d0\uc18c\ub97c dfs\ud558\uba74\uc11c \uc21c\uc11c\ub300\ub85c \uc0bd\uc785\ud558\uba74 \uc791\uc740 \ud06c\uae30\uc758 \uc9d1\ud569\uc73c\ub85c \ubcc0\ud658\ud560 \uc218 \uc788\uae30 \ub54c\ubb38\uc5d0 \ubb34\uc870\uac74 \\(A, B\\) \uc9d1\ud569\uc774 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub3c4\ub85d \ud560 \uc218 \uc788\ub2e4.</p> <p>Observation 1</p> <p>\uc77c\ubc18\uc131\uc744 \uc783\uc9c0 \uc54a\uace0 \\(a \\le b \\le c\\)\ub77c \uac00\uc815\ud558\uc790. \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ubd84\ud560\uc774 \uc874\uc7ac\ud55c\ub2e4\uba74, \\(A, B\\) \uc9d1\ud569\uc774 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub294 \ubd84\ud560 \ub610\ud55c \uc874\uc7ac\ud55c\ub2e4.</p> <p>\ub610\ud55c, \uc815\uc810\ub4e4\uc744 \ud06c\uae30 \\(a, b, c\\)\uc778 \uc138 \uc9d1\ud569 \\(A, B, C\\)\ub85c \ubd84\ud560\ud558\uc5ec \\(A, B\\)\uac00 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub294 \uc9d1\ud569\uc774 \ub418\ub3c4\ub85d \ud558\ub294 \uac83\uc740 \uc815\uc810\ub4e4\uc744 \ub450 \uc9d1\ud569\uc73c\ub85c \ubd84\ud560\ud558\uc5ec, \uac01 \uc9d1\ud569\uc758 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8\uc758 \ucd5c\ub300 \ud06c\uae30\uac00 \\(a\\)\uc774\uc0c1, \\(b\\)\uc774\uc0c1\uc774 \ub418\ub3c4\ub85d \ud558\ub294\uac83\uacfc \ub3d9\uce58\uc774\ub2e4. \ub9cc\uc57d \uc815\uc810\ub4e4\uc744 \uc138 \uc9d1\ud569 \\(A, B, C\\)\ub85c \ubd84\ud560\ud558\uc5ec \\(A, B\\)\uac00 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub294 \uc9d1\ud569\uc774 \ub418\ub3c4\ub85d \ud588\ub2e4\uba74 \\(C\\) \uc9d1\ud569\uc758 \uc6d0\uc18c\ub97c \uc801\ub2f9\ud788 \\(A, B\\)\uc5d0 \uc0bd\uc785\ud558\uc5ec \ub450 \uc9d1\ud569\uc758 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8\uc758 \ucd5c\ub300 \ud06c\uae30\uac00 \\(a\\)\uc774\uc0c1, \\(b\\)\uc774\uc0c1\uc774 \ub418\ub3c4\ub85d \ud560 \uc218 \uc788\ub2e4. \ubc18\ub300\ub85c, \uc815\uc810\ub4e4\uc744 \ub450 \uc9d1\ud569\uc73c\ub85c \ubd84\ud560\ud558\uc5ec, \uac01 \uc9d1\ud569\uc758 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8\uc758 \ucd5c\ub300 \ud06c\uae30\uac00 \\(a\\)\uc774\uc0c1, \\(b\\)\uc774\uc0c1\uc774 \ub418\ub3c4\ub85d \ud588\ub2e4\uba74 \uac01 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8\uc5d0\uc11c dfs \uc21c\uc11c\ub300\ub85c \uac00\uc7a5 \ube60\ub978 \\(a\\)\uac1c, \\(b\\)\uac1c\uc758 \uc815\uc810\ub4e4\uc744 \\(A\\), \\(B\\)\uc5d0 \uc0bd\uc785\ud558\uace0 \ub098\uba38\uc9c0 \uc815\uc810\ub4e4\uc744 \\(C\\)\uc5d0 \ubc30\uc815\ud558\uba74 \ub41c\ub2e4.</p> <p>Observation 2</p> <p>\"\uc815\uc810\ub4e4\uc744 \ud06c\uae30 \\(a, b, c\\)\uc778 \uc138 \uc9d1\ud569 \\(A, B, C\\)\ub85c \ubd84\ud560\ud558\uc5ec, \\(A, B\\)\uac00 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub3c4\ub85d \ud558\ub294 \uac83\"\uacfc \"\uc815\uc810\ub4e4\uc744 \ub450 \uc9d1\ud569\uc73c\ub85c \ubd84\ud560\ud558\uc5ec, \uac01 \uc9d1\ud569\uc758 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8\uc758 \ucd5c\ub300 \ud06c\uae30\uac00 \\(a\\)\uc774\uc0c1, \\(b\\)\uc774\uc0c1\uc774 \ub418\ub3c4\ub85d \ud558\ub294\uac83\"\uc740 \ub3d9\uce58\uc774\ub2e4.</p> <p>CheckPoint</p> <p>Observation 1\uc5d0 \uc758\ud574 \uc77c\ubc18\uc131\uc744 \uc783\uc9c0 \uc54a\uace0 \\(a \\le b \\le c\\)\ub77c \uac00\uc815\ud560 \ub54c, \\(A, B\\) \uc9d1\ud569\uc774 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub294 \ubd84\ud560\uc744 \ucc3e\uc73c\uba74 \ub41c\ub2e4. \uc774\ub294 Observation 2\uc5d0 \uc758\ud574 \uc815\uc810\ub4e4\uc744 \ub450 \uc9d1\ud569\uc73c\ub85c \ubd84\ud560\ud558\uc5ec, \uac01 \uc9d1\ud569\uc758 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8\uc758 \ucd5c\ub300 \ud06c\uae30\uac00 \\(a\\)\uc774\uc0c1, \\(b\\)\uc774\uc0c1\uc774 \ub418\ub3c4\ub85d \ud558\ub294 \ubc29\ubc95\uc744 \ucc3e\ub294 \uac83\uacfc \ub3d9\uce58\uc774\ub2e4.</p> <p>\ucd94\uac00\ub85c \uc77c\ubc18\uc131\uc744 \uc783\uc9c0 \uc54a\uace0 \\(a \\le b \\le c\\)\ub97c \uac15\uc81c\ud558\uc600\uae30 \ub54c\ubb38\uc5d0, \\(a, b, c\\)\uc5d0\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \uc131\uc9c8\ub4e4\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> <p>Observation 3</p> \\[a \\le \\frac{N}{3}, b \\le \\frac{N-a}{2}\\] <p>\uc774\uc81c, \uc815\uc810\ub4e4\uc744 \ub450 \uc9d1\ud569\uc73c\ub85c \ubd84\ud560\ud558\uc5ec, \uac01 \uc9d1\ud569\uc758 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8\uc758 \ucd5c\ub300 \ud06c\uae30\uac00 \\(a\\)\uc774\uc0c1, \\(b\\)\uc774\uc0c1\uc774 \ub418\ub3c4\ub85d \ud558\ub294 \ubc29\ubc95\uc744 \ucc3e\ub294 \uac83\uc5d0 \uc9d1\uc911\ud558\uc790. \uc55e\uc73c\ub85c\uc758 \ud480\uc774\ub294 centroid\uc758 \uc544\uc774\ub514\uc5b4\uc640 \ub2e4\uc591\ud55c \uad00\ucc30\ub4e4\uc744 \uc774\uc6a9\ud558\uc5ec \ubb38\uc81c\ub97c \ud574\uacb0\ud55c\ub2e4.</p> <p>\uadf8\ub798\ud504\uc758 \uc784\uc758\uc758 spanning tree\ub97c \uc7a1\uace0, \uc774 \ud2b8\ub9ac\uc758 centroid\ub97c \uc7a1\uc790. Centroid\ub97c \uae30\uc900\uc73c\ub85c \ud2b8\ub9ac\ub97c \uc11c\ube0c\ud2b8\ub9ac\ub4e4\ub85c \ubd84\ud560\ud558\uba74, \uc815\uc758\uc5d0 \uc758\ud574 \ub0a8\ub294 \uc11c\ube0c\ud2b8\ub9ac\ub4e4\uc740 \ud06c\uae30 \\(\\frac{N}{2}\\) \uc774\ud558\uac00 \ub41c\ub2e4.</p> <p></p> <p>(Case 1) Centroid\ub97c \uc81c\uac70\ud55c \ud6c4 \ub0a8\uc740 \uc11c\ube0c\ud2b8\ub9ac\ub4e4 \uc911 \ud06c\uae30 \\(a\\) \uc774\uc0c1\uc778 \uc11c\ube0c\ud2b8\ub9ac\uac00 \uc874\uc7ac\ud55c\ub2e4. \ud06c\uae30 \\(a\\) \uc774\uc0c1\uc778 \uc11c\ube0c\ud2b8\ub9ac \ud55c\uac1c\ub97c \uc9d1\ud569 \\(A\\)\uc5d0 \ubc30\uc815\ud55c \ud6c4, centroid\ub97c \ud3ec\ud568\ud55c \ub098\uba38\uc9c0 \uc815\uc810\ub4e4\uc744 \uc9d1\ud569 \\(B\\)\uc5d0 \ubc30\uc815\ud558\uc600\ub2e4\uace0 \uc0dd\uac01\ud558\uc790. \ubaa8\ub4e0 \uc11c\ube0c\ud2b8\ub9ac\uc758 \ud06c\uae30\uac00 \\(\\frac{N}{2}\\) \uc774\ud558\uc774\ub2c8 \\(|A| \\le \\frac{N}{2}\\), \\(|B|=N-|A| \\ge \\frac{N}{2}\\)\uac00 \uc131\ub9bd\ud558\uba70 \\(|B| \\ge \\frac{N}{2} \\ge \\frac{N-a}{2} \\ge b\\)\uc774\ub2c8 \\(a \\le |A|\\), \\(b \\le |B|\\)\uac00 \uc131\ub9bd\ud558\uace0, spanning tree \uc0c1\uc5d0\uc11c \uac01 \uc9d1\ud569\uc740 \uc5f0\uacb0\ub418\uc5b4 \uc788\uae30 \ub54c\ubb38\uc5d0 \ubaa8\ub4e0 \uc870\uac74\uc744 \ub9cc\uc871\ud55c\ub2e4.</p> <p>(Case 2) Centroid\ub97c \uc81c\uac70\ud55c \ud6c4 \ub0a8\uc740 \uc11c\ube0c\ud2b8\ub9ac\ub4e4\uc774 \ubaa8\ub450 \ud06c\uae30\uac00 \\(a\\) \ubbf8\ub9cc\uc774\ub2e4. \uc774 \uacbd\uc6b0\ub294 \ud55c \uc11c\ube0c\ud2b8\ub9ac\ub97c \ud1b5\uc9f8\ub85c \\(A\\)\uc5d0 \ubc30\uc815\ud558\uc5ec\ub3c4 \ud06c\uae30\uac00 \ucda9\ubd84\ud558\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0 \uc870\uac74\uc744 \ub9cc\uc871\ud558\uc9c0 \ubabb\ud558\ub294 \uacbd\uc6b0\uc774\ub2e4. \ub9cc\uc57d \uc774 \uacbd\uc6b0\uc5d0\ub3c4 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub3c4\ub85d \ub450 \uc9d1\ud569\uc73c\ub85c \ubd84\ud560\ud560 \uc218 \uc788\ub2e4\uba74, \ub450 \uc9d1\ud569 \uc911 centroid\ub97c \ud3ec\ud568\ud558\uace0 \uc788\uc9c0 \uc54a\ub294 \uc9d1\ud569\uc740 \uc5ec\ub7ec \uac1c\uc758 \uc11c\ube0c\ud2b8\ub9ac\uc5d0 \uac78\uccd0 \uc788\ub294 \uc815\uc810\ub4e4\uc744 \ud3ec\ud568\ud558\uace0 \uc788\uc5b4\uc57c \ud558\uba70, \uc9d1\ud569\uc758 \ud06c\uae30\ub294 \\(a\\) \uc774\uc0c1\uc774\uc5b4\uc57c \ud55c\ub2e4. \uac01 \uc11c\ube0c\ud2b8\ub9ac\ub4e4\uc744 \ud558\ub098\uc758 \uc815\uc810\uc73c\ub85c \uc555\ucd95\ud558\uc5ec \ud45c\ud604\ud558\uc600\uc744 \ub54c spanning tree\uc5d0 \uc0ac\uc6a9\ub418\uc9c0 \uc54a\ub294 \uac04\uc120\ub4e4\uc740 \uc555\ucd95\ub41c \uc815\uc810\ub4e4\uc744 \uc5f0\uacb0\ud558\ub294 \uac04\uc120\uc758 \uc5ed\ud560\uc744 \ud55c\ub2e4. \uc704\uc5d0\uc11c \uc5b8\uae09\ud55c \uac83\uacfc \uac19\uc774 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub3c4\ub85d \ub450 \uc9d1\ud569\uc73c\ub85c \ubd84\ud560\ud560 \uc218 \uc788\ub2e4\uba74 \uc555\ucd95\ub41c \uc815\uc810\ub4e4 \uba87\uac1c\ub97c \uc120\ud0dd\ud558\uc5ec \ud558\ub098\uc758 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8\ub97c \uc774\ub8e8\uba70, \uc9d1\ud569\uc758 \ud06c\uae30\uac00 \\(a\\) \uc774\uc0c1\uc774 \ub418\ub3c4\ub85d \ud574\uc57c \ud55c\ub2e4. \ub9cc\uc57d \uc5b4\ub5bb\uac8c \uc120\ud0dd\ud558\ub354\ub77c\ub3c4 \ud55c \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8 \ub0b4\uc5d0\uc11c \uc9d1\ud569\uc758 \ud06c\uae30\uac00 \\(a\\) \uc774\uc0c1\uc774 \ub420 \uc218 \uc5c6\ub2e4\uba74, \uc774\ub294 \uc555\ucd95\ub41c \uc815\uc810\ub4e4\uc758 \uac00\uc7a5 \ud070 \ud06c\uae30\uc758 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8 \uc9d1\ud569\uc758 \ud06c\uae30\uac00 \\(a\\) \ubbf8\ub9cc\uc774\ub77c\ub294 \uc758\ubbf8\uace0, \uc774\ub294 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ubd84\ud560\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc74c\uc744 \uc758\ubbf8\ud55c\ub2e4. \uc544\ub2d0 \uacbd\uc6b0 \uc555\ucd95\ub41c \uc815\uc810\ub4e4\uc758 \uac00\uc7a5 \ud070 \ud06c\uae30\uc758 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8 \uc9d1\ud569\uc758 \uc784\uc758\uc758 \uc815\uc810\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec, \ud558\ub098\uc529 \\(A\\)\uc5d0 \ubc30\uc815\ud558\uba70 \uc9d1\ud569\uc758 \ud06c\uae30\uac00 \\(a\\) \uc774\uc0c1\uc774 \ub418\ub294 \uc21c\uac04 \uc885\ub8cc\ud558\ub294 dfs\ub97c \uc0dd\uac01\ud558\uc790. centroid\ub97c \ud3ec\ud568\ud55c \ub098\uba38\uc9c0 \uc815\uc810\ub4e4\uc740 \uc9d1\ud569 \\(B\\)\uc5d0 \ubc30\uc815\ud55c\ub2e4. \ubaa8\ub4e0 \uc555\ucd95\ub41c \uc815\uc810\ub4e4\uc758 \uc9d1\ud569 \ud06c\uae30\ub294 \\(a\\) \ubbf8\ub9cc\uc774\ub2c8 \\(a \\le |A| &lt; 2a\\)\uc784\uc744 \uc54c \uc218 \uc788\ub2e4. \\(|B|=N-|A|&gt;N-2a \\ge N-a-c = b\\)\uc774\ub2c8 \\(a \\le |A|\\), \\(b \\le |B|\\)\uac00 \uc131\ub9bd\ud558\uace0, spanning tree \uc0c1\uc5d0\uc11c \uac01 \uc9d1\ud569\uc740 \uc5f0\uacb0\ub418\uc5b4 \uc788\uae30 \ub54c\ubb38\uc5d0 \ubaa8\ub4e0 \uc870\uac74\uc744 \ub9cc\uc871\ud55c\ub2e4.</p> <p>Observation 4</p> <p>\uadf8\ub798\ud504\uc758 \uc784\uc758\uc758 spanning tree\ub97c \uc7a1\uace0, \uc774 \ud2b8\ub9ac\uc758 centroid\ub97c \uc7a1\uc790.</p> <p>(Case 1) Centroid\ub97c \uc81c\uac70\ud55c \ud6c4 \ub0a8\uc740 \uc11c\ube0c\ud2b8\ub9ac\ub4e4 \uc911 \ud06c\uae30 \\(a\\) \uc774\uc0c1\uc778 \uc11c\ube0c\ud2b8\ub9ac\uac00 \uc874\uc7ac\ud55c\ub2e4. \ud06c\uae30 \\(a\\) \uc774\uc0c1\uc778 \uc11c\ube0c\ud2b8\ub9ac \ud55c\uac1c\ub97c \uc9d1\ud569 \\(A\\)\uc5d0 \ubc30\uc815\ud55c \ud6c4, centroid\ub97c \ud3ec\ud568\ud55c \ub098\uba38\uc9c0 \uc815\uc810\ub4e4\uc744 \uc9d1\ud569 \\(B\\)\uc5d0 \ubc30\uc815\ud558\uba74 \uc870\uac74\uc744 \ub9cc\uc871\ud55c\ub2e4.</p> <p>(Case 2) Centroid\ub97c \uc81c\uac70\ud55c \ud6c4 \ub0a8\uc740 \uc11c\ube0c\ud2b8\ub9ac\ub4e4\uc774 \ubaa8\ub450 \ud06c\uae30\uac00 \\(a\\) \ubbf8\ub9cc\uc774\ub2e4. \uac01 \uc11c\ube0c\ud2b8\ub9ac\ub4e4\uc744 \ud558\ub098\uc758 \uc815\uc810\uc73c\ub85c \uc555\ucd95\ud558\uc5ec \ud45c\ud604\ud558\uc600\uc744 \ub54c spanning tree\uc5d0 \uc0ac\uc6a9\ub418\uc9c0 \uc54a\ub294 \uac04\uc120\ub4e4\uc740 \uc555\ucd95\ub41c \uc815\uc810\ub4e4\uc744 \uc5f0\uacb0\ud558\ub294 \uac04\uc120\uc758 \uc5ed\ud560\uc744 \ud55c\ub2e4. \ub9cc\uc57d \uc555\ucd95\ub41c \uc815\uc810\ub4e4\uc758 \uac00\uc7a5 \ud070 \ud06c\uae30\uc758 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8 \uc9d1\ud569\uc758 \ud06c\uae30\uac00 \\(a\\) \ubbf8\ub9cc\uc774\uba74, \uc774\ub294 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ubd84\ud560\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc74c\uc744 \uc758\ubbf8\ud55c\ub2e4. \uc544\ub2d0 \uacbd\uc6b0 \uc555\ucd95\ub41c \uc815\uc810\ub4e4\uc758 \uac00\uc7a5 \ud070 \ud06c\uae30\uc758 \uc5f0\uacb0 \ucef4\ud3ec\ub10c\ud2b8 \uc9d1\ud569\uc758 \uc784\uc758\uc758 \uc815\uc810\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec, \ud558\ub098\uc529 \\(A\\)\uc5d0 \ubc30\uc815\ud558\uba70 \uc9d1\ud569\uc758 \ud06c\uae30\uac00 \\(a\\) \uc774\uc0c1\uc774 \ub418\ub294 \uc21c\uac04 \uc885\ub8cc\ud558\ub294 dfs\ub97c \uc0dd\uac01\ud558\uc790. centroid\ub97c \ud3ec\ud568\ud55c \ub098\uba38\uc9c0 \uc815\uc810\ub4e4\uc740 \uc9d1\ud569 \\(B\\)\uc5d0 \ubc30\uc815\ud558\uba74 \uc870\uac74\uc744 \ub9cc\uc871\ud55c\ub2e4.</p> <p>\uc704 Observation 4\uc758 \uc54c\uace0\ub9ac\uc998\uc744 dfs\ub97c \uc774\uc6a9\ud558\uc5ec \\(O(N)\\)\uc5d0 \ud0d0\uc0c9\ud558\uba74 Observation 2\uc758 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ubd84\ud560\uc744 \ucc3e\uc744 \uc218 \uc788\uace0, \uc774\ub97c \uc774\uc6a9\ud558\uc5ec \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>\uadf8\ub798\ud504\uc758 \uc784\uc758\uc758 spanning tree\ub97c \uc7a1\uace0, centroid\ub97c \ucc3e\uc740 \ud6c4 Observation 4\uc758 \uc54c\uace0\ub9ac\uc998\uc744 dfs\ub97c \uc774\uc6a9\ud558\uc5ec \\(O(N)\\)\uc5d0 \ud0d0\uc0c9\ud558\uba74 Observation 2\uc758 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ubd84\ud560\uc744 \ucc3e\uc744 \uc218 \uc788\ub2e4. \uc774 \ubd84\ud560\uc744 \uc774\uc6a9\ud558\uc5ec \uad6c\ud558\uace0\uc790 \ud558\ub294 \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N)\\)</p>","tags":["ad_hoc","centroid","dfs","graphs","graph_traversal","greedy","trees","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P2%20Split%20the%20Attractions/solution/#code","title":"Code","text":"<pre><code>#include \"split.h\"\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 1e5;\n\nint N, ans[MAXN+10];\npii A[4];\nvector&lt;int&gt; adj[MAXN+10], adj2[MAXN+10], adj3[MAXN+10];\n\nint sz[MAXN+10], id[MAXN+10];\n\nvoid getsz(int now, int bef)\n{\n    sz[now]=1;\n    for(int nxt : adj2[now])\n    {\n        if(nxt==bef) continue;\n        getsz(nxt, now);\n        sz[now]+=sz[nxt];\n    }\n}\n\nint getcen(int now, int bef, int S)\n{\n    for(int nxt : adj2[now])\n    {\n        if(nxt==bef) continue;\n        if(sz[nxt]&gt;S/2) return getcen(nxt, now, S);\n    }\n    return now;\n}\n\nvoid color(int now, int bef, int col, int &amp;k)\n{\n    if(k&lt;=0) return;\n    ans[now]=col; k--;\n    for(int nxt : adj2[now])\n    {\n        if(nxt==bef) continue;\n        if(ans[nxt]) continue;\n        color(nxt, now, col, k);\n    }\n}\n\nvoid color2(int now, int bef, int root)\n{\n    id[now]=root;\n    for(int nxt : adj2[now])\n    {\n        if(nxt==bef) continue;\n        color2(nxt, now, root);\n    }\n}\n\nbool vis[MAXN+10];\nvoid dfs(int now)\n{\n    vis[now]=true;\n    for(int nxt : adj[now])\n    {\n        if(vis[nxt]) continue;\n        adj2[now].push_back(nxt);\n        adj2[nxt].push_back(now);\n        dfs(nxt);\n    }\n}\n\nvector&lt;int&gt; V;\nvoid dfs2(int now, int &amp;k)\n{\n    vis[now]=true;\n    k+=sz[now]; V.push_back(now);\n    if(k&gt;=A[1].first) return;\n    for(int nxt : adj3[now])\n    {\n        if(vis[nxt]) continue;\n        dfs2(nxt, k);\n    }\n}\n\nvoid solve()\n{\n    memset(vis, 0, sizeof(vis));\n    dfs(1);\n    getsz(1, 1);\n    int cen=getcen(1, 1, N);\n    getsz(cen, cen);\n\n    for(int now : adj2[cen])\n    {\n        color2(now, cen, now);\n        if(A[1].first&lt;=sz[now])\n        {\n            int t=A[1].first;\n            color(now, cen, A[1].second, t);\n            t=A[2].first;\n            color(cen, now, A[2].second, t);\n            for(int i=1; i&lt;=N; i++) if(ans[i]==0) ans[i]=A[3].second;\n            return;\n        }\n    }\n\n    for(int i=1; i&lt;=N; i++)\n    {\n        int now=i;\n        if(now==cen) continue;\n        for(int nxt : adj[now])\n        {\n            if(nxt==cen) continue;\n            if(id[now]==id[nxt]) continue;\n            adj3[id[now]].push_back(id[nxt]);\n        }\n    }\n\n    memset(vis, 0, sizeof(vis));\n    for(int now : adj2[cen])\n    {\n        if(vis[now]) continue;\n        int t=0;\n        dfs2(now, t);\n        if(t&lt;A[1].first) continue;\n\n        t=A[1].first;\n        for(auto it : V) color(it, cen, A[1].second, t);\n        color(cen, cen, A[2].second, A[2].first);\n        for(int i=1; i&lt;=N; i++) if(ans[i]==0) ans[i]=A[3].second;\n        return;\n    }\n}\n\nvector&lt;int&gt; find_split(int _N, int _A, int _B, int _C, vector&lt;int&gt; _P, vector&lt;int&gt; _Q)\n{\n    N=_N; A[1]=pii(_A, 1); A[2]=pii(_B, 2); A[3]=pii(_C, 3);\n    for(int i=0; i&lt;_P.size(); i++)\n    {\n        int u=_P[i]+1, v=_Q[i]+1;\n        adj[u].push_back(v);\n        adj[v].push_back(u);\n    }\n    sort(A+1, A+4);\n\n    solve();\n\n    vector&lt;int&gt; _ans(N);\n    for(int i=1; i&lt;=N; i++) _ans[i-1]=ans[i];\n    return _ans;\n}\n</code></pre>","tags":["ad_hoc","centroid","dfs","graphs","graph_traversal","greedy","trees","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P3%20Rectangles/solution/","title":"IOI 2019 D1P3 Rectangles","text":"","tags":["implementation","sorting","stack","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P3%20Rectangles/solution/#problem","title":"Problem","text":"","tags":["implementation","sorting","stack","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P3%20Rectangles/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/19916 https://oj.uz/problem/view/IOI19_rect</p>","tags":["implementation","sorting","stack","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P3%20Rectangles/solution/#summary","title":"Summary","text":"<p>2\ucc28\uc6d0 \ubc30\uc5f4 \\(A\\)\uac00 \uc8fc\uc5b4\uc9c8 \ub54c, \\(y_1 \\le y \\le y_2\\), \\(x_1 \\le x \\le x_2\\) \ub97c \ub9cc\uc871\ud558\ub294 \\(A[y][x]\\)\ub85c \uad6c\uc131\ub41c \\(A\\)\uc758 \ubd80\ubd84\uc9c1\uc0ac\uac01\ud615 \\((y_1, y_2, x_1, x_2)\\)\uc5d0 \ub300\ud558\uc5ec \ub2e4\uc74c\uc744 \ub9cc\uc871\ud558\ub294 \ubd80\ubd84\uc9c1\uc0ac\uac01\ud615\uc758 \uac1c\uc218\ub97c \uad6c\ud558\uc5ec\ub77c.</p> <ul> <li>\\(2 \\le y_1 \\le y_2 \\le N-1\\), \\(2 \\le x_1 \\le x_2 \\le M-1\\)</li> <li>\\(\\forall \\ y_1 \\le y \\le y_2, x_1 \\le x \\le x_2\\), \\(min(A[y_1-1][x], A[y_2+1][x], A[y][x_1-1], A[y][x_2+1])&gt;A[y][x]\\)</li> </ul>","tags":["implementation","sorting","stack","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P3%20Rectangles/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(1 \\le N, M \\le 2,500\\)</li> <li>\\(0 \\le A[i][j] \\le 7,000,000\\) \\((1 \\le i \\le N, 1 \\le j \\le M)\\)</li> </ul>","tags":["implementation","sorting","stack","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P3%20Rectangles/solution/#solution","title":"Solution","text":"","tags":["implementation","sorting","stack","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P3%20Rectangles/solution/#subtask-5","title":"Subtask 5","text":"<ul> <li>\\(N \\le 3\\)</li> </ul> <p>\\(N \\le 3\\)\uc774\ub2c8, \\(1\\)\ucc28\uc6d0 \ubc30\uc5f4\uc5d0\uc11c \\(x\\)\ucd95\uc5d0 \ub300\ud558\uc5ec \ub2e4\uc74c \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uad6c\uac04 \\((x_1, x_2)\\)\uc758 \uac1c\uc218\ub97c \uc138\ub294 \ubb38\uc81c\uc774\ub2e4.</p> <ul> <li>\\(2 \\le x_1 \\le x_2 \\le M-1\\)</li> <li>\\(\\forall x_1 \\le x \\le x_2\\), \\(min(A[2][x_1-1], A[2][x_2+1])&gt;A[2][x]\\)</li> <li>\\(\\forall x_1 \\le x \\le x_2\\), \\(min(A[1][x], A[3][x])&gt;A[2][x]\\)</li> </ul> <p>\uc870\uac74 \\(min(A[1][x], A[3][x])&gt;A[2][x]\\)\uc744 \ub9cc\uc871\ud558\uc9c0 \uc54a\ub294 \uc810 \\(x\\)\ub294 \uc5b4\ub5a4 \uad6c\uac04\uc5d0\ub3c4 \ud3ec\ud568\ub420 \uc218 \uc5c6\uc73c\ub2c8, \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uc810\ub4e4\ub9cc \ub0a8\uae30\uace0 \ubc30\uc5f4\uc744 \uc5ec\ub7ec \uac1c\uc758 \ubc30\uc5f4\ub85c \ucabc\uac24 \uc218 \uc788\ub2e4. \uc774\uc640 \uac19\uc774 \ubc30\uc5f4\uc744 \ucabc\uac20 \ud6c4 \uc870\uac74 \\(min(A[2][x_1-1], A[2][x_2+1])&gt;A[2][x]\\)\uc744 \ub9cc\uc871\ud558\ub294 \uad6c\uac04\uc758 \uac1c\uc218\ub97c \uc138\uc790.</p> <p>\uad6c\uac04\uc758 \ucd5c\ub313\uac12 \\(A[k]\\)\ub97c \uace0\uc815\ud574 \ub193\uace0, \\(A[k]\\)\ub97c \ud3ec\ud568\ud558\uba70 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uad6c\uac04 \\((l, r)\\)\uc774 \uba87\uac1c \uc788\uc744 \uc218 \uc788\ub294\uc9c0 \uc0dd\uac01\ud574\ubcf4\uc790. \\(A[k]\\)\uac00 \ucd5c\ub313\uac12\uc774\uae30 \ub54c\ubb38\uc5d0 \\(A[l-1]&gt;A[k]\\), \\(A[r+1]&gt;A[k]\\), \\(A[i] \\le A[k] (l \\le i \\le r)\\)\ub97c \ub9cc\uc871\ud574\uc57c \ud55c\ub2e4. \\(l=r=k\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec, \uc870\uac74\uc744 \ub9cc\uc871\ud560 \ub54c\uae4c\uc9c0 \ud55c \uce78\uc529 \ud655\uc7a5\uc2dc\ucf1c\ubcf4\uc790. \\(A[l-1] \\le A[k]\\)\uc774\uac70\ub098 \\(A[r+1] \\le A[k]\\)\ub77c\uba74, \uc870\uac74\uc744 \ub9cc\uc871\ud558\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0 \\(l\\)\uc774\ub098 \\(r\\)\uc744 \ud55c \uce78\uc529 \ud655\uc7a5\uc2dc\ucf1c \uad6c\uac04 \uc548\uc5d0 \ud3ec\ud568\uc2dc\ucf1c\uc57c \ud55c\ub2e4. \uc704 \uacfc\uc815\uc744 \ubc18\ubcf5\ud558\uc5ec \\(A[l] &gt; A[k]\\), \\(A[r] &gt; A[k]\\)\ub77c\uba74, \uc870\uac74\uc744 \ub9cc\uc871\ud560 \ubfd0\ub9cc \uc544\ub2c8\ub77c \uc5ec\uae30\uc11c \ud55c\uce78\uc774\ub77c\ub3c4 \ub354 \ud655\uc7a5\uc2dc\ud0a4\ub294 \uc21c\uac04 \\(A[k]\\)\uac00 \ucd5c\ub313\uac12\uc774\ub77c\ub294 \uc870\uac74\uc5d0 \uc704\ubc30\ub418\ub2c8, \uc774\ub7ec\ud55c \\((l, r)\\)\uc774 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uc720\uc77c\ud55c \\((l, r)\\)\uc774\ub2e4.</p> <p></p> <p>\ub530\ub77c\uc11c, \uac01 \ucd5c\ub313\uac12 \\(A[k]\\)\uc5d0 \ub300\ud558\uc5ec \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \\((l, r)\\)\uc740 \ucd5c\ub300 \\(1\\)\uac1c \uc874\uc7ac\ud558\ub2c8, \uc804\uccb4 \uac00\ub2a5\ud55c \ub2f5\uc758 \uac1c\uc218\ub294 \ucd5c\ub300 \\(O(M)\\)\uc774\ub2e4. \uac01 \\(k\\)\uc5d0 \ub300\ud558\uc5ec \\(l&lt;k, A[l]&gt;A[k]\\)\uc778 \ucd5c\ub300 \\(l\\)\uc640 \\(k&lt;r, A[r]&gt;A[k]\\)\uc778 \ucd5c\ub300 \\(r\\)\uc744 stack\uc73c\ub85c \uad00\ub9ac\ud558\uba74 \\(O(M)\\)\uc5d0 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Observation 1</p> <p>\\(1\\)\ucc28\uc6d0 \ubb38\uc81c\uc5d0\uc11c \uad6c\uac04\uc758 \ucd5c\ub313\uac12\uc744 \\(A[k]\\)\ub85c \uace0\uc815\ud558\uc600\uc744 \ub54c \uc870\uac74 \\(\\forall x_1 \\le x \\le x_2\\), \\(min(A[2][x_1-1], A[2][x_2+1])&gt;A[2][x]\\)\uc744 \ub9cc\uc871\ud558\ub294 \\((x_1, x_2)\\)\uc740 \ucd5c\ub300 \\(1\\)\uac1c \uc874\uc7ac\ud55c\ub2e4. \ub530\ub77c\uc11c \uc804\uccb4 \uac00\ub2a5\ud55c \uad6c\uac04\uc758 \uc218\ub294 \ucd5c\ub300 \\(O(M)\\)\uac1c\uc774\ub2e4.</p> <p>CheckPoint</p> <p>Observation 1\uc5d0 \uc758\ud574 1\ucc28\uc6d0 \ubb38\uc81c\uc5d0\uc11c \uac00\ub2a5\ud55c \uad6c\uac04\uc758 \uc218\ub294 \ucd5c\ub300 \\(N\\)\uac1c\uc774\ub2c8 \uac01 \\(k\\)\uc5d0 \ub300\ud558\uc5ec \\(l&lt;k, A[l]&gt;A[k]\\)\uc778 \ucd5c\ub300 \\(l\\)\uc640 \\(k&lt;r, A[r]&gt;A[k]\\)\uc778 \ucd5c\uc18c \\(r\\)\uc744 stack\uc73c\ub85c \uad00\ub9ac\ud558\uba74 \\(O(M)\\)\uc5d0 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(M)\\)</p>","tags":["implementation","sorting","stack","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P3%20Rectangles/solution/#subtask-7-full","title":"Subtask 7 (Full)","text":"<p>\\(2\\)\ucc28\uc6d0 \uc0c1\ud669\uc5d0\uc11c\ub3c4 \ube44\uc2b7\ud55c \uc544\uc774\ub514\uc5b4\ub85c \uc811\uadfc\ud560 \uc218 \uc788\ub2e4. \uc6b0\uc120, Observation 1\uc5d0\uc11c \uc870\uac74 \\(\\forall \\ y_1 \\le y \\le y_2, x_1 \\le x \\le x_2\\), \\(min(A[y_1-1][x], A[y_2+1][x])&gt;A[y][x], min(A[y][x_1-1], A[y][x_2+1])&gt;A[y][x]\\)\uc744 \ub9cc\uc871\ud558\ub294 \"\uad6c\uac04\" \\((y_1, y_2)\\), \\((x_1, x_2)\\)\ub294 \uac01 \ud589, \uc5f4\ubcc4\ub85c \\(O(M)\\), \\(O(N)\\)\uac1c\uc774\ub2e4.</p> <p>\ub610\ud55c, \uc804\uacfc \ube44\uc2b7\ud558\uac8c \uc9c1\uc0ac\uac01\ud615 \ub0b4\uc758 \uc804\uccb4 \ucd5c\ub313\uac12 \\(A[p][q]\\)\ub97c \uace0\uc815\ud558\uba74 Observation 1\uc5d0\uc11c \\(p\\)\ud589\uacfc \\(q\\)\uc5f4\uc5d0 \ub300\ud558\uc5ec \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \\((y_1, y_2, x_1, x_2)\\)\ub294 \uc815\ud655\ud788 \\(1\\)\uac1c\uc774\ub2e4. \ub530\ub77c\uc11c \uc804\uccb4 \uac00\ub2a5\ud55c \ub2f5\uc758 \ucd5c\ub300 \uac1c\uc218 \ub610\ud55c \\(O(NM)\\)\uc784\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>Observation 2</p> <p>\uc9c1\uc0ac\uac01\ud615\uc758 \ucd5c\ub313\uac12\uc744 \\(A[p][q]\\)\ub85c \uace0\uc815\ud558\uc600\uc744 \ub54c \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uc9c1\uc0ac\uac01\ud615 \\((y_1, y_2, x_1, x_2)\\)\uc740 Observation 1\uc5d0 \uc758\ud574 \uc815\ud655\ud788 \ud558\ub098\ub85c \uacb0\uc815\ub41c\ub2e4. \ub530\ub77c\uc11c \uc804\uccb4 \uac00\ub2a5\ud55c \uc9c1\uc0ac\uac01\ud615\uc758 \uc218\ub294 \ucd5c\ub300 \\(O(NM)\\)\uac1c\uc774\ub2e4.</p> <p>\uc774\uc81c \uc704 \\(O(NM)\\)\uac1c\uc758 \uc9c1\uc0ac\uac01\ud615 \ud6c4\ubcf4\ub4e4\uc744 \uad6c\ud558\uace0, \uac01 \ud6c4\ubcf4\uc5d0 \ub300\ud558\uc5ec \uc9c1\uc0ac\uac01\ud615 \ub0b4\uc758 \ub2e4\ub978 \uac12\ub4e4\uc5d0 \ub300\ud574\uc11c\ub3c4 \uc870\uac74\uc774 \uc131\ub9bd\ud558\ub294\uc9c0\ub9cc \ube60\ub974\uac8c \ud655\uc778\ud574\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\uc6b0\uc120, \uc9c1\uc0ac\uac01\ud615 \ud6c4\ubcf4\ub97c \uad6c\ud558\ub294 \uac83\uc740 \uac01 \ud589\uacfc \uc5f4\uc5d0 \ub300\ud55c \\(1\\)\ucc28\uc6d0 \ubb38\uc81c\ub85c \uc0dd\uac01\ud558\uace0 Subtask 5\uc5d0\uc11c \uad6c\ud588\ub358 \uac83\uacfc \uac19\uc740 \ubc29\ubc95\uc73c\ub85c stack\uc744 \uc774\uc6a9\ud558\uc5ec \uac01 \ud589, \uc5f4\ubcc4\ub85c \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uad6c\uac04\ub4e4\uc744 \uad6c\ud558\uba74 \ub41c\ub2e4. \uac01 \ud589, \uc5f4\ubcc4\ub85c \\(O(M)\\), \\(O(N)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub9ac\ub2c8 \uc804\uccb4 \\(O(NM)\\)\uc758 \uc2dc\uac04\uc5d0 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\uc9c1\uc0ac\uac01\ud615 \ud6c4\ubcf4 \\((y_1, y_2, x_1, x_2)\\)\uac00 \uc870\uac74\uc744 \uc131\ub9bd\ud558\ub294\uc9c0 \ud655\uc778\ud558\ub294 \ubc29\ubc95\uc740, \\(\\forall \\ y_1 \\le y \\le y_2\\), \ud589 \\(y\\)\uc5d0 \ub300\ud55c \uad6c\uac04 \\((y, x_1, x_2)\\)\uc774 \uc870\uac74\uc744 \ub9cc\uc871\ud558\uba70 \\(\\forall \\ x_1 \\le x \\le x_2\\), \uc5f4 \\(x\\)\uc5d0 \ub300\ud55c \uad6c\uac04 \\((x, y_1, y_2)\\)\uc774 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294\uc9c0 \ud655\uc778\ud558\ub294 \uac83\uc774\ub2e4. \uc774\ub97c \uc704\ud558\uc5ec \ub2e4\uc74c\uacfc \uac19\uc740 \uac12\uc744 \uc804\ucc98\ub9ac\ud558\uc790.</p> <p>Definition 1</p> <p>\\(low(y_1, x_1, x_2):=\\) \ud589 \\(y_1\\)\uc5d0 \ub300\ud55c \uad6c\uac04 \\((y_1, x_1, x_2)\\)\uc774 \uc870\uac74\uc744 \ub9cc\uc871\ud560 \ub54c, \uc870\uac74\uc744 \ub9cc\uc871\ud558\uba70 \ub0b4\ub824\uac08 \uc218 \uc788\ub294 \ucd5c\ub300\uc758 \\(y\\) \\(low(y_1, x_1, x_2)=y_2\\)\ub77c \ud560 \ub54c, \\(\\forall \\ y_1 \\le y \\le y_2\\), \ud589 \\(y\\)\uc5d0 \ub300\ud55c \uad6c\uac04 \\((y, x_1, x_2)\\)\uc774 \ubaa8\ub450 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ucd5c\ub300\uc758 \\(y_2\\)</p> <p>\\(low(x_1, y_1, y_2):=\\) \uc5f4 \\(x_1\\)\uc5d0 \ub300\ud55c \uad6c\uac04 \\((x_1, y_1, y_2)\\)\uc774 \uc870\uac74\uc744 \ub9cc\uc871\ud560 \ub54c, \uc870\uac74\uc744 \ub9cc\uc871\ud558\uba70 \uc624\ub978\ucabd\uc73c\ub85c \uac08 \uc218 \uc788\ub294 \ucd5c\ub300\uc758 \\(x\\) \\(low(x_1, y_1, y_2)=x_2\\)\ub77c \ud560 \ub54c, \\(\\forall \\ x_1 \\le x \\le x_2\\), \uc5f4 \\(x\\)\uc5d0 \ub300\ud55c \uad6c\uac04 \\((x, y_1, y_2)\\)\uc774 \ubaa8\ub450 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ucd5c\ub300\uc758 \\(x_2\\)</p> <p>\uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ud589 \\(y\\)\uc5d0 \ub300\ud55c \uad6c\uac04 \\((y, x_1, x_2)\\), \uc5f4 \\(x\\)\uc5d0 \ub300\ud55c \uad6c\uac04 \\((x, y_1, y_2)\\)\uc744 \ubaa8\ub450 \uad6c\ud574\ub193\uc558\ub2e4\uba74 \\(low(y_1, x_1, x_2)\\), \\(low(x_1, y_1, y_2)\\) \ub610\ud55c \uad6c\ud560 \uc218 \uc788\ub2e4. \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \\(NM\\)\uac1c\uc758 \uc77c\ucc28\uc6d0 \uad6c\uac04\ub4e4\uc744 \ubaa8\ub450 \\(y\\), \\(x\\)\uc5d0 \ub300\ud558\uc5ec \uc815\ub82c\ud55c \ud6c4, \ub2e4\uc74c \\(y\\), \\(x\\)\uc5d0 \ub300\ud55c \uad6c\uac04\uc774 \uc874\uc7ac\ud558\ub294\uc9c0 \ud655\uc778\ud558\uba74 \ub418\uae30 \ub54c\ubb38\uc5d0, \uc774\ubd84\ud0d0\uc0c9 \ub4f1\uc744 \ud1b5\ud574 \uc774 \uacfc\uc815\uc740 \\(O(NM\\log NM)\\)\uc5d0 \uc804\ucc98\ub9ac \ud558\uba74 \ub41c\ub2e4. \uc774\uc81c, \uc9c1\uc0ac\uac01\ud615 \ud6c4\ubcf4 \\((y_1, y_2, x_1, x_2)\\)\uac00 \uc870\uac74\uc744 \uc131\ub9bd\ud558\ub294\uc9c0 \ud655\uc778\ud558\ub294 \ubc29\ubc95\uc740 \ub2e8\uc21c\ud788 \\(low(y_1, x_1, x_2) \\ge y_2\\), \\(low(x_1, y_1, y_2) \\ge x_2\\)\uc778\uc9c0 \ud655\uc778\ud558\ub294 \uac83\uc774\ub2e4.</p> <p>CheckPoint</p> <p>Observation 2\uc5d0 \uc758\ud574 \uc804\uccb4 \uac00\ub2a5\ud55c \uc9c1\uc0ac\uac01\ud615 \ud6c4\ubcf4\uc758 \uc218\uac00 \\(O(NM)\\)\uac1c\uc774\ub2c8, Subtask 5\uc5d0\uc11c \uad6c\ud588\ub358 \uac83\uacfc \uac19\uc740 \ubc29\ubc95\uc73c\ub85c stack\uc744 \uc774\uc6a9\ud558\uc5ec \uac01 \ud589, \uc5f4\ubcc4\ub85c \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uad6c\uac04\ub4e4\uc744 \\(O(NM)\\)\uc5d0 \uad6c\ud55c\ub2e4. \uc9c1\uc0ac\uac01\ud615 \ud6c4\ubcf4\uac00 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294\uc9c0 \ud655\uc778\ud558\uae30 \uc704\ud558\uc5ec Definition 1\uacfc \uac19\uc774 \\(low(y_1, x_1, x_2)\\), \\(low(x_1, y_1, y_2)\\)\ub97c \uc774\ubd84\ud0d0\uc0c9 \ub4f1\uc744 \ud65c\uc6a9\ud558\uc5ec \\(O(NM\\log NM)\\)\uc5d0 \uc804\ucc98\ub9ac\ud55c\ub2e4. \uc774\ud6c4, \uc9c1\uc0ac\uac01\ud615 \ud6c4\ubcf4 \\((y_1, y_2, x_1, x_2)\\)\uac00 \uc870\uac74\uc744 \uc131\ub9bd\ud558\ub294\uc9c0 \ud655\uc778\ud558\uae30 \uc704\ud558\uc5ec \\(low(y_1, x_1, x_2) \\ge y_2\\), \\(low(x_1, y_1, y_2) \\ge x_2\\)\uc778\uc9c0 \ud655\uc778\ud558\uc5ec \ub2f5\uc758 \uac1c\uc218\ub97c \uc13c\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(NM\\log NM)\\)</p> <p>\ud558\uc9c0\ub9cc \uc774\ub97c \uadf8\ub0e5 \uad6c\ud604\ud558\uba74 TLE\ub97c \ubc1b\uace0, vector\uc744 \uc774\uc6a9\ud558\uc9c0 \ub9d0\uace0, \uc774\ubd84\ud0d0\uc0c9\ubcf4\ub2e4\ub294 Two Pointer \uc774 \uac00\ub2a5\ud55c \uacbd\uc6b0\uc5d0\ub294 Two Pointer\uc744 \uc774\uc6a9\ud558\uace0, \ube44\ud2b8\ubcc4\ub85c \ucabc\uac1c\ub294 \ub4f1\uc758 \uc5ec\ub7ec \ucd5c\uc801\ud654\ub97c \ud574\uc57c 100\uc810\uc744 \ub9de\uc744 \uc218 \uc788\ub2e4.</p>","tags":["implementation","sorting","stack","~ solution"]},{"location":"solutions/Olympiad/IOI/2019/D1P3%20Rectangles/solution/#code","title":"Code","text":"<pre><code>#pragma GCC optimize (\"O3\")\n#pragma GCC optimize (\"Ofast\")\n#pragma GCC optimize (\"unroll-loops\")\n\n#include \"rect.h\"\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 2500;\n\nint N, M, A[MAXN+10][MAXN+10];\nint L[MAXN+10][MAXN+10], R[MAXN+10][MAXN+10], U[MAXN+10][MAXN+10], D[MAXN+10][MAXN+10];\n\nstruct Line\n{\n    int y, x;\n    Line() {}\n    Line(int y, int x1, int x2) : y(y), x((x1&lt;&lt;12)|x2) {}\n    bool operator &lt; (const Line &amp;p) const\n    {\n        if(y!=p.y) return y&lt;p.y;\n        return x&lt;p.x;\n    }\n\n    bool operator == (const Line &amp;p) { return y==p.y &amp;&amp; x==p.x; }\n    bool operator != (const Line &amp;p) { return !(y==p.y &amp;&amp; x==p.x); }\n};\n\nstruct Data\n{\n    Line first; int second;\n    Data() {}\n    Data(Line a, int b) : first(a), second(b) {}\n    bool operator &lt; (const Data &amp;p) const { return first&lt;p.first; };\n};\n\nLine H[MAXN*MAXN+10], V[MAXN*MAXN+10];\nint HS, VS;\nint lowH[MAXN*MAXN+10], lowV[MAXN*MAXN+10];\nll ans[MAXN*MAXN+10], anss;\nint posH[MAXN+10][MAXN+10], posV[MAXN+10][MAXN+10];\nData HT[MAXN*MAXN+10], VT[MAXN*MAXN+10];\nint HTS, VTS;\n\nll count_rectangles(vector&lt;vector&lt;int&gt;&gt; _A)\n{\n    N=_A.size(); M=_A[0].size();\n    for(int i=1; i&lt;=N; i++) for(int j=1; j&lt;=M; j++) A[i][j]=_A[i-1][j-1];\n\n    for(int i=1; i&lt;=N; i++)\n    {\n        vector&lt;int&gt; S;\n        S.clear();\n        for(int j=1; j&lt;=M; j++) L[i][j]=0;\n        for(int j=1; j&lt;=M; j++)\n        {\n            while(!S.empty() &amp;&amp; A[i][S.back()]&lt;=A[i][j]) S.pop_back();\n            if(!S.empty()) L[i][j]=S.back();\n            S.push_back(j);\n        }\n\n        S.clear();\n        for(int j=1; j&lt;=M; j++) R[i][j]=M+1;\n        for(int j=M; j&gt;=1; j--)\n        {\n            while(!S.empty() &amp;&amp; A[i][S.back()]&lt;=A[i][j]) S.pop_back();\n            if(!S.empty()) R[i][j]=S.back();\n            S.push_back(j);\n        }\n    }\n\n    for(int i=1; i&lt;=M; i++)\n    {\n        vector&lt;int&gt; S;\n        S.clear();\n        for(int j=1; j&lt;=N; j++) U[j][i]=0;\n        for(int j=1; j&lt;=N; j++)\n        {\n            while(!S.empty() &amp;&amp; A[S.back()][i]&lt;=A[j][i]) S.pop_back();\n            if(!S.empty()) U[j][i]=S.back();\n            S.push_back(j);\n        }\n\n        S.clear();\n        for(int j=1; j&lt;=N; j++) D[j][i]=N+1;\n        for(int j=N; j&gt;=1; j--)\n        {\n            while(!S.empty() &amp;&amp; A[S.back()][i]&lt;=A[j][i]) S.pop_back();\n            if(!S.empty()) D[j][i]=S.back();\n            S.push_back(j);\n        }\n    }\n\n    for(int i=1; i&lt;=N; i++)\n    {\n        for(int j=1; j&lt;=M; j++)\n        {\n            if(L[i][j]==0) continue;\n            if(R[i][j]==M+1) continue;\n            H[HS++]=Line(i, L[i][j]+1, R[i][j]-1);\n        }\n        for(int j=1; j&lt;=M; j++)\n        {\n            if(U[i][j]==0) continue;\n            if(D[i][j]==N+1) continue;\n            V[VS++]=Line(j, U[i][j]+1, D[i][j]-1);\n        }\n    }\n\n    sort(H, H+HS);\n    HS=unique(H, H+HS)-H;\n\n    sort(V, V+VS);\n    VS=unique(V, V+VS)-V;\n\n    for(int i=HS-1, j=HS-1; i&gt;=0; i--)\n    {\n        lowH[i]=H[i].y;\n        Line t=Line(H[i].y+1, H[i].x&gt;&gt;12, H[i].x&amp;4095);\n        for(int ; j&gt;=0 &amp;&amp; t&lt;H[j]; j--);\n        if(j&gt;=0 &amp;&amp; t==H[j]) lowH[i]=lowH[j];\n    }\n\n    for(int i=VS-1, j=VS-1; i&gt;=0; i--)\n    {\n        lowV[i]=V[i].y;\n        Line t=Line(V[i].y+1, V[i].x&gt;&gt;12, V[i].x&amp;4095);\n        for(int ; j&gt;=0 &amp;&amp; t&lt;V[j]; j--);\n        if(j&gt;=0 &amp;&amp; t==V[j]) lowV[i]=lowV[j];\n    }\n\n    for(int i=2; i&lt;=N-1; i++) for(int j=2; j&lt;=M-1; j++)\n    {\n        if(L[i][j]==0) continue;\n        if(R[i][j]==M+1) continue;\n        if(U[i][j]==0) continue;\n        if(D[i][j]==N+1) continue;\n\n        Line tu={U[i][j]+1, L[i][j]+1, R[i][j]-1};\n        Line tl={L[i][j]+1, U[i][j]+1, D[i][j]-1};\n\n        HT[HTS++]=Data(tu, (i&lt;&lt;12)|j);\n        VT[VTS++]=Data(tl, (i&lt;&lt;12)|j);\n    }\n\n    sort(HT, HT+HTS);\n    for(int i=0, j=0; i&lt;HTS; i++)\n    {\n        for(int ; j&lt;HS &amp;&amp; H[j]&lt;HT[i].first; j++);\n        if(j&lt;HS &amp;&amp; HT[i].first==H[j]) posH[HT[i].second&gt;&gt;12][HT[i].second&amp;4095]=j;\n        else posH[HT[i].second&gt;&gt;12][HT[i].second&amp;4095]=-1;\n    }\n\n    sort(VT, VT+VTS);\n    for(int i=0, j=0; i&lt;VTS; i++)\n    {\n        for(int ; j&lt;VS &amp;&amp; V[j]&lt;VT[i].first; j++);\n        if(j&lt;VS &amp;&amp; VT[i].first==V[j]) posV[VT[i].second&gt;&gt;12][VT[i].second&amp;4095]=j;\n        else posV[VT[i].second&gt;&gt;12][VT[i].second&amp;4095]=-1;\n    }\n\n    for(int i=2; i&lt;=N-1; i++) for(int j=2; j&lt;=M-1; j++)\n    {\n        if(L[i][j]==0) continue;\n        if(R[i][j]==M+1) continue;\n        if(U[i][j]==0) continue;\n        if(D[i][j]==N+1) continue;\n\n        int it=posH[i][j];\n        int jt=posV[i][j];\n\n        if(it==-1 || jt==-1) continue;\n\n        if(lowH[it]&lt;D[i][j]-1) continue;\n        if(lowV[jt]&lt;R[i][j]-1) continue;\n\n        ans[anss++]=(((L[i][j]&lt;&lt;12)|R[i][j])*1000000000ll+((U[i][j]&lt;&lt;12)|D[i][j]));\n    }\n    sort(ans, ans+anss);\n    return unique(ans, ans+anss)-ans;\n}\n</code></pre> <p>TLE(72\uc810) \uc774\uc9c0\ub9cc \ucd5c\uc801\ud654 \ub4f1\uc744 \ud558\uc9c0 \uc54a\uc544 \uac00\ub3c5\uc131\uc774 \ub354 \uc88b\uc740 \ucf54\ub4dc\uc774\ub2e4. <pre><code>#include \"rect.h\"\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 2500;\n\nint N, M, A[MAXN+10][MAXN+10];\nint L[MAXN+10][MAXN+10], R[MAXN+10][MAXN+10], U[MAXN+10][MAXN+10], D[MAXN+10][MAXN+10];\n\nstruct Line\n{\n    int y, x1, x2;\n    bool operator &lt; (const Line &amp;p) const\n    {\n        if(y!=p.y) return y&lt;p.y;\n        if(x1!=p.x1) return x1&lt;p.x1;\n        return x2&lt;p.x2;\n    }\n\n    bool operator == (const Line &amp;p) { return y==p.y &amp;&amp; x1==p.x1 &amp;&amp; x2==p.x2; }\n};\n\nvector&lt;Line&gt; H, V;\nint lowH[MAXN*MAXN+10], lowV[MAXN*MAXN+10];\n\nll count_rectangles(vector&lt;vector&lt;int&gt;&gt; _A)\n{\n    N=_A.size(); M=_A[0].size();\n    for(int i=1; i&lt;=N; i++) for(int j=1; j&lt;=M; j++) A[i][j]=_A[i-1][j-1];\n\n    for(int i=1; i&lt;=N; i++)\n    {\n        vector&lt;int&gt; S;\n        S.clear();\n        for(int j=1; j&lt;=M; j++) L[i][j]=0;\n        for(int j=1; j&lt;=M; j++)\n        {\n            while(!S.empty() &amp;&amp; A[i][S.back()]&lt;=A[i][j]) S.pop_back();\n            if(!S.empty()) L[i][j]=S.back();\n            S.push_back(j);\n        }\n\n        S.clear();\n        for(int j=1; j&lt;=M; j++) R[i][j]=M+1;\n        for(int j=M; j&gt;=1; j--)\n        {\n            while(!S.empty() &amp;&amp; A[i][S.back()]&lt;=A[i][j]) S.pop_back();\n            if(!S.empty()) R[i][j]=S.back();\n            S.push_back(j);\n        }\n    }\n\n    for(int i=1; i&lt;=M; i++)\n    {\n        vector&lt;int&gt; S;\n        S.clear();\n        for(int j=1; j&lt;=N; j++) U[j][i]=0;\n        for(int j=1; j&lt;=N; j++)\n        {\n            while(!S.empty() &amp;&amp; A[S.back()][i]&lt;=A[j][i]) S.pop_back();\n            if(!S.empty()) U[j][i]=S.back();\n            S.push_back(j);\n        }\n\n        S.clear();\n        for(int j=1; j&lt;=N; j++) D[j][i]=N+1;\n        for(int j=N; j&gt;=1; j--)\n        {\n            while(!S.empty() &amp;&amp; A[S.back()][i]&lt;=A[j][i]) S.pop_back();\n            if(!S.empty()) D[j][i]=S.back();\n            S.push_back(j);\n        }\n    }\n\n    for(int i=1; i&lt;=N; i++)\n    {\n        for(int j=1; j&lt;=M; j++)\n        {\n            if(L[i][j]==0) continue;\n            if(R[i][j]==M+1) continue;\n            H.push_back({i, L[i][j]+1, R[i][j]-1});\n        }\n        for(int j=1; j&lt;=M; j++)\n        {\n            if(U[i][j]==0) continue;\n            if(D[i][j]==N+1) continue;\n            V.push_back({j, U[i][j]+1, D[i][j]-1});\n        }\n    }\n\n    sort(H.begin(), H.end());\n    H.erase(unique(H.begin(), H.end()), H.end());\n\n    sort(V.begin(), V.end());\n    V.erase(unique(V.begin(), V.end()), V.end());\n\n    for(int i=H.size()-1; i&gt;=0; i--)\n    {\n        lowH[i]=H[i].y;\n        Line t={H[i].y+1, H[i].x1, H[i].x2};\n        if(binary_search(H.begin(), H.end(), t)) lowH[i]=lowH[lower_bound(H.begin(), H.end(), t)-H.begin()];\n    }\n\n    for(int i=V.size()-1; i&gt;=0; i--)\n    {\n        lowV[i]=V[i].y;\n        Line t={V[i].y+1, V[i].x1, V[i].x2};\n        if(binary_search(V.begin(), V.end(), t)) lowV[i]=lowV[lower_bound(V.begin(), V.end(), t)-V.begin()];\n    }\n\n    vector&lt;tuple&lt;int, int, int, int&gt;&gt; ans;\n    for(int i=1; i&lt;=N; i++) for(int j=1; j&lt;=M; j++)\n    {\n\n        //printf(\"%d %d : %d %d %d %d\\n\", i, j, L[i][j], R[i][j], U[i][j], D[i][j]);\n        if(L[i][j]==0) continue;\n        if(R[i][j]==M+1) continue;\n        if(U[i][j]==0) continue;\n        if(D[i][j]==N+1) continue;\n\n        Line tu={U[i][j]+1, L[i][j]+1, R[i][j]-1};\n        if(!binary_search(H.begin(), H.end(), tu)) continue;\n        Line tl={L[i][j]+1, U[i][j]+1, D[i][j]-1};\n        if(!binary_search(V.begin(), V.end(), tl)) continue;\n\n        if(lowH[lower_bound(H.begin(), H.end(), tu)-H.begin()]&lt;D[i][j]-1) continue;\n        if(lowV[lower_bound(V.begin(), V.end(), tl)-V.begin()]&lt;R[i][j]-1) continue;\n\n        ans.push_back(make_tuple(L[i][j]+1, R[i][j]-1, U[i][j]+1, D[i][j]-1));\n    }\n    sort(ans.begin(), ans.end());\n    ans.erase(unique(ans.begin(), ans.end()), ans.end());\n    return ans.size();\n}\n</code></pre></p>","tags":["implementation","sorting","stack","~ solution"]},{"location":"solutions/Olympiad/IOI/2021/D1P2%20Keys/solution/","title":"IOI 2021 D1P2 Keys","text":"","tags":["~ solution","data_structures","disjoint_set","graphs","graph_traversal","scc","smaller_to_larger"]},{"location":"solutions/Olympiad/IOI/2021/D1P2%20Keys/solution/#problem","title":"Problem","text":"","tags":["~ solution","data_structures","disjoint_set","graphs","graph_traversal","scc","smaller_to_larger"]},{"location":"solutions/Olympiad/IOI/2021/D1P2%20Keys/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/22024 https://oj.uz/problem/view/IOI21_keys</p>","tags":["~ solution","data_structures","disjoint_set","graphs","graph_traversal","scc","smaller_to_larger"]},{"location":"solutions/Olympiad/IOI/2021/D1P2%20Keys/solution/#summary","title":"Summary","text":"<p>\uc815\uc810 \\(N\\)\uac1c, \uac04\uc120 \\(M\\)\uac1c\uc758 \ub2e8\uc21c \uc591\ubc29\ud5a5 \uadf8\ub798\ud504\uac00 \uc8fc\uc5b4\uc9c4\ub2e4. \uac01 \uc815\uc810\uc5d0\ub294 \uc5f4\uc1e0\uac00 \ud558\ub098\uc529 \uc788\ub294\ub370, \\(i\\)\ubc88 \uc815\uc810\uc758 \uc5f4\uc1e0\uc758 \uc885\ub958\ub294 \\(R_i\\)\uc774\ub2e4. \\((1 \\le i \\le N)\\) \uac01 \uac04\uc120\uc744 \uc9c0\ub098\uae30 \uc704\ud574\uc11c\ub294 \uc5f4\uc1e0\uac00 \uc788\uc5b4\uc57c \ud558\ub294\ub370, \\(i\\)\ubc88\uc9f8 \uac04\uc120\uc744 \uc9c0\ub098\uae30 \uc704\ud574 \ud544\uc694\ud55c \uc5f4\uc1e0\uc758 \uc885\ub958\ub294 \\(C_i\\)\uc774\ub2e4. \\((1 \\le i \\le M)\\) \\(v\\)\ubc88 \uc815\uc810\uc5d0\uc11c \uc774\ub3d9\uc744 \uc2dc\uc791\ud560 \ub54c, \uc815\uc810\ub4e4\uc744 \ub3cc\uc544\ub2e4\ub2c8\uba70 \uc5bb\uc744 \uc218 \uc788\ub294 \uc5f4\uc1e0\ub97c \uc5bb\uace0, \uc790\uc2e0\uc774 \uac16\uace0 \uc788\ub294 \uc5f4\uc1e0\ub97c \uc774\uc6a9\ud558\uc5ec \uc774\ub3d9\uc774 \uac00\ub2a5\ud55c \uac04\uc120\uc744 \ub530\ub77c \uc774\ub3d9\ud560 \uc218 \uc788\ub2e4. \uc774\uc640 \uac19\uc774 \\(v\\)\ubc88 \uc815\uc810\uc5d0\uc11c \uc2dc\uc791\ud558\uc600\uc744 \ub54c \ub3c4\ub2ec\uac00\ub2a5\ud55c \uc815\uc810\ub4e4\uc758 \uac1c\uc218\uac00 \ucd5c\uc18c\uac00 \ub418\ub294 \uc815\uc810 \\(v\\)\ub4e4\uc758 \uc9d1\ud569\uc744 \uad6c\ud558\uc5ec\ub77c.</p>","tags":["~ solution","data_structures","disjoint_set","graphs","graph_traversal","scc","smaller_to_larger"]},{"location":"solutions/Olympiad/IOI/2021/D1P2%20Keys/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(2 \\le N \\le 300,000\\)</li> <li>\\(1 \\le M \\le 300,000\\)</li> <li>\\(1 \\le R_i \\le N\\) \\((1 \\le i \\le N)\\)</li> <li>\\(1 \\le C_i \\le N\\) \\((1 \\le i \\le M)\\)</li> </ul>","tags":["~ solution","data_structures","disjoint_set","graphs","graph_traversal","scc","smaller_to_larger"]},{"location":"solutions/Olympiad/IOI/2021/D1P2%20Keys/solution/#solution","title":"Solution","text":"","tags":["~ solution","data_structures","disjoint_set","graphs","graph_traversal","scc","smaller_to_larger"]},{"location":"solutions/Olympiad/IOI/2021/D1P2%20Keys/solution/#subtask-3","title":"Subtask 3","text":"<ul> <li>\\(N, M \\le 2,000\\)</li> </ul> <p>\uac01 \uc815\uc810\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec, \uc774 \uc815\uc810\uc5d0\uc11c \ub3c4\ub2ec\ud560 \uc218 \uc788\ub294 \ubaa8\ub4e0 \uc815\uc810\ub4e4\uc744 \uad6c\ud558\uae30 \uc704\ud558\uc5ec \ub2e4\uc74c\uacfc \uac19\uc740 BFS \uc54c\uace0\ub9ac\uc998\uc744 \uc0dd\uac01\ud558\uc790. \uadf8\ub798\ud504 \ud0d0\uc0c9\uc744 \ud558\uba70 \"\uc9c0\uae08\uae4c\uc9c0 \ubc29\ubb38\ud55c \uc815\uc810\ub4e4\uc758 \uc5f4\uc1e0 \\(C\\)\uc758 \uc9d1\ud569\"\uacfc, \"\uc9c0\uae08\uae4c\uc9c0 \ubc29\ubb38\ud55c \uc815\uc810\ub4e4\uacfc \uc778\uc811\ud55c \uac04\uc120\ub4e4 \uc911 \uc544\uc9c1 \uc5f4\uc1e0\ub97c \ubc1c\uacac\ud558\uc9c0 \ubabb\ud55c \uac04\uc120\ub4e4\uc758 \uc9d1\ud569\"\uc744 \uc885\ub958\ubcc4\ub85c \ub098\ub204\uc5b4 \ubc30\uc5f4\uc73c\ub85c \uad00\ub9ac\ud558\uc790. \ub9cc\uc57d \uc0c8\ub85c\uc6b4 \uc815\uc810 \\(v\\)\ub97c \ubc29\ubb38\ud558\uc600\ub294\ub370, \\(C_v\\)\uac00 \uc9c0\uae08\uae4c\uc9c0\ub294 \ubcf8 \uc801 \uc5c6\ub294 \uc885\ub958\uc758 \uc5f4\uc1e0\ub77c\uba74, \uc774 \uc5f4\uc1e0\ub97c \uc774\uc6a9\ud558\uc5ec \uc774\uc804\uc5d0\ub294 \uc0ac\uc6a9\ud558\uc9c0 \ubabb\ud588\ub358, \\(C_v=R_e\\)\ub97c \ub9cc\uc871\ud558\ub294 \uac04\uc120 \\(e\\)\ub4e4\uc744 queue\uc5d0 \uc0bd\uc785\ud574\uc8fc\uba74 \ub41c\ub2e4. \uc0c8\ub85c\uc6b4 \uac04\uc120 \\(e\\)\ub97c \ubc1c\uacac\ud558\uc600\ub294\ub370, \\(R_e\\)\uac00 \uc774\ubbf8 \ubc1c\uacac\ud55c \uc885\ub958\uc758 \uc5f4\uc1e0\ub77c\uba74 \ubc14\ub85c queue\uc5d0 \uc0bd\uc785\ud574\uc8fc\uba74 \ub418\uace0, \uc544\ub2c8\uba74 \uc544\uc9c1 \uc5f4\uc1e0\ub97c \ubc1c\uacac\ud558\uc9c0 \ubabb\ud55c \uac04\uc120\ub4e4\uc758 \ub9ac\uc2a4\ud2b8\uc5d0 \ucd94\uac00\ud574\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\uc704 \uc54c\uace0\ub9ac\uc998\uc744 \ud1b5\ud558\uc5ec \uac01 \uc2dc\uc791\uc810\uc5d0 \ub300\ud558\uc5ec \\(O(N+M)\\)\uc758 \uc2dc\uac04\uc5d0 BFS\ub97c \ud560 \uc218 \uc788\uc73c\ub2c8, \uc804\uccb4 \\(O(N(N+M))\\)\uc758 \uc2dc\uac04\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Checkpoint</p> <p>\uac01 \uc815\uc810\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec, \uc774 \uc815\uc810\uc5d0\uc11c \ub3c4\ub2ec\ud560 \uc218 \uc788\ub294 \ubaa8\ub4e0 \uc815\uc810\ub4e4\uc744 \uad6c\ud558\uae30 \uc704\ud558\uc5ec \ub2e4\uc74c\uacfc \uac19\uc740 BFS \uc54c\uace0\ub9ac\uc998\uc744 \uc0dd\uac01\ud558\uc790. \uadf8\ub798\ud504 \ud0d0\uc0c9\uc744 \ud558\uba70 \"\uc9c0\uae08\uae4c\uc9c0 \ubc29\ubb38\ud55c \uc815\uc810\ub4e4\uc758 \uc5f4\uc1e0 \\(C\\)\uc758 \uc9d1\ud569\"\uacfc, \"\uc9c0\uae08\uae4c\uc9c0 \ubc29\ubb38\ud55c \uc815\uc810\ub4e4\uacfc \uc778\uc811\ud55c \uac04\uc120\ub4e4 \uc911 \uc544\uc9c1 \uc5f4\uc1e0\ub97c \ubc1c\uacac\ud558\uc9c0 \ubabb\ud55c \uac04\uc120\ub4e4\uc758 \uc9d1\ud569\"\uc744 \uc885\ub958\ubcc4\ub85c \ub098\ub204\uc5b4 \ubc30\uc5f4\uc73c\ub85c \uad00\ub9ac\ud558\uc790. \ub9cc\uc57d \uc0c8\ub85c\uc6b4 \uc815\uc810 \\(v\\)\ub97c \ubc29\ubb38\ud558\uc600\ub294\ub370, \\(C_v\\)\uac00 \uc9c0\uae08\uae4c\uc9c0\ub294 \ubcf8 \uc801 \uc5c6\ub294 \uc885\ub958\uc758 \uc5f4\uc1e0\ub77c\uba74, \uc774 \uc5f4\uc1e0\ub97c \uc774\uc6a9\ud558\uc5ec \uc774\uc804\uc5d0\ub294 \uc0ac\uc6a9\ud558\uc9c0 \ubabb\ud588\ub358, \\(C_v=R_e\\)\ub97c \ub9cc\uc871\ud558\ub294 \uac04\uc120 \\(e\\)\ub4e4\uc744 queue\uc5d0 \uc0bd\uc785\ud574\uc8fc\uba74 \ub41c\ub2e4. \uc0c8\ub85c\uc6b4 \uac04\uc120 \\(e\\)\ub97c \ubc1c\uacac\ud558\uc600\ub294\ub370, \\(R_e\\)\uac00 \uc774\ubbf8 \ubc1c\uacac\ud55c \uc885\ub958\uc758 \uc5f4\uc1e0\ub77c\uba74 \ubc14\ub85c queue\uc5d0 \uc0bd\uc785\ud574\uc8fc\uba74 \ub418\uace0, \uc544\ub2c8\uba74 \uc544\uc9c1 \uc5f4\uc1e0\ub97c \ubc1c\uacac\ud558\uc9c0 \ubabb\ud55c \uac04\uc120\ub4e4\uc758 \ub9ac\uc2a4\ud2b8\uc5d0 \ucd94\uac00\ud574\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\uc704 \uc54c\uace0\ub9ac\uc998\uc744 \ud1b5\ud558\uc5ec \uac01 \uc2dc\uc791\uc810\uc5d0 \ub300\ud558\uc5ec \\(O(N+M)\\)\uc758 \uc2dc\uac04\uc5d0 BFS\ub97c \ud560 \uc218 \uc788\uc73c\ub2c8, \uc804\uccb4 \\(O(N(N+M))\\)\uc758 \uc2dc\uac04\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N^2+NM)\\)</p>","tags":["~ solution","data_structures","disjoint_set","graphs","graph_traversal","scc","smaller_to_larger"]},{"location":"solutions/Olympiad/IOI/2021/D1P2%20Keys/solution/#subtask-5-full","title":"Subtask 5 (Full)","text":"<p>\ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30 \uc804\uc5d0, \uc774 \ubb38\uc81c\uc758 \uc0c1\ud669\uc740 \uc77c\ubc18\uc801\uc778 \ubc29\ud5a5\uadf8\ub798\ud504\uc758 SCC\uc758 \uc0c1\ud669\uacfc \ub9e4\uc6b0 \ube44\uc2b7\ud558\ub2e4. \uc815\uc810 \\(v\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \ub3c4\ub2ec \uac00\ub2a5\ud55c \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(S_v\\)\ub77c \ud560 \ub54c, \\(u\\)\uc640 \\(v\\)\uac00 \uac19\uc740 SCC\uc5d0 \uc18d\ud55c\ub2e4\ub294 \uac83\uc740 \\(S_u=S_v\\)\ub77c\ub294 \uac83\uacfc \ud544\uc694\ucda9\ubd84\uc774\uba70, SCC\ub294 \\(S_v\\)\uc5d0 \ub300\ud55c equivalence class\ub77c\uace0 \uc0dd\uac01\ud560 \uc218 \uc788\ub2e4. \ub610\ud55c, \ubc29\ud5a5 \uac04\uc120 \\(u \\rightarrow v\\)\uac00 \uc874\uc7ac\ud55c\ub2e4\uba74 \\(S_u \\supseteq S_v\\)\uac00 \uc131\ub9bd\ud558\uace0, \\(v \\in S_u\\)\ub77c\uba74 \\(S_u \\supseteq S_v\\)\uac00 \uc131\ub9bd\ud55c\ub2e4.</p> <p>\\(v\\)\ubc88 \uc815\uc810\uc5d0\uc11c \uc2dc\uc791\ud558\uc600\uc744 \ub54c \ub3c4\ub2ec\uac00\ub2a5\ud55c \uc815\uc810\ub4e4\uc758 \uac1c\uc218\uac00 \ucd5c\uc18c\uac00 \ub418\ub294 \uc815\uc810 \\(v\\)\ub4e4\uc758 \uc9d1\ud569\uc744 \uad6c\ud574\uc57c \ud558\ub294 \uc774 \ubb38\uc81c\uc758 \uc0c1\ud669\uc744 SCC\uc758 \uc0c1\ud669\uc73c\ub85c \uc0dd\uac01\ud574\ubcf4\uba74, \uacb0\uad6d condensation graph\uc5d0\uc11c outdegree\uac00 \uc5c6\ub294 SCC\ub4e4\uc744 \ubaa8\ub450 \uad6c\ud574\uc57c \ud558\ub294 \uc0c1\ud669\uacfc \uc77c\uce58\ud55c\ub2e4. condensation graph\uc5d0\uc11c outdegree\uac00 \uc5c6\ub294 SCC\uc5d0 \uc18d\ud558\ub294 \uc815\uc810 \\(u\\)\uc5d0 \ub300\ud574\uc11c\ub294 \\(v \\in S_u\\)\uc778 \ub2e4\ub978 \uc815\uc810 \\(v\\)\uc5d0 \ub300\ud574 \\(S_u=S_v\\)\ub77c\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>Observation 1</p> <p>\ubc29\ud5a5\uadf8\ub798\ud504\uc758 SCC\uc5d0\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \uc131\uc9c8\ub4e4\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> <p>\uc815\uc810 \\(v\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \ub3c4\ub2ec \uac00\ub2a5\ud55c \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(S_v\\)\ub77c \ud558\uc790.</p> <ol> <li>\\(u\\)\uc640 \\(v\\)\uac00 \uac19\uc740 SCC\uc5d0 \uc18d\ud55c\ub2e4\ub294 \uac83\uc740 \\(S_u=S_v\\)\ub77c\ub294 \uac83\uacfc \ud544\uc694\ucda9\ubd84\uc774\uba70, SCC\ub294 \\(S_v\\)\uc5d0 \ub300\ud55c equivalence class\ub77c\uace0 \uc0dd\uac01\ud560 \uc218 \uc788\ub2e4.</li> <li>\ubc29\ud5a5 \uac04\uc120 \\(u \\rightarrow v\\)\uac00 \uc874\uc7ac\ud55c\ub2e4\uba74 \\(S_u \\supseteq S_v\\)\uac00 \uc131\ub9bd\ud55c\ub2e4.</li> <li>\\(v \\in S_u\\)\ub77c\uba74, \\(S_u \\supseteq S_v\\)\uac00 \uc131\ub9bd\ud55c\ub2e4.</li> <li>condensation graph\uc5d0\uc11c outdegree\uac00 \uc5c6\ub294 SCC\uc5d0 \uc18d\ud558\ub294 \uc815\uc810 \\(u\\)\uc5d0 \ub300\ud574\uc11c\ub294 \\(v \\in S_u\\)\uc778 \ub2e4\ub978 \uc815\uc810 \\(v\\)\uc5d0 \ub300\ud574 \\(S_u=S_v\\)\uac00 \uc131\ub9bd\ud55c\ub2e4.</li> </ol> <p>\uc704 Observation 1\uc758 \uc131\uc9c8\uc740 SCC\uc5d0\uc11c \uc131\ub9bd\ud558\ub294 \uc131\uc9c8\uc774\uc9c0\ub9cc, \uc774 \ubb38\uc81c\uc5d0\uc11c\ub3c4 \uc131\ub9bd\ud558\uba70 \ud480\uc774\uc758 \uacb0\uc815\uc801\uc778 \uad00\ucc30\uc744 \uc81c\uacf5\ud55c\ub2e4. \ub530\ub77c\uc11c, \uc774 \ubb38\uc81c\uc758 \uc870\uac74\uacfc \uc0c1\ud669\uc740 \ub2e4\ub974\ub354\ub77c\ub3c4 \uc774\uc640 \uac19\uc774 \uac01 \uc815\uc810\uc5d0\uc11c \\(v\\)\ubc88 \uc815\uc810\uc5d0\uc11c \uc2dc\uc791\ud558\uc600\uc744 \ub54c \ub3c4\ub2ec\uac00\ub2a5\ud55c \uc815\uc810\ub4e4\uc758 \uac1c\uc218\uac00 \ucd5c\uc18c\uac00 \ub418\ub294 \uc815\uc810 \\(v\\)\ub4e4\uc758 \uc9d1\ud569\uc744 \uad6c\ud574\uc57c \ud558\ub294 \ubb38\uc81c\uc5d0\uc11c \uc774 \ubb38\uc81c\uc758 \ud480\uc774\ub97c \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4.</p> <p>\\(v\\)\ubc88 \uc815\uc810\uc5d0\uc11c \uc2dc\uc791\ud558\uc600\uc744 \ub54c \ub3c4\ub2ec\uac00\ub2a5\ud55c \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(S_v\\)\ub77c \ud558\uc790. \uac04\uc120 \\((u, v, c)\\)\uc5d0 \ub300\ud558\uc5ec \ub9cc\uc57d \\(S_u\\)\uc758 \uc815\uc810\ub4e4 \uc911 \uc5f4\uc1e0 \\(c\\)\ub97c \uc5bb\uc744 \uc218 \uc788\ub294 \uc815\uc810\uc774 \ud3ec\ud568\ub418\uc5b4 \uc788\ub2e4\uba74, \\(u\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \\(v\\)\ub85c \uc774\ub3d9\ud560 \uc218 \uc788\uc73c\uba70, \ub530\ub77c\uc11c \\(S_u \\supseteq S_v\\)\uac00 \uc131\ub9bd\ud55c\ub2e4.</p> <p>Observation 2</p> <p>\\(v\\)\ubc88 \uc815\uc810\uc5d0\uc11c \uc2dc\uc791\ud558\uc600\uc744 \ub54c \ub3c4\ub2ec\uac00\ub2a5\ud55c \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(S_v\\)\ub77c \ud558\uc790.</p> <p>\uac04\uc120 \\((u, v, c)\\)\uc5d0 \ub300\ud558\uc5ec \ub9cc\uc57d \\(S_u\\)\uc758 \uc815\uc810\ub4e4 \uc911 \uc5f4\uc1e0 \\(c\\)\ub97c \uc5bb\uc744 \uc218 \uc788\ub294 \uc815\uc810\uc774 \ud3ec\ud568\ub418\uc5b4 \uc788\ub2e4\uba74, \\(u\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \\(v\\)\ub85c \uc774\ub3d9\ud560 \uc218 \uc788\uc73c\uba70, \ub530\ub77c\uc11c \\(S_u \\supseteq S_v\\)\uac00 \uc131\ub9bd\ud55c\ub2e4.</p> <p>\uac04\uc120 \\((u, v, c)\\)\uc5d0 \ub300\ud558\uc5ec \\(R_u=c\\)\uc774\uba74, Observation 2\uc5d0 \uc758\ud574 \\(S_u \\supseteq S_v\\)\uac00 \uc131\ub9bd\ud55c\ub2e4. \uac01 \\(u\\)\uc5d0 \ub300\ud558\uc5ec \uc774\uc640 \uac19\uc774 \ud655\uc2e4\ud788 \\(S_u \\supseteq S_v\\)\ub77c\ub294 \uac83\uc744 \uc544\ub294 \uc815\uc810 \\(v\\)\uc5d0 \ub300\ud558\uc5ec \\(par(u)=v\\)\ub85c \uac04\uc120\uc744 \ud558\ub098\uc529 \uc774\uc5b4 \uc8fc\uba74, \uc644\uc131\ub41c \uadf8\ub798\ud504\uc5d0\uc11c \uac01 \uc815\uc810\uc758 outdegree\ub294 \\(0\\) \uc544\ub2c8\uba74 \\(1\\)\uc73c\ub85c, functional graph\ub098 \ud2b8\ub9ac\ub4e4\uc758 \uc9d1\ud569\uc774 \ub41c\ub2e4. \uc774 \ub54c, functional graph\uc758 \ub8e8\ud2b8\uc5d0 \ud574\ub2f9\ud558\ub294 \uc0ac\uc774\ud074 \\(P=\\{v_1, v_2, \\cdots, v_k \\}\\)\uc5d0 \ub300\ud574 \ub2e4\uc74c\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> \\[S_{v_1} \\supseteq S_{v_2} \\supseteq \\cdots \\supseteq S_{v_k} \\supseteq S_{v_1}\\] \\[S_{v_1} = S_{v_2} = \\cdots = S_{v_k}\\] <p>\uc989, functional graph\uc758 \ub8e8\ud2b8\uc5d0 \ud574\ub2f9\ud558\ub294 \uc0ac\uc774\ud074 \\(P=\\{v_1, v_2, \\cdots, v_k \\}\\)\uc5d0 \ud574\ub2f9\ud558\ub294 \ubaa8\ub4e0 \uc815\uc810\ub4e4\uc758 \\(S_v\\)\uac00 \uac19\uc73c\ub2c8 \uc774\ub4e4\uc744 \ud558\ub098\uc758 \uc815\uc810\uc73c\ub85c \ubb36\uc5b4\uc11c \ucde8\uae09\ud560 \uc218 \uc788\ub2e4. (\uc774\ub294 \ubc29\ud5a5 \uadf8\ub798\ud504\uc5d0\uc11c \uc815\uc810\ub4e4\uc744 \\(S_v\\)\uac00 \uac19\uc740 \uc815\uc810\ub4e4\uc744 \ud558\ub098\uc758 SCC\ub85c \ubb36\ub294\ub2e4\uace0 \uc0dd\uac01\ud574\ub3c4 \ub41c\ub2e4.) \uc774\ud6c4, \ubb36\uc778 \uc0c8\ub85c\uc6b4 \uc815\uc810\ub4e4\uc758 \uc5f4\uc1e0 \uc9d1\ud569\uacfc \uac04\uc120 \uc9d1\ud569\uc744 \ud558\ub098\ub85c \ubb36\uc5b4\uc900 \ud6c4, \ub2e4\uc2dc \uac04\uc120 \\((u, v, c)\\)\uc5d0 \ub300\ud558\uc5ec \\(u \\in P, v \\notin P, R_u=c\\)\uc778 \\(v\\)\ub97c \ucc3e\uc544 \\(par(u)=v\\)\ub85c \uac04\uc120\uc744 \uc0c8\ub86d\uac8c \uc774\uc5b4\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\uc704 \uacfc\uc815\uc744 \ubc18\ubcf5\ud558\ub2e4 \ubcf4\uba74, \uc644\uc131\ub41c \uadf8\ub798\ud504\ub294 \ub354\uc774\uc0c1 functional graph\uac00 \ub0a8\uc544 \uc788\uc9c0 \uc54a\uace0, \uc5ec\ub7ec \ud2b8\ub9ac\ub4e4\uc758 \uc9d1\ud569\uc774 \ub0a8\ub294\ub2e4. \\(S_u\\)\uc758 \ud06c\uae30\uac00 \ucd5c\uc18c\uac00 \ub418\ub294 \uc815\uc810 \\(u\\)\ub294 Observation 1\uacfc \uac19\uc774 \\(v \\in S_u\\)\uc778 \ub2e4\ub978 \uc815\uc810 \\(v\\)\uc5d0 \ub300\ud574 \\(S_u=S_v\\)\uac00 \uc131\ub9bd\ud574\uc57c \ud55c\ub2e4. \ud2b8\ub9ac\uc758 \ub8e8\ud2b8\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc740 \ub354 \uc774\uc0c1 \ubc16\uc73c\ub85c \ub098\uac00\ub294 \uac04\uc120\uc744 \ucc3e\uc744 \uc218 \uc5c6\ub2e4\ub294 \uc758\ubbf8\uc774\ub2c8, \uc9d1\ud569 \ubc16\uc73c\ub85c \uc774\ub3d9\ud560 \uc218 \uc5c6\uace0, \ub530\ub77c\uc11c \ub2f5\uc73c\ub85c \uac00\ub2a5\ud55c \uc815\uc810\ub4e4\uc740 \uc624\uc9c1 \ub8e8\ud2b8\uc5d0 \uc18d\ud55c \uc815\uc810\ub4e4\uc774\ub2e4.</p> <p>\uc804\uccb4 \uc54c\uace0\ub9ac\uc998\uc740 \uc704\uc640 \uac19\uc774 \uc815\uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \uad00\ub9ac\ud558\uba70, \uac01 \uc9d1\ud569\uc5d0\uc11c \ubc16\uc73c\ub85c \ub098\uac08 \uc218 \uc788\ub294 \ud55c \uc815\uc810 \\(par(v)\\)\ub97c \uc774\uc6a9\ud558\uc5ec functional graph\ub97c \ub9cc\ub4e4\uace0, \ub8e8\ud2b8\uc5d0 \ud574\ub2f9\ud558\ub294 \uc0ac\uc774\ud074\uc744 \ubb36\uc5b4\uc11c \ud55c \uc9d1\ud569\uc73c\ub85c \ub9cc\ub4e0 \ud6c4 \uc0c8\ub85c\uc6b4 \\(par(v)\\)\ub97c \uad6c\ud574\uc8fc\uc5b4\uc57c \ud55c\ub2e4. \uc774\ub97c \ud6a8\uc728\uc801\uc73c\ub85c \uad00\ub9ac\ud558\uae30 \uc704\ud558\uc5ec Union Find\uc640 \uac01 \uc815\uc810\uc758 \uc5f4\uc1e0 \uc9d1\ud569\uacfc \ub098\uac00\ub294 \uac04\uc120\ub4e4\uc758 \uc9d1\ud569\uc744 \uad00\ub9ac\ud558\uae30 \uc704\ud558\uc5ec Set\uacfc Small to Large\ub97c \uc774\uc6a9\ud558\uba74 \ub41c\ub2e4. \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 Set\uc5d0\uc11c Small to Large\ub97c \ud574\uc57c \ud558\ub2c8, \\(O((N+M)\\log^2M)\\)\uc774 \ub41c\ub2e4.</p> <p>CheckPoint</p> <p>\uac04\uc120 \\((u, v, c)\\)\uc5d0 \ub300\ud558\uc5ec \\(R_u=c\\)\uc774\uba74, Observation 2\uc5d0 \uc758\ud574 \\(S_u \\supseteq S_v\\)\uac00 \uc131\ub9bd\ud55c\ub2e4. \uac01 \\(u\\)\uc5d0 \ub300\ud558\uc5ec \uc774\uc640 \uac19\uc774 \ud655\uc2e4\ud788 \\(S_u \\supseteq S_v\\)\ub77c\ub294 \uac83\uc744 \uc544\ub294 \uc815\uc810 \\(v\\)\uc5d0 \ub300\ud558\uc5ec \\(par(u)=v\\)\ub85c \uac04\uc120\uc744 \ud558\ub098\uc529 \uc774\uc5b4 \uc8fc\uba74, \uc644\uc131\ub41c \uadf8\ub798\ud504\uc5d0\uc11c \uac01 \uc815\uc810\uc758 outdegree\ub294 \\(0\\) \uc544\ub2c8\uba74 \\(1\\)\uc73c\ub85c, functional graph\ub098 \ud2b8\ub9ac\ub4e4\uc758 \uc9d1\ud569\uc774 \ub41c\ub2e4. \uc774 \ub54c, functional graph\uc758 \ub8e8\ud2b8\uc5d0 \ud574\ub2f9\ud558\ub294 \uc0ac\uc774\ud074 \\(P=\\{v_1, v_2, \\cdots, v_k \\}\\)\uc5d0 \ud574\ub2f9\ud558\ub294 \ubaa8\ub4e0 \uc815\uc810\ub4e4\uc758 \\(S_v\\)\uac00 \uac19\uc73c\ub2c8 \uc774\ub4e4\uc744 \ud558\ub098\uc758 \uc815\uc810\uc73c\ub85c \ubb36\uc5b4\uc11c \ucde8\uae09\ud560 \uc218 \uc788\ub2e4. \uc774\ud6c4, \ubb36\uc778 \uc0c8\ub85c\uc6b4 \uc815\uc810\ub4e4\uc758 \uc5f4\uc1e0 \uc9d1\ud569\uacfc \uac04\uc120 \uc9d1\ud569\uc744 \ud558\ub098\ub85c \ubb36\uc5b4\uc900 \ud6c4, \ub2e4\uc2dc \uac04\uc120 \\((u, v, c)\\)\uc5d0 \ub300\ud558\uc5ec \\(u \\in P, v \\notin P, R_u=c\\)\uc778 \\(v\\)\ub97c \ucc3e\uc544 \\(par(u)=v\\)\ub85c \uac04\uc120\uc744 \uc0c8\ub86d\uac8c \uc774\uc5b4\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\uc704 \uacfc\uc815\uc744 \ubc18\ubcf5\ud558\ub2e4 \ubcf4\uba74, \uc644\uc131\ub41c \uadf8\ub798\ud504\ub294 \ub354\uc774\uc0c1 functional graph\uac00 \ub0a8\uc544 \uc788\uc9c0 \uc54a\uace0, \uc5ec\ub7ec \ud2b8\ub9ac\ub4e4\uc758 \uc9d1\ud569\uc774 \ub0a8\ub294\ub2e4. \ud2b8\ub9ac\uc758 \ub8e8\ud2b8\uc5d0 \uc18d\ud558\ub294 \uc815\uc810\ub4e4\uc740 \ub354 \uc774\uc0c1 \ubc16\uc73c\ub85c \ub098\uac00\ub294 \uac04\uc120\uc744 \ucc3e\uc744 \uc218 \uc5c6\ub2e4\ub294 \uc758\ubbf8\uc774\ub2c8, \uc9d1\ud569 \ubc16\uc73c\ub85c \uc774\ub3d9\ud560 \uc218 \uc5c6\uace0, \ub530\ub77c\uc11c \ub2f5\uc73c\ub85c \uac00\ub2a5\ud55c \uc815\uc810\ub4e4\uc740 \uc624\uc9c1 \ub8e8\ud2b8\uc5d0 \uc18d\ud55c \uc815\uc810\ub4e4\uc774\ub2e4.</p> <p>\uc774\ub97c \ud6a8\uc728\uc801\uc73c\ub85c \uad00\ub9ac\ud558\uae30 \uc704\ud558\uc5ec Union Find\uc640 \uac01 \uc815\uc810\uc758 \uc5f4\uc1e0 \uc9d1\ud569\uacfc \ub098\uac00\ub294 \uac04\uc120\ub4e4\uc758 \uc9d1\ud569\uc744 \uad00\ub9ac\ud558\uae30 \uc704\ud558\uc5ec Set\uacfc Small to Large\ub97c \uc774\uc6a9\ud558\uba74 \ub41c\ub2e4. \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 Set\uc5d0\uc11c Small to Large\ub97c \ud574\uc57c \ud558\ub2c8, \\(O((N+M)\\log^2M)\\)\uc774 \ub41c\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O((N+M)\\log^2M)\\)</p>","tags":["~ solution","data_structures","disjoint_set","graphs","graph_traversal","scc","smaller_to_larger"]},{"location":"solutions/Olympiad/IOI/2021/D1P2%20Keys/solution/#code","title":"Code","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 3e5;\n\nint N, M;\nint R[MAXN+10];\nint ans[MAXN+10];\n\nset&lt;pii&gt; adj[MAXN+10];\nvector&lt;pii&gt; adj2[MAXN+10];\nset&lt;int&gt; S[MAXN+10];\n\nint par[MAXN+10];\nint vis[MAXN+10];\nbool dead[MAXN+10];\n\nstruct UF\n{\n    int par[MAXN+10];\n    int Find(int x)\n    {\n        if(x==par[x]) return x;\n        return par[x]=Find(par[x]);\n    }\n    void Union(int x, int y)\n    {\n        x=Find(x); y=Find(y);\n        par[x]=y;\n    }\n    void init()\n    {\n        for(int i=1; i&lt;=N; i++) par[i]=i;\n    }\n}uf, uf2;\n\nint cnt[MAXN+10];\n\nvector&lt;int&gt; find_reachable(vector&lt;int&gt; _R, vector&lt;int&gt; _U, vector&lt;int&gt; _V, vector&lt;int&gt; _C)\n{\n    N=_R.size(); M=_U.size();\n    for(int i=1; i&lt;=N; i++) R[i]=_R[i-1]+1;\n    for(int i=1; i&lt;=M; i++)\n    {\n        int u=_U[i-1]+1, v=_V[i-1]+1, w=_C[i-1]+1;\n        if(R[u]!=w) adj[u].insert({w, v});\n        else adj2[u].push_back({w, v});\n\n        if(R[v]!=w) adj[v].insert({w, u});\n        else adj2[v].push_back({w, u});\n    }\n\n    uf.init(); uf2.init();\n    for(int i=1; i&lt;=N; i++)\n    {\n        S[i].insert(R[i]);\n\n        if(!adj2[i].empty())\n        {\n            par[i]=adj2[i].back().second;\n            uf.Union(i, par[i]);\n        }\n    }\n\n    queue&lt;int&gt; Q;\n    for(int i=1; i&lt;=N; i++)\n    {\n        int now=i;\n        while(1)\n        {\n            if(vis[now]) break;\n            vis[now]=i;\n            if(par[now]==0) break;\n            now=par[now];\n        }\n        if(par[now]!=0 &amp;&amp; vis[now]==i) Q.push(now);\n    }\n\n    while(!Q.empty())\n    {\n        int now=Q.front(); Q.pop();\n        now=uf2.Find(now);\n\n        vector&lt;int&gt; V;\n        for(int i=par[now]; i!=now; i=uf2.Find(par[i])) V.push_back(i);\n\n        for(auto it : V)\n        {\n            if(adj[now].size()+adj2[now].size()+S[now].size()&lt;adj[it].size()+adj2[it].size()+S[it].size()) swap(now, it);\n\n            for(auto jt : adj2[it]) adj2[now].push_back(jt);\n            for(auto jt : adj[it])\n            {\n                auto pt=S[now].lower_bound(jt.first);\n                if(pt!=S[now].end() &amp;&amp; *pt==jt.first) adj2[now].push_back(jt);\n                else adj[now].insert(jt);\n            }\n            for(auto jt : S[it])\n            {\n                for(auto pt=adj[now].lower_bound({jt, 0}); pt!=adj[now].end() &amp;&amp; pt-&gt;first==jt; pt=adj[now].erase(pt)) adj2[now].push_back(*pt);\n                S[now].insert(jt);\n            }\n            uf2.Union(it, now);\n            dead[it]=true;\n        }\n\n        while(!adj2[now].empty() &amp;&amp; uf2.Find(adj2[now].back().second)==now) adj2[now].pop_back();\n\n        if(!adj2[now].empty())\n        {\n            assert(S[now].count(adj2[now].back().first));\n            par[now]=uf2.Find(adj2[now].back().second);\n            if(uf.Find(now)==uf.Find(par[now])) Q.push(now);\n            else uf.Union(now, par[now]);\n        }\n        else par[now]=0;\n    }\n    for(int i=1; i&lt;=N; i++) cnt[uf2.Find(i)]++;\n\n    int val=N;\n    set&lt;int&gt; SS;\n    for(int i=1; i&lt;=N; i++) if(par[uf2.Find(i)]==0) val=min(val, cnt[uf2.Find(i)]);\n    for(int i=1; i&lt;=N; i++) if(par[uf2.Find(i)]==0 &amp;&amp; cnt[uf2.Find(i)]==val) SS.insert(uf2.Find(i));\n    for(int i=1; i&lt;=N; i++) if(SS.count(uf2.Find(i))) ans[i]=1;\n\n    return vector&lt;int&gt;(ans+1, ans+N+1);\n}\n</code></pre>","tags":["~ solution","data_structures","disjoint_set","graphs","graph_traversal","scc","smaller_to_larger"]},{"location":"solutions/Olympiad/IOI/2021/D2P1%20Mutating%20DNA/solution/","title":"IOI 2021 D2P1 Mutating DNA","text":"","tags":["~ solution","greedy","prefix_sum"]},{"location":"solutions/Olympiad/IOI/2021/D2P1%20Mutating%20DNA/solution/#problem","title":"Problem","text":"","tags":["~ solution","greedy","prefix_sum"]},{"location":"solutions/Olympiad/IOI/2021/D2P1%20Mutating%20DNA/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/22046 https://oj.uz/problem/view/IOI21_dna</p>","tags":["~ solution","greedy","prefix_sum"]},{"location":"solutions/Olympiad/IOI/2021/D2P1%20Mutating%20DNA/solution/#summary","title":"Summary","text":"<p>\"A\", \"T\", \"C\"\ub85c \uad6c\uc131\ub41c \uae38\uc774 \\(N\\)\uc758 \ubb38\uc790\uc5f4 \\(A\\)\uc640 \\(B\\)\uac00 \uc8fc\uc5b4\uc9c4\ub2e4. \\(Q\\)\uac1c\uc758 \ucffc\ub9ac\uac00 \uc8fc\uc5b4\uc9c0\uba70, \\(i\\)\ubc88 \ucffc\ub9ac\uc5d0\uc11c\ub294 \\(A[L_i ... R_i]\\)\uc758 \ub450 \ubb38\uc790\ub97c swap\ud558\uc5ec \\(B[L_i ... R_i]\\)\uc640 \uac19\uac8c \ub9cc\ub4e4\uae30 \uc704\ud558\uc5ec \ud544\uc694\ud55c swap\uc758 \ucd5c\uc18c \ud69f\uc218 (\ubd88\uac00\ub2a5\ud558\uba74 \\(-1\\))\uc744 \uad6c\ud574\uc57c \ud55c\ub2e4. \\((1 \\le i \\le Q)\\)</p>","tags":["~ solution","greedy","prefix_sum"]},{"location":"solutions/Olympiad/IOI/2021/D2P1%20Mutating%20DNA/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(1 \\le N \\le 100,000\\)</li> <li>\\(1 \\le Q \\le 100,000\\)</li> <li>\\(1 \\le L_i \\le R_i \\le N\\) \\((1 \\le i \\le Q)\\)</li> </ul>","tags":["~ solution","greedy","prefix_sum"]},{"location":"solutions/Olympiad/IOI/2021/D2P1%20Mutating%20DNA/solution/#solution","title":"Solution","text":"<p>\uc6b0\uc120, \\(A[L_i ... R_i]\\), \\(B[L_i ... R_i]\\)\uc5d0 \uc788\ub294 \uac01 \ubb38\uc790 \"A\", \"T\", \"C\"\uc758 \uac1c\uc218\uac00 \ub2e4\ub974\uba74 \ub2f5\uc740 \\(-1\\)\uc774\uace0, \uac19\ub2e4\uba74 \\(-1\\)\uc774 \uc544\ub2c8\ub2e4.</p> <p>\uc774\uc81c, \\(L_i \\le j \\le R_i\\)\uc778 \\(j\\)\uc5d0 \ub300\ud558\uc5ec \uc21c\uc11c\uc30d \\((A[j], B[j])\\)\ub97c \uc0dd\uac01\ud558\uc790. \ucd1d \\(9\\)\uac00\uc9c0\uc758 \uac00\ub2a5\ud55c \uc21c\uc11c\uc30d\uc5d0 \ub300\ud558\uc5ec, \uac01 \uc21c\uc11c\uc30d\uc774 \uad6c\uac04 \ub0b4 \uba87 \ubc88 \ub4f1\uc7a5\ud588\ub294\uc9c0\ub97c \uad6c\ud574 \ub193\uc558\ub2e4\uba74, \uc774\uc81c \ubb38\uc790\uc5f4 \ub300\uc2e0 \\(3 \\times 3\\) \ud06c\uae30\uc758 \uac01 \uc21c\uc11c\uc30d\ub4e4\uc758 \uac1c\uc218\ub97c \ub098\ud0c0\ub0b4\ub294 \ubc30\uc5f4 \\(P\\)\ub9cc \uc0dd\uac01\ud574\ub3c4 \ub41c\ub2e4.</p> <p>\uc6b0\uc120, (A, A), (T, T), (C, C)\uc640 \uac19\uc774 \\(A\\)\uc758 \ubb38\uc790\uc640 \\(B\\)\uc758 \ubb38\uc790\uac00 \uac19\uc740 \uce78\ub4e4\uc5d0 \ub300\ud574\uc11c\ub294, \uad73\uc774 swap\ud560 \ud544\uc694 \uc5c6\uc774 \uac00\ub9cc\ud788 \ub194\ub450\uc5b4\ub3c4 \ub41c\ub2e4. \ub2e4\uc74c\uc73c\ub85c, \ub9cc\uc57d (A, T), (T, A)\uc758 \ub450 \uc21c\uc11c\uc30d\uc774 \uac01\uac01 \\(1\\)\uac1c \uc774\uc0c1 \uc874\uc7ac\ud55c\ub2e4\uace0 \uc0dd\uac01\ud558\uc790. \uc774 \ub450 \uc21c\uc11c\uc30d\uc744 \uc11c\ub85c swap\ud574\uc8fc\uba74, \ud55c \ubc88\uc758 swap\uc73c\ub85c \ub450 \uac1c\uc758 \uce78\uc5d0 \uc870\uac74\uc744 \ub9cc\uc871\uc2dc\ucf30\uc73c\uba70, \ud55c \ubc88\uc758 swap\uc73c\ub85c\ub294 \ucd5c\ub300 \ub450 \uac1c\uc758 \uce78 \ubc16\uc5d0 \uc870\uac74\uc744 \ub9cc\uc871\uc2dc\ud0a4\uc9c0 \ubabb\ud55c\ub2e4\ub294 \uac83\uc744 \uc0dd\uac01\ud558\uba74 \uc774\uac83\uc774 \ucd5c\uc120\uc758 \uc120\ud0dd\uc784\uc744 \uc54c \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, (A, T)\uc640 (T, A), (A, C)\uc640 (C, A), (T, C)\uc640 (C, T)\uc640 \uac19\uc774 \uc11c\ub85c \ubc14\ub00c\ub294 \ubb38\uc790 \uc30d\uc774 \uc874\uc7ac\ud55c\ub2e4\uba74, \uc774\ub97c \uc11c\ub85c swap\ud558\uc5ec \uc81c\uac70\ud574\uc900\ub2e4.</p> <p>\uc774\uc81c \uc704 \uc5f0\uc0b0\uc744 \ubaa8\ub450 \uc2e4\ud589\ud558\uace0 \ub098\uba74 \ub0a8\uc740 \uac83\uc740 \uc815\ud655\ud788 \uac19\uc740 \uac1c\uc218\uc758 (A, T), (T, C), (C, A)\uc640 \uac19\uc774 \uc11c\ub85c \uc21c\ud658\ud558\ub294 \uc21c\uc11c\uc30d\ub4e4\uc774\ub2e4. \uc774 \uc774\uc720\ub294 \ucc98\uc74c\uc5d0 \ubb38\uc790\uc5f4 \ub0b4 \uac01 \ubb38\uc790\uc758 \uac1c\uc218\uac00 \uac19\ub2e4\uace0 \uac15\uc81c\ud558\uc600\uae30 \ub54c\ubb38\uc774\ub2e4. (A, T), (T, C), (C, A) \uc21c\uc11c\uc30d\uc744 \ud574\uacb0\ud558\uae30 \uc704\ud574\uc11c\ub294 2\ubc88\uc758 \uc5f0\uc0b0\uc73c\ub85c \uc55e\uc5d0\uc11c\ubd80\ud130 \ud558\ub098\uc529 \uc0ac\uc774\ud074\uc744 \ud574\uc18c\ud574\uc904 \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, \ub450 \ubc88\uc758 swap\uc73c\ub85c \uc138 \uac1c\uc758 \uce78\uc5d0 \uc870\uac74\uc744 \ub9cc\uc871\uc2dc\ud0a4\uac8c \ub418\uba70, \uc774\uac83\uc774 \ud604\uc7ac \uc0c1\ud669\uc5d0\uc11c\ub294 \ucd5c\uc801\uc774\ub2e4. \ub530\ub77c\uc11c, \ub0a8\uc740 (A, T), (T, C), (C, A)\uc640 \uac19\uc774 \uc11c\ub85c \uc21c\ud658\ud558\ub294 \uc21c\uc11c\uc30d\ub4e4\uc774 \uac01\uac01 \\(X\\)\uac1c \uc788\uc5c8\ub2e4\uace0 \ud558\uba74, \\(2X\\)\ubc88\uc758 swap\uc73c\ub85c \ub0a8\uc740 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Observation 1</p> <p>\uc6b0\uc120, \\(A[L_i ... R_i]\\), \\(B[L_i ... R_i]\\)\uc5d0 \uc788\ub294 \uac01 \ubb38\uc790 \"A\", \"T\", \"C\"\uc758 \uac1c\uc218\uac00 \ub2e4\ub974\uba74 \ub2f5\uc740 \\(-1\\)\uc774\uace0, \uac19\ub2e4\uba74 \\(-1\\)\uc774 \uc544\ub2c8\ub2e4.</p> <p>\ub9cc\uc57d \ub2f5\uc774 \\(-1\\)\uc774 \uc544\ub2c8\ub77c\uba74 \ucd5c\uc801\ud574\ub294 \ub2e4\uc74c\uacfc \uac19\ub2e4. \uc6b0\uc120, (A, A), (T, T), (C, C)\uc640 \uac19\uc774 \\(A\\)\uc758 \ubb38\uc790\uc640 \\(B\\)\uc758 \ubb38\uc790\uac00 \uac19\uc740 \uce78\ub4e4\uc5d0 \ub300\ud574\uc11c\ub294, \uad73\uc774 swap\ud560 \ud544\uc694 \uc5c6\uc774 \uac00\ub9cc\ud788 \ub194\ub450\uc5b4\ub3c4 \ub41c\ub2e4. \ub2e4\uc74c\uc73c\ub85c, (A, T)\uc640 (T, A), (A, C)\uc640 (C, A), (T, C)\uc640 (C, T)\uc640 \uac19\uc774 \uc11c\ub85c \ubc14\ub00c\ub294 \ubb38\uc790 \uc30d\uc774 \uc874\uc7ac\ud55c\ub2e4\uba74, \uc774\ub97c \uba3c\uc800 \uc11c\ub85c swap\ud558\uc5ec \uc81c\uac70\ud574\uc900\ub2e4. \ub9c8\uc9c0\ub9c9\uc73c\ub85c \ub0a8\uc740 \uac83\uc740 \uc815\ud655\ud788 \uac19\uc740 \uac1c\uc218 \\(X\\)\uac1c\uc758 (A, T), (T, C), (C, A)\uc640 \uac19\uc774 \uc11c\ub85c \uc21c\ud658\ud558\ub294 \uc21c\uc11c\uc30d\ub4e4\uc774\uace0, \uc774\ub4e4\uc744 \uc55e\uc5d0\uc11c\ubd80\ud130 \ud558\ub098\uc529 \uc0ac\uc774\ud074\uc744 \ucc98\ub9ac\ud558\uc5ec \\(2X\\)\ubc88\uc758 swap\uc73c\ub85c \ub0a8\uc740 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\uc804\uccb4 \ud480\uc774\uc5d0\uc11c \uac01 \ucffc\ub9ac\ubcc4\ub85c \uc6b0\ub9ac\uac00 \ud544\uc694\ud588\ub358 \uac83\uc740 \uad6c\uac04 \uc548\uc758 \uac01 \ubb38\uc790\uc758 \uac1c\uc218\uc640, \\(3 \\times 3\\) \ud06c\uae30\uc758 \uac01 \uc21c\uc11c\uc30d\ub4e4\uc758 \uac1c\uc218\ub97c \ub098\ud0c0\ub0b4\ub294 \ubc30\uc5f4 \\(P\\)\uc774\ub2e4. \uc774\ub294 \ubc30\uc5f4 \\(P\\)\ub97c \uc804\uccb4 \ubb38\uc790\uc5f4\uc5d0 \ub300\ud558\uc5ec \ub204\uc801\ud569 \ubc30\uc5f4\uc744 \ub9cc\ub4e4\uc5b4 \ucffc\ub9ac\ub2f9 \\(O(1)\\)\uc548\uc5d0 \uad6c\ud560 \uc218 \uc788\uace0, \uc644\uc131\ub41c \ubc30\uc5f4 \\(P\\)\ub97c \uc774\uc6a9\ud558\uc5ec \ubb38\uc81c\ub97c \ud574\uacb0\ud558\ub294 \uac83 \ub610\ud55c \\(O(1)\\)\uc774\ub2c8, \uc804\uccb4 \\(O(N+Q)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>Observation 1\uacfc \uac19\uc774 \ucd5c\uc801\ud574\ub97c \uad6c\ud560 \uc218 \uc788\uc73c\uba70, \uc774 \uacfc\uc815\uc5d0\uc11c \ud544\uc694\ud55c \uac83\uc740 \uad6c\uac04 \uc548\uc758 \uac01 \ubb38\uc790\uc758 \uac1c\uc218\uc640, \\(3 \\times 3\\) \ud06c\uae30\uc758 \uac01 \uc21c\uc11c\uc30d\ub4e4\uc758 \uac1c\uc218\ub97c \ub098\ud0c0\ub0b4\ub294 \ubc30\uc5f4 \\(P\\)\uc774\ub2e4. \uc774\ub294 \ubc30\uc5f4 \\(P\\)\ub97c \uc804\uccb4 \ubb38\uc790\uc5f4\uc5d0 \ub300\ud558\uc5ec \ub204\uc801\ud569 \ubc30\uc5f4\uc744 \ub9cc\ub4e4\uc5b4 \ucffc\ub9ac\ub2f9 \\(O(1)\\)\uc548\uc5d0 \uad6c\ud560 \uc218 \uc788\uace0, \uc644\uc131\ub41c \ubc30\uc5f4 \\(P\\)\ub97c \uc774\uc6a9\ud558\uc5ec \ubb38\uc81c\ub97c \ud574\uacb0\ud558\ub294 \uac83 \ub610\ud55c \\(O(1)\\)\uc774\ub2c8, \uc804\uccb4 \\(O(N+Q)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N+Q)\\)</p>","tags":["~ solution","greedy","prefix_sum"]},{"location":"solutions/Olympiad/IOI/2021/D2P1%20Mutating%20DNA/solution/#code","title":"Code","text":"<pre><code>#include \"dna.h\"\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 1e5;\n\nint N, P[MAXN+10][3][3];\n\nint f(char x)\n{\n    if(x=='A') return 0;\n    if(x=='C') return 1;\n    if(x=='T') return 2;\n}\n\nvoid init(string a, string b)\n{\n    N=a.size();\n    for(int i=1; i&lt;=N; i++)\n    {\n        for(int p=0; p&lt;3; p++) for(int q=0; q&lt;3; q++) P[i][p][q]=P[i-1][p][q];\n        P[i][f(a[i-1])][f(b[i-1])]++;\n    }\n}\n\nint get_distance(int l, int r) {\n    l++; r++;\n    int A[3][3]={{0}};\n    for(int p=0; p&lt;3; p++) for(int q=0; q&lt;3; q++) A[p][q]=P[r][p][q]-P[l-1][p][q];\n    for(int p=0; p&lt;3; p++)\n    {\n        int t=0;\n        for(int q=0; q&lt;3; q++) t+=A[p][q]-A[q][p];\n        if(t) return -1;\n    }\n\n    int ans=0;\n    ans+=min(A[0][1], A[1][0]);\n    ans+=min(A[0][2], A[2][0]);\n    ans+=min(A[2][1], A[1][2]);\n    ans+=abs(A[0][1]-A[1][0])*2;\n    return ans;\n}\n</code></pre>","tags":["~ solution","greedy","prefix_sum"]},{"location":"solutions/Olympiad/IOI/2022/D1P1%20Catfish%20Farm/solution/","title":"IOI 2022 D1P1 Catfish Farm","text":"","tags":["~ solution","dp","segtree"]},{"location":"solutions/Olympiad/IOI/2022/D1P1%20Catfish%20Farm/solution/#problem","title":"Problem","text":"","tags":["~ solution","dp","segtree"]},{"location":"solutions/Olympiad/IOI/2022/D1P1%20Catfish%20Farm/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/25438 https://oj.uz/problem/view/IOI22_fish</p>","tags":["~ solution","dp","segtree"]},{"location":"solutions/Olympiad/IOI/2022/D1P1%20Catfish%20Farm/solution/#summary","title":"Summary","text":"<p>\\(N \\times N\\) \uaca9\uc790\ud310\uc774 \uc788\uace0, \uadf8 \uc911 \\(M\\)\uac1c\uc758 \uce78\uc5d0\ub294 \\((X_i, Y_i)\\)\uc5d0 \uac00\uc911\uce58 \\(W_i\\)\uac00 \uc801\ud600 \uc788\ub2e4. \\((1 \\le i \\le M)\\) \uac01 \uc5f4\uc5d0 \ub300\ud558\uc5ec \\(0\\)\ubc88 \ud589\ubd80\ud130 \uc2dc\uc791\ud558\uc5ec \ud589 \ubc88\ud638\uac00 \uc99d\uac00\ud558\ub294 \uc21c\uc11c\ub300\ub85c \\(0\\)\uac1c \uc774\uc0c1\uc758 \uce78\uc744 \uc120\ud0dd\ud558\uc5ec \ud788\uc2a4\ud1a0\uadf8\ub7a8\uacfc \uac19\uc774 \uc0c9\uce60\ud560 \uc218 \uc788\ub2e4. \uc5b4\ub5a4 \uce78 \\((X_i, Y_i)\\)\uc758 \uac00\uc911\uce58 \\(W_i\\)\ub97c \uc5bb\uae30 \uc704\ud574\uc11c\ub294, \ub2e4\uc74c \ub450 \uc870\uac74\uc744 \ubaa8\ub450 \ub9cc\uc871\ud574\uc57c \ud55c\ub2e4.</p> <ul> <li>\\((X_i-1, Y_i)\\), \\((X_i+1, Y_i)\\)\uc911 \uc801\uc5b4\ub3c4 \ud558\ub098\uac00 \uc0c9\uce60\ub418\uc5b4 \uc788\ub2e4.</li> <li>\\((X_i, Y_i)\\)\ub294 \uc0c9\uce60\ub418\uc5b4 \uc788\uc9c0 \uc54a\ub2e4.</li> </ul> <p>\uc774 \ub54c \uc5bb\uc744 \uc218 \uc788\ub294 \uac00\uc911\uce58 \ud569\uc758 \ucd5c\ub300\uac12\uc744 \uad6c\ud558\uc5ec\ub77c.</p> <p></p>","tags":["~ solution","dp","segtree"]},{"location":"solutions/Olympiad/IOI/2022/D1P1%20Catfish%20Farm/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(2 \\le N \\le 100,000\\)</li> <li>\\(1 \\le M \\le 300,000\\)</li> <li>\\(1 \\le X_i, Y_i \\le N\\) \\((1 \\le i \\le M)\\)</li> <li>\\(1 \\le W_i \\le 10^9\\) \\((1 \\le i \\le M)\\)</li> <li>\ubaa8\ub4e0 \\((X_i, Y_i)\\)\uc758 \uc704\uce58\ub294 \uc11c\ub85c \ub2e4\ub974\ub2e4.</li> </ul>","tags":["~ solution","dp","segtree"]},{"location":"solutions/Olympiad/IOI/2022/D1P1%20Catfish%20Farm/solution/#solution","title":"Solution","text":"<p>\uc0c9\uce60\ud560 \ud788\uc2a4\ud1a0\uadf8\ub7a8 \uc601\uc5ed\uc744 \uc815\ud558\uba74 \ub2f5 \ub610\ud55c \uc815\ud574\uc9c0\ub2c8, \uc0c9\uce60\ud560 \ud788\uc2a4\ud1a0\uadf8\ub7a8 \uc601\uc5ed\uc5d0 \ub300\ud55c \uc5ec\ub7ec \uad00\ucc30\uc744 \ud1b5\ud558\uc5ec \uac00\ub2a5\ud55c \ucd5c\uc801\ud574\uc758 \ud615\ud0dc\ub97c \uc0dd\uac01\ud574\ubcf4\uc790. \ud3b8\uc758\ub97c \uc704\ud558\uc5ec \uc5f4 \\(x\\)\uc758 \ud788\uc2a4\ud1a0\uadf8\ub7a8 \ub192\uc774\ub97c \\(C[x]\\)\ub77c \ud558\uc790.</p> <p></p> <p>\uc6b0\uc120 \\(C[x]&gt;0\\)\uc778 \uc5f0\uc18d\ud55c \uce78\ub4e4\uc744 \ubb36\uc5b4 \ud558\ub098\uc758 \uad6c\uac04\uc73c\ub85c \uc0dd\uac01\ud558\uc790. \ub9cc\uc57d \ud55c \uad6c\uac04 \ub0b4\uc5d0\uc11c \uc544\ub798 \uadf8\ub9bc\uacfc \uac19\uc774 \\(C[x]&gt;0\\), \\(C[x-1]&gt;C[x]\\), \\(C[x]&lt;C[x+1]\\)\ub97c \ub9cc\uc871\ud558\ub294 \\(x\\)\uac00 \uc874\uc7ac\ud55c\ub2e4\uba74, \\(C[x]\\)\ub97c \\(0\\)\uc73c\ub85c \ub9cc\ub4e4\uc5b4 \uc804\ubcf4\ub2e4 \ub9ce\uc740 \uce78\ub4e4\uc758 \uac00\uc911\uce58\ub97c \uc5bb\uc744 \uc218 \uc788\ub2e4.</p> <p></p> <p>\ub530\ub77c\uc11c, \ucd5c\uc801\ud574\uc5d0\uc11c \ud55c \uc5f0\uc18d\ud55c \uad6c\uac04\uc5d0 \ub300\ud558\uc5ec \\(C[x-1]&gt;C[x]\\), \\(C[x]&lt;C[x+1]\\)\ub97c \ub9cc\uc871\ud558\ub294 \\(x\\)\uac00 \uc5c6\uc5b4\uc57c \ud558\uba70, \uc774\ub294 \ud55c \uc5f0\uc18d\ud55c \uad6c\uac04 \ub0b4\uc5d0\uc11c \\(C[x]\\)\ub294 \ub2e8\uc870 \uc99d\uac00\ud558\ub2e4\uac00 \ub2e8\uc870 \uac10\uc18c\ud558\ub294 \ud615\ud0dc\uc784\uc744 \uc758\ubbf8\ud55c\ub2e4.</p> <p>Observation 1</p> <p>\\(C[x]&gt;0\\)\uc778 \uc5f0\uc18d\ud55c \uce78\ub4e4\uc744 \ubb36\uc5b4 \ud558\ub098\uc758 \uad6c\uac04\uc73c\ub85c \uc0dd\uac01\ud558\uc790. \ucd5c\uc801\ud574\uc5d0\uc11c \ud55c \uc5f0\uc18d\ud55c \uad6c\uac04\uc758 \\(C[x]\\)\ub294 \ub2e8\uc870\uc99d\uac00\ud558\ub2e4\uac00, \ub2e8\uc870\uac10\uc18c\ud558\ub294 \ud615\ud0dc\uc774\ub2e4.</p> <p></p> <p>\uc774\uc81c \ub2e8\uc870\uc99d\uac00\ud558\ub2e4\uac00 \ub2e8\uc870\uac10\uc18c\ud558\ub294 \ud615\ud0dc\uc778 \ud55c \uc5f0\uc18d\ud55c \uad6c\uac04 \ub0b4\uc5d0\uc11c \\(C[x]\\)\uc758 \ucd5c\ub313\uac12\uc744 \uc0dd\uac01\ud558\uc790. \ub9cc\uc57d \uad6c\uac04 \ub0b4 \ucd5c\ub313\uac12\uc774 \\(C[x] &lt; N\\)\uc774\ub77c\uba74, \ucd5c\ub313\uac12\uc5d0 \ud574\ub2f9\ud558\ub294 \uac12\ub4e4\uc744 \ubaa8\ub450 \\(N\\)\uc73c\ub85c \ubcc0\uacbd\ud558\uc5ec \uc804\ubcf4\ub2e4 \ub9ce\uc740 \uce78\ub4e4\uc758 \uac00\uc911\uce58\ub97c \uc5bb\uc744 \uc218 \uc788\ub2e4. \ub610\ud55c, \ub9cc\uc57d \ucd5c\ub313\uac12\uc774 \\(3\\)\uac1c \uc774\uc0c1\uc774\ub77c\uba74 \uadf8 \uc911 \uac00\uc7a5 \uc67c\ucabd \uce78\uacfc \uac00\uc7a5 \uc624\ub978\ucabd \uce78\uc744 \uc81c\uc678\ud558\uace0 \ubaa8\ub450 \\(0\\)\uc73c\ub85c \ub9cc\ub4e4\uc5b4 \ub354 \ub9ce\uc740 \uce78\ub4e4\uc758 \uac00\uc911\uce58\ub97c \uc5bb\uc744 \uc218 \uc788\ub2e4.</p> <p></p> <p>\ub530\ub77c\uc11c, \ucd5c\uc801\ud574\uc5d0\uc11c \ud55c \uc5f0\uc18d\ud55c \uad6c\uac04\uc5d0 \ub300\ud574\uc11c \\(C[x]=N\\)\uc744 \ub9cc\uc871\ud558\ub294 \uce78\uc774 \uc874\uc7ac\ud558\uba70, \uadf8 \uac1c\uc218\ub294 \ucd5c\ub300 \\(2\\)\uac1c\uc774\ub2e4.</p> <p>Observation 2</p> <p>\ucd5c\uc801\ud574\uc5d0\uc11c \ud55c \uc5f0\uc18d\ud55c \uad6c\uac04\uc5d0 \ub300\ud574\uc11c \\(C[x]=N\\)\uc744 \ub9cc\uc871\ud558\ub294 \uce78\uc774 \uc874\uc7ac\ud558\uba70, \uadf8 \uac1c\uc218\ub294 \ucd5c\ub300 \\(2\\)\uac1c\uc774\ub2e4.</p> <p></p> <p>\uc5b4\ub5a4 \ub450 \uc5f0\uc18d\ud55c \uad6c\uac04 \uc0ac\uc774\uc758 \\(C[x]\\)\ub294 \ubaa8\ub450 \\(0\\)\uc774 \ub41c\ub2e4. \ub9cc\uc57d \\(C[x]=0\\)\uc778 \\(x\\)\uac00 \uc5f0\uc18d\ud558\uc5ec \\(3\\)\uac1c \uc774\uc0c1 \ub4f1\uc7a5\ud55c\ub2e4\uba74, \uc544\ub798 \uadf8\ub9bc\uacfc \uac19\uc774 \uac00\uc7a5 \uc67c\ucabd \uce78\uacfc \uac00\uc7a5 \uc624\ub978\ucabd \uce78\uc744 \uc81c\uc678\ud558\uace0 \ubaa8\ub450 \\(N\\)\uc73c\ub85c \ub9cc\ub4e4\uc5b4 \ub354 \ub9ce\uc740 \uce78\ub4e4\uc758 \uac00\uc911\uce58\ub97c \uc5bb\uc744 \uc218 \uc788\ub2e4.</p> <p></p> <p>\ub610\ud55c, \ub9cc\uc57d \uc5b4\ub5a4 \ub450 \uc5f0\uc18d\ud55c \uad6c\uac04 \uc0ac\uc774\uc5d0 \\(C[x]=0\\)\uc778 \\(x\\)\uac00 \uc815\ud655\ud788 \\(1\\)\uac1c \ub4f1\uc7a5\ud55c\ub2e4\uba74, \uc544\ub798 \uadf8\ub9bc\uacfc \uac19\uc774 \uc67c\ucabd\uc774\ub098 \uc624\ub978\ucabd\uc758 \uce78 \uc911 \ud558\ub098(\ub354 \uc791\uc740 \uce78)\ub97c \\(0\\)\uc73c\ub85c \ub9cc\ub4e4\uc5b4 \ub354 \ub9ce\uc740 \uce78\ub4e4\uc758 \uac00\uc911\uce58\ub97c \uc5bb\uc744 \uc218 \uc788\ub2e4.</p> <p></p> <p>\uc704 \ub450 \ubcc0\ud658\uc744 \uc0dd\uac01\ud558\uba74, \uc5b4\ub5a4 \ub450 \uc5f0\uc18d\ud55c \uad6c\uac04 \uc0ac\uc774\uc5d0 \\(C[x]=0\\)\uc744 \ub9cc\uc871\ud558\ub294 \\(x\\)\ub294 \uc815\ud655\ud788 \\(2\\)\uac1c\uc5ec\uc57c \ud55c\ub2e4. \ud558\uc9c0\ub9cc, \ub2e4\uc74c\uacfc \uac19\uc740 \ud558\ub098\uc758 \ubc18\ub840\uac00 \uc874\uc7ac\ud55c\ub2e4. \ub9cc\uc57d \\(C[x]=0\\)\uc778 \uce78 \\(x\\)\uc758 \uc591 \uc606\uc5d0 \uc788\ub294 \uce78\uc774 \\(C[x-1]=C[x+1]=N\\)\uc774\ub77c\uba74, \uc704 \ubcc0\ud658\uc744 \uc801\uc6a9\ud560 \uc218 \uc5c6\uae30 \ub54c\ubb38\uc5d0 \uc774 \uacbd\uc6b0\ub294 \ucd5c\uc801\ud574\uc5d0\uc11c \uac00\ub2a5\ud558\ub2e4.</p> <p></p> <p>\ub530\ub77c\uc11c, \uc815\ub9ac\ud558\uba74 \ucd5c\uc801\ud574\uc5d0\uc11c \uc5f0\uc18d\ud55c \ub450 \uad6c\uac04 \uc0ac\uc774\uc5d0 \\(C[x]=0\\)\uc744 \ub9cc\uc871\ud558\ub294 \\(x\\)\ub294 \uc815\ud655\ud788 \\(2\\)\uac1c\uc5ec\uc57c \ud55c\ub2e4. \ub2e8, \\(C[x-1]=C[x+1]=N\\)\uc774\ub77c\uba74 \uc608\uc678\uc801\uc73c\ub85c \\(C[x]=0\\)\uc778 \uce78\uc774 \\(1\\)\uac1c\uc77c \uc218 \uc788\ub2e4.</p> <p>Observation 3</p> <p>\ucd5c\uc801\ud574\uc5d0\uc11c \uc5f0\uc18d\ud55c \ub450 \uad6c\uac04 \uc0ac\uc774\uc5d0 \\(C[x]=0\\)\uc744 \ub9cc\uc871\ud558\ub294 \\(x\\)\ub294 \uc815\ud655\ud788 \\(2\\)\uac1c\uc5ec\uc57c \ud55c\ub2e4. \ub2e8, \\(C[x-1]=C[x+1]=N\\)\uc774\ub77c\uba74 \uc608\uc678\uc801\uc73c\ub85c \\(C[x]=0\\)\uc778 \uce78\uc774 \\(1\\)\uac1c\uc77c \uc218 \uc788\ub2e4.</p> <p></p> <p>\uc774\uc81c, \ucd5c\uc801\ud574\uc5d0 \ub300\ud55c \uad00\ucc30 Observation 1, Observation 2, Observation 3\ub97c \uc815\ub9ac\ud558\uba74 \ucd5c\uc801\ud574\uac00 \uc544\ub798 \uadf8\ub9bc\uacfc \uac19\uc740 \ud615\ud0dc\ub77c\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p></p> <p>\ucd5c\uc801\ud574\uc758 \ud615\ud0dc\ub97c \ucda9\ubd84\ud788 \ub2e8\uc21c\ud654\uc2dc\ucf30\uc73c\ub2c8, \uc774\uc81c DP\ub97c \ud1b5\ud574 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ucd5c\uc801\ud574\ub97c \ud0d0\uc0c9\ud558\uba74 \ub41c\ub2e4. \uc6b0\uc120, \uc774\uc81c \ud788\uc2a4\ud1a0\uadf8\ub7a8\uc758 \uc601\uc5ed\uc774 \uc544\ub2cc \uac00\uc911\uce58\ub97c \uc5bb\uc744 \uc218 \uc788\ub294 \uce78\ub4e4\uc758 \uc601\uc5ed\uc5d0 \ub300\ud55c DP\ub97c \uc9c4\ud589\ud558\uba74 \ub418\ub294\ub370, \ucd5c\uc801\ud574\ub294 \ud56d\uc0c1 \ub2e4\uc74c\uacfc \uac19\uc740 \uc774\ub3d9\uc744 \ud558\uba70 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <ul> <li>\ub192\uc774 \\(y=1\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uc624\ub978\ucabd \uc704\ucabd \uce78\uc73c\ub85c \uc62c\ub77c\uac00\uba74\uc11c \ub192\uc774 \\(y=N\\)\uc5d0 \ub3c4\ucc29\ud560 \ub54c\uae4c\uc9c0 \uc774\ub3d9\ud55c\ub2e4. (Observation 1)</li> <li>\\(y=N\\)\uc5d0 \ub3c4\ucc29\ud55c \ud6c4 \\(1\\)\uce78 \ud639\uc740 \\(2\\)\uce78\uc744 \uac74\ub108\ub6f4\ub2e4. (Observation 2)</li> <li>\ub192\uc774 \\(y=N\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uc624\ub978\ucabd \uc544\ub798 \uce78\uc73c\ub85c \ub0b4\ub824\uac00\uba74\uc11c \ub192\uc774 \\(y=1\\)\uc5d0 \ub3c4\ucc29\ud560 \ub54c\uae4c\uc9c0 \uc774\ub3d9\ud55c\ub2e4. (Observation 1)</li> <li>\uc815\ud655\ud788 \\(1\\)\uce78 \uc624\ub978\ucabd\uc73c\ub85c \uc774\ub3d9\ud558\uc5ec \uc704 \uacfc\uc815\uc744 \ubc18\ubcf5\ud55c\ub2e4. (Observation 3)</li> <li>\ub2e8, \\(C[x-1]=C[x+1]=N\\), \\(C[x]=0\\)\uc778 \uacbd\uc6b0 \uc608\uc678\uac00 \uc874\uc7ac\ud558\ub2c8 \uc774 \uacbd\uc6b0 \ub530\ub85c \ucc98\ub9ac\ud55c\ub2e4. (Observation 3)</li> </ul> <p>Observation 4</p> <p>\ucd5c\uc801\ud574\ub294 \ud56d\uc0c1 \ub2e4\uc74c\uacfc \uac19\uc740 \uc774\ub3d9\uc744 \ud558\uba70 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <ul> <li>\ub192\uc774 \\(y=1\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uc624\ub978\ucabd \uc704\ucabd \uce78\uc73c\ub85c \uc62c\ub77c\uac00\uba74\uc11c \ub192\uc774 \\(y=N\\)\uc5d0 \ub3c4\ucc29\ud560 \ub54c\uae4c\uc9c0 \uc774\ub3d9\ud55c\ub2e4. (Observation 1)</li> <li>\\(y=N\\)\uc5d0 \ub3c4\ucc29\ud55c \ud6c4 \\(1\\)\uce78 \ud639\uc740 \\(2\\)\uce78\uc744 \uac74\ub108\ub6f4\ub2e4. (Observation 2)</li> <li>\ub192\uc774 \\(y=N\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uc624\ub978\ucabd \uc544\ub798 \uce78\uc73c\ub85c \ub0b4\ub824\uac00\uba74\uc11c \ub192\uc774 \\(y=1\\)\uc5d0 \ub3c4\ucc29\ud560 \ub54c\uae4c\uc9c0 \uc774\ub3d9\ud55c\ub2e4. (Observation 1)</li> <li>\uc815\ud655\ud788 \\(1\\)\uce78 \uc624\ub978\ucabd\uc73c\ub85c \uc774\ub3d9\ud558\uc5ec \uc704 \uacfc\uc815\uc744 \ubc18\ubcf5\ud55c\ub2e4. (Observation 3)</li> <li>\ub2e8, \\(C[x-1]=C[x+1]=N\\), \\(C[x]=0\\)\uc778 \uacbd\uc6b0 \uc608\uc678\uac00 \uc874\uc7ac\ud558\ub2c8 \uc774 \uacbd\uc6b0 \ub530\ub85c \ucc98\ub9ac\ud55c\ub2e4. (Observation 3)</li> </ul> <p>\uc774 \uacfc\uc815\uc744 \\(N \\times N\\)\uc758 \ud06c\uae30\uc758 \uaca9\uc790\ud310\uc5d0 \ub300\ud558\uc5ec na\u00efve\ud558\uac8c \ud574\uc8fc\uba74 \\(O(N^2)\\)\uac1c\uc758 DP \uc0c1\ud0dc\uac00 \uc788\uc73c\ub2c8 \\(O(N^2)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub824 Subtask 6\uae4c\uc9c0 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>Observation 4\uc640 \uac19\uc740 \uc774\ub3d9\uc744 \ud558\uba70 \ucd5c\uc801\ud574\ub97c \uad6c\ud560 \uc218 \uc788\uc73c\ub2c8, \\(N \\times N\\)\uc758 \ud06c\uae30\uc758 \uaca9\uc790\ud310\uc5d0 \ub300\ud558\uc5ec na\u00efve\ud558\uac8c DP\ub97c \uc804\uc774\ud574\uc8fc\uba74 \\(O(N^2)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\ud558\uc9c0\ub9cc, \uc2e4\uc81c\ub85c \uac00\uc911\uce58\uac00 \uc788\ub294 \uce78\uc740 \ucd1d \\(M\\)\uac1c\uc774\ub2c8, Observation 4\uc5d0\uc11c \uc774\ub3d9\ud560 \ub54c \ub4e4\ub7ec\uc57c \ud558\ub294 \uce78\ub3c4 \ucd1d \\(M\\)\uac1c\uc774\ub2e4. \uc774 \ub54c, \ubaa8\ub4e0 \\(x\\)\uc5d0 \ub300\ud558\uc5ec \\(y=1\\), \\(y=N\\)\uc778 \uce78\ub4e4\uc5d0 \\(0\\)\uc758 \uac00\uc911\uce58\ub97c \ucd94\uac00\ud558\uc5ec \uc804\uc774\uac00 \uac00\ub2a5\ud558\uac8c \ud574\uc900\ub2e4.</p> <p></p> <p>Definition 1</p> <p>\uac01 \uce78 \\(v\\)\uc5d0 \ub300\ud558\uc5ec \\(dp1[v]\\), \\(dp2[v]\\)\ub97c \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\uc758\ud558\uc790.</p> <p>\\(dp1[v]:=\\) \\(v\\)\uae4c\uc9c0 \uc774\ub3d9\ud558\uc600\uc73c\uba70, \ud604\uc7ac \uc62c\ub77c\uac00\ub294 \uc0c1\ud0dc\uc77c \ub54c\uc758 \uac00\uc911\uce58 \ud569\uc758 \ucd5c\ub313\uac12 \\(dp2[v]:=\\) \\(v\\)\uae4c\uc9c0 \uc774\ub3d9\ud558\uc600\uc73c\uba70, \ud604\uc7ac \ub0b4\ub824\uac00\ub294 \uc0c1\ud0dc\uc77c \ub54c\uc758 \uac00\uc911\uce58 \ud569\uc758 \ucd5c\ub313\uac12  </p> <p>Definition 1\uacfc \uac19\uc740 DP \uc815\uc758\ub97c \ud1b5\ud558\uc5ec \ubaa8\ub4e0 \uce78\ub4e4\uc744 \uc67c\ucabd\uc5d0\uc11c \uc624\ub978\ucabd\uc73c\ub85c \ubcf4\uba70 DP\uac12\ub4e4\uc744 \uad6c\ud574\uc904 \uc218 \uc788\ub2e4. \ub9c8\uc9c0\ub9c9\uc73c\ub85c, Observation 4\uc5d0\uc11c \uc790\uae30\ubcf4\ub2e4 \uc67c\ucabd \uc544\ub798, \uc67c\ucabd \uc704\uc758 \uce78\ub4e4\uc5d0\uc11c DP\uac12\uc744 \ubc1b\uc544\uc640\uc57c \ud558\ub294\ub370, \uc774\ub294 inversion\uc758 \uc218\ub97c \uc140 \ub54c\uc640 \ube44\uc2b7\ud558\uac8c segment tree\ub098 fenwick tree \ub4f1\uc744 \uc774\uc6a9\ud558\uc5ec \uc804\uc774\ub97c \\(O(\\log N)\\)\ub9cc\uc5d0 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\ub530\ub77c\uc11c, \uc804\uccb4 \uce78\uc758 \uc218\uac00 \\(O(N+M)\\)\uac1c\uc774\uace0, DP \uacc4\uc0b0\uc5d0 \ub4dc\ub294 \uc2dc\uac04\uc740 \uce78\ub2f9 \\(O(\\log N)\\)\uc774\ub2c8, \\(O((N+M)\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>Observation 4\uc5d0\uc11c \uc774\ub3d9\ud560 \ub54c \ub4e4\ub7ec\uc57c \ud558\ub294 \uce78\ub3c4 \ucd1d \\(M\\)\uac1c\uc774\ub2c8, \ubaa8\ub4e0 \\(x\\)\uc5d0 \ub300\ud558\uc5ec \\(y=1\\), \\(y=N\\)\uc778 \uce78\ub4e4\uc5d0 \\(0\\)\uc758 \uac00\uc911\uce58\ub97c \ucd94\uac00\ud558\uba74 \ucd1d \\(O(N+M)\\)\uac1c\uc758 \uce78\uc5d0 \ub300\ud558\uc5ec DP\ub97c \uc9c4\ud589\ud574\ub3c4 \ub41c\ub2e4. Definition 1\uacfc \uac19\uc740 DP \uc815\uc758\ub97c \ud1b5\ud558\uc5ec \ubaa8\ub4e0 \uce78\ub4e4\uc744 \uc67c\ucabd\uc5d0\uc11c \uc624\ub978\ucabd\uc73c\ub85c \ubcf4\uba70 DP\uac12\ub4e4\uc744 \uad6c\ud574\uc904 \uc218 \uc788\ub2e4. \uc774 \ub54c, Observation 4\uc5d0\uc11c \uc790\uae30\ubcf4\ub2e4 \uc67c\ucabd \uc544\ub798, \uc67c\ucabd \uc704\uc758 \uce78\ub4e4\uc5d0\uc11c DP\uac12\uc744 \ubc1b\uc544\uc640\uc57c \ud558\ub294\ub370, \uc774\ub294 inversion\uc758 \uc218\ub97c \uc140 \ub54c\uc640 \ube44\uc2b7\ud558\uac8c segment tree\ub098 fenwick tree \ub4f1\uc744 \uc774\uc6a9\ud558\uc5ec \uc804\uc774\ub97c \\(O(\\log N)\\)\ub9cc\uc5d0 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, \uc804\uccb4 \uce78\uc758 \uc218\uac00 \\(O(N+M)\\)\uac1c\uc774\uace0, DP \uacc4\uc0b0\uc5d0 \ub4dc\ub294 \uc2dc\uac04\uc740 \uce78\ub2f9 \\(O(\\log N)\\)\uc774\ub2c8, \\(O((N+M)\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O((N+M)\\log N)\\)</p>","tags":["~ solution","dp","segtree"]},{"location":"solutions/Olympiad/IOI/2022/D1P1%20Catfish%20Farm/solution/#code","title":"Code","text":"<pre><code>#include \"fish.h\"\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 1e5;\nconst ll INF = 1e18;\n\nint N, M;\nvector&lt;pii&gt; V[MAXN+10];\nvector&lt;ll&gt; dp1[MAXN+10], dp2[MAXN+10];\n\nstruct BIT\n{\n    ll tree[MAXN+10];\n    void init() { for(int i=1; i&lt;=N; i++) tree[i]=-INF; }\n    void update(int i, ll k) { for(; i&lt;=N; i+=(i&amp;-i)) tree[i]=max(tree[i], k); }\n    ll query(int i) { ll ret=-INF; for(; i&gt;0; i-=(i&amp;-i)) ret=max(ret, tree[i]); return ret; }\n}bit1, bit2;\n\nll max_weights(int _N, int _M, vector&lt;int&gt; _X, vector&lt;int&gt; _Y, vector&lt;int&gt; _W)\n{\n    N=_N; M=_M;\n    for(int i=0; i&lt;M; i++)\n    {\n        int x=_X[i]+1, y=_Y[i]+1, w=_W[i];\n        V[x].push_back({y, w});\n    }\n    for(int i=0; i&lt;=N+1; i++)\n    {\n        sort(V[i].begin(), V[i].end());\n        if(V[i].empty() || V[i][0].first!=1) V[i].push_back({1, 0});\n        if(V[i].back().first!=N) V[i].push_back({N, 0});\n        sort(V[i].begin(), V[i].end());\n\n        dp1[i]=vector&lt;ll&gt;(V[i].size(), -INF);\n        dp2[i]=vector&lt;ll&gt;(V[i].size(), -INF);\n    }\n\n\n    bit1.init(); bit2.init();\n    dp2[0][0]=0; dp1[0][dp1[0].size()-1]=0;\n    ll p=-INF, q=-INF, ans=0;\n    for(int i=0; i&lt;=N+1; i++)\n    {\n        int t=V[i].size();\n        if(i-1&gt;=0) p=max(p, dp2[i-1][0]);\n        if(i-2&gt;=0) q=max(q, dp1[i-2].back());\n\n        dp1[i][0]=max(dp1[i][0], p+V[i][0].second);\n        if(i-2&gt;=0) dp1[i][0]=max(dp1[i][0], dp1[i-2].back()+V[i][0].second);\n        dp2[i][t-1]=max(dp2[i][t-1], q+V[i][t-1].second);\n        for(int j=0; j&lt;t; j++)\n        {\n            auto [y, w] = V[i][j];\n            dp1[i][j]=max(dp1[i][j], bit1.query(y-1)+w);\n            bit1.update(y, dp1[i][j]);\n        }\n        for(int j=t-1; j&gt;=0; j--)\n        {\n            auto [y, w] = V[i][j];\n            dp2[i][j]=max(dp2[i][j], bit2.query(N-y)+w);\n            bit2.update(N-y+1, dp2[i][j]);\n        }\n\n        ans=max(ans, dp2[i][0]);\n    }\n    return ans;\n}\n</code></pre>","tags":["~ solution","dp","segtree"]},{"location":"solutions/Olympiad/IOI/2022/D1P2%20Prisoner%20Challenge/solution/","title":"IOI 2022 D1P2 Prisoner Challenge","text":"","tags":["~ solution","ad_hoc","constructive","divide_and_conquer","dp"]},{"location":"solutions/Olympiad/IOI/2022/D1P2%20Prisoner%20Challenge/solution/#problem","title":"Problem","text":"","tags":["~ solution","ad_hoc","constructive","divide_and_conquer","dp"]},{"location":"solutions/Olympiad/IOI/2022/D1P2%20Prisoner%20Challenge/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/25439 https://oj.uz/problem/view/IOI22_prison</p>","tags":["~ solution","ad_hoc","constructive","divide_and_conquer","dp"]},{"location":"solutions/Olympiad/IOI/2022/D1P2%20Prisoner%20Challenge/solution/#summary","title":"Summary","text":"<p>\\(500\\)\uba85\uc758 \uc8c4\uc218\uac00 \uc788\uace0, \ubc29 \uc548\uc5d0\ub294 \uac00\ubc29 \\(A\\), \\(B\\)\uc640 \\(0\\) \uc774\uc0c1 \\(x\\)\uc774\ud558\uc758 \uc218\ub97c \uc801\uc744 \uc218 \uc788\ub294 \uce60\ud310 \ud558\ub098\uac00 \uc788\ub2e4. \uac00\ubc29 \\(A\\), \\(B\\)\uc5d0\ub294 \\(1\\)\uac1c \uc774\uc0c1, \\(N\\)\uac1c \uc774\ud558\uc758 \uc11c\ub85c \ub2e4\ub978 \uac1c\uc218\uc758 \ub3d9\uc804\ub4e4\uc774 \ub4e4\uc5b4 \uc788\uace0, \uc8c4\uc218\ub4e4\uc740 \ub450 \uac00\ubc29 \uc911 \uc5b4\ub5a4 \uac00\ubc29\uc5d0 \ub3d9\uc804\uc774 \ub354 \uc801\uac8c \ub4e4\uc5b4 \uc788\ub294\uc9c0 \ub9de\ucd94\uc5b4\uc57c \ud55c\ub2e4. \uc8c4\uc218\ub4e4\uc740 \ud55c \uba85\uc529, \uce60\ud310\uc5d0 \uc801\ud600 \uc788\ub294 \uc218\ub97c \ubcf8 \ud6c4 \uac00\ubc29 \\(A\\), \\(B\\) \uc911 \ud558\ub098\ub97c \uace8\ub77c \uc774 \uac00\ubc29\uc758 \ub3d9\uc804\uc758 \uc218\ub97c \ud655\uc778\ud55c \ud6c4, \uce60\ud310\uc5d0 \uc788\ub358 \uc218\ub97c \uc9c0\uc6b0\uace0 \uc790\uae30\uac00 \uc6d0\ud558\ub294 \uc218\ub97c \uc801\uac70\ub098, \ub450 \uac00\ubc29 \uc911 \uc5b4\ub5a4 \uac00\ubc29\uc5d0 \ub3d9\uc804\uc774 \ub354 \uc801\uac8c \ub4e4\uc5b4\uc788\ub294\uc9c0 \ub9de\ucd9c \uc218 \uc788\ub2e4. \uc774 \ub54c \uc798\ubabb\ub41c \uac00\ubc29\uc744 \uc120\ud0dd\ud558\uba74 \uc548\ub418\uace0, \uac01 \uc8c4\uc218\ub294 \uce60\ud310\uc5d0 \uc368\uc788\ub294 \uc815\ubcf4 \uc774\uc678\uc758 \ub2e4\ub978 \uc815\ubcf4(\uc790\uc2e0\uc774 \uba87 \ubc88\uc9f8\ub85c \ub4e4\uc5b4\uc654\ub294\uc9c0 \ub4f1)\ub294 \uc5bb\uc744 \uc218 \uc5c6\ub2e4. \uc774 \ub54c, \\(x\\)\ub97c \ucd5c\uc18c\ud654\uc2dc\ud0ac \uc218 \uc788\ub294 \uc804\ub7b5\uc744 \uad6c\ud558\uc5ec\ub77c.</p>","tags":["~ solution","ad_hoc","constructive","divide_and_conquer","dp"]},{"location":"solutions/Olympiad/IOI/2022/D1P2%20Prisoner%20Challenge/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(2 \\le N \\le 5,000\\)</li> <li>\\(x \\le 20\\) (\\(x\\)\uc758 \ucd5c\ub300 \ud06c\uae30\uc5d0 \ub530\ub77c \ubd80\ubd84 \uc810\uc218\ub97c \uc5bb\uc744 \uc218 \uc788\ub2e4.)</li> </ul>","tags":["~ solution","ad_hoc","constructive","divide_and_conquer","dp"]},{"location":"solutions/Olympiad/IOI/2022/D1P2%20Prisoner%20Challenge/solution/#solution","title":"Solution","text":"","tags":["~ solution","ad_hoc","constructive","divide_and_conquer","dp"]},{"location":"solutions/Olympiad/IOI/2022/D1P2%20Prisoner%20Challenge/solution/#subtask-1","title":"Subtask 1","text":"<ul> <li>\\(N \\le 500\\)</li> <li>\\(x \\le 500\\)</li> </ul> <p>\ub2e4\uc74c\uacfc \uac19\uc740 \uc804\ub7b5\uc73c\ub85c \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <ul> <li>\uccab \ubc88\uc9f8 \uc0ac\ub78c\uc740 \uce60\ud310\uc5d0 \\(0\\)\uc774 \uc368\uc788\uc73c\ub2c8, \uac00\ubc29 \\(A\\)\ub97c \uc5f4\uc5b4\ubcf4\uace0 \uadf8 \ub3d9\uc804\uc758 \uc218\ub97c \uce60\ud310\uc5d0 \uc801\ub294\ub2e4.</li> <li>\ub450 \ubc88\uc9f8 \uc0ac\ub78c\uc740 \uce60\ud310\uc5d0 \\(0\\)\uc774 \uc544\ub2cc \uc218\uac00 \uc368\uc788\uc73c\ub2c8, \uac00\ubc29 \\(B\\)\ub97c \uc5f4\uc5b4\ubcf4\uace0 \uce60\ud310\uc758 \uc218\uc640 \ube44\uad50\ud558\uc5ec \ub2f5\uc744 \uad6c\ud55c\ub2e4.</li> </ul> <p>CheckPoint</p> <p>\ub2e4\uc74c\uacfc \uac19\uc740 \uc804\ub7b5\uc73c\ub85c \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <ul> <li>\uccab \ubc88\uc9f8 \uc0ac\ub78c\uc740 \uce60\ud310\uc5d0 \\(0\\)\uc774 \uc368\uc788\uc73c\ub2c8, \uac00\ubc29 \\(A\\)\ub97c \uc5f4\uc5b4\ubcf4\uace0 \uadf8 \ub3d9\uc804\uc758 \uc218\ub97c \uce60\ud310\uc5d0 \uc801\ub294\ub2e4.</li> <li>\ub450 \ubc88\uc9f8 \uc0ac\ub78c\uc740 \uce60\ud310\uc5d0 \\(0\\)\uc774 \uc544\ub2cc \uc218\uac00 \uc368\uc788\uc73c\ub2c8, \uac00\ubc29 \\(B\\)\ub97c \uc5f4\uc5b4\ubcf4\uace0 \uce60\ud310\uc758 \uc218\uc640 \ube44\uad50\ud558\uc5ec \ub2f5\uc744 \uad6c\ud55c\ub2e4.</li> </ul>","tags":["~ solution","ad_hoc","constructive","divide_and_conquer","dp"]},{"location":"solutions/Olympiad/IOI/2022/D1P2%20Prisoner%20Challenge/solution/#subtask-31","title":"Subtask 3.1","text":"<ul> <li>\\(N \\le 5000\\)</li> <li>\\(x \\le 26\\)</li> </ul> <p>\uae30\ubcf8\uc801\uc73c\ub85c \ub450 \uc218\ub97c \ube44\uad50\ud558\ub294 \ubb38\uc81c\uc774\ub2c8, 2\uc9c4\uc218\ub85c \ub098\ud0c0\ub0b4 \uac00\uc7a5 \ub192\uc740 \ube44\ud2b8\ubd80\ud130 \ud558\ub098\uc529 \ube44\uad50\ud558\ub294 \uc804\ub7b5\uc744 \uc0dd\uac01\ud560 \uc218 \uc788\ub2e4.</p> <ul> <li>\uccab \ubc88\uc9f8 \uc0ac\ub78c\uc740 \uce60\ud310\uc5d0 \\(0\\)\uc774 \uc368\uc788\uc73c\ub2c8, \uac00\ubc29 \\(A\\)\ub97c \uc5f4\uc5b4\ubcf4\uace0 \\(12\\)\ubc88\uc9f8 \ube44\ud2b8\ub97c \ud655\uc778\ud558\uc5ec \\(1\\), \\(2\\)\uc911 \ud558\ub098\uc758 \uc218\ub97c \uce60\ud310\uc5d0 \uc801\ub294\ub2e4.</li> <li>\ub450 \ubc88\uc9f8 \uc0ac\ub78c\uc740 \uc801\ud600 \uc788\ub294 \\(1\\), \\(2\\)\uc911 \ud558\ub098\uc758 \uc218\ub97c \uc77d\uace0 \uac00\ubc29 \\(B\\)\ub97c \uc5f4\uc5b4\ubcf4\uace0 \\(12\\)\ubc88\uc9f8 \ube44\ud2b8\ub97c \ud655\uc778\ud558\uc5ec \uce60\ud310\uc5d0 \uc801\ud600\uc788\ub294 \uc815\ubcf4\uc778 \\(A\\)\uc758 \\(12\\)\ubc88\uc9f8 \ube44\ud2b8\uc640 \ube44\uad50\ud55c \ud6c4 \ub2e4\ub974\uba74 \ub2f5\uc744 \ub9de\ucd94\uace0, \uac19\ub2e4\uba74 \\(B\\)\uc758 \\(11\\)\ubc88\uc9f8 \ube44\ud2b8\ub97c \ud655\uc778\ud558\uc5ec \\(3\\), \\(4\\)\uc911 \ud558\ub098\uc758 \uc218\ub97c \uce60\ud310\uc5d0 \uc801\ub294\ub2e4.</li> <li>\uc704 \uacfc\uc815\uc744 \ubc18\ubcf5\ud558\uc5ec \ub9c8\uc9c0\ub9c9 \ube44\ud2b8\uae4c\uc9c0 \ube44\uad50\ud55c\ub2e4.</li> </ul> <p>\uc774 \uc804\ub7b5\uc744 \uc0ac\uc6a9\ud558\uba74 \\(0\\)\ubc88\uc9f8 \ube44\ud2b8\uc5d0 \ub300\ud55c \uc815\ubcf4\uac00 \uc801\ud78c \uce60\ud310\uc744 \ud655\uc778\ud558\ub294 \uc21c\uac04 \ub2f5\uc744 \uacb0\uc815\ud560 \uc218 \uc788\uc73c\uba70, \ub530\ub77c\uc11c \ucd1d \\(13\\)\uac1c\uc758 \ube44\ud2b8\uc5d0 \ub300\ud558\uc5ec \\(0\\)\ubd80\ud130 \\(26\\)\uae4c\uc9c0\uc758 \uc0c1\ud0dc\ub85c \ub098\ud0c0\ub0bc \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>2\uc9c4\uc218\ub85c \ub098\ud0c0\ub0b4 \uac00\uc7a5 \ub192\uc740 \ube44\ud2b8\ubd80\ud130 \ud558\ub098\uc529 \ube44\uad50\ud558\ub294 \uc804\ub7b5\uc744 \uc0ac\uc6a9\ud55c\ub2e4.</p> <ul> <li>\uccab \ubc88\uc9f8 \uc0ac\ub78c\uc740 \uce60\ud310\uc5d0 \\(0\\)\uc774 \uc368\uc788\uc73c\ub2c8, \uac00\ubc29 \\(A\\)\ub97c \uc5f4\uc5b4\ubcf4\uace0 \\(12\\)\ubc88\uc9f8 \ube44\ud2b8\ub97c \ud655\uc778\ud558\uc5ec \\(1\\), \\(2\\)\uc911 \ud558\ub098\uc758 \uc218\ub97c \uce60\ud310\uc5d0 \uc801\ub294\ub2e4.</li> <li>\ub450 \ubc88\uc9f8 \uc0ac\ub78c\uc740 \uc801\ud600 \uc788\ub294 \\(1\\), \\(2\\)\uc911 \ud558\ub098\uc758 \uc218\ub97c \uc77d\uace0 \uac00\ubc29 \\(B\\)\ub97c \uc5f4\uc5b4\ubcf4\uace0 \\(12\\)\ubc88\uc9f8 \ube44\ud2b8\ub97c \ud655\uc778\ud558\uc5ec \uce60\ud310\uc5d0 \uc801\ud600\uc788\ub294 \uc815\ubcf4\uc778 \\(A\\)\uc758 \\(12\\)\ubc88\uc9f8 \ube44\ud2b8\uc640 \ube44\uad50\ud55c \ud6c4 \ub2e4\ub974\uba74 \ub2f5\uc744 \ub9de\ucd94\uace0, \uac19\ub2e4\uba74 \\(B\\)\uc758 \\(11\\)\ubc88\uc9f8 \ube44\ud2b8\ub97c \ud655\uc778\ud558\uc5ec \\(3\\), \\(4\\)\uc911 \ud558\ub098\uc758 \uc218\ub97c \uce60\ud310\uc5d0 \uc801\ub294\ub2e4.</li> <li>\uc704 \uacfc\uc815\uc744 \ubc18\ubcf5\ud558\uc5ec \ub9c8\uc9c0\ub9c9 \ube44\ud2b8\uae4c\uc9c0 \ube44\uad50\ud55c\ub2e4.</li> </ul> <p>\uc774 \uc804\ub7b5\uc744 \uc0ac\uc6a9\ud558\uba74 \\(0\\)\ubc88\uc9f8 \ube44\ud2b8\uc5d0 \ub300\ud55c \uc815\ubcf4\uac00 \uc801\ud78c \uce60\ud310\uc744 \ud655\uc778\ud558\ub294 \uc21c\uac04 \ub2f5\uc744 \uacb0\uc815\ud560 \uc218 \uc788\uc73c\uba70, \ub530\ub77c\uc11c \ucd1d \\(13\\)\uac1c\uc758 \ube44\ud2b8\uc5d0 \ub300\ud558\uc5ec \\(0\\)\ubd80\ud130 \\(26\\)\uae4c\uc9c0\uc758 \uc0c1\ud0dc\ub85c \ub098\ud0c0\ub0bc \uc218 \uc788\ub2e4.</p>","tags":["~ solution","ad_hoc","constructive","divide_and_conquer","dp"]},{"location":"solutions/Olympiad/IOI/2022/D1P2%20Prisoner%20Challenge/solution/#subtask-32","title":"Subtask 3.2","text":"<ul> <li>\\(N \\le 5000\\)</li> <li>\\(x \\le 22\\)</li> </ul> <p>\uc704 \uc804\ub7b5\uc73c\ub85c 56\uc810 \uc815\ub3c4\ub97c \ub9de\uc744 \uc218 \uc788\uc73c\ub2c8, \ud070 \uc804\ub7b5\uc758 \uc218\uc815 \uc5c6\uc774 \uc704 \uc804\ub7b5\uc744 \ucd5c\uc801\ud654\ud560 \uc218 \uc788\ub294 \ubc29\ubc95\uc5d0 \ub300\ud574 \uc0dd\uac01\ud558\uc790.</p> <p>\uc6b0\uc120, \uaf2d \uc218\ub97c 2\uc9c4\uc218\ub85c \ud45c\ud604\ud560 \ud544\uc694\uac00 \uc5c6\ub2e4. 3\uc9c4\uc218\ub098 4\uc9c4\uc218, \ud639\uc740 \uac01 \uc790\ub9ac\uc218\ubcc4\ub85c \uac00\ub2a5\ud55c \uc218\uac00 \uc11c\ub85c \ub2e4\ub978 \ud615\ud0dc\uc758 \uc9c4\ubc95\uc774 \ubaa8\ub450 \uac00\ub2a5\ud558\ub2e4. Subtask 3.1 \uc804\ub7b5\uc758 \ud575\uc2ec\uc740, \uac01 \ub2e8\uacc4\uc5d0\uc11c \uac00\ub2a5\ud55c \uc218\uc758 \ubc94\uc704\ub97c \uc801\ub2f9\ud788 \ucabc\uac1c \uac00\ubc29 \\(A\\) \ud639\uc740 \\(B\\)\uc758 \ub3d9\uc804\uc758 \uc218\uac00 \ud2b9\uc815 \uad6c\uac04\uc5d0 \ud3ec\ud568\ub41c\ub2e4\ub294 \uac83\uc744 \ucd5c\uc18c\ud55c\uc758 \uc0c1\ud0dc\ub85c \ud45c\ud604\ud558\ub294 \uac83\uc774\ub2e4. \ud604\uc7ac \uce60\ud310\uc5d0 \uc801\ud600 \uc788\ub294 \uc815\ubcf4\ub85c \uac00\ubc29 \\(A\\)\uac00 \uad6c\uac04 \\([l, r]\\)\uc5d0 \uc18d\ud55c\ub2e4\ub294 \uc815\ubcf4\ub97c \uc5bb\uc5c8\uc744 \ub54c, \uac00\ubc29 \\(B\\)\uac00 \uad6c\uac04\uc5d0 \uc18d\ud558\uc9c0 \uc54a\ub294\ub2e4\uba74 \ubc14\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\uace0, \uad6c\uac04\uc5d0 \uc18d\ud55c\ub2e4\uba74 \uad6c\uac04 \\([l, r]\\)\uc744 \\([l', r']\\)\uc73c\ub85c \ucabc\uac1c \uc0c8\ub85c\uc6b4 \uc0c1\ud0dc\ub85c \uce60\ud310\uc5d0 \uc801\uc73c\uba74 \ub41c\ub2e4.</p> <p>Observation 1</p> <p>Subtask 3.1 \uc804\ub7b5\uc758 \ud575\uc2ec\uc740, \uac01 \ub2e8\uacc4\uc5d0\uc11c \uac00\ub2a5\ud55c \uc218\uc758 \ubc94\uc704\ub97c \uc801\ub2f9\ud788 \ucabc\uac1c \uac00\ubc29 \\(A\\) \ud639\uc740 \\(B\\)\uc758 \ub3d9\uc804\uc758 \uc218\uac00 \ud2b9\uc815 \uad6c\uac04\uc5d0 \ud3ec\ud568\ub41c\ub2e4\ub294 \uac83\uc744 \ucd5c\uc18c\ud55c\uc758 \uc0c1\ud0dc\ub85c \ud45c\ud604\ud558\ub294 \uac83\uc774\ub2e4. \ud604\uc7ac \uce60\ud310\uc5d0 \uc801\ud600 \uc788\ub294 \uc815\ubcf4\ub85c \uac00\ubc29 \\(A\\)\uac00 \uad6c\uac04 \\([l, r]\\)\uc5d0 \uc18d\ud55c\ub2e4\ub294 \uc815\ubcf4\ub97c \uc5bb\uc5c8\uc744 \ub54c, \uac00\ubc29 \\(B\\)\uac00 \uad6c\uac04\uc5d0 \uc18d\ud558\uc9c0 \uc54a\ub294\ub2e4\uba74 \ubc14\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\uace0, \uad6c\uac04\uc5d0 \uc18d\ud55c\ub2e4\uba74 \uad6c\uac04 \\([l, r]\\)\uc744 \\([l', r']\\)\uc73c\ub85c \ucabc\uac1c \uc0c8\ub85c\uc6b4 \uc0c1\ud0dc\ub85c \uce60\ud310\uc5d0 \uc801\uc73c\uba74 \ub41c\ub2e4.</p> <p>\ub530\ub77c\uc11c \uaf2d 2\uc9c4\ubc95\uc774 \uac00\uc7a5 \ud6a8\uc728\uc801\uc778 \uac83\uc740 \uc544\ub2c8\ub2c8 DP\ub97c \ud1b5\ud574 \ucd5c\uc801\uc758 \ubd84\ud560 \uc804\ub7b5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4. \uad6c\uac04\uc744 \ucd5c\ub300\ud55c \uace0\ub974\uac8c \ub098\ub204\ub294 \uac83\uc774 \uc774\ub4dd\uc774\ub2c8, \uac01 \uad6c\uac04\uc758 \uae38\uc774\uc5d0 \ub300\ud558\uc5ec \uba87 \uac1c\uc758 \uad6c\uac04\uc73c\ub85c \ucabc\uac24 \uac83\uc778\uc9c0\ub97c DP\ub97c \ud1b5\ud574 \uad6c\ud558\uba74 \ub41c\ub2e4.</p> <p>Definition 1</p> <p>\\(dp[i] :=\\) \uad6c\uac04\uc758 \uae38\uc774\uac00 \\(i\\)\uc77c \ub54c \ud544\uc694\ud55c \uc0c1\ud0dc\uc758 \uac1c\uc218</p> <p>\\(\\displaystyle dp[i] = \\min_{j&lt;i} {dp \\left[ \\left \\lceil \\frac{i}{j} \\right \\rceil \\right] + j}\\) \uc640 \uac19\uc740 \uc810\ud654\uc2dd\uc744 \ud1b5\ud574 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\uc704 Definition 1\uc640 \uac19\uc740 DP\ub97c \ud1b5\ud574 \\(N \\le 5000\\)\uc5d0 \ub300\ud55c \ucd5c\uc801\uc758 \ubd84\ud560\uc744 \uad6c\ud558\uba74 \ub41c\ub2e4. \uc774 \ub54c, \ub9c8\uc9c0\ub9c9\uc5d0 \uce60\ud310\uc5d0 \uc5b4\ub5a4 \uc218\uac00 \uae38\uc774 \\(2\\)\uc758 \uad6c\uac04\uc5d0 \uc18d\ud55c\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4\uba74, \ub354 \uc774\uc0c1 \uad6c\uac04\uc744 \ucabc\uac1c\uc9c0 \ub9d0\uace0 \uac00\ubc29\uc744 \ud55c\ubc88 \uc5f4\uc5b4\ubcf4\uc558\uc744 \ub54c \ubc14\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4. \uc774\ub294 \ub450 \uc218\uac00 \uc11c\ub85c \ub2e4\ub974\ub2e4\ub294 \uc870\uac74 \ub54c\ubb38\uc778\ub370, \uc774\ub97c \uc774\uc6a9\ud558\uba74 \\(22\\)\uac1c\uc758 \uc0c1\ud0dc\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>Observation 1\uacfc \uac19\uc774 \uce60\ud310\uc5d0 \ub3d9\uc804\uc774 \ud3ec\ud568\ub41c \ubc94\uc704\ub97c \ub098\ud0c0\ub0b4\ub294 \uc0c1\ud0dc\ub97c \uc801\uc73c\uba74, \uc774 \uad6c\uac04\uc744 \ubc18\ubcf5\uc801\uc73c\ub85c \ubd84\ud560\ud558\uba70 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4. \uc774 \ub54c, \ucd5c\uc801\uc758 \ubd84\ud560 \uc804\ub7b5\uc744 \uad6c\ud558\uae30 \uc704\ud558\uc5ec Definition 1\uacfc \uac19\uc740 DP\ub97c \uc774\uc6a9\ud560 \uc218 \uc788\ub2e4. \ucd94\uac00\ub85c \ub9c8\uc9c0\ub9c9\uc5d0 \uce60\ud310\uc5d0 \uc5b4\ub5a4 \uc218\uac00 \uae38\uc774 \\(2\\)\uc758 \uad6c\uac04\uc5d0 \uc18d\ud55c\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4\uba74, \ub354 \uc774\uc0c1 \uad6c\uac04\uc744 \ucabc\uac1c\uc9c0 \ub9d0\uace0 \uac00\ubc29\uc744 \ud55c\ubc88 \uc5f4\uc5b4\ubcf4\uc558\uc744 \ub54c \ubc14\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4. \uc774\ub294 \ub450 \uc218\uac00 \uc11c\ub85c \ub2e4\ub974\ub2e4\ub294 \uc870\uac74 \ub54c\ubb38\uc778\ub370, \uc774\ub97c \uc774\uc6a9\ud558\uba74 \\(22\\)\uac1c\uc758 \uc0c1\ud0dc\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p>","tags":["~ solution","ad_hoc","constructive","divide_and_conquer","dp"]},{"location":"solutions/Olympiad/IOI/2022/D1P2%20Prisoner%20Challenge/solution/#subtask-3-full","title":"Subtask 3 (Full)","text":"<ul> <li>\\(N \\le 5000\\)</li> <li>\\(x \\le 20\\)</li> </ul> <p>Subtask 3.2\uc758 \ub9c8\uc9c0\ub9c9 \ubd80\ubd84\uc5d0\uc11c \uce60\ud310\uc5d0 \uc5b4\ub5a4 \uc218\uac00 \uae38\uc774 \\(2\\)\uc758 \uad6c\uac04\uc5d0 \uc18d\ud55c\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4\uba74, \ub354 \uc774\uc0c1 \uad6c\uac04\uc744 \ucabc\uac1c\uc9c0 \ub9d0\uace0 \uac00\ubc29\uc744 \ud55c\ubc88 \uc5f4\uc5b4\ubcf4\uc558\uc744 \ub54c \ubc14\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4\ub294 \uc810\uc744 \uc774\uc6a9\ud558\uc600\ub2e4. \uc774\ub97c \uc751\uc6a9\ud558\uc5ec, \ud604\uc7ac \uce60\ud310\uc5d0 \uc801\ud600 \uc788\ub294 \uc815\ubcf4\ub85c \uac00\ubc29 \\(A\\)\uac00 \uad6c\uac04 \\([l, r]\\)\uc5d0 \uc18d\ud55c\ub2e4\ub294 \uc815\ubcf4\ub97c \uc5bb\uc5c8\uc744 \ub54c, \uac00\ubc29 \\(B\\)\uac00 \uc815\ud655\ud788 \\(l\\)\uc774\ub098 \\(r\\)\uc774\ub77c\uba74 \ub450 \uc218\uac00 \uc11c\ub85c \ub2e4\ub974\ub2e4\ub294 \uc870\uac74\uc744 \uc774\uc6a9\ud558\uc5ec \ubc14\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4. \uc774\ub294, \uc0ac\uc2e4 \uad6c\uac04\uc774 \uc6d0\ub798 \\([l, r]\\)\uc774\uc5c8\ub2e4\uba74, \ub2e4\uc74c \ub2e8\uacc4\uc5d0\uc11c\ub294 \uad6c\uac04 \\([l+1, r-1]\\)\uc744 \uc5ec\ub7ec \uac1c\uc758 \uc791\uc740 \uad6c\uac04 \\([l', r']\\)\uc73c\ub85c \ucabc\uac1c\uba74 \ub428\uc744 \uc758\ubbf8\ud55c\ub2e4.</p> <p>Observation 2</p> <p>\ud604\uc7ac \uce60\ud310\uc5d0 \uc801\ud600 \uc788\ub294 \uc815\ubcf4\ub85c \uac00\ubc29 \\(A\\)\uac00 \uad6c\uac04 \\([l, r]\\)\uc5d0 \uc18d\ud55c\ub2e4\ub294 \uc815\ubcf4\ub97c \uc5bb\uc5c8\uc744 \ub54c, \uac00\ubc29 \\(B\\)\uac00 \uc815\ud655\ud788 \\(l\\)\uc774\ub098 \\(r\\)\uc774\ub77c\uba74 \ub450 \uc218\uac00 \uc11c\ub85c \ub2e4\ub974\ub2e4\ub294 \uc870\uac74\uc744 \uc774\uc6a9\ud558\uc5ec \ubc14\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4. \uc774\ub294, \uc0ac\uc2e4 \uad6c\uac04\uc774 \uc6d0\ub798 \\([l, r]\\)\uc774\uc5c8\ub2e4\uba74, \ub2e4\uc74c \ub2e8\uacc4\uc5d0\uc11c\ub294 \uad6c\uac04 \\([l+1, r-1]\\)\uc744 \uc5ec\ub7ec \uac1c\uc758 \uc791\uc740 \uad6c\uac04 \\([l', r']\\)\uc73c\ub85c \ucabc\uac1c\uba74 \ub428\uc744 \uc758\ubbf8\ud55c\ub2e4.</p> <p>Observation 2\uc744 \uc774\uc6a9\ud558\uc5ec Definition 1\uc758 DP\ub97c \uc218\uc815\ud558\uc790.</p> <p>Definition 2</p> <p>\\(dp[i] :=\\) \uad6c\uac04\uc758 \uae38\uc774\uac00 \\(i\\)\uc77c \ub54c \ud544\uc694\ud55c \uc0c1\ud0dc\uc758 \uac1c\uc218</p> <p>\\(\\displaystyle dp[i] = \\min_{j&lt;i} {dp \\left[ \\left \\lceil \\frac{i-2}{j} \\right \\rceil \\right] + j}\\) \uc640 \uac19\uc740 \uc810\ud654\uc2dd\uc744 \ud1b5\ud574 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\uc704 Definition 2\uc640 \uac19\uc740 DP\ub97c \ud1b5\ud574 \ucd5c\uc801\uc758 \ubd84\ud560 \uc804\ub7b5\uc744 \uad6c\ud558\uba74, \\(\\{2, 3, 3, 3, 3, 2, 2, 2\\}\\)\uacfc \uac19\uc740 \uc21c\uc11c\ub85c \ubd84\ud560\uc744 \uc9c4\ud589\ud558\uba74, \\(N=5022\\)\uc5d0 \ub300\ud558\uc5ec \uc815\ud655\ud788 \\(20\\)\uac1c\uc758 \uc0c1\ud0dc\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\ucd5c\uc885 \ud480\uc774\uc5d0\uc11c\ub294 DP\ub294 \ub3cc\ub9b4 \ud544\uc694 \uc5c6\uc774, \ubbf8\ub9ac \uacc4\uc0b0\ub41c \ubc30\uc5f4 \\(\\{2, 3, 3, 3, 3, 2, 2, 2\\}\\)\uc744 \uc774\uc6a9\ud558\uc5ec \uc804\ub7b5\uc744 \uad6c\ud604\ud558\uba74 \ub41c\ub2e4.</p> <p>CheckPoint</p> <p>Observation 2\uc640 \uac19\uc774, \uce60\ud310\uc5d0 \uc801\ud78c \uad6c\uac04 \\([l, r]\\)\uc744 \ud655\uc778\ud560 \ub54c\ub9c8\ub2e4 \ub2e4\uc74c \ub2e8\uacc4\uc5d0\uc11c\ub294 \uad6c\uac04 \\([l+1, r-1]\\)\uc744 \uc5ec\ub7ec \uac1c\uc758 \uc791\uc740 \uad6c\uac04 \\([l', r']\\)\uc73c\ub85c \ucabc\uac24 \uc218 \uc788\ub2e4. \uc774\ub97c \uc774\uc6a9\ud558\uc5ec Definition 2\uc640 \uac19\uc740 DP\ub97c \ud1b5\ud574 \ucd5c\uc801\uc758 \ubd84\ud560 \uc804\ub7b5\uc744 \uad6c\ud558\uba74, \\(\\{2, 3, 3, 3, 3, 2, 2, 2\\}\\)\uacfc \uac19\uc740 \uc21c\uc11c\ub85c \ubd84\ud560\uc744 \uc9c4\ud589\ud558\uba74, \\(N=5022\\)\uc5d0 \ub300\ud558\uc5ec \uc815\ud655\ud788 \\(20\\)\uac1c\uc758 \uc0c1\ud0dc\ub85c \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p>","tags":["~ solution","ad_hoc","constructive","divide_and_conquer","dp"]},{"location":"solutions/Olympiad/IOI/2022/D1P2%20Prisoner%20Challenge/solution/#code","title":"Code","text":"<pre><code>#include \"prison.h\"\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nint P[]={0, 2, 3, 3, 3, 3, 2, 2, 2};\nint Q[]={0, 2, 5, 8, 11, 14, 16, 18, 20};\nint A[21][5023];\nint B[10][5023];\n\nvoid f(int pos, int l, int r)\n{\n    B[pos][l]=-1; B[pos][r]=-2;\n    if(l+2&gt;r) return;\n    int p=(r-l-1)/P[pos];\n    for(int i=l+1; i&lt;r; i++)\n    {\n        B[pos][i]=(i-l-1)/p+Q[pos-1]+1;\n    }\n    for(int i=l+1; i&lt;r; i+=p) f(pos+1, i, i+p-1);\n}\n\nvector&lt;vector&lt;int&gt;&gt; devise_strategy(int N)\n{\n    f(1, 1, 5022);\n    A[0][0]=0;\n    A[0][1]=-1; A[0][5022]=-2;\n    for(int i=2; i&lt;=5021; i++) A[0][i]=B[1][i];\n    for(int i=1; i&lt;=8; i++)\n    {\n        for(int j=Q[i-1]+1; j&lt;=Q[i]; j++)\n        {\n            int t=A[j][0]=i%2;\n            for(int k=1; k&lt;=5022; k++)\n            {\n                if(B[i][k]==-1)\n                {\n                    if(t) A[j][k]=-2;\n                    else A[j][k]=-1;\n                }\n                else if(B[i][k]==-2)\n                {\n                    if(t) A[j][k]=-1;\n                    else A[j][k]=-2;\n                }\n                else if(B[i][k]&lt;j)\n                {\n                    if(t) A[j][k]=-2;\n                    else A[j][k]=-1;\n                }\n                else if(B[i][k]&gt;j)\n                {\n                    if(t) A[j][k]=-1;\n                    else A[j][k]=-2;\n                }\n                else\n                {\n                    if(B[i+1][k]==-1)\n                    {\n                        if(t) A[j][k]=-2;\n                        else A[j][k]=-1;\n                    }\n                    else if(B[i+1][k]==-2)\n                    {\n                        if(t) A[j][k]=-1;\n                        else A[j][k]=-2;\n                    }\n                    else A[j][k]=B[i+1][k];\n                }\n            }\n        }\n    }\n\n    vector&lt;vector&lt;int&gt;&gt; ans=vector&lt;vector&lt;int&gt;&gt;(21, vector&lt;int&gt;(N+1));\n    for(int i=0; i&lt;=20; i++) for(int j=0; j&lt;=N; j++) ans[i][j]=A[i][j];\n    return ans;\n}\n</code></pre>","tags":["~ solution","ad_hoc","constructive","divide_and_conquer","dp"]},{"location":"solutions/Olympiad/IOI/2022/D1P3%20Radio%20Towers/solution/","title":"IOI 2022 D1P3 Radio Towers","text":"","tags":["~ solution","data_structures","greedy","pst","segtree","tree_set"]},{"location":"solutions/Olympiad/IOI/2022/D1P3%20Radio%20Towers/solution/#problem","title":"Problem","text":"","tags":["~ solution","data_structures","greedy","pst","segtree","tree_set"]},{"location":"solutions/Olympiad/IOI/2022/D1P3%20Radio%20Towers/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/25440 https://oj.uz/problem/view/IOI22_towers</p>","tags":["~ solution","data_structures","greedy","pst","segtree","tree_set"]},{"location":"solutions/Olympiad/IOI/2022/D1P3%20Radio%20Towers/solution/#summary","title":"Summary","text":"<p>\\(N\\)\uac1c\uc758 \uc1a1\uc2e0\ud0d1\uc774 \uc788\uace0, \uc1a1\uc2e0\ud0d1 \\(i\\)\uc758 \ub192\uc774\ub294 \\(H_i\\)\uc774\ub2e4. \\((1 \\le i \\le N)\\) \uc5b4\ub5a4 \uc591\uc758 \uc815\uc218 \"\uac04\uc12d \uc218\uce58\" \\(D\\)\uc5d0 \ub300\ud574, \ub450 \uc1a1\uc2e0\ud0d1 \\(i&lt;j\\)\uc774 \uc11c\ub85c \uc18c\ud1b5\ud560 \uc218 \uc788\ub2e4\ub294 \uac83\uc740 \ub2e4\uc74c \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uc1a1\uc2e0\ud0d1 \\(k\\)\uac00 \uc874\uc7ac\ud55c\ub2e4\ub294 \uac83\uc774\ub2e4.</p> <ul> <li>\\(i &lt; k &lt; j\\)</li> <li>\\(H_i, H_j \\le H_k-D\\)</li> </ul> <p>\\(Q\\)\uac1c\uc758 \ucffc\ub9ac\uac00 \uc8fc\uc5b4\uc9c0\uba70, \\(i\\)\ubc88 \ucffc\ub9ac\uc5d0\uc11c\ub294 \\(L_i\\)\uc640 \\(R_i\\)\ubc88 \uc0ac\uc774 \uc1a1\uc2e0\ud0d1\ub4e4\ub9cc \uc774\uc6a9\ud558\uc5ec \uac04\uc12d \uc218\uce58\uac00 \\(D_i\\)\uc77c \ub54c \uba87 \uac1c\uc758 \uc1a1\uc2e0\ud0d1\ub4e4\uc744 \uc120\ud0dd\ud558\uc5ec \uc120\ud0dd\ub41c \ubaa8\ub4e0 \uc1a1\uc2e0\ud0d1\ub4e4\uc774 \uc11c\ub85c \uc18c\ud1b5 \uac00\ub2a5\ud558\ub3c4\ub85d \ud558\uace0\uc790 \ud560 \ub54c, \uc120\ud0dd\ud560 \uc218 \uc788\ub294 \uc1a1\uc2e0\ud0d1\uc758 \ucd5c\ub300 \uac1c\uc218\ub97c \uad6c\ud558\uc5ec\ub77c. \\((1 \\le i \\le Q)\\)</p>","tags":["~ solution","data_structures","greedy","pst","segtree","tree_set"]},{"location":"solutions/Olympiad/IOI/2022/D1P3%20Radio%20Towers/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(1 \\le N \\le 100,000\\)</li> <li>\\(1 \\le Q \\le 100,000\\)</li> <li>\\(1 \\le H_i \\le 10^9\\) \\((1 \\le i \\le N)\\)</li> <li>\ubaa8\ub4e0 \\(H_i\\)\ub294 \uc11c\ub85c \ub2e4\ub974\ub2e4.</li> <li>\\(1 \\le L_i \\le R_i \\le N\\), \\(1 \\le D_i \\le 10^9\\) \\((1 \\le i \\le Q)\\)</li> </ul>","tags":["~ solution","data_structures","greedy","pst","segtree","tree_set"]},{"location":"solutions/Olympiad/IOI/2022/D1P3%20Radio%20Towers/solution/#solution","title":"Solution","text":"","tags":["~ solution","data_structures","greedy","pst","segtree","tree_set"]},{"location":"solutions/Olympiad/IOI/2022/D1P3%20Radio%20Towers/solution/#subtask-2","title":"Subtask 2","text":"<ul> <li>\\(Q=1\\)</li> <li>\\(N \\le 2,000\\)</li> </ul> <p>\uc6b0\uc120, \ub450 \uc1a1\uc2e0\ud0d1 \\(i&lt;j\\)\uc774 \uc11c\ub85c \uc18c\ud1b5\ud560 \uc218 \uc788\ub2e4\ub294 \uc870\uac74\uc744 \ub2e8\uc21c\ud654\uc2dc\ud0a4\uba74 \ub2e4\uc74c\uacfc \uac19\ub2e4.</p> \\[H_i, H_j \\le max(H_{i+1}, H_{i+2}, ..., H_{j-1})-D\\] <p>\ub9cc\uc57d \uc138 \uc1a1\uc2e0\ud0d1 \\(i&lt;j&lt;k\\)\ub97c \uc120\ud0dd\ud588\uace0, \uc1a1\uc2e0\ud0d1 \\((i, j)\\), \\((j, k)\\)\ub9cc \uc11c\ub85c \uc18c\ud1b5\ud560 \uc218 \uc788\ub2e4\uace0 \ud558\uc790.</p> \\[H_i, H_j \\le max(H_{i+1}, H_{i+2}, ..., H_{j-1})-D\\] \\[H_j, H_k \\le max(H_{j+1}, H_{j+2}, ..., H_{k-1})-D\\] <p>\uc774 \ub54c, \\(max(H_{i+1}, H_{i+2}, ..., H_{k-1})\\)\ub97c \uc0dd\uac01\ud558\uba74 \ub2e4\uc74c\uc774 \uc131\ub9bd\ud55c\ub2e4.</p> \\[H_i, H_k \\le max(H_{i+1}, H_{i+2}, ..., H_{k-1})-D\\] <p>\ub530\ub77c\uc11c, \uc1a1\uc2e0\ud0d1 \\((i, j)\\), \\((j, k)\\)\ub9cc \uc11c\ub85c \uc18c\ud1b5\ud560 \uc218 \uc788\uc73c\uba74 \uc1a1\uc2e0\ud0d1 \\((i, k)\\) \ub610\ud55c \uc18c\ud1b5\ud560 \uc218 \uc788\ub2e4. \uc774\uc81c, \uc6b0\ub9ac\ub294 \uad6c\uac04 \ub0b4\uc5d0\uc11c \uc120\ud0dd\ub41c \ubaa8\ub4e0 \uc1a1\uc2e0\ud0d1\ub4e4\uc774 \uc11c\ub85c \uc18c\ud1b5 \uac00\ub2a5\ud558\ub3c4\ub85d \ud558\uace0\uc790 \ud558\ub294 \ub300\uc2e0, \uc778\uc811\ud55c \ub450 \uc120\ud0dd\ub41c \uc1a1\uc2e0\ud0d1\ub9cc \uc18c\ud1b5 \uac00\ub2a5\ud558\uba74 \ub41c\ub2e4.</p> <p>Observation 1</p> <p>\uc1a1\uc2e0\ud0d1 \\((i, j)\\), \\((j, k)\\)\ub9cc \uc11c\ub85c \uc18c\ud1b5\ud560 \uc218 \uc788\uc73c\uba74 \uc1a1\uc2e0\ud0d1 \\((i, k)\\) \ub610\ud55c \uc18c\ud1b5\ud560 \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c \uc6b0\ub9ac\ub294 \uad6c\uac04 \ub0b4\uc5d0\uc11c \uc120\ud0dd\ub41c \ubaa8\ub4e0 \uc1a1\uc2e0\ud0d1\ub4e4\uc774 \uc11c\ub85c \uc18c\ud1b5 \uac00\ub2a5\ud558\ub3c4\ub85d \ud558\uace0\uc790 \ud558\ub294 \ub300\uc2e0, \uc778\uc811\ud55c \ub450 \uc120\ud0dd\ub41c \uc1a1\uc2e0\ud0d1\ub9cc \uc18c\ud1b5 \uac00\ub2a5\ud558\uba74 \ub41c\ub2e4.</p> <p>Observation 1\uc73c\ub85c \uc778\ud574 \ud558\ub098\uc529 \uc1a1\uc2e0\ud0d1\ub4e4\uc744 \uc120\ud0dd\ud560 \ub54c, \ub9c8\uc9c0\ub9c9\uc73c\ub85c \uc120\ud0dd\ud55c \uc1a1\uc2e0\ud0d1\ub9cc \uc911\uc694\ud558\ub2c8 DP\ub97c \ud1b5\ud574 \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Definition 1</p> <p>\\(dp[i]:=\\) \\(i\\)\ubc88 \uc1a1\uc2e0\ud0d1\uc744 \ub9c8\uc9c0\ub9c9\uc73c\ub85c \uc120\ud0dd\ud558\uc600\uc744 \ub54c \uc120\ud0dd\ud560 \uc218 \uc788\ub294 \uc1a1\uc2e0\ud0d1\uc758 \ucd5c\ub300 \uac1c\uc218 \\(dp[i]= \\max_{j&lt;i}{dp[j]+1}\\) (\\((j, i)\\)\uac00 \uc11c\ub85c \uc18c\ud1b5\ud560 \uc218 \uc788\uc74c)</p> <p>Definition 1\uacfc \uac19\uc774 DP\ub97c \uc815\uc758\ud558\uba74 \uac01 \ucffc\ub9ac\ub2f9 \\(O(N^2)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\uc73c\ub2c8, \uc804\uccb4 \\(O(QN^2)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>Observation 1\uc73c\ub85c \uc778\ud574 \ud558\ub098\uc529 \uc1a1\uc2e0\ud0d1\ub4e4\uc744 \uc120\ud0dd\ud560 \ub54c, \ub9c8\uc9c0\ub9c9\uc73c\ub85c \uc120\ud0dd\ud55c \uc1a1\uc2e0\ud0d1\ub9cc \uc911\uc694\ud558\ub2c8 Definition 1\uacfc \uac19\uc740 DP\ub97c \ud1b5\ud574 \uac01 \ucffc\ub9ac\ub2f9 \\(O(N^2)\\), \uc804\uccb4 \\(O(QN^2)\\)\uc5d0 \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(QN^2)\\)</p>","tags":["~ solution","data_structures","greedy","pst","segtree","tree_set"]},{"location":"solutions/Olympiad/IOI/2022/D1P3%20Radio%20Towers/solution/#subtask-3","title":"Subtask 3","text":"<ul> <li>\\(Q=1\\)</li> </ul> <p>\uc870\uac74\uc744 \ub2e4\uc2dc \uc0b4\ud3b4\ubcf4\uba74, \uc5b4\ub5a4 \uc120\ud0dd\ub41c \ub450 \uc1a1\uc2e0\ud0d1 \\(i&lt;j\\)\uc774 \uc11c\ub85c \uc18c\ud1b5\ud560 \uc218 \uc788\uc744 \ub54c, \\(H_i, H_j \\le H_k-D\\)\ub97c \ub9cc\uc871\ud558\ub294 \\(k\\) \\((i &lt; k &lt; j)\\)\uac00 \uc874\uc7ac\ud55c\ub2e4. \uc120\ud0dd\ub41c \uc1a1\uc2e0\ud0d1\ub4e4\uc758 \uc0ac\uc774\uc0ac\uc774\uc5d0, \uc774 \ub450 \uc1a1\uc2e0\ud0d1\uc758 \uc18c\ud1b5\uc774 \uac00\ub2a5\ud558\uac8c \ud574 \uc8fc\ub294 \uc1a1\uc2e0\ud0d1 \\(k\\)\ub97c \ucd94\uac00\ud558\uba74 \uc804\uccb4 \uc120\ud0dd\ub41c \uc218\uc5f4\uc740 \ub2e4\uc74c \uc870\uac74\uc744 \ub9cc\uc871\ud55c\ub2e4.</p> <ul> <li>\uc120\ud0dd\ub41c \uc1a1\uc2e0\ud0d1\ub4e4\uc758 \ub192\uc774\ub294 \uc99d\uac00, \uac10\uc18c\uac00 \ubc18\ubcf5\ub41c\ub2e4.</li> <li>\uc778\uc811\ud55c \ub450 \uc120\ud0dd\ub41c \uc1a1\uc2e0\ud0d1\uc758 \ub192\uc774\ub294 \\(D\\) \uc774\uc0c1 \ucc28\uc774\ub09c\ub2e4.</li> </ul> <p>Observation 2</p> <p>\uc120\ud0dd\ub41c \uc1a1\uc2e0\ud0d1\ub4e4\uc758 \uc0ac\uc774\uc0ac\uc774\uc5d0, \uc774 \ub450 \uc1a1\uc2e0\ud0d1\uc758 \uc18c\ud1b5\uc774 \uac00\ub2a5\ud558\uac8c \ud574 \uc8fc\ub294 \uc1a1\uc2e0\ud0d1 \\(k\\)\ub97c \ucd94\uac00\ud558\uba74 \uc804\uccb4 \uc120\ud0dd\ub41c \uc218\uc5f4\uc740 \ub2e4\uc74c \uc870\uac74\uc744 \ub9cc\uc871\ud55c\ub2e4.</p> <ul> <li>\uc120\ud0dd\ub41c \uc1a1\uc2e0\ud0d1\ub4e4\uc758 \ub192\uc774\ub294 \uc99d\uac00, \uac10\uc18c\uac00 \ubc18\ubcf5\ub41c\ub2e4.</li> <li>\uc778\uc811\ud55c \ub450 \uc120\ud0dd\ub41c \uc1a1\uc2e0\ud0d1\uc758 \ub192\uc774\ub294 \\(D\\) \uc774\uc0c1 \ucc28\uc774\ub09c\ub2e4.</li> </ul> <p>Observation 2\uc640 \uac19\uc774 \uc120\ud0dd\ub41c \uc1a1\uc2e0\ud0d1\ub4e4\uc758 \uc0ac\uc774\uc0ac\uc774\uc5d0 \uc1a1\uc2e0\ud0d1\ub4e4\uc744 \ub07c\uc6cc \ub123\uc740 \uc218\uc5f4\uc744 DP\ub97c \ud1b5\ud574 \uad6c\ud558\uc790.</p> <p>Definition 2</p> <p>\\(dp1[i]:=\\) \\(i\\)\ubc88 \uc1a1\uc2e0\ud0d1\uc744 \ub9c8\uc9c0\ub9c9\uc73c\ub85c \uc120\ud0dd\ud558\uc600\uace0, \uc99d\uac00\ud558\ub294 \uc1a1\uc2e0\ud0d1\uc774\uc5c8\uc744 \ub54c \uc120\ud0dd\ud560 \uc218 \uc788\ub294 \uc1a1\uc2e0\ud0d1\uc758 \ucd5c\ub300 \uac1c\uc218 \\(dp2[i]:=\\) \\(i\\)\ubc88 \uc1a1\uc2e0\ud0d1\uc744 \ub9c8\uc9c0\ub9c9\uc73c\ub85c \uc120\ud0dd\ud558\uc600\uace0, \uac10\uc18c\ud558\ub294 \uc1a1\uc2e0\ud0d1\uc774\uc5c8\uc744 \ub54c \uc120\ud0dd\ud560 \uc218 \uc788\ub294 \uc1a1\uc2e0\ud0d1\uc758 \ucd5c\ub300 \uac1c\uc218</p> <p>\\(dp1[i]= \\max_{j&lt;i}{dp2[j]+1}\\) (\\(H_j+D \\le H_i\\)) \\(dp2[i]= \\max_{j&lt;i}{dp1[j]+1}\\) (\\(H_j-D \\ge H_i\\))</p> <p>Definition 2\uacfc \uac19\uc774 DP\ub97c \uc815\uc758\ud558\uba74 \uc774\uc81c inversion\uc744 \uad6c\ud558\ub294 \uac83\uacfc \uac19\uc774 Segment Tree\ub098 Fenwick Tree\ub97c \uc774\uc6a9\ud558\uc5ec \ucffc\ub9ac\ub2f9 \\(O(N\\log N)\\), \uc804\uccb4 \\(O(QN\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>Observation 2\ub85c \uc778\ud574 \uc120\ud0dd\ub41c \uc1a1\uc2e0\ud0d1\ub4e4\uc758 \uc0ac\uc774\uc0ac\uc774\uc5d0 \uc1a1\uc2e0\ud0d1\ub4e4\uc744 \ub07c\uc6cc \ub123\uc740 \uc218\uc5f4\uc758 \uae38\uc774\ub97c \ucd5c\ub300\ud654\ud558\uba74 \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4. \uc774\ub294 Definition 2\uc758 DP\ub97c \uc774\uc6a9\ud558\uba74 \ub2e8\uc21c\ud55c \ud615\ud0dc\uc758 \uc804\uc774\uc774\ub2c8 Segment Tree\ub098 Fenwick Tree\ub97c \uc774\uc6a9\ud558\uc5ec \ucffc\ub9ac\ub2f9 \\(O(N\\log N)\\), \uc804\uccb4 \\(O(QN\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(QN\\log N)\\)</p>","tags":["~ solution","data_structures","greedy","pst","segtree","tree_set"]},{"location":"solutions/Olympiad/IOI/2022/D1P3%20Radio%20Towers/solution/#subtask-5","title":"Subtask 5","text":"<ul> <li>\\(L=0, R=N-1\\)</li> </ul> <p>\uc55e\uc73c\ub85c\ub294 \uc804\uccb4 \uc1a1\uc2e0\ud0d1\ub4e4 \uc911 Observation 2\uc758 \uc120\ud0dd\ub41c \uc1a1\uc2e0\ud0d1\ub4e4\uc758 \uc0ac\uc774\uc0ac\uc774\uc5d0 \uc1a1\uc2e0\ud0d1\ub4e4\uc744 \ub07c\uc6cc \ub123\uc740 \uc218\uc5f4\uc744 \uad6c\ud558\uace0\uc790 \ud55c\ub2e4. DP \ud480\uc774\ub85c\ub294 \uac01 \ucffc\ub9ac\uc5d0 \ub300\ud574 \\(O(N)\\) \uc774\ud558\uc758 \uc2dc\uac04\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30\uc5d0\ub294 \uc5b4\ub824\uc6cc \ubcf4\uc774\ub2c8, \ucd94\uac00\uc801\uc778 \uad00\ucc30\uc744 \ud1b5\ud574 \ucd5c\uc801\ud574\uc758 \ud615\ud0dc\ub97c \ub2e8\uc21c\ud654\ud558\uc790.</p> <p>\uc804\uccb4 \uc218\uc5f4\uc744 \uc99d\uac00\ud558\ub294 \ubd80\ubd84\uacfc \uac10\uc18c\ud558\ub294 \ubd80\ubd84\uc744 \ubb36\uc5b4\uc11c \ub098\ud0c0\ub0b4\uc790. \uc5b4\ub5a4 \uc5f0\uc18d\ud55c \ubd80\ubd84\uc218\uc5f4\uc774 \uc99d\uac00\ud55c\ub2e4\uba74, Observation 2\uc5d0\uc11c \uc120\ud0dd\ub41c \uc5f0\uc18d\ud55c \\(3\\)\uac1c\uc758 \uc218\ub294 \uc99d\uac00, \uac10\uc18c\uac00 \ub2ec\ub77c\uc57c \ud558\ub2c8 \uc774 \uc99d\uac00\ud558\ub294 \uad6c\uac04\uc5d0\uc11c \\(3\\)\uac1c \uc774\uc0c1\uc758 \uc218\ub97c \uc120\ud0dd\ud560 \uc218 \uc5c6\ub2e4. \ub530\ub77c\uc11c \ucd5c\ub300 \\(2\\)\uac1c\ub97c \uc120\ud0dd\ud560 \uc218 \uc788\ub294\ub370, \uc6b0\ub9ac\ub294 \uc120\ud0dd\ud55c \uc778\uc811\ud55c \ub450 \uc218\uac00 \ucd5c\ub300\ud55c \ub9ce\uc740 \ucc28\uc774\uac00 \ub098\uae30\ub97c \uc6d0\ud558\ub2c8 \uc774 \\(2\\)\uac1c\uc758 \uc120\ud0dd\ub41c \uc218\ub97c \uac01\uac01 \uc99d\uac00 \uad6c\uac04\uc5d0\uc11c\uc758 \ucd5c\uc19f\uac12\uacfc \ucd5c\ub313\uac12\uc73c\ub85c \uc120\ud0dd\ud558\ub294 \uac83\uc774 \ucd5c\uc801\uc784\uc744 \uc54c \uc218 \uc788\ub2e4. \uc815\ub9ac\ud558\uc790\uba74, \uc6b0\ub9ac\ub294 \uc804\uccb4 \uc218\uc5f4\uc5d0\uc11c \uc99d\uac10\uc774 \ubc14\ub00c\ub294, \uc989 \\(H_{i-1}&lt;H_i&gt;H_{i+1}\\)\uc774\uac70\ub098 \\(H_{i-1}&gt;H_i&lt;H_{i+1}\\)\uc778 \uc218\ub4e4 \uc911\uc5d0\uc11c\ub9cc \uc120\ud0dd\ud558\uc5ec\ub3c4 \ucd5c\uc801\ud574\ub97c \uc5bb\uc744 \uc218 \uc788\ub2e4.</p> <p></p> <p>Observation 3</p> <p>\uc804\uccb4 \uc218\uc5f4\uc5d0\uc11c \uc99d\uac10\uc774 \ubc14\ub00c\ub294, \uc989 \\(H_{i-1}&lt;H_i&gt;H_{i+1}\\)\uc774\uac70\ub098 \\(H_{i-1}&gt;H_i&lt;H_{i+1}\\)\uc778 \uc218\ub4e4 \uc911\uc5d0\uc11c\ub9cc \uc120\ud0dd\ud558\uc5ec\ub3c4 \ucd5c\uc801\ud574\ub97c \uc5bb\uc744 \uc218 \uc788\ub2e4.</p> <p>\ub9cc\uc57d \\(D=1\\)\uc774\ub77c\uba74 \\(H_{i-1}&lt;H_i&gt;H_{i+1}\\)\uc774\uac70\ub098 \\(H_{i-1}&gt;H_i&lt;H_{i+1}\\)\ub97c \ub9cc\uc871\ud558\ub294 \uc218\ub4e4\uc744 \ubaa8\ub450 \uace0\ub978\ub2e4\uba74 Observation 2\uc758 \uc870\uac74\uc744 \uc815\ud655\ud788 \ub9cc\uc871\ud558\ub2c8 \ubc14\ub85c \ucd5c\uc801\ud574\uac00 \ub41c\ub2e4. \uc774 \ub54c, \uc67c\ucabd \ub05d\uacfc \uc624\ub978\ucabd \ub05d\uc774 \uac01\uac01 \uc99d\uac00\uc640 \uac10\uc18c\uac00 \ub418\ub3c4\ub85d \\(1\\)\uac1c\uc758 \uc218\ub294 \uc81c\uac70\ud560 \uc218 \uc788\uc74c\uc5d0 \uc8fc\uc758\ud558\uc790.</p> <p>\uc774\uc81c, \uc774 \uc0c1\ud0dc\uc5d0\uc11c \\(D\\)\ub97c \uc99d\uac00\uc2dc\ucf1c\uac00\uba70, \ucd5c\uc801\ud574\uac00 \uc5b4\ub5bb\uac8c \ubcc0\ud558\ub294\uc9c0 \uc0dd\uac01\ud558\uc790. \ucd5c\uc801\ud574\uc5d0\uc11c \uc778\uc811\ud55c \ub450 \uce78\uc758 \ucc28\uc774 \uc911 \ucd5c\uc19f\uac12\uc744 \\(K\\)\ub77c \ud560 \ub54c, \\(D \\le K\\)\uc5d0 \ub300\ud574\uc11c\ub294 \uc774 \ucd5c\uc801\ud574\uac00 Observation 2\uc758 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub2c8, \ucd5c\uc801\ud574\ub97c \uc218\uc815\ud560 \ud544\uc694\uac00 \uc5c6\ub2e4. \ud558\uc9c0\ub9cc \\(D\\)\uac00 \\(K\\)\ub97c \ub118\uc5b4\uac00\ub294 \uc21c\uac04, \ucc28\uc774\uac00 \uc815\ud655\ud788 \\(K\\)\uc778 \ub450 \uce78 \\((i, j)\\)\ub294 \ub3d9\uc2dc\uc5d0 \ucd5c\uc801\ud574\uc5d0 \uc874\uc7ac\ud560 \uc218 \uc5c6\ub2e4. \uadf8\ub798\uc11c \ud558\ub098\ub97c \uc81c\uac70\ud558\uace0 \ub098\uba74, \uc544\ub798 \uadf8\ub9bc\uacfc \uac19\uc774 \ub098\uba38\uc9c0 \ud558\ub098 \ub610\ud55c \ubb34\uc870\uac74 \uc81c\uac70\ud574\uc57c \ud558\uace0, \uacb0\ub860\uc801\uc73c\ub85c\ub294 \\(i\\)\uc640 \\(j\\) \ubaa8\ub450 \uc81c\uac70\ud574\uc57c \ud55c\ub2e4. \ub610\ud55c, \uc774 \ub450 \uc218\ub97c \uc81c\uac70\ud55c\ub2e4\uace0 \ud574\ub3c4, \uc560\ucd08\uc5d0 \\(K\\)\uac00 \uc778\uc811\ud55c \ub450 \uce78\uc758 \ucc28\uc774\uc758 \ucd5c\uc19f\uac12\uc774\uc5c8\uae30 \ub54c\ubb38\uc5d0 \ub0a8\uc740 \ucd5c\uc801\ud574\uc5d0\uc11c \uc778\uc811\ud55c \ub450 \uce78\uc758 \ucc28\uc774 \ub610\ud55c \\(K\\)\uc774\uc0c1\uc73c\ub85c \uc720\uc9c0\ub41c\ub2e4.</p> <p></p> <p>\ub530\ub77c\uc11c, \uacb0\ub860\uc801\uc73c\ub85c\ub294 \\(D\\)\uac00 \\(K\\)\ub97c \ub118\uc5b4\uac00\ub294 \uc21c\uac04, \ucc28\uc774\uac00 \uc815\ud655\ud788 \\(K\\)\uc778 \ub450 \uce78 \\((i, j)\\)\uc744 \uc81c\uac70\ud558\uba74 \uc0c8\ub85c\uc6b4 \ucd5c\uc801\ud574\ub97c \uc5bb\uc744 \uc218 \uc788\ub2e4. \uc774 \uacfc\uc815\uc744 set\uc744 \uc774\uc6a9\ud558\uc5ec \uad00\ub9ac\ud560 \uc218 \uc788\uace0, \\(D\\)\ub97c \uc99d\uac00\uc2dc\ud0a4\uba70 \uc2dc\uac04\uc5d0 \ub530\ub77c \uc0ad\uc81c\ub418\ub294 \uc810\ub4e4\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4. \ucffc\ub9ac\uac00 \uc8fc\uc5b4\uc9c0\uba74, \\(D\\) \ubbf8\ub9cc\uc758 \uc2dc\uac04\uc5d0 \uc0ad\uc81c\ub41c \uc810\ub4e4\uc758 \uac1c\uc218\ub97c \uc138\uba74 \ub418\ub2c8 Set\uacfc \uc774\ubd84\ud0d0\uc0c9\uc744 \uc774\uc6a9\ud558\uc5ec \\(L=0, R=N-1\\)\uc73c\ub85c \uace0\uc815\ub41c \uc0c1\ud0dc\uc5d0\uc11c\ub294 \\(O((N+Q)\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>Observation 3\uc5d0 \uc758\ud574 \uc99d\uac10\uc774 \ubc14\ub00c\ub294, \uc989 \\(H_{i-1}&lt;H_i&gt;H_{i+1}\\)\uc774\uac70\ub098 \\(H_{i-1}&gt;H_i&lt;H_{i+1}\\)\uc778 \uc218\ub4e4 \uc911\uc5d0\uc11c\ub9cc \uc120\ud0dd\ud558\uc5ec\ub3c4 \ucd5c\uc801\ud574\ub97c \uc5bb\uc744 \uc218 \uc788\ub2e4. \\(D=1\\)\uc77c \ub54c\ub294 \uc774\ub97c \ubaa8\ub450 \uc120\ud0dd\ud558\uba74 \ucd5c\uc801\ud574\uc774\uace0, \\(D\\)\ub97c \uc99d\uac00\uc2dc\ucf1c\uac00\uba70 \ucd5c\uc801\ud574\uc758 \ubcc0\ud654\ub97c \uad6c\ud55c\ub2e4. \ucd5c\uc801\ud574\uc5d0\uc11c \uc778\uc811\ud55c \ub450 \uce78\uc758 \ucc28\uc774 \uc911 \ucd5c\uc19f\uac12\uc744 \\(K\\)\ub77c \ud560 \ub54c, \\(D\\)\uac00 \\(K\\)\ub97c \ub118\uc5b4\uac00\ub294 \uc21c\uac04, \ucc28\uc774\uac00 \uc815\ud655\ud788 \\(K\\)\uc778 \ub450 \uce78 \\((i, j)\\)\uc744 \uc81c\uac70\ud558\uba74 \uc0c8\ub85c\uc6b4 \ucd5c\uc801\ud574\ub97c \uc5bb\uc744 \uc218 \uc788\ub2e4. \uc774 \uacfc\uc815\uc744 set\uc744 \uc774\uc6a9\ud558\uc5ec \uad00\ub9ac\ud560 \uc218 \uc788\uace0, \\(D\\)\ub97c \uc99d\uac00\uc2dc\ud0a4\uba70 \uc2dc\uac04\uc5d0 \ub530\ub77c \uc0ad\uc81c\ub418\ub294 \uc810\ub4e4\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4. \ucffc\ub9ac\uac00 \uc8fc\uc5b4\uc9c0\uba74, \\(D\\) \ubbf8\ub9cc\uc758 \uc2dc\uac04\uc5d0 \uc0ad\uc81c\ub41c \uc810\ub4e4\uc758 \uac1c\uc218\ub97c \uc138\uba74 \ub418\ub2c8 Set\uacfc \uc774\ubd84\ud0d0\uc0c9\uc744 \uc774\uc6a9\ud558\uc5ec \\(L=0, R=N-1\\)\uc73c\ub85c \uace0\uc815\ub41c \uc0c1\ud0dc\uc5d0\uc11c\ub294 \\(O((N+Q)\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O((N+Q)\\log N)\\)</p>","tags":["~ solution","data_structures","greedy","pst","segtree","tree_set"]},{"location":"solutions/Olympiad/IOI/2022/D1P3%20Radio%20Towers/solution/#subtask-6-full","title":"Subtask 6 (Full)","text":"<p>\\(L=0, R=N-1\\)\uc774 \uc544\ub2c8\ub77c\uace0 \ud574\ub3c4 \ud480\uc774\uc758 \ud070 \ud2c0\uc740 \ubcc0\ud558\uc9c0 \uc54a\ub294\ub2e4. \uc774\uc81c \uad6c\uac04 \\([L, R]\\)\uc5d0 \ud3ec\ud568\ub418\uba70, \\(D\\) \ubbf8\ub9cc\uc758 \uc2dc\uac04\uc5d0 \uc0ad\uc81c\ub41c \uc810\ub4e4\uc758 \uac1c\uc218\ub97c \uc138\uc57c \ud55c\ub2e4. \uac01 \uc810\uc758 \uc0ad\uc81c \uc2dc\uac04\uc744 \\(T_i\\)\ub77c \ud558\uba74 \\(L \\le i \\le R\\), \\(T_i &lt;D\\)\uc778 \uc810\uc758 \uc218\ub97c \uc138\ub294 \uac83\uc740 2\ucc28\uc6d0 \ud3c9\uba74\uc5d0\uc11c \uc9c1\uc0ac\uac01\ud615 \uc601\uc5ed\uc5d0 \uc788\ub294 \uc810\uc758 \uc218\ub97c \uc138\ub294 \ubb38\uc81c\uc774\ub2c8 Persistent Segment Tree\ub97c \uc774\uc6a9\ud558\uc5ec \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\ud558\uc9c0\ub9cc \ub610 \ud558\ub098 \uace0\ub824\ud574\uc57c \ud560 \uac83\uc740, \uad6c\uac04\uc758 \uac00\uc7a5 \uc67c\ucabd\uacfc \uc624\ub978\ucabd \uc810\uc740 \uac01\uac01 \uc99d\uac00, \uac10\uc18c\ud574\uc57c \ud55c\ub2e4\ub294 \uc870\uac74\uc774\ub2e4. \uad6c\uac04\uc5d0 \ud3ec\ud568\ub418\uace0 \uc544\uc9c1 \uc0ad\uc81c\ub418\uc9c0 \uc54a\uc740 \uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(S\\)\ub77c \ud55c\ub2e4\uba74, \\(S\\)\uc758 \uc67c\ucabd\uc774\ub098 \uc624\ub978\ucabd\uc5d0 \uc5b4\ub5a4 \uc810\uc744 \ucd94\uac00\ud558\uc5ec \ub2f5\uc774 \ub354 \ucee4\uc9c8\uc218\ub3c4 \uc788\uace0, \uc774\ub97c \uac80\uc0ac\ud574\uc57c \ud55c\ub2e4. \uc774\ub97c \uac80\uc0ac\ud558\uae30 \uc704\ud574\uc11c\ub294 \uad6c\uac04\uc5d0 \ud3ec\ud568\ub418\uace0 \uc544\uc9c1 \uc0ad\uc81c\ub418\uc9c0 \uc54a\uc740 \uc810\ub4e4 \uc911 \uac00\uc7a5 \uc67c\ucabd \uc810, \uac00\uc7a5 \uc624\ub978\ucabd \uc810\uc744 \uad6c\ud574\uc57c \ud55c\ub2e4. \uc774\ub294 \\(T_i \\ge D\\), \\(L \\le i\\)\uc778 \\(i\\) \uc911 \ucd5c\uc19f\uac12\uc744 \uad6c\ud558\ub294 \ubb38\uc81c\uc774\ub2c8, Segment Tree \uc704\uc5d0\uc11c\uc758 \uc774\ubd84\ud0d0\uc0c9\uc744 \ud1b5\ud574 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\ub530\ub77c\uc11c, Persistent Segment Tree\uc640 Segment Tree \uc704\uc5d0\uc11c\uc758 \uc774\ubd84\ud0d0\uc0c9\uc744 \ud1b5\ud574 \uac01 \ucffc\ub9ac\ub2f9 \\(O(\\log N)\\), \uc804\uccb4 \\(O((N+Q)\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>\\(L=0, R=N-1\\)\uc774 \uc544\ub2c8\uba74 \uad6c\uac04 \\([L, R]\\)\uc5d0 \ud3ec\ud568\ub418\uba70, \\(D\\) \ubbf8\ub9cc\uc758 \uc2dc\uac04\uc5d0 \uc0ad\uc81c\ub41c \uc810\ub4e4\uc758 \uac1c\uc218\ub97c \uc138\uc57c \ud55c\ub2e4. \uac01 \uc810\uc758 \uc0ad\uc81c \uc2dc\uac04\uc744 \\(T_i\\)\ub77c \ud558\uba74 \\(L \\le i \\le R\\), \\(T_i &lt;D\\)\uc778 \uc810\uc758 \uc218\ub97c \uc138\ub294 \uac83\uc740 2\ucc28\uc6d0 \ud3c9\uba74\uc5d0\uc11c \uc9c1\uc0ac\uac01\ud615 \uc601\uc5ed\uc5d0 \uc788\ub294 \uc810\uc758 \uc218\ub97c \uc138\ub294 \ubb38\uc81c\uc774\ub2c8 Persistent Segment Tree\ub97c \uc774\uc6a9\ud558\uc5ec \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\ub610\ud55c, \uad6c\uac04\uc758 \uac00\uc7a5 \uc67c\ucabd\uacfc \uc624\ub978\ucabd \uc810\uc740 \uac01\uac01 \uc99d\uac00, \uac10\uc18c\ud574\uc57c \ud55c\ub2e4\ub294 \uc870\uac74 \ub54c\ubb38\uc5d0 \uad6c\uac04\uc5d0 \ud3ec\ud568\ub418\uace0 \uc544\uc9c1 \uc0ad\uc81c\ub418\uc9c0 \uc54a\uc740 \uc810\ub4e4\uc758 \uc9d1\ud569\uc744 \\(S\\)\ub77c \ud55c\ub2e4\uba74, \\(S\\)\uc758 \uc67c\ucabd\uc774\ub098 \uc624\ub978\ucabd\uc5d0 \uc5b4\ub5a4 \uc810\uc744 \ucd94\uac00\ud558\uc5ec \ub2f5\uc774 \ub354 \ucee4\uc9c8\uc218\ub3c4 \uc788\uace0, \uc774\ub97c \uac80\uc0ac\ud574\uc57c \ud55c\ub2e4. \uc774\ub97c \uac80\uc0ac\ud558\uae30 \uc704\ud574\uc11c\ub294 \uad6c\uac04\uc5d0 \ud3ec\ud568\ub418\uace0 \uc544\uc9c1 \uc0ad\uc81c\ub418\uc9c0 \uc54a\uc740 \uc810\ub4e4 \uc911 \uac00\uc7a5 \uc67c\ucabd \uc810, \uac00\uc7a5 \uc624\ub978\ucabd \uc810\uc744 \uad6c\ud574\uc57c \ud55c\ub2e4. \uc774\ub294 \\(T_i \\ge D\\), \\(L \\le i\\)\uc778 \\(i\\) \uc911 \ucd5c\uc19f\uac12\uc744 \uad6c\ud558\ub294 \ubb38\uc81c\uc774\ub2c8, Segment Tree \uc704\uc5d0\uc11c\uc758 \uc774\ubd84\ud0d0\uc0c9\uc744 \ud1b5\ud574 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\ub530\ub77c\uc11c, Persistent Segment Tree\uc640 Segment Tree \uc704\uc5d0\uc11c\uc758 \uc774\ubd84\ud0d0\uc0c9\uc744 \ud1b5\ud574 \uac01 \ucffc\ub9ac\ub2f9 \\(O(\\log N)\\), \uc804\uccb4 \\(O((N+Q)\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O((N+Q)\\log N)\\)</p>","tags":["~ solution","data_structures","greedy","pst","segtree","tree_set"]},{"location":"solutions/Olympiad/IOI/2022/D1P3%20Radio%20Towers/solution/#code","title":"Code","text":"<pre><code>#include \"towers.h\"\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 1e5;\nconst int INF = 1e9+7;\n\nint N, A[MAXN+10], B[MAXN+10], P[MAXN+10];\nvector&lt;int&gt; comp;\n\nstruct SEG\n{\n    int tree[MAXN*4+10];\n    void init(int node, int tl, int tr)\n    {\n        if(tl==tr)\n        {\n            tree[node]=A[tl];\n            return;\n        }\n        int mid=tl+tr&gt;&gt;1;\n        init(node*2, tl, mid);\n        init(node*2+1, mid+1, tr);\n        tree[node]=min(tree[node*2], tree[node*2+1]);\n    }\n    int query(int node, int tl, int tr, int l, int r)\n    {\n        if(r&lt;tl || tr&lt;l) return INF;\n        if(l&lt;=tl &amp;&amp; tr&lt;=r) return tree[node];\n        int mid=tl+tr&gt;&gt;1;\n        return min(query(node*2, tl, mid, l, r), query(node*2+1, mid+1, tr, l, r));\n    }\n}seg;\n\nstruct SEG2\n{\n    int tree[MAXN*4+10];\n    void init(int node, int tl, int tr)\n    {\n        if(tl==tr)\n        {\n            tree[node]=P[tl];\n            return;\n        }\n        int mid=tl+tr&gt;&gt;1;\n        init(node*2, tl, mid);\n        init(node*2+1, mid+1, tr);\n        tree[node]=max(tree[node*2], tree[node*2+1]);\n    }\n    int query1(int node, int tl, int tr, int l, int r, int D)\n    {\n        if(r&lt;tl || tr&lt;l) return -1;\n        if(l&lt;=tl &amp;&amp; tr&lt;=r &amp;&amp; tree[node]&lt;D) return -1;\n        if(tl==tr) return tl;\n        int mid=tl+tr&gt;&gt;1;\n        int ret=query1(node*2, tl, mid, l, r, D);\n        if(ret!=-1) return ret;\n        ret=query1(node*2+1, mid+1, tr, l, r, D);\n        return ret;\n    }\n    int query2(int node, int tl, int tr, int l, int r, int D)\n    {\n        if(r&lt;tl || tr&lt;l) return -1;\n        if(l&lt;=tl &amp;&amp; tr&lt;=r &amp;&amp; tree[node]&lt;D) return -1;\n        if(tl==tr) return tl;\n        int mid=tl+tr&gt;&gt;1;\n        int ret=query2(node*2+1, mid+1, tr, l, r, D);\n        if(ret!=-1) return ret;\n        ret=query2(node*2, tl, mid, l, r, D);\n        return ret;\n    }\n}seg2;\n\nstruct PST\n{\n    struct Node\n    {\n        int val, lc, rc;\n        Node() : val(0), lc(-1), rc(-1) {}\n    };\n    vector&lt;Node&gt; NS;\n    int tree[MAXN+10];\n\n    int newNode()\n    {\n        NS.push_back(Node());\n        return NS.size()-1;\n    }\n\n    int makeTree(int tl, int tr)\n    {\n        int node=newNode();\n        if(tl==tr) return node;\n        int mid=tl+tr&gt;&gt;1;\n        NS[node].lc=makeTree(tl, mid);\n        NS[node].rc=makeTree(mid+1, tr);\n        return node;\n    }\n\n    int addTree(int node, int tl, int tr, int p)\n    {\n        if(p&lt;tl || tr&lt;p) return node;\n        int now=newNode();\n        if(tl==tr)\n        {\n            NS[now].val=NS[node].val+1;\n            return now;\n        }\n        int mid=tl+tr&gt;&gt;1;\n        NS[now].lc=addTree(NS[node].lc, tl, mid, p);\n        NS[now].rc=addTree(NS[node].rc, mid+1, tr, p);\n        NS[now].val=NS[NS[now].lc].val+NS[NS[now].rc].val;\n        return now;\n    }\n\n    int query(int node, int tl, int tr, int l, int r)\n    {\n        if(l&lt;=tl &amp;&amp; tr&lt;=r) return NS[node].val;\n        if(r&lt;tl || tr&lt;l) return 0;\n        int mid=tl+tr&gt;&gt;1;\n        return query(NS[node].lc, tl, mid, l, r)+query(NS[node].rc, mid+1, tr, l, r);\n    }\n}pst;\n\nvoid init(int _N, vector&lt;int&gt; _H)\n{\n    N=_N;\n    for(int i=1; i&lt;=N; i++) A[i]=_H[i-1];\n    seg.init(1, 1, N);\n\n    vector&lt;int&gt; V;\n    V.push_back(1);\n    for(int i=2; i&lt;=N; i++)\n    {\n        if(V.size()%2)\n        {\n            if(A[V.back()]&lt;A[i]) V.push_back(i);\n            else V.back()=i;\n        }\n        else\n        {\n            if(A[V.back()]&gt;A[i]) V.push_back(i);\n            else V.back()=i;\n        }\n    }\n    if(V.size()%2==0) V.pop_back();\n\n    set&lt;int&gt; S;\n    set&lt;pii&gt; S2;\n    for(int i=0; i&lt;V.size(); i++)\n    {\n        S.insert(V[i]);\n        if(i%2==0) B[V[i]]=1;\n        else B[V[i]]=2;\n    }\n    for(int i=0; i+1&lt;V.size(); i++) S2.insert({abs(A[V[i+1]]-A[V[i]]), V[i]});\n\n    while(!S2.empty())\n    {\n        auto [val, p] = *S2.begin(); S2.erase(S2.begin());\n        auto it=S.find(p);\n        int l=-1, r=-1;\n\n        if(it!=S.begin())\n        {\n            int t1=*prev(it), t2=*it;\n            S2.erase({abs(A[t1]-A[t2]), t1});\n            l=t1;\n        }\n        if(next(next(it))!=S.end())\n        {\n            int t1=*next(it), t2=*next(next(it));\n            S2.erase({abs(A[t1]-A[t2]), t1});\n            r=t2;\n        }\n        if(l!=-1 &amp;&amp; r!=-1) S2.insert({abs(A[r]-A[l]), l});\n\n        P[*next(it)]=val; P[*it]=val;\n        S.erase(*next(it));\n        S.erase(it);\n    }\n\n    for(int i=1; i&lt;=N; i++) comp.push_back(P[i]);\n    sort(comp.begin(), comp.end());\n    comp.erase(unique(comp.begin(), comp.end()), comp.end());\n\n    pst.tree[0]=pst.makeTree(1, comp.size());\n    for(int i=1; i&lt;=N; i++) \n    {\n        pst.tree[i]=pst.addTree(pst.tree[i-1], 1, comp.size(), lower_bound(comp.begin(), comp.end(), P[i])-comp.begin()+1);\n    }\n\n    seg2.init(1, 1, N);\n}\n\nint max_towers(int L, int R, int D) \n{\n    L++; R++;\n\n    int t=lower_bound(comp.begin(), comp.end(), D)-comp.begin()+1;\n    int ans=pst.query(pst.tree[R], 1, comp.size(), t, comp.size())-pst.query(pst.tree[L-1], 1, comp.size(), t, comp.size());\n\n    if(!ans) return 1;\n\n    int p=seg2.query1(1, 1, N, L, R, D), q=seg2.query2(1, 1, N, L, R, D);\n    if(B[p]==2)\n    {\n        if(seg.query(1, 1, N, L, p-1)&lt;=A[p]-D) ans++;\n        else ans--;\n    }\n    if(B[q]==2)\n    {\n        if(seg.query(1, 1, N, q+1, R)&lt;=A[q]-D) ans++;\n        else ans--;\n    }\n    return ans/2+1;\n}\n</code></pre>","tags":["~ solution","data_structures","greedy","pst","segtree","tree_set"]},{"location":"solutions/Olympiad/JOISC/2023/D1P1%20Two%20Currencies/solution/","title":"JOISC 2023 D1P1 Two Currencies","text":"","tags":["binary_search","data_structures","euler_tour_technique","lca","offline_queries","pbs","pst","segtree","trees","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P1%20Two%20Currencies/solution/#problem","title":"Problem","text":"","tags":["binary_search","data_structures","euler_tour_technique","lca","offline_queries","pbs","pst","segtree","trees","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P1%20Two%20Currencies/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/27992 https://oj.uz/problem/view/JOI23_currencies</p>","tags":["binary_search","data_structures","euler_tour_technique","lca","offline_queries","pbs","pst","segtree","trees","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P1%20Two%20Currencies/solution/#summary","title":"Summary","text":"<p>\uc815\uc810 \\(N\\)\uac1c\uc758 \ud2b8\ub9ac\uac00 \uc8fc\uc5b4\uc9c0\uace0, \\(M\\)\uac1c\uc758 \uac04\uc120\uc740 \uc9c0\ub098\ub824\uba74 \ud1b5\ud589\ub8cc\ub97c \ub0b4\uc57c \ud55c\ub2e4. \\(P_i\\)\ubc88\uc9f8 \uac04\uc120\uc744 \ud1b5\uacfc\ud558\uae30 \uc704\ud574\uc11c\ub294 \\(1\\)\uac1c\uc758 \uae08\ud654\ub97c \ub0b4\uac70\ub098, \\(C_i\\)\uac1c\uc758 \uc740\ud654\ub97c \ub0b4\uc57c \ud55c\ub2e4. \\((1 \\leq i \\leq M)\\) \\(Q\\)\uac1c\uc758 \ucffc\ub9ac\uac00 \uc8fc\uc5b4\uc9c0\uba70, \\(i\\)\ubc88 \ucffc\ub9ac\uc5d0\uc11c\ub294 \\(S_i\\)\ubc88 \uc815\uc810\uc5d0\uc11c \\(T_i\\)\ubc88 \uc815\uc810\uc73c\ub85c \uae08\ud654 \\(X_i\\)\uac1c, \uc740\ud654 \\(Y_i\\)\uac1c\ub97c \uac16\uace0 \uc774\ub3d9\ud558\ub824 \ud55c\ub2e4. \\((1 \\leq i \\leq Q)\\) \uc774 \ub54c, \uc774\ub3d9\uc774 \uac00\ub2a5\ud55c\uc9c0 \ud310\ubcc4\ud558\uace0, \uac00\ub2a5\ud558\ub2e4\uba74 \ub0a8\ub294 \uae08\ud654\uc758 \uac1c\uc218\uc758 \ucd5c\ub313\uac12\uc744 \uad6c\ud558\uc5ec\ub77c.</p>","tags":["binary_search","data_structures","euler_tour_technique","lca","offline_queries","pbs","pst","segtree","trees","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P1%20Two%20Currencies/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(2 \\leq N \\leq 100,000\\)</li> <li>\\(1 \\leq M \\leq 100,000\\)</li> <li>\\(1 \\leq Q \\leq 100,000\\)</li> <li>\\(1 \\leq P_j \\leq N-1\\), \\(1 \\leq C_j \\leq 10^9\\) \\((1 \\leq j \\leq M)\\)</li> <li>\\(1 \\leq S_k, T_k \\leq N\\), \\(0 \\leq X_k \\leq 10^9\\), \\(0 \\leq Y_k \\leq 10^{18}\\) \\((1 \\leq k \\leq Q)\\)</li> </ul>","tags":["binary_search","data_structures","euler_tour_technique","lca","offline_queries","pbs","pst","segtree","trees","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P1%20Two%20Currencies/solution/#solution","title":"Solution","text":"","tags":["binary_search","data_structures","euler_tour_technique","lca","offline_queries","pbs","pst","segtree","trees","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P1%20Two%20Currencies/solution/#subtask-1","title":"Subtask 1","text":"<ul> <li>\\(N \\leq 2000\\), \\(M \\leq 2000\\), \\(Q \\leq 2000\\)</li> </ul> <p>\ud55c \ucffc\ub9ac\uc5d0\uc11c \uc774\ub3d9\ud558\ub294 \uacbd\ub85c\uc5d0 \uc788\ub294 \ubaa8\ub4e0 \ud1b5\ud589\ub8cc\ub4e4\uc744 \ubaa8\uc544\uc11c \uc0dd\uac01\ud558\uc790. \ud1b5\ud589\ub8cc\ub4e4\uc758 \ubc30\uc5f4 \\(C_i\\)\ub294 \uae08\ud654 \\(1\\)\uac1c\ub97c \ub0b4\uac70\ub098, \uc740\ud654 \\(C_i\\)\uac1c\ub97c \ub0b4\uc57c \ud568\uc744 \uc758\ubbf8\ud55c\ub2e4. \uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 \uc740\ud654\uc758 \ucd1d \uac1c\uc218\uac00 \uc815\ud574\uc9c4 \uc0c1\ud0dc\uc5d0\uc11c, \uae08\ud654\ub97c \ucd5c\ub300\ud55c \uc801\uac8c \uc0ac\uc6a9\ud558\ub294 \uac83\uc774 \ubaa9\uc801\uc774\ub2c8, \\(C_i\\)\uac00 \uc791\uc740 \ud1b5\ud589\ub8cc\ubd80\ud130 \uc608\uc0b0\uc774 \ubc14\ub2e5\ub0a0 \ub54c\uae4c\uc9c0 \uc740\ud654\ub85c \uc9c0\ubd88\ud558\uace0, \ub098\uba38\uc9c0\ub97c \uae08\ud654\ub85c \uc9c0\ubd88\ud558\ub294 \uac83\uc774 \ucd5c\uc120\uc774\ub2e4.</p> <p>Observation 1</p> <p>\ud55c \ucffc\ub9ac \\(k\\)\uc5d0\uc11c \uacbd\ub85c\uc5d0 \uc788\ub294 \ubaa8\ub4e0 \ud1b5\ud589\ub8cc\ub4e4\uc744 \\(C_i\\)\uc758 \uc21c\uc11c\ub300\ub85c \uc815\ub82c\ud55c \ud6c4, \\(C_i\\)\uac00 \uc791\uc740 \ud1b5\ud589\ub8cc\ubd80\ud130 \uc21c\uc11c\ub300\ub85c \ud569\uc774 \\(Y_k\\)\uc774\ud558\uc77c \ub54c\uae4c\uc9c0 \ucd5c\ub300\ud55c \ub354\ud558\uace0 \ub0a8\uc740 \ud1b5\ud589\ub8cc\ub4e4\uc744 \uae08\ud654\ub85c \uc9c0\ubd88\ud558\ub294 \uac83\uc774 \ucd5c\uc801\ud574\uc774\ub2e4.</p> <p>Observation 1\uc744 \uc774\uc6a9\ud558\uc5ec Naive\ud558\uac8c \uac01 \ucffc\ub9ac\ub9c8\ub2e4 \uacbd\ub85c\ub97c \ub530\ub77c \ubaa8\ub4e0 \ud1b5\ud589\ub8cc\ub4e4\uc758 \ubc30\uc5f4\uc744 \uc5bb\uace0, \uc815\ub82c\ud558\uc5ec \ub2f5\uc744 \uacc4\uc0b0\ud558\uba74 \\(O(Q(N+M))\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>Observation 1\uc744 \uc774\uc6a9\ud558\uc5ec Naive\ud558\uac8c \uad6c\ud604\ud558\uba74 \\(O(Q(N+M))\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(Q(N+M))\\)</p>","tags":["binary_search","data_structures","euler_tour_technique","lca","offline_queries","pbs","pst","segtree","trees","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P1%20Two%20Currencies/solution/#subtask-4-full","title":"Subtask 4 (Full)","text":"<p>\\(N\\), \\(Q\\), \\(M\\)\uc774 \ud074 \ub54c\uc5d0\ub294 \uc9c1\uc811 \\(C_i\\)\ub4e4\uc744 \uc815\ub82c\ud558\uc5ec \ub2f5\uc744 \uad6c\ud560 \uc218 \uc5c6\ub2e4. \uc9c1\uc811 \uc815\ub82c\ud558\uc9c0 \uc54a\uace0, Observation 1\uc758, \\(C_i\\)\uac00 \uc791\uc740 \uac12\ub4e4\ubd80\ud130 \uc774\uc6a9\ud574\uc57c \ud55c\ub2e4\ub294 \uc870\uac74\uc744 \uc5b4\ub5bb\uac8c \ud65c\uc6a9\ud558\uba74 \uc88b\uc744\uae4c?</p> <p>\uc774\ubd84\ud0d0\uc0c9\uc744 \ud1b5\ud574 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4. \uc6b0\uc120, \ud3b8\uc758\ub97c \uc704\ud558\uc5ec \ubaa8\ub4e0 \\(C_i\\)\uac00 \uc11c\ub85c \ub2e4\ub974\ub2e4\uace0 \uac00\uc815\ud55c\ub2e4. \\(C_i \\leq T\\)\uc778 \ud1b5\ud589\ub8cc\ub4e4\uc758 \ud569\uc744 \uad6c\ud558\uc5ec \ud1b5\ud589\ub8cc\ub4e4\uc758 \ud569\uc774 \\(Y_k\\)\ubcf4\ub2e4 \uc791\uac70\ub098 \uac19\uc740 \\(T\\)\uc758 \ucd5c\ub313\uac12\uc744 \uad6c\ud558\uba74, \\(C_i \\leq T\\)\uc778 \ud1b5\ud589\ub8cc\ub4e4\uc758 \uac1c\uc218\uac00 \uace7 \uc740\ud654\ub85c \uc9c0\ubd88\ud560 \uc218 \uc788\ub294 \ud1b5\ud589\ub8cc\ub4e4\uc758 \uc218\ub97c \uc758\ubbf8\ud55c\ub2e4. \uc774\uc81c \uacbd\ub85c \\((S_k, T_k)\\) \uc5d0 \uc788\ub294 \ud1b5\ud589\ub8cc\ub4e4 \uc911 \\(T\\) \uc774\ud558\uc778 \uac83\ub4e4\uc758 \ud569, \ud639\uc740 \uac1c\uc218\uc5d0 \ub300\ud55c \ucffc\ub9ac\uc5d0 \ube60\ub978 \uc2dc\uac04 \uc548\uc5d0 \ub2f5\ud560 \uc218 \uc788\ub2e4\uba74, \uc774 \uacb0\uacfc\ub97c \uc774\uc6a9\ud558\uc5ec \uc774\ubd84\ud0d0\uc0c9\uc744 \ud1b5\ud574 \ub2f5\uc744 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>\uacbd\ub85c \\((S_k, T_k)\\) \uc5d0 \uc788\ub294 \ud1b5\ud589\ub8cc\ub4e4 \uc911 \\(T\\) \uc774\ud558\uc778 \uac83\ub4e4\uc758 \ud569, \ud639\uc740 \uac1c\uc218\uc5d0 \ub300\ud55c \ucffc\ub9ac\uc5d0 \ube60\ub978 \uc2dc\uac04 \uc548\uc5d0 \ub2f5\ud560 \uc218 \uc788\ub2e4\uace0 \uac00\uc815\ud558\uc790. \\(C_i \\leq T\\)\uc778 \ud1b5\ud589\ub8cc\ub4e4\uc758 \ud569\uc774 \\(Y_k\\)\ubcf4\ub2e4 \uc791\uac70\ub098 \uac19\uc740 \\(T\\)\uc758 \ucd5c\ub313\uac12\uc744 \uc774\ubd84\ud0d0\uc0c9\uc73c\ub85c \uad6c\ud558\uc5ec \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\ub8e8\ud2b8\uc5d0\uc11c \uc784\uc758\uc758 \uc815\uc810\uae4c\uc9c0\uc758 \uacbd\ub85c\uc5d0\uc11c \\(T\\)\uc774\ud558\uc778 \uc218\ub4e4\uc758 \uac1c\uc218\ub098 \ud569\uc740 Persistent Segment Tree\ub97c \ud65c\uc6a9\ud558\uc5ec \uad6c\ud560 \uc218 \uc788\ub2e4. \ud2b8\ub9ac\uc5d0\uc11c DFS\ub97c \ub3cc\uba70, \uc790\uc2dd\uc758 PST\ub294 \ubd80\ubaa8\uc758 PST\uc5d0 \uac04\uc120\uc774 \uc9c0\ub098\ub294 \\(C_i\\)\ub97c \ucd94\uac00\ud55c \ud615\ud0dc\ub85c PST\ub97c \uad6c\uc131\ud55c \ud6c4, \uacbd\ub85c \\((S_k, T_k)\\)\uc758 \ucffc\ub9ac\ub294 \\(S_k\\), \\(T_k\\), \\(lca\\) \uc5d0\uc11c\uc758 \\(T\\)\uc5d0 \ub300\ud55c \ucffc\ub9ac\ub97c \ub0a0\ub824 \uad6c\ud560 \uc218 \uc788\ub2e4. \uc774\ubd84\ud0d0\uc0c9\uc5d0 \\(O(\\log Y)\\), PST \ucffc\ub9ac\uc5d0\uc11c \\(O(\\log M)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub9ac\ub2c8, \uc804\uccb4 \\(O(N\\log N+M+Q\\log Y\\log M)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>\ud544\uc694\ud55c \ucffc\ub9ac\ub294 \ud2b8\ub9ac\uc5d0\uc11c\uc758 Persistent Segment Tree\ub97c \uc774\uc6a9\ud558\uc5ec \uad6c\ud560 \uc218 \uc788\ub2e4. \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(N\\log N+M+Q\\log Y\\log M)\\)\uc774\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N\\log N+M+Q\\log Y\\log M)\\)</p> <p>\ubaa8\ub4e0 \ucffc\ub9ac\uac00 \uc624\ud504\ub77c\uc778\uc784\uc744 \uc774\uc6a9\ud558\uba74 \uc0c1\uc218\uac00 \ud070 PST\ub97c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\uace0\ub3c4 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4. \\(Q\\)\ubc88\uc758 \uc774\ubd84\ud0d0\uc0c9\uc744 \ud574\uc57c \ud558\ub2c8, Parallel Binary Search\ub97c \uc0ac\uc6a9\ud558\uc790.</p> <p>\ubaa8\ub4e0 \ucffc\ub9ac\uc5d0 \ub300\ud558\uc5ec \ub3d9\uc2dc\uc5d0 \uc774\ubd84\ud0d0\uc0c9\uc744 \ud558\uace0, \ud55c \ubc88 \uc774\ubd84\ud0d0\uc0c9\uc744 \ud560 \ub54c \\(T\\)\uc640 \\(C_i\\)\ub4e4\uc744 \uc815\ub82c\ud55c\ub2e4. \uc815\ub82c\ub41c \uc21c\uc11c\ub300\ub85c \ud2b8\ub9ac\uc5d0 \uac04\uc120 \uac00\uc911\uce58 \uc5c5\ub370\uc774\ud2b8, \uacbd\ub85c\uc758 \uac00\uc911\uce58 \ud569\uc744 \uad6c\ud560 \uc218 \uc788\uc5b4\uc57c \ud55c\ub2e4. \uc774\ub294 Euler Tree Trick\uc744 \uc0ac\uc6a9\ud574\uc11c \ud2b8\ub9ac\ub97c \uc77c\uc9c1\uc120\uc73c\ub85c \ud540 \ud6c4, \uad6c\uac04 \uc5c5\ub370\uc774\ud2b8, \uc810 \ucffc\ub9ac\ub85c \ud574\uacb0\ud560 \uc218 \uc788\uc73c\ub2c8 Segment Tree (Lazy Propagation \ud544\uc694 \uc5c6\uc74c)\uc73c\ub85c \uad6c\ud55c\ub2e4. \uc774\ubd84\ud0d0\uc0c9\uc5d0 \ucd1d \\(O(\\log Y)\\), \uc815\ub82c \ubc0f Segment Tree \ucffc\ub9ac\uc5d0 \\(O(\\log N)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub9ac\ub2c8, \uc804\uccb4 \\(O(N\\log N+M+Q\\log Y\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>\uc624\ud504\ub77c\uc778 \ucffc\ub9ac\uc774\ub2c8, Parallel Binary Search\ub97c \uc0ac\uc6a9\ud558\uba74 \uac04\uc120 \uac00\uc911\uce58 \uc5c5\ub370\uc774\ud2b8\uc640 \uacbd\ub85c \uac00\uc911\uce58 \ud569 \ucffc\ub9ac \ubb38\uc81c\ub85c \ud658\uc6d0\ud560 \uc218 \uc788\ub2e4. \uc774\ub294 Euler Tree Trick\uc73c\ub85c \ud2b8\ub9ac\ub97c \uc77c\uc9c1\uc120\uc73c\ub85c \ud53c\uace0, Segment Tree\ub97c \ud65c\uc6a9\ud558\uc5ec \ud574\uacb0\ud560 \uc218 \uc788\ub2e4. \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(N\\log N+M+Q\\log Y\\log N)\\)\uc774\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N\\log N+M+Q\\log Y\\log N)\\)</p> <p>\ub9c8\uc9c0\ub9c9\uc73c\ub85c, \ubaa8\ub4e0 \\(C_i\\)\uac00 \ub2e4\ub974\ub2e4\uace0 \uac00\uc815\ud558\uc600\ub294\ub370, \\(C_i\\)\uac00 \uac19\uc744 \uc218 \uc788\ub2e4\uba74 \uac19\uc740 \\(C_i\\)\uc911 \uc77c\ubd80\ub9cc \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0\ub97c \uace0\ub824\ud560 \uc218 \uc5c6\ub2e4. \uc774\ub294 \ub2e8\uc21c\ud788 \uc784\uc758\ub85c tie-breaking rule\uc744 \uc801\uc6a9\ud55c \ud6c4, \uc774\ubd84\ud0d0\uc0c9\uc744 \uc815\ub82c\ub41c \\(C_i\\)\ub4e4\uc758 \ubc30\uc5f4\uc5d0 \ub300\ud574\uc11c \uc2dc\ud589\ud568\uc73c\ub85c\uc11c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p>","tags":["binary_search","data_structures","euler_tour_technique","lca","offline_queries","pbs","pst","segtree","trees","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P1%20Two%20Currencies/solution/#code","title":"Code","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 1e5;\n\nint N, M, Q;\nvector&lt;pii&gt; adj[MAXN+10];\npii A[MAXN+10];\n\nstruct SEG\n{\n    ll tree[MAXN*4+10];\n    void init()\n    {\n        fill(tree, tree+MAXN*4+10, 0);\n    }\n    void update(int node, int tl, int tr, int l, int r, ll k)\n    {\n        if(l&lt;=tl &amp;&amp; tr&lt;=r)\n        {\n            tree[node]+=k;\n            return;\n        }\n        if(r&lt;tl || tr&lt;l) return;\n        int mid=tl+tr&gt;&gt;1;\n        update(node*2, tl, mid, l, r, k);\n        update(node*2+1, mid+1, tr, l, r, k);\n    }\n    ll query(int node, int tl, int tr, int k)\n    {\n        if(tl==tr) return tree[node];\n        int mid=tl+tr&gt;&gt;1;\n        if(k&lt;=mid) return tree[node]+query(node*2, tl, mid ,k);\n        else return tree[node]+query(node*2+1, mid+1, tr, k);\n    }\n}seg;\n\nint L[MAXN+10], R[MAXN+10], dep[MAXN+10], par[MAXN+10][30], cnt, P[MAXN+10];\nvoid dfs(int now, int bef, int d)\n{\n    L[now]=++cnt;\n    par[now][0]=bef;\n    dep[now]=d;\n    for(auto [nxt, e] : adj[now])\n    {\n        if(nxt==bef) continue;\n        P[e]=nxt;\n        dfs(nxt, now, d+1);\n    }\n    R[now]=cnt;\n}\n\nint lca(int u, int v)\n{\n    if(dep[u]&gt;dep[v]) swap(u, v);\n    for(int i=20; i&gt;=0; i--) if(dep[par[v][i]]&gt;=dep[u]) v=par[v][i];\n    if(u==v) return u;\n    for(int i=20; i&gt;=0; i--) if(par[u][i]!=par[v][i]) u=par[u][i], v=par[v][i];\n    return par[u][0];\n}\n\nint C[MAXN+10];\npii B[MAXN+10];\npll D[MAXN+10];\nint lo[MAXN+10], hi[MAXN+10];\nint E[MAXN+10];\n\nll f(int p)\n{\n    int u=B[p].first, v=B[p].second, w=C[p];\n    return seg.query(1, 1, N, L[u])+seg.query(1, 1, N, L[v])-2*seg.query(1, 1, N, L[w]);\n}\n\nint main()\n{\n    scanf(\"%d%d%d\", &amp;N, &amp;M, &amp;Q);\n    for(int i=1; i&lt;N; i++)\n    {\n        int u, v;\n        scanf(\"%d%d\", &amp;u, &amp;v);\n        adj[u].push_back({v, i});\n        adj[v].push_back({u, i});\n    }\n    for(int i=1; i&lt;=M; i++) scanf(\"%d%d\", &amp;A[i].second, &amp;A[i].first);\n\n    dfs(1, 1, 1);\n    for(int i=1; i&lt;=20; i++) for(int j=1; j&lt;=N; j++) par[j][i]=par[par[j][i-1]][i-1];\n\n    for(int i=1; i&lt;=Q; i++) scanf(\"%d%d%lld%lld\", &amp;B[i].first, &amp;B[i].second, &amp;D[i].first, &amp;D[i].second), C[i]=lca(B[i].first, B[i].second);\n\n    sort(A+1, A+M+1);\n\n    for(int i=1; i&lt;=Q; i++) lo[i]=0, hi[i]=M+1;\n    while(1)\n    {\n        vector&lt;pii&gt; V;\n        for(int i=1; i&lt;=Q; i++)\n        {\n            if(lo[i]+1&lt;hi[i])\n            {\n                V.push_back({lo[i]+hi[i]&gt;&gt;1, i});\n            }\n        }\n        if(V.empty()) break;\n        sort(V.begin(), V.end());\n\n        seg.init();\n        int pt=1;\n        for(auto it : V)\n        {\n            for(; pt&lt;=M &amp;&amp; pt&lt;=it.first; pt++)\n            {\n                seg.update(1, 1, N, L[P[A[pt].second]], R[P[A[pt].second]], A[pt].first);\n            }\n            //printf(\"??%d %d %lld %d\\n\", it.first, it.second, f(it.second), D[it.second].second);\n            if(f(it.second)&gt;D[it.second].second) hi[it.second]=it.first;\n            else lo[it.second]=it.first; \n        }\n    }\n\n    seg.init();\n    int pt=1;\n    vector&lt;pii&gt; V;\n    for(int i=1; i&lt;=Q; i++) V.push_back({lo[i], i});\n    sort(V.begin(), V.end());\n    for(auto it : V)\n    {\n        for(; pt&lt;=M &amp;&amp; pt&lt;=it.first; pt++)\n        {\n            seg.update(1, 1, N, L[P[A[pt].second]], R[P[A[pt].second]], 1);\n        }\n        E[it.second]=f(it.second);\n    }\n    for(; pt&lt;=M; pt++) seg.update(1, 1, N, L[P[A[pt].second]], R[P[A[pt].second]], 1);\n\n    for(int i=1; i&lt;=Q; i++)\n    {\n        //printf(\"%d %d %d\\n\", lo[i], f(i), E[i]);\n        printf(\"%lld\\n\", max(-1ll, D[i].first-f(i)+E[i]));\n    }\n}\n</code></pre>","tags":["binary_search","data_structures","euler_tour_technique","lca","offline_queries","pbs","pst","segtree","trees","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P3%20Passport/solution/","title":"JOISC 2023 D1P3 Passport","text":"","tags":["0_1_bfs","data_structures","dijkstra","graphs","segtree","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P3%20Passport/solution/#problem","title":"Problem","text":"","tags":["0_1_bfs","data_structures","dijkstra","graphs","segtree","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P3%20Passport/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/27994 https://oj.uz/problem/view/JOI23_passport</p>","tags":["0_1_bfs","data_structures","dijkstra","graphs","segtree","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P3%20Passport/solution/#summary","title":"Summary","text":"<p>\\(1, 2, \\cdots, N\\)\ubc88\uc758 \\(N\\)\uac1c\uc758 \ub3c4\uc2dc\uac00 \uc788\uace0, \ub3c4\uc2dc \\(i\\)\uc5d0\uc11c\ub294 \uad6c\uac04 \\([L_i, R_i]\\) \ub0b4\uc758 \uc784\uc758\uc758 \ub3c4\uc2dc\ub85c \uc790\uc720\ub86d\uac8c \uc774\ub3d9\ud560 \uc218 \uc788\ub294 \uc5ec\uad8c\uc744 \ubc1c\uae09\ubc1b\uc744 \uc218 \uc788\ub2e4. \\((1 \\leq i \\leq N)\\) \\(Q\\)\uac1c\uc758 \ucffc\ub9ac\uac00 \uc8fc\uc5b4\uc9c8 \ub54c, \uac01 \ucffc\ub9ac\ubcc4\ub85c \\(X_k\\)\ubc88 \ub3c4\uc2dc\uc5d0\uc11c \ucd9c\ubc1c\ud558\uc600\uc744 \ub54c, \ubaa8\ub4e0 \ub3c4\uc2dc\ub97c \ubc29\ubb38\ud558\uae30 \uc704\ud558\uc5ec \ud544\uc694\ud55c \uc5ec\uad8c\uc758 \ucd5c\uc18c \uac1c\uc218\ub97c \uad6c\ud558\uc5ec\ub77c. \\((1 \\leq k \\leq Q)\\)</p>","tags":["0_1_bfs","data_structures","dijkstra","graphs","segtree","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P3%20Passport/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(2 \\leq N \\leq 200,000\\)</li> <li>\\(1 \\leq L_i \\leq i \\leq R_i \\leq N\\) \\((1 \\leq i \\leq N)\\)</li> <li>\\(1 \\leq Q \\leq N\\)</li> <li>\\(1 \\leq X_k \\leq N\\) \\((1 \\leq k \\leq Q)\\), \ubaa8\ub4e0 \\(X_k\\)\ub294 \uc11c\ub85c \ub2e4\ub974\ub2e4.</li> </ul>","tags":["0_1_bfs","data_structures","dijkstra","graphs","segtree","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P3%20Passport/solution/#solution","title":"Solution","text":"","tags":["0_1_bfs","data_structures","dijkstra","graphs","segtree","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P3%20Passport/solution/#subtask-4","title":"Subtask 4","text":"<ul> <li>\\(N \\leq 2500\\)</li> </ul> <p>\ud604\uc7ac \uac16\uace0 \uc788\ub294 \uc5ec\uad8c\ub4e4\ub9cc \uc0ac\uc6a9\ud574\uc11c \uc774\ub3d9\ud560 \uc218 \uc788\ub294 \ub3c4\uc2dc\uc758 \ubc94\uc704\ub294 \ud56d\uc0c1 \uad6c\uac04\uc774\ub2e4. \\((\\because L_i \\leq i \\leq R_i)\\) \ub530\ub77c\uc11c, \ubc29\ubb38 \uac00\ub2a5\ud55c \ub3c4\uc2dc\uc758 \ubc94\uc704\uac00 \\([1, N]\\)\uc784\uacfc, \\(L_i=1\\)\uc778 \uc5ec\uad8c\uacfc \\(R_i=N\\)\uc778 \uc5ec\uad8c\uc744 \uac01\uac01 \ubc1c\uae09\ubc1b\ub294\uac83\uc740 \ub3d9\uce58\uc774\ub2e4.</p> <p>Observation 1</p> <p> \ubaa8\ub4e0 \ub3c4\uc2dc\ub97c \ubc29\ubb38\ud558\uae30 \uc704\ud558\uc5ec \ubc1c\uae09\ubc1b\uc544\uc57c \ud558\ub294 \uc5ec\uad8c\uc758 \ucd5c\uc18c \uac1c\uc218\ub294 \\(X_k\\)\ubc88 \ub3c4\uc2dc\uc5d0\uc11c \uc2dc\uc791\ud574\uc11c \\(L_i=1\\)\uc778 \uc5ec\uad8c\uacfc \\(R_i=N\\)\uc778 \uc5ec\uad8c\uc744 \uac01\uac01 \ubc1c\uae09\ubc1b\uae30 \uc704\ud558\uc5ec \ubc1c\uae09\ubc1b\uc544\uc57c \ud558\ub294 \uc5ec\uad8c\uc758 \ucd5c\uc18c \uac1c\uc218\uc640 \ub3d9\uce58\uc774\ub2e4.</p> <p>\uc5b4\ub5a4 \ub3c4\uc2dc \\(x\\)\uc5d0\uc11c \uc5ec\uad8c\uc744 \ubc1c\uae09\ubc1b\uc544, \\([L_x, R_x]\\)\uc5d0 \uc18d\ud558\ub294 \ub3c4\uc2dc \\(y\\)\ub85c \uc774\ub3d9\ud558\uc5ec \uc5ec\uad8c\uc744 \ubc1c\uae09\ubc1b\ub294 \ud589\ub3d9\uc744 \\(x\\)\ubc88 \uc815\uc810\uc5d0\uc11c \\(y\\)\ubc88 \uc815\uc810\uc73c\ub85c \uc774\ub3d9\ud558\ub294 \uac04\uc120\uc73c\ub85c \uc0dd\uac01\ud558\uc790. \ub530\ub77c\uc11c, \ubb38\uc81c\ub294 \\(X_k\\)\ubc88 \ub3c4\uc2dc\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \\(L_i=1\\)\uc778 \ub3c4\uc2dc \\(L\\)\uacfc \\(R_i=N\\)\ubc88 \ub3c4\uc2dc \\(R\\)\ub85c \uc774\ub3d9\ud558\ub294 \uacbd\ub85c\ub97c \ucc3e\ub294 \uac83\uc774\ub2e4. \uc774 \ub54c \uacbd\ub85c\ub294 \uaf2d \\(X_k\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \\(L\\)\uc744 \ubc29\ubb38\ud55c \ud6c4 \\(R\\)\ub97c \ubc29\ubb38\ud560 \ud544\uc694 \uc5c6\uc774, \uc911\uac04\uc5d0 \uac08\ub77c\uc838\uc11c \\(L\\)\ub85c \uac00\ub294 \uacbd\ub85c\uc640 \\(R\\)\ub85c \uac00\ub294 \uacbd\ub85c\ub97c \ub2e4\ub974\uac8c \uc120\ud0dd\ud574\ub3c4 \ub41c\ub2e4. \ubb3c\ub860, \uc774 \ub54c\uc5d0\ub3c4 \uc0ac\uc6a9\ud55c \uc815\uc810\uc758 \ucd1d \uac1c\uc218\ub294 \uc911\ubcf5\ud558\uc9c0 \uc54a\uace0 \uc13c\ub2e4.</p> <p></p> <p>\uc704 \uadf8\ub9bc\ucc98\ub7fc, \ucd5c\uc801\ud574\ub294 \\(X_k\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \ud55c \uacbd\ub85c\ub97c \ub530\ub77c \uc784\uc758\uc758 \uc815\uc810 \\(W\\)\uae4c\uc9c0 \uc774\ub3d9 \ud6c4, \\(W\\)\uc5d0\uc11c \uac08\ub77c\uc838 \\(L\\)\uacfc \\(R\\)\ub85c \uac01\uac01 \uc774\ub3d9\ud558\ub294 \ud615\ud0dc\uc774\ub2e4.</p> <p>Observation 2</p> <p>\\(X_k\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uc815\uc810 \\(L\\)\uacfc \\(R\\)\ub85c \uac00\ub294 \ucd5c\ub2e8\uacbd\ub85c\uc758 \ud615\ud0dc\ub294, \uc6b0\uc120 \uc784\uc758\uc758 \uc815\uc810 \\(W\\)\ub85c \uc774\ub3d9\ud55c \ud6c4 \uac08\ub77c\uc838 \\(L\\)\uacfc \\(R\\)\ub85c \uc774\ub3d9\ud558\ub294 \uac83\uc774\ub2e4. \uc774 \ub54c \\(X_k \\rightarrow W\\), \\(W \\rightarrow L\\), \\(W \\rightarrow R\\)\uc758 \uac01 \uacbd\ub85c\uc5d0\ub294 \uacb9\uce58\ub294 \uc815\uc810\uc774 \uc5c6\ub2e4.</p> <p>\uc774\uc81c, \ubb38\uc81c\ub97c \ube60\ub974\uac8c \ud574\uacb0\ud558\uae30 \uc704\ud558\uc5ec \ubaa8\ub4e0 \uac04\uc120\uc758 \ubc29\ud5a5\uc744 \ub4a4\uc9d1\uace0, \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \\(L\\) \uc815\uc810\ub4e4\uc5d0\uc11c \ub2e4\ub978 \ubaa8\ub4e0 \uc815\uc810\ub4e4\ub85c\uc758 \ucd5c\ub2e8\uacbd\ub85c \\(D_L\\), \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \\(R\\) \uc815\uc810\ub4e4\uc5d0\uc11c \ub2e4\ub978 \ubaa8\ub4e0 \uc815\uc810\ub4e4\ub85c\uc758 \ucd5c\ub2e8\uacbd\ub85c \\(D_R\\)\ub97c \uad6c\ud558\uc790. \uc774\ud6c4 \uac01 \uc815\uc810 \\(w\\)\uc5d0\uc11c \uae30\ubcf8 \uac00\uc911\uce58 \\(D_L[w]+D_R[w]\\)\ub85c \uc2dc\uc791\ud558\uc5ec \ub2e4\ub978 \uc815\uc810\ub4e4\ub85c \uac00\ub294 \ucd5c\ub2e8\uacbd\ub85c \\(D\\)\ub97c \uad6c\ud560 \uc218 \uc788\ub2e4\uba74, \\(D\\)\uac00 \ubc14\ub85c \ubb38\uc81c\uc5d0\uc11c \uc694\uad6c\ud558\ub294 \ub2f5\uc774 \ub428\uc744 \uc54c \uc218 \uc788\ub2e4.</p> <p>\ubaa8\ub4e0 \uac04\uc120\uc758 \uac00\uc911\uce58\uac00 1\uc774\uace0, \uc815\uc810\uc774 \\(O(N)\\)\uac1c, \uac04\uc120\uc740 \\(O(N^2)\\)\uac1c\uc774\ub2c8 BFS\ub97c \ud1b5\ud574 \\(O(N^2)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>\uc5b4\ub5a4 \ub3c4\uc2dc \\(x\\)\uc5d0\uc11c \uc5ec\uad8c\uc744 \ubc1c\uae09\ubc1b\uc544, \\([L_x, R_x]\\)\uc5d0 \uc18d\ud558\ub294 \ub3c4\uc2dc \\(y\\)\ub85c \uc774\ub3d9\ud558\uc5ec \uc5ec\uad8c\uc744 \ubc1c\uae09\ubc1b\ub294 \ud589\ub3d9\uc744 \\(x\\)\ubc88 \uc815\uc810\uc5d0\uc11c \\(y\\)\ubc88 \uc815\uc810\uc73c\ub85c \uc774\ub3d9\ud558\ub294 \uac04\uc120\uc73c\ub85c \uc0dd\uac01\ud560 \ub54c, Observation 1\uc5d0 \uc758\ud574 \uc774 \uadf8\ub798\ud504\uc5d0\uc11c \\(X_k\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \\(L_i=1\\)\uc778 \ub3c4\uc2dc \\(L\\)\uacfc \\(R_i=N\\)\ubc88 \ub3c4\uc2dc \\(R\\)\ub85c \uc774\ub3d9\ud558\ub294 \uacbd\ub85c\ub97c \ucc3e\uc73c\uba74 \ub41c\ub2e4. Observation 2\uc5d0 \uc758\ud574 \uc774\ub7ec\ud55c \uacbd\ub85c\ub294 \uc784\uc758\uc758 \uc815\uc810 \\(W\\)\ub97c \uae30\uc900\uc73c\ub85c \\(X_k \\rightarrow W\\), \\(W \\rightarrow L\\), \\(W \\rightarrow R\\) 3\uac1c\uc758 \ucd5c\ub2e8 \uacbd\ub85c\uc758 \ud569\uc744 \uad6c\ud558\ub294 \ubb38\uc81c\ub85c \uc0dd\uac01\ud560 \uc218 \uc788\uc73c\ub2c8, BFS\ub97c \ud1b5\ud574 \\(O(N^2)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N^2)\\)</p>","tags":["0_1_bfs","data_structures","dijkstra","graphs","segtree","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P3%20Passport/solution/#subtask-5-full","title":"Subtask 5 (Full)","text":"<p>\uc774\uc81c \uc2e4\uc81c\ub85c \\(N^2\\)\uac1c\uc758 \uac04\uc120\uc744 \uc774\uc744 \uc218 \uc5c6\ub294 \uc0c1\ud669\uc778\ub370, \uac04\uc120\uc758 \ud615\ud0dc\uac00 \uad6c\uac04\uc5d0 \uc788\ub294 \ubaa8\ub4e0 \uc815\uc810\uc5d0\uc11c \ud2b9\uc815\ud55c \uc810\uc744 \uc5f0\uacb0\ud558\ub294 \ud615\ud0dc\uc774\ubbc0\ub85c, Segment Tree\ub97c \uc0ac\uc6a9\ud558\uc5ec \ucd5c\uc801\ud654\ud560 \uc218 \uc788\ub2e4. \uac01 \uc815\uc810\uc744 \ub9ac\ud504\ub85c \ud558\ub294 Segment Tree\ub97c dummy node\ub85c \ub9cc\ub4e4\uace0, Segment Tree\uc758 \ub8e8\ud2b8\ub85c \ubc29\ud5a5\uc744 \ubd80\uc5ec\ud558\uba74 \ud2b9\uc815 \uad6c\uac04\uc5d0\uc11c \uc815\uc810\uc73c\ub85c \uac04\uc120\uc744 \uc774\uc744 \uc218 \uc788\ub2e4. \ud55c \uad6c\uac04\uc5d0\uc11c \uc815\uc810\uc73c\ub85c \uac04\uc120\uc744 \uc5f0\uacb0\ud558\ub294\ub370 \\(O(\\log N)\\)\uac1c\uc758 \uac04\uc120\ub9cc \ud544\uc694\ud558\ub2c8, \uc804\uccb4 \uadf8\ub798\ud504\uc758 \uc815\uc810\uc740 \\(O(N)\\), \uac04\uc120\uc740 \\(O(N\\log N)\\)\uac1c\uc774\ub2e4.</p> <p>\ud558\uc9c0\ub9cc Segment Tree\uc758 \uac04\uc120\ub4e4\uc740 \uac00\uc911\uce58\uac00 \\(0\\)\uc774\uae30 \ub54c\ubb38\uc5d0 \ub2e8\uc21c\ud55c BFS\ub97c \uc0ac\uc6a9\ud560 \uc218\ub294 \uc5c6\ub2e4. Segment Tree\uc5d0 \uc18d\ud558\ub294 \uac04\uc120\ub4e4\uc740 \uac00\uc911\uce58\uac00 \\(0\\), \ub098\uba38\uc9c0 \uac04\uc120\ub4e4\uc740 \ubaa8\ub450 \uac00\uc911\uce58\uac00 1\ub85c \uc804\uccb4 \uadf8\ub798\ud504\uc758 \uac04\uc120\ub4e4\uc758 \uac00\uc911\uce58\uac00 \\(0\\) \ud639\uc740 \\(1\\)\uc774\ub2c8 01-BFS\ub97c \uc0ac\uc6a9\ud558\uba74 \\(O(N\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>CheckPoint</p> <p>\\(O(N^2)\\)\uac1c\uc758 \uac04\uc120\uc744 Segment Tree\ub97c \uc0ac\uc6a9\ud558\uc5ec \\(O(N\\log N)\\)\uac1c\uc758 \uac04\uc120\ub4e4\ub85c \uc555\ucd95\ud560 \uc218 \uc788\ub2e4. \uc774\uc81c, \uc774 \uadf8\ub798\ud504\uc5d0\uc11c \uac00\uc911\uce58\uac00 \\(0\\) \ud639\uc740 \\(1\\)\uc774\ub2c8 01-BFS\ub97c \uc0ac\uc6a9\ud558\uba74 \\(O(N\\log N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(N\\log N)\\)</p>","tags":["0_1_bfs","data_structures","dijkstra","graphs","segtree","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D1P3%20Passport/solution/#code","title":"Code","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\n\nconst int MAXN = 1e6;\n\nint N, Q;\npii A[MAXN+10];\nvector&lt;int&gt; adj[MAXN+10];\n\nint init(int node, int tl, int tr)\n{\n    if(tl==tr) return tl;\n    int mid=tl+tr&gt;&gt;1;\n    adj[init(node*2, tl, mid)].push_back(node+N);\n    adj[init(node*2+1, mid+1, tr)].push_back(node+N);\n    return node+N;\n}\n\nvoid query(int node, int tl, int tr, int l, int r, int k)\n{\n    if(r&lt;tl || tr&lt;l) return;\n    if(l&lt;=tl &amp;&amp; tr&lt;=r)\n    {\n        if(tl==tr) adj[tl].push_back(k);\n        else adj[node+N].push_back(k);\n        return;\n    }\n    int mid=tl+tr&gt;&gt;1;\n    query(node*2, tl, mid, l, r, k);\n    query(node*2+1, mid+1, tr, l, r, k);\n}\n\nint D1[MAXN+10], D2[MAXN+10], D3[MAXN+10];\n\nvoid bfs(int *D)\n{\n    deque&lt;pii&gt; Q;\n    vector&lt;pii&gt; V;\n    for(int i=1; i&lt;=N; i++) if(D[i]) V.push_back({D[i], i});\n    sort(V.begin(), V.end());\n    for(int p=0; p&lt;V.size();)\n    {\n        Q.push_back({V[p].second, V[p].first}); p++;\n        while(!Q.empty())\n        {\n            pii t=Q.front(); Q.pop_front();\n            if(D[t.first]!=t.second) continue;\n\n            int now=t.first;\n            for(; p&lt;V.size() &amp;&amp; V[p].first&lt;=D[now]+1; p++) Q.push_back({V[p].second, V[p].first});\n            for(auto nxt : adj[now])\n            {\n                if(D[nxt]!=0 &amp;&amp; D[nxt]&lt;=D[now]+1) continue;\n                if(nxt&lt;=N)\n                {\n                    D[nxt]=D[now]+1;\n                    Q.push_back({nxt, D[nxt]});\n                }\n                else\n                {\n                    D[nxt]=D[now];\n                    Q.push_front({nxt, D[nxt]});                    \n                }\n            }\n        }\n    }\n    for(int i=1; i&lt;=N; i++) if(!D[i]) D[i]=N+N;\n}\n\nint main()\n{\n    scanf(\"%d\", &amp;N);\n    for(int i=1; i&lt;=N; i++) scanf(\"%d%d\", &amp;A[i].first, &amp;A[i].second);\n\n    init(1, 1, N);\n    for(int i=1; i&lt;=N; i++)\n    {\n        auto [l, r]=A[i];\n        query(1, 1, N, l, r, i);\n    }\n\n    for(int i=1; i&lt;=N; i++) if(A[i].first==1) D1[i]=1;\n    bfs(D1);\n\n    for(int i=1; i&lt;=N; i++) if(A[i].second==N) D2[i]=1;\n    bfs(D2);\n\n    for(int i=1; i&lt;=N; i++) D3[i]=D1[i]+D2[i]-1;\n    bfs(D3);\n\n    scanf(\"%d\", &amp;Q);\n    while(Q--)\n    {\n        int t;\n        scanf(\"%d\", &amp;t);\n        if(D3[t]&gt;N) D3[t]=-1;\n        printf(\"%d\\n\", D3[t]);\n    }\n}\n</code></pre> <p>asdf</p>","tags":["0_1_bfs","data_structures","dijkstra","graphs","segtree","~ solution"]},{"location":"solutions/Olympiad/JOISC/2023/D2P2%20Council/solution/","title":"JOISC 2023 D2P2 Council","text":"","tags":["~ solution","bitmask","dp","dp_sum_over_subsets"]},{"location":"solutions/Olympiad/JOISC/2023/D2P2%20Council/solution/#problem","title":"Problem","text":"","tags":["~ solution","bitmask","dp","dp_sum_over_subsets"]},{"location":"solutions/Olympiad/JOISC/2023/D2P2%20Council/solution/#problem-link","title":"Problem Link","text":"<p>https://www.acmicpc.net/problem/27996 https://oj.uz/problem/view/JOI23_council</p>","tags":["~ solution","bitmask","dp","dp_sum_over_subsets"]},{"location":"solutions/Olympiad/JOISC/2023/D2P2%20Council/solution/#summary","title":"Summary","text":"<p>\\(1, 2, ..., N\\)\uc758 \\(N\\)\uba85\uc758 \uc0ac\ub78c\ub4e4\uc774 \uc788\uace0, \\(1, 2, ..., M\\)\uc758 \\(M\\)\uac1c\uc758 \uc815\ucc45\uc774 \uc788\ub2e4. \\(A_{i, j}\\)\ub294 \\(i\\)\ubc88 \uc0ac\ub78c\uc774 \\(j\\)\ubc88 \uc815\ucc45\uc5d0 \ub300\ud558\uc5ec \ucc2c\uc131\ud45c\ub97c \ub358\uc9c4\ub2e4\uba74 \\(1\\), \uc544\ub2c8\uba74 \\(0\\)\uc774\ub2e4. \\(N\\)\uba85\uc758 \uc0ac\ub78c\ub4e4 \uc911 \ud68c\uc7a5 \ud55c\uba85\uc744 \uc815\ud558\uace0, \ud68c\uc7a5\uc744 \uc81c\uc678\ud55c \uc0ac\ub78c\ub4e4 \uc911 \ubd80\ud68c\uc7a5 \ud55c\uba85\uc744 \uc815\ud55c \ud6c4, \ub0a8\uc740 \uc0ac\ub78c\ub4e4\uc5d0 \ub300\ud558\uc5ec \ubaa8\ub4e0 \uc815\ucc45\uc5d0 \ub300\ud55c \ud22c\ud45c\ub97c \uc9c4\ud589\ud55c\ub2e4. \uac01 \uc815\ucc45\uc5d0 \ub300\ud558\uc5ec, \ud68c\uc7a5\uacfc \ubd80\ud68c\uc7a5\uc744 \uc81c\uc678\ud55c \ub098\uba38\uc9c0 \uc0ac\ub78c\ub4e4 \uc911 \ucc2c\uc131\ud45c\uc758 \uc218\uac00 \\(\\lfloor \\frac{N}{2} \\rfloor\\)\ud45c \uc774\uc0c1\uc774\ub77c\uba74, \uc774 \uc815\ucc45\uc744 \uc2b9\uc778\ud55c\ub2e4. \\(i\\)\ubc88 \uc0ac\ub78c\uc774 \ud68c\uc7a5\uc77c \ub54c, \ubd80\ud68c\uc7a5\uc744 \uc801\ub2f9\ud788 \uc815\ud588\uc744 \ub54c \uc2b9\uc778\ub418\ub294 \uc815\ucc45\uc758 \uc218\uc758 \ucd5c\ub313\uac12\uc744 \ubaa8\ub4e0 \\(i\\)\uc5d0 \ub300\ud574 \uad6c\ud558\uc5ec\ub77c. \\((1 \\le i \\le N)\\)</p>","tags":["~ solution","bitmask","dp","dp_sum_over_subsets"]},{"location":"solutions/Olympiad/JOISC/2023/D2P2%20Council/solution/#constraints","title":"Constraints","text":"<ul> <li>\\(3 \\le N \\le 300,000\\)</li> <li>\\(1 \\le M \\le 20\\)</li> <li>\\(0 \\le A_{i, j} \\le 1\\) \\((1 \\le i \\le N, 1 \\le j \\le M)\\)</li> </ul>","tags":["~ solution","bitmask","dp","dp_sum_over_subsets"]},{"location":"solutions/Olympiad/JOISC/2023/D2P2%20Council/solution/#solution","title":"Solution","text":"<p>\\(N\\)\uc5d0 \ube44\ud558\uc5ec \\(M\\)\uc774 \ub9e4\uc6b0 \uc791\uc73c\ub2c8, \\(2^M\\)\uacfc \ube44\uc2b7\ud55c \uc2dc\uac04\ubcf5\uc7a1\ub3c4\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\uc74c\uc5d0 \uc720\uc758\ud558\uc790.</p> <p>\uac01 \uc815\ucc45\uc5d0 \ub300\ud558\uc5ec, \ud68c\uc7a5\uacfc \ubd80\ud68c\uc7a5\uc744 \uc81c\uc678\ud55c \ud6c4 \uc0ac\ub78c\ub4e4\uc758 \ud45c\ub97c \uc14c\uc744 \ub54c \\(\\lfloor \\frac{N}{2} \\rfloor\\)\ud45c \uc774\uc0c1\uc774\uc5b4\uc57c\uc9c0 \uc815\ucc45\uc774 \uc2b9\uc778\ub41c\ub2e4. \ud68c\uc7a5\uacfc \ubd80\ud68c\uc7a5\uc744 \uc81c\uc678\ud558\uc9c0 \uc54a\uc558\uc744 \ub54c \uc815\ucc45 \\(j\\)\uc758 \uc804\uccb4 \ud45c\uc758 \uc218\ub97c \\(C_j\\)\ub77c \ud558\uc790. \ub9cc\uc57d, \\(C_j&lt;\\lfloor \\frac{N}{2} \\rfloor\\) \uc774\uac70\ub098, \\(C_j \\ge \\lfloor \\frac{N}{2} \\rfloor+2\\)\ub77c\uba74 \uc5ec\uae30\uc11c \\(0, 1, 2\\)\ud45c\ub97c \uc81c\uc678\ud55c\ub2e4\uace0 \ud574\uc11c \uc815\ucc45\uc758 \uc2b9\uc778 \uc5ec\ubd80\uac00 \ubc14\ub00c\uc9c0 \uc54a\ub294\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, \uac01 \uc815\ucc45 \\(j\\)\ub97c \ub2e4\uc74c\uacfc \uac19\uc740 \\(3\\)\uac00\uc9c0 \uc0c1\ud0dc\ub85c \uc694\uc57d\ud560 \uc218 \uc788\ub2e4.</p> <ul> <li>State \\(0\\) : \\(C_j&lt;\\lfloor \\frac{N}{2} \\rfloor\\)\uc774\uac70\ub098 \\(C_j \\ge \\lfloor \\frac{N}{2} \\rfloor+2\\)</li> <li>State \\(1\\) : \\(C_j = \\lfloor \\frac{N}{2} \\rfloor\\)</li> <li>State \\(2\\) : \\(C_j = \\lfloor \\frac{N}{2} \\rfloor + 1\\)</li> </ul> <p>Observation 1</p> <p>\ud68c\uc7a5\uacfc \ubd80\ud68c\uc7a5\uc744 \uc81c\uc678\ud558\uc9c0 \uc54a\uc558\uc744 \ub54c \uc815\ucc45 \\(j\\)\uc758 \uc804\uccb4 \ud45c\uc758 \uc218\ub97c \\(C_j\\)\ub77c \ud558\uc790. \ub9cc\uc57d, \\(C_j&lt;\\lfloor \\frac{N}{2} \\rfloor\\) \uc774\uac70\ub098, \\(C_j \\ge \\lfloor \\frac{N}{2} \\rfloor+2\\)\ub77c\uba74 \ud68c\uc7a5, \ubd80\ud68c\uc7a5\uc758 \uc120\ud0dd\uacfc \ubb34\uad00\ud558\uac8c \uc815\ucc45\uc758 \uc2b9\uc778 \uc5ec\ubd80\uac00 \ubc14\ub00c\uc9c0 \uc54a\ub294\ub2e4. \ub530\ub77c\uc11c \uac01 \uc815\ucc45 \\(j\\)\ub97c \ub2e4\uc74c\uacfc \uac19\uc740 \\(3\\)\uac00\uc9c0 \uc0c1\ud0dc\ub85c \uc694\uc57d\ud560 \uc218 \uc788\ub2e4.</p> <ul> <li>State \\(0\\) : \\(C_j&lt;\\lfloor \\frac{N}{2} \\rfloor\\)\uc774\uac70\ub098 \\(C_j \\ge \\lfloor \\frac{N}{2} \\rfloor+2\\)</li> <li>State \\(1\\) : \\(C_j = \\lfloor \\frac{N}{2} \\rfloor\\)</li> <li>State \\(2\\) : \\(C_j = \\lfloor \\frac{N}{2} \\rfloor + 1\\)</li> </ul> <p>\ub9cc\uc57d \ud68c\uc7a5\uc744 \\(i\\)\ubc88 \uc0ac\ub78c\uc73c\ub85c \uc815\ud588\ub2e4\uace0 \uc0dd\uac01\ud558\uc790. \uc774\uc81c, Observation 1\uc5d0\uc11c State \\(1\\)\uacfc \\(2\\)\uc5d0 \uc18d\ud558\ub294 \uc815\ucc45\ub4e4 \uc911, \\(C_j - A_{i, j} = \\lfloor \\frac{N}{2} \\rfloor\\)\uc778 \uc815\ucc45\ub4e4\ub9cc \ubd80\ud68c\uc7a5\uc758 \uc120\ud0dd\uc5d0 \uc601\ud5a5\uc744 \ubc1b\uace0, \ub2e4\ub978 \uc815\ucc45\ub4e4\uc740 \uc2b9\uc778 \uc5ec\ubd80\uac00 \ubc14\ub85c \uc815\ud574\uc9c4\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4. \uac01 \uc815\ucc45\uc5d0 \ub300\ud558\uc5ec, \\(C_j - A_{i, j} = \\lfloor \\frac{N}{2} \\rfloor\\)\uc774\uba74 \\(1\\), \uc544\ub2c8\uba74 \\(0\\)\uc73c\ub85c \ud45c\ud604\ud55c bitmask \\(mask\\)\ub97c \uc0dd\uac01\ud558\uc790. \ubd80\ud68c\uc7a5\uc744 \\(k\\)\ub85c \uace8\ub790\ub2e4\uace0 \ud560 \ub54c, bitmask \\(A_k\\)\uc640 \\(mask\\)\ub97c bitwise and \ud558\uc600\uc744 \ub54c \\(1\\)\uc778 \uce78\ub4e4\uc740 \uc2b9\uc778\ub418\uc9c0 \uc54a\ub294 \uc815\ucc45\ub4e4\uc774\ub2c8, \\(A_k \\ \\&amp; \\ mask\\)\uc5d0 \ucf1c\uc838 \uc788\ub294 \uce78\ub4e4\uc758 \uc218\ub97c \ucd5c\uc18c\ud654\ud574\uc57c\ud55c\ub2e4.</p> <p>Observation 2</p> <p>\ud68c\uc7a5\uc744 \\(i\\)\ubc88 \uc0ac\ub78c\uc73c\ub85c \uc815\ud588\uc744 \ub54c, \uac01 \uc815\ucc45\uc5d0 \ub300\ud558\uc5ec \\(C_j - A_{i, j} = \\lfloor \\frac{N}{2} \\rfloor\\)\uc774\uba74 \\(1\\), \uc544\ub2c8\uba74 \\(0\\)\uc73c\ub85c \ud45c\ud604\ud55c bitmask \\(mask\\)\ub97c \uc0dd\uac01\ud558\uc790. \ubd80\ud68c\uc7a5\uc744 \\(k\\)\ub85c \uace8\ub790\ub2e4\uace0 \ud560 \ub54c, \ucd5c\uc801\ud574\uc5d0\uc11c\ub294 \\(A_k \\ \\&amp; \\ mask\\)\uc5d0 \ucf1c\uc838 \uc788\ub294 \uce78\ub4e4\uc758 \uc218\ub97c \ucd5c\uc18c\ud654\ud574\uc57c\ud55c\ub2e4.</p> <p>\uc5ec\ub7ec \uac1c\uc758 \\(mask\\)\uc5d0 \ub300\ud558\uc5ec \\(A_k \\ \\&amp; \\ mask\\)\uc5d0 \ucf1c\uc838 \uc788\ub294 \uce78\ub4e4\uc758 \uc218\uc758 \ucd5c\uc19f\uac12\uc744 \uad6c\ud558\uace0 \uc2f6\uc73c\ub2c8, SOS(Sum of Subset) DP\ub97c \uc774\uc6a9\ud558\uc5ec \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uc790. SOS DP\ub97c \uadf8\ub300\ub85c \uc801\uc6a9\ud560 \uc218\ub294 \uc5c6\uace0, \\(A_k\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uc55e\ucabd\ubd80\ud130 bit \uba87 \uac1c\ub97c \ubc14\uafb8\uba70 \\(mask\\)\ub85c \ubc14\uafb8\uc5b4 \ub098\uac04\ub2e4\uace0 \uc0dd\uac01\ud558\uc790. \\(A_k\\)\uc758 \ube44\ud2b8\ub97c \\(0 \\rightarrow 0\\), \\(0 \\rightarrow 1\\), \\(1 \\rightarrow 0\\), \\(1 \\rightarrow 1\\)\ub85c \ubc14\uafb8\ub294 \uac83\uc774 \ubaa8\ub450 \uac00\ub2a5\ud55c\ub370, \uc6b0\ub9ac\uac00 \uc138\uace0 \uc2f6\uc740 \uac83\uc740 \\(A_k \\ \\&amp; \\ mask\\)\uc5d0 \ucf1c\uc838 \uc788\ub294 \uce78\uc774\ub2c8, \\(1 \\rightarrow 1\\)\uc758 \ubcc0\ud658\uc774 \ubc1c\uc0dd\ud560 \ub54c\uc5d0\ub9cc \uac12\uc744 \\(1\\) \uc99d\uac00\uc2dc\ucf1c \uc138\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\ub2e8, \ud68c\uc7a5\uacfc \ubd80\ud68c\uc7a5\uc758 \ubc88\ud638\ub294 \ub2ec\ub77c\uc57c \ud558\uae30 \ub54c\ubb38\uc5d0 \ub2e8\uc21c \ucd5c\uc19f\uac12\uc744 \uad6c\ud558\uba74 \uc548\ub418\uace0, \ucd5c\uc19f\uac12\uc744 \uad6c\ud55c \ud6c4, \ucd5c\uc19f\uac12\uacfc \ub2e4\ub978 \ubc88\ud638\uc758 \ub450 \ubc88\uc9f8 \ucd5c\uc19f\uac12\uc744 \ud55c\ubc88 \ub354 \uad6c\ud574\uc8fc\uc5b4\uc57c \ud55c\ub2e4.</p> <p>\ub530\ub77c\uc11c, \ucd5c\uc19f\uac12\uacfc \ub450 \ubc88\uc9f8 \ucd5c\uc19f\uac12\uc744 SOS DP\ub97c \uc774\uc6a9\ud558\uc5ec \ud55c\ubc88 \uad6c\ud574\uc900 \ud6c4, \\(N\\)\uba85\uc758 \ud68c\uc7a5 \ud6c4\ubcf4\uc5d0 \ub300\ud558\uc5ec \ub2f5\uc744 \uad6c\ud574\uc8fc\uba74 \ub418\uace0, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(2^MM+N)\\)\uc774\ub2e4.</p> <p>CheckPoint</p> <p>Observation 2\uc5d0 \uc758\ud558\uc5ec \uac01 \ud68c\uc7a5 \\(i\\)\uc5d0 \ub300\ud558\uc5ec \ubaa8\ub4e0 \uac00\ub2a5\ud55c \ubd80\ud68c\uc7a5 \\(k\\) \uc911 \\(A_k \\ \\&amp; \\ mask\\)\uc5d0 \ucf1c\uc838 \uc788\ub294 \uce78\ub4e4\uc758 \uc218\ub97c \ucd5c\uc18c\ud654\ud574\uc57c\ud55c\ub2e4. \uc774\ub294 SOS DP\ub97c \uc751\uc6a9\ud558\uc5ec \uad6c\ud560 \uc218 \uc788\uace0, \\(A_k\\)\uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec \uc55e\ucabd\ubd80\ud130 bit \uba87 \uac1c\ub97c \ubc14\uafb8\uba70 \\(mask\\)\ub85c \ubc14\uafb8\uc5b4 \ub098\uac04\ub2e4\uace0 \uc0dd\uac01\ud558\uba74 \ub41c\ub2e4. \ub2e8, \ud68c\uc7a5\uacfc \ubd80\ud68c\uc7a5\uc758 \ubc88\ud638\ub294 \ub2ec\ub77c\uc57c \ud558\uae30 \ub54c\ubb38\uc5d0 \ucd5c\uc19f\uac12\uacfc \ub2e4\ub978 \ubc88\ud638\uc758 \ub450 \ubc88\uc9f8 \ucd5c\uc19f\uac12\uc744 \ud55c\ubc88 \ub354 \uad6c\ud574\uc8fc\uc5b4\uc57c \ud55c\ub2e4. \ub530\ub77c\uc11c, \ucd5c\uc19f\uac12\uacfc \ub450 \ubc88\uc9f8 \ucd5c\uc19f\uac12\uc744 SOS DP\ub97c \uc774\uc6a9\ud558\uc5ec \ud55c\ubc88 \uad6c\ud574\uc900 \ud6c4, \ubaa8\ub4e0 \\(N\\)\uba85\uc758 \ud68c\uc7a5 \ud6c4\ubcf4\uc5d0 \ub300\ud558\uc5ec \ub2f5\uc744 \uad6c\ud574\uc8fc\uba74 \ub418\uace0, \uc804\uccb4 \uc2dc\uac04\ubcf5\uc7a1\ub3c4\ub294 \\(O(2^MM+N)\\)\uc774\ub2e4.</p> <p>Complexity</p> <p>Time Complexity : \\(O(2^MM+N)\\)</p>","tags":["~ solution","bitmask","dp","dp_sum_over_subsets"]},{"location":"solutions/Olympiad/JOISC/2023/D2P2%20Council/solution/#code","title":"Code","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair&lt;int, int&gt; pii;\ntypedef pair&lt;ll, ll&gt; pll;\ntypedef pair&lt;pii, pii&gt; ppp;\n\nconst int MAXN = 3e5;\nconst int MAXM = 20;\nconst int INF = 1e9;\n\nint N, M, A[MAXN+10][MAXM+10];\nint P[MAXM+10];\nint B[MAXN+10];\n\nppp dp[(1&lt;&lt;MAXM)+10][MAXM+10];\n\npii operator + (pii &amp;p, int q)\n{\n    return {p.first+q, p.second};\n}\n\nppp operator + (ppp &amp;p, int q)\n{\n    return {p.first+q, p.second+q};\n}\n\nvoid f(ppp &amp;p, ppp q)\n{\n    if(p.first&lt;q.first)\n    {\n        if(q.first.second==p.first.second) q.first=q.second;\n        p={p.first, min(q.first, p.second)};\n    }\n    else\n    {\n        if(p.first.second==q.first.second) p.first=p.second;\n        p={q.first, min(p.first, q.second)};\n    }\n}\n\nint main()\n{\n    scanf(\"%d%d\", &amp;N, &amp;M);\n    for(int i=1; i&lt;=N; i++) for(int j=0; j&lt;M; j++) scanf(\"%d\", &amp;A[i][j]);\n    for(int j=0; j&lt;M; j++)\n    {\n        int cnt=0;\n        for(int i=1; i&lt;=N; i++) cnt+=A[i][j];\n        if(cnt&lt;N/2) P[j]=0;\n        else if(cnt&gt;N/2+1) P[j]=3;\n        else if(cnt==N/2) P[j]=1;\n        else if(cnt==N/2+1) P[j]=2;\n    }\n\n    for(int j=0; j&lt;=M; j++) for(int i=0; i&lt;(1&lt;&lt;M); i++) dp[i][j]={pii(INF, -1), pii(INF, -1)};\n    for(int i=1; i&lt;=N; i++)\n    {\n        for(int j=0; j&lt;M; j++) B[i]|=(A[i][j]&lt;&lt;j);\n        f(dp[B[i]][0], {pii(0, i), pii(INF, -1)});\n    }\n\n    for(int i=0; i&lt;M; i++)\n    {\n        for(int j=0; j&lt;(1&lt;&lt;M); j++)\n        {\n            if(P[i]==0)\n            {\n                f(dp[j][i+1], dp[j][i]+1);\n                f(dp[j][i+1], dp[j^(1&lt;&lt;i)][i]+1);\n            }\n            if(P[i]==3)\n            {\n                f(dp[j][i+1], dp[j][i]);\n                f(dp[j][i+1], dp[j^(1&lt;&lt;i)][i]);\n            }   \n            if(P[i]==1)\n            {\n                if(j&amp;(1&lt;&lt;i))\n                {\n                    f(dp[j][i+1], dp[j][i]+1);\n                    f(dp[j][i+1], dp[j^(1&lt;&lt;i)][i]+1);\n                }\n                else\n                {\n                    f(dp[j][i+1], dp[j][i]);\n                    f(dp[j][i+1], dp[j^(1&lt;&lt;i)][i]+1);\n                }\n            }\n            if(P[i]==2)\n            {\n                if(j&amp;(1&lt;&lt;i))\n                {\n                    f(dp[j][i+1], dp[j][i]+1);\n                    f(dp[j][i+1], dp[j^(1&lt;&lt;i)][i]);\n                }\n                else\n                {\n                    f(dp[j][i+1], dp[j][i]);\n                    f(dp[j][i+1], dp[j^(1&lt;&lt;i)][i]);\n                }\n            }\n        }\n    }\n    for(int i=1; i&lt;=N; i++)\n    {\n        if(dp[B[i]][M].first.second!=i) printf(\"%d\\n\", M-dp[B[i]][M].first.first);\n        else printf(\"%d\\n\", M-dp[B[i]][M].second.first);\n    }\n}\n</code></pre>","tags":["~ solution","bitmask","dp","dp_sum_over_subsets"]},{"location":"study/","title":"Study Records","text":""},{"location":"study/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Random Platinum Defence</li> <li>OI Review</li> </ul>"},{"location":"study/#contest-review","title":"Contest Review","text":"<ul> <li>[20250711] SCPC 2025 Round 1</li> </ul>"},{"location":"study/#todo","title":"Todo","text":""},{"location":"study/Contest%20Review/20250711/post/","title":"SCPC 2025 Round 1","text":"","tags":["~post"]},{"location":"study/Contest%20Review/20250711/post/#a","title":"A. \uac70\uc2a4\ub984\ub3c8","text":"<ul> <li>\\(500\\)\uc6d0\uc744 \ub0b4\ub294 \uc0ac\ub78c\uc774 \uc654\uc744 \ub54c\ub294 \\(500\\)\uc6d0\uc744 \ubc1b\ub294 \uc120\ud0dd\uc9c0\ubc16\uc5d0 \uc5c6\uc73c\uba70, \ud56d\uc0c1 \uac00\ub2a5\ud558\ub2e4.</li> <li>\\(1000\\)\uc6d0\uc744 \ub0b4\ub294 \uc0ac\ub78c\uc774 \uc654\uc744 \ub54c\ub294 \\(1000\\)\uc6d0\uc744 \ubc1b\uace0 \\(500\\)\uc6d0\uc744 \uac70\uc2ac\ub7ec \uc8fc\ub294 \uc120\ud0dd\uc9c0\ubc16\uc5d0 \uc5c6\uc73c\uba70, \\(500\\)\uc6d0 \ub3d9\uc804\uc774 \ub0a8\uc544 \uc788\ub2e4\uba74 \uac00\ub2a5\ud558\ub2e4.</li> <li>\\(5000\\)\uc6d0\uc744 \ub0b4\ub294 \uc0ac\ub78c\uc774 \uc654\uc744 \ub54c\uac00 \ubb38\uc81c\uc778\ub370, \uc6b0\uc120 \\(5000\\)\uc6d0 \uc9c0\ud3d0\ub294 \uac70\uc2a4\ub984\ub3c8\uc5d0 \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0\uac00 \uc5c6\uae30 \ub54c\ubb38\uc5d0 \ubb34\uc2dc\ud574\ub3c4 \ub418\uace0, \ud604\uc7ac \uac16\uace0 \uc788\ub294 \\(500\\)\uc6d0\uc9dc\ub9ac \ub3d9\uc804\ub4e4\uacfc \\(1000\\)\uc6d0\uc9dc\ub9ac \uc9c0\ud3d0\ub97c \uc774\uc6a9\ud558\uc5ec \\(4500\\)\uc6d0\uc744 \uac70\uc2ac\ub7ec \uc8fc\ub294 \uc0c1\ud669\uc774\ub2e4.     \\(500\\)\uc6d0\uc9dc\ub9ac \ub3d9\uc804\uc740 2\ubc88\uc9f8 \ucf00\uc774\uc2a4\uc5d0\uc11c \uac70\uc2ac\ub7ec \uc8fc\uc5b4\uc57c \ud558\uc9c0\ub9cc \\(1000\\)\uc6d0\uc9dc\ub9ac \uc9c0\ud3d0\ub294 \ubc1b\uae30\ub9cc \ud558\ub2c8, \ucd5c\ub300\ud55c \\(1000\\)\uc6d0\uc9dc\ub9ac \uc9c0\ud3d0\ub97c \ub9ce\uc774 \uc774\uc6a9\ud558\ub294 \uac83\uc774 \uc774\ub4dd\uc774\ub2e4.     \ub530\ub77c\uc11c \\(4500\\)\uc6d0\uc744 \uc6b0\uc120 \uac00\ub2a5\ud55c \ub9ce\uc740 \\(1000\\)\uc6d0 \uc9c0\ud3d0\ub97c \uc774\uc6a9\ud558\uace0, \ub0a8\uc740 \ub9cc\ud07c \\(500\\)\uc6d0\uc9dc\ub9ac \ub3d9\uc804\uc744 \uc774\uc6a9\ud558\uc5ec \uac70\uc2ac\ub7ec \uc8fc\uba74 \ub41c\ub2e4.</li> </ul> <p>\uc704 \uc804\ub7b5\uc5d0 \ub9de\uac8c \uc0ac\ub78c\ub4e4\uc774 \uc62c \ub54c\ub9c8\ub2e4 \ud604\uc7ac \ub0b4\uac00 \ub4e4\uace0 \uc788\ub294 \\(500\\)\uc6d0, \\(1000\\)\uc6d0\uc758 \uac1c\uc218\ub97c \uad00\ub9ac\ud558\uba70 \uadf8\ub9ac\ub514\ud558\uac8c \ubc30\uc815\ud558\ub2e4\uac00 \uc2e4\ud328\ud558\ub294 \uc21c\uac04\uc744 \uad6c\ud558\uba74 \ub41c\ub2e4.</p>","tags":["~post"]},{"location":"study/Contest%20Review/20250711/post/#b","title":"B. \ud3ed\ud0c4","text":"<p>\uac01 \ud3ed\ud0c4 \uc0ac\uc774\uc5d0 \\(0\\)\uc73c\ub85c \uc774\ub3d9\ud560\uc9c0, \\(L\\)\ub85c \uc774\ub3d9\ud560\uc9c0\ub97c \uc815\ud558\uba74 \ub418\ub294 \ubb38\uc81c\uc774\ub2e4. \ubaa8\ub4e0 \uc120\ud0dd\ub4e4\uc774 \uc11c\ub85c \ub3c5\ub9bd\uc801\uc774\ubbc0\ub85c \ub2e8\uc21c\ud558\uac8c \uc778\uc811\ud55c \ub450 \ud3ed\ud0c4 \uc0ac\uc774\uc5d0\uc11c \\(0\\)\uc73c\ub85c \uc774\ub3d9\ud558\ub294 \uac70\ub9ac\uc758 \ud569\uc774 \uc791\uc740\uc9c0, \\(L\\)\ub85c \uc774\ub3d9\ud558\ub294 \uac70\ub9ac\uc758 \ud569\uc774 \uc791\uc740\uc9c0 \ub530\uc838\uc11c \uadf8\ub9ac\ub514\ud558\uac8c \ub354\ud574\uc8fc\uba74 \ub41c\ub2e4.</p>","tags":["~post"]},{"location":"study/Contest%20Review/20250711/post/#c","title":"C. \uc2ed\uc9c4\uc218","text":"<p>\uc0dd\uac01\uc758 \ud3b8\uc758\ub97c \uc704\ud558\uc5ec leading zero\ub97c \ubaa8\ub450 \ubd99\uc5ec\uc11c \uc0dd\uac01\ud55c\ub2e4. (\uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 \uc22b\uc790\uac00 \\(0, 1, 2\\)\uc774\uae30 \ub54c\ubb38\uc5d0 \ubb38\uc81c\uac00 \uc5c6\ub2e4.) \ub610\ud55c, \ud3b8\uc758\ub97c \uc704\ud558\uc5ec \\(1 \\sim N\\)\uae4c\uc9c0\uc758 \uc218 \ub300\uc2e0 \\(0 \\sim N-1\\)\uae4c\uc9c0\uc758 \uc218\ub4e4 \uc911 \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \uc218\ub4e4\uc758 \uac1c\uc218\ub97c \uc13c\ub2e4.</p> <p>\uac00\uc7a5 \uc55e\uc790\ub9ac\ubd80\ud130 \ud558\ub098\uc529 \ubcf4\uba70, \\(0 \\sim N-1\\) \uc218\ub4e4 \uc911 \uc9c0\uae08\uae4c\uc9c0 \ubcf8 \uc790\ub9ac\uc758 \uc22b\uc790\ub4e4\uc774 \\(N\\)\uacfc \ub2e4\ub978 \uc218\ub4e4\uc758 \uac1c\uc218\ub97c \ub2f5\uc5d0 \ub354\ud574 \ub098\uac04\ub2e4. \ud604\uc7ac \uc790\ub9ac\uc758 \uce78\uc744 \ud3ec\ud568\ud558\uc5ec, \uc55e\uc73c\ub85c \ub0a8\uc740 \uc790\ub9ac\ub4e4\uc758 \uac1c\uc218\ub97c \\(k\\)\uac1c\ub77c \ud558\uc790.</p> <ul> <li>\ud604\uc7ac \uc790\ub9ac\uac00 \\(0\\) : \ucd94\uac00\ub85c \ub354\ud558\uc9c0 \uc54a\uace0 \ub2e4\uc74c \uc790\ub9ac\ub85c \ub118\uc5b4\uac04\ub2e4.</li> <li>\ud604\uc7ac \uc790\ub9ac\uac00 \\(1\\) : \ud604\uc7ac \uc790\ub9ac\uac00 \\(0\\)\uc778 \uc218\ub4e4\uc744 \ubaa8\ub450 \ub2f5\uc5d0 \ub354\ud574\uc8fc\uc5b4\uc57c \ud55c\ub2e4.     \ub2f5\uc5d0 \\(3^{k-1}\\)\uc744 \ub354\ud558\uace0 \ub2e4\uc74c \uc790\ub9ac\ub85c \ub118\uc5b4\uac04\ub2e4.</li> <li>\ud604\uc7ac \uc790\ub9ac\uac00 \\(2\\) : \ud604\uc7ac \uc790\ub9ac\uac00 \\(0, 1\\)\uc778 \uc218\ub4e4\uc744 \ubaa8\ub450 \ub2f5\uc5d0 \ub354\ud574\uc8fc\uc5b4\uc57c \ud55c\ub2e4.     \ub2f5\uc5d0 \\(2 \\cdot 3^{k-1}\\)\uc744 \ub354\ud558\uace0 \ub2e4\uc74c \uc790\ub9ac\ub85c \ub118\uc5b4\uac04\ub2e4.</li> <li>\ud604\uc7ac \uc790\ub9ac\uac00 \\(3\\)\uc774\uc0c1 : \ub354 \uc774\uc0c1 \ucd94\uac00\uc801\uc73c\ub85c \uace0\ub824\ud560 \ud544\uc694\uac00 \uc5c6\ub2e4.     \ud604\uc7ac \uc790\ub9ac\ubd80\ud130 \uc2dc\uc791\ud558\uc5ec \ub0a8\uc740 \ubaa8\ub4e0 \uc790\ub9ac\uc5d0 \\(0, 1, 2\\)\ub97c \uc790\uc720\ub86d\uac8c \ubc30\uc815\ud558\uba74 \ub41c\ub2e4.     \ub2f5\uc5d0 \\(3^k\\)\ub97c \ub354\ud558\uace0 \uc885\ub8cc\ud55c\ub2e4.</li> </ul>","tags":["~post"]},{"location":"study/Contest%20Review/20250711/post/#d","title":"D. \uc0c1\uc810","text":"<p>\uc6b0\uc120 \ud30c\ub780 \uc9d1 \\(b\\)\uacfc \ub9e4\uce6d\ub418\ub294 \ube68\uac04 \uc0c1\uc810 \\(r\\)\uc758 \uc21c\uc11c\uc30d\uc744 \uace0\uc815\uc2dc\ucf30\ub2e4\uace0 \uc0dd\uac01\ud558\uc790. \uac19\uc740 \uac1c\uc218\uc758 \ube68\uac04 \uc9d1\ub4e4\uc744 \ube68\uac04 \uc0c1\uc810\ub4e4\uacfc \uc77c\ub300\uc77c \ub9e4\uce6d \uc2dc\ucf1c\uc11c \uac70\ub9ac\uc758 \ud569\uc744 \ucd5c\uc18c\ud654\ud574\uc57c \ud558\ub2c8, \uc774\ub294 \ub450 \uc9d1\ud569\uc744 \uc815\ub82c\ud558\uace0 \uc21c\uc11c\ub300\ub85c \ub9e4\uce6d\ud558\uba74 \ub41c\ub2e4. (\ud30c\ub780 \uc9d1\ub4e4\uacfc \ud30c\ub780 \uc0c1\uc810\ub4e4\ub3c4 \ub9c8\ucc2c\uac00\uc9c0\ub85c \uacc4\uc0b0\ud55c\ub2e4.) \uc774\uc640 \uac19\uc774 \\((r, b)\\)\uc758 \uc21c\uc11c\uc30d\uc744 \uace0\uc815\uc2dc\ud0a4\ub294\ub370 \\(O(N^2)\\), \ube44\uc6a9\uc744 \uacc4\uc0b0\ud558\ub294\ub370 \\(O(N)\\)\uc73c\ub85c \\(O(N^3)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\\((r, b)\\) \ub300\uc2e0 \\(r\\)\ub9cc \uace0\uc815\ud574\ub3c4 \ube68\uac04 \uc9d1\ub4e4\uacfc \ube68\uac04 \uc0c1\uc810\ub4e4 \uac04\uc758 \ub9e4\uce6d \ube44\uc6a9\uc740 \uacc4\uc0b0\ud560 \uc218 \uc788\ub2e4. \uc774\ub294 \ube68\uac04 \uc9d1, \uc0c1\uc810 \ub450 \uc9d1\ud569\uc744 \uc815\ub82c\ud558\uace0 prefix, suffix sum\uc744 \uc774\uc6a9\ud558\uc5ec \ube60\ub974\uac8c \uad6c\ud560 \uc218 \uc788\uc73c\uba70 \uacb0\ub860\uc801\uc73c\ub85c \ubaa8\ub4e0 \\(r\\)\uc5d0 \ub300\ud574 \\(r\\)\uc744 \uc120\ud0dd\ud588\uc744 \ub54c \ub0a8\uc740 \ube68\uac04 \uc9d1, \uc0c1\uc810\ub4e4\uc744 \ub9e4\uce6d\ud558\ub294 \ube44\uc6a9 \\(X[r]\\)\uc744 \\(O(N)\\)\uc5d0 \uad6c\ud560 \uc218 \uc788\ub2e4. \uac19\uc740 \ubc29\ubc95\uc73c\ub85c \\(b\\)\ub97c \uc120\ud0dd\ud588\uc744 \ub54c \ub0a8\uc740 \ud30c\ub780 \uc9d1, \uc0c1\uc810\ub4e4\uc744 \ub9e4\uce6d\ud558\ub294 \ube44\uc6a9 \\(Y[b]\\)\ub97c \\(O(N)\\)\uc5d0 \uad6c\ud560 \uc218 \uc788\ub2e4.</p> <p>\uc774\uc81c \uc6b0\ub9ac\uac00 \ud574\uacb0\ud558\uace0 \uc2f6\uc740 \ubb38\uc81c\ub294 \ubaa8\ub4e0 \\((r, b)\\) \uc21c\uc11c\uc30d\uc5d0 \ub300\ud558\uc5ec \\(X[r]+Y[b]+|A[r]-B[b]|\\) (\\(A[r], B[b]\\)\ub294 \uc88c\ud45c)\ub97c \ucd5c\uc18c\ud654 \ud558\ub294 \uac83\uc774\ub2e4. \uc808\ub313\uac12 \uae30\ud638\uac00 \uac70\uc2ac\ub9ac\uae34 \ud558\uc9c0\ub9cc, \\(A[r]&gt;B[b]\\)\uc778 \uacbd\uc6b0\ub9cc \uace0\ub824\ud55c\ub2e4\uace0 \uac00\uc815\ud558\uba74 \\((X[r]+A[r])+(Y[b]-B[b])\\)\ub97c \ucd5c\uc18c\ud654\ud558\ub294 \ubb38\uc81c\uc774\ub2c8 \ubcc0\uc218 \ubd84\ub9ac\uac00 \uac00\ub2a5\ud558\uace0, \\(r\\)\uc744 \ud558\ub098\uc529 \uc99d\uac00\uc2dc\ud0a4\uba70, \\(b\\)\uc5d0 \ub300\ud55c \ud22c \ud3ec\uc778\ud130\ub85c \\(O(N)\\)\uc5d0 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4. \ubc18\ub300\uc758 \uacbd\uc6b0\ub3c4 \uc815\ud655\ud788 \uac19\uc740 \ubc29\ubc95\uc73c\ub85c \ud55c\ubc88 \ub354 \ud22c \ud3ec\uc778\ud130\ub97c \ud65c\uc6a9\ud558\uba74 \uc815\ub82c \ud55c\ubc88 \ud6c4 \uc804 \uacfc\uc815\uc744 \\(O(N)\\)\uc5d0 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p>","tags":["~post"]},{"location":"study/Contest%20Review/20250711/post/#e-mst","title":"E. MST","text":"<p>\ubaa8\ub4e0 \uc2a4\ud328\ub2dd \ud2b8\ub9ac\ub4e4\uc5d0 \ub300\ud558\uc5ec, 1. \uc0ac\uc6a9\ud55c \uac04\uc120\uc758 \uac00\uc911\uce58\uc758 \ucd5c\ub313\uac12 - \ucd5c\uc19f\uac12\uc744 \ucd5c\ub300\ud654 \ud574\uc57c \ud558\uace0, 2. \uac19\uc740 \uacbd\uc6b0 \uc0ac\uc6a9\ud55c \uac04\uc120\uc758 \uac00\uc911\uce58 \ud569\uc744 \ucd5c\uc18c\ud654 \ud574\uc57c \ud55c\ub2e4.</p> <p>\uc6b0\uc120, \"\uc0ac\uc6a9\ud55c \uac04\uc120\uc758 \uac00\uc911\uce58\uc758 \ucd5c\ub313\uac12 - \ucd5c\uc19f\uac12\"\uc744 \ucd5c\ub300\ud654 \ud574\uc57c \ud558\ub294\ub370, \ub2e4\uc74c\uacfc \uac19\uc774 \ubcc0\ud615\ud560 \uc218 \uc788\ub2e4. \"\uc2a4\ud328\ub2dd \ud2b8\ub9ac\uc5d0 \ub300\ud558\uc5ec \uc784\uc758\uc758 \ub450 \uac04\uc120 \\(e_1, e_2\\)\ub97c \uc120\ud0dd\ud558\uace0, \\(e_1 - e_2\\)\"\ub97c \ucd5c\ub300\ud654 \ud558\ub294 \ubb38\uc81c\ub85c \ubc14\uafb8\uc5b4 \uc0dd\uac01\ud574\ub3c4 \ucd5c\uc801\ud574\uc5d0\uc11c\ub294 \uc790\uc5f0\uc2a4\ub7fd\uac8c \\(e_1\\)\uc744 \ucd5c\ub313\uac12, \\(e_2\\)\ub97c \ucd5c\uc19f\uac12\uc73c\ub85c \uc120\ud0dd\ud560 \uac83\uc774\uae30 \ub54c\ubb38\uc5d0 \uc6d0\ub798 \ubb38\uc81c\uc640 \ub3d9\uc77c\ud558\ub2e4. \uc774 \ubb38\uc81c\ub294 \uba3c\uc800 \uc784\uc758\uc758 \ub450 \uac04\uc120 \\(e_1, e_2\\)\ub97c \uc120\ud0dd\ud558\uace0, \uadf8 \ub2e4\uc74c \\(e_1, e_2\\)\ub97c \ud3ec\ud568\ud558\ub294 MST\ub97c \uc7a1\ub294 \ubb38\uc81c\ub85c \uc0dd\uac01\ud560 \uc218 \uc788\uc73c\ub2c8, \\(O(M^3)\\)\uc5d0 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\ud558\uc9c0\ub9cc \uc6b0\ub9ac\ub294 \\(e_2\\)\ub97c \ucd5c\uc19f\uac12 \uac04\uc120\uc73c\ub85c \uc120\ud0dd\ud558\uace0 \uc2f6\uace0, MST\ub97c \uc120\ud0dd\ud558\uba74 \uc790\uc5f0\uc2a4\ub7fd\uac8c \ucd5c\uc18c \uac00\uc911\uce58 \uac04\uc120\uc740 \ubb34\uc870\uac74 \ud3ec\ud568\ud55c\ub2e4. \uc774\ub97c \uc774\uc6a9\ud558\uc5ec \ucc98\uc74c\ubd80\ud130 \uad73\uc774 \\(e_1, e_2\\)\ub97c \uc120\ud0dd\ud558\uc9c0 \ub9d0\uace0, \\(e_1\\)\ub9cc \uc120\ud0dd\ud55c \ud6c4 MST\ub97c \uad6c\ud558\uba74 \uc790\uc5f0\uc2a4\ub7fd\uac8c \\(e_2\\)\ub294 \ud604\uc7ac MST\uc5d0\uc11c \ucd5c\uc18c \uac00\uc911\uce58 \uac04\uc120\uc73c\ub85c \uc815\ud558\uba74 \ub41c\ub2e4. \ub530\ub77c\uc11c, \uc784\uc758\uc758 \uac04\uc120 \\(e_1\\)\uc5d0 \ub300\ud558\uc5ec \\(e_1\\)\uc744 \ud3ec\ud568\ud558\ub294 MST\ub97c \uad6c\ud558\uace0, \ucd5c\uc18c \uac00\uc911\uce58 \uac04\uc120\uacfc \uac00\uc911\uce58 \ud569\uc744 \uad6c\ud558\uba74 \ubb38\uc81c\ub97c \\(O(M^2)\\)\uc5d0 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p> <p>\ud558\uc9c0\ub9cc \"\uc784\uc758\uc758 \uac04\uc120 \\(e_1\\)\uc744 \ud3ec\ud568\ud558\ub294 MST \uad6c\ud558\uae30\"\ub294 \uc720\uba85\ud55c \ubb38\uc81c\uc774\uba70, \uae30\ubcf8\uc801\uc73c\ub85c MST\ub97c \uad6c\ud55c \ud6c4, \uc6d0\ud558\ub294 \uac04\uc120 \\(e_1\\)\uc774 \uc5f0\uacb0\ud558\ub294 \ub450 \uc815\uc810 \uc0ac\uc774\uc758 \uacbd\ub85c\uc5d0\uc11c \uac00\uc7a5 \uac00\uc911\uce58\uac00 \ud070 \uac04\uc120\uc744 \ub04a\uace0 \\(e_1\\)\uc744 \uc0bd\uc785\ud558\uba74 \ub41c\ub2e4. \uc6b0\ub9ac\uac00 \ud544\uc694\ud55c \uac74 \uc6d0\ub798 MST\uc5d0\uc11c \uc5b4\ub5a4 \uac04\uc120\uc744 \ub04a\uc5b4\uc57c \ud558\ub294\uc9c0\uc640, \uadf8 \uac04\uc120\uc744 \ub04a\uace0 \\(e_1\\)\uc744 \uc0bd\uc785\ud558\uc600\uc744 \ub54c\uc758 \ucd5c\uc18c \uac00\uc911\uce58 \uac04\uc120\uacfc \uac00\uc911\uce58 \ud569\uc774\ub2c8, \uc6d0\ub798 MST\uc5d0\uc11c minimum\uacfc second minimum \uc815\ub3c4\ub9cc \uad00\ub9ac\ud558\uace0, \uc6d0\ub798 MST\uc5d0\uc11c path maximum query\ub97c \ube60\ub974\uac8c \ud574\uacb0\ud560 \uc218 \uc788\uc73c\uba74 \ub41c\ub2e4. \uc774\ub294 sparse table\uc744 \uc774\uc6a9\ud558\uba74 \uc27d\uac8c \ud574\uacb0\ud560 \uc218 \uc788\uc73c\ub2c8, \uc804\uccb4 \ubb38\uc81c\ub97c \\(O(M \\log M)\\)\uc5d0 \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.</p>","tags":["~post"]},{"location":"study/OI%20Review/post/","title":"OI Review","text":"","tags":["~post"]},{"location":"study/OI%20Review/post/#joi","title":"JOI","text":"","tags":["~post"]},{"location":"study/OI%20Review/post/#2023","title":"2023","text":"","tags":["~post"]},{"location":"study/OI%20Review/post/#p3-maze","title":"P3 Maze","text":"<p>01-BFS. \uc774\ubbf8 \ub6ab\ub824 \uc788\ub294 \uce78\uc774\ub77c\uba74 \ube44\uc6a9 0\uc73c\ub85c \uc774\ub3d9\ud558\uace0 \ub6ab\ub824 \uc788\uc9c0 \uc54a\uc740 \uce78\uc774\ub77c\uba74 \ud604\uc7ac \uc704\uce58 \uc911\uc2ec\uc73c\ub85c \uc815\uc0ac\uac01\ud615 \uc601\uc5ed\uc5d0 \ubcbd\uc758 \uc874\uc7ac \uc720\ubb34\uc640 \ubb34\uad00\ud558\uac8c \ube44\uc6a9 1\uc73c\ub85c \uc774\ub3d9\ud55c\ub2e4. \ud55c\ubc88 \ub370\ud050\uc5d0 \ub4e4\uc5b4\uac04 \uc815\uc810\ub4e4\uc744 \ub2e4\uc2dc \ub123\uc9c0 \uc54a\ub3c4\ub85d \ud558\uc5ec \uc2dc\uac04\uc744 \uc904\uc5ec\uc57c \ud558\ub294\ub370, \uad6c\uac04\uc5d0 \ucf1c\uc838 \uc788\ub294 \uce78 \ubaa8\ub450 \ub3cc\uba70 \uc0ad\uc81c \uc5f0\uc0b0\uc744 \ud574\uc57c \ud558\ub2c8 set\uc774\ub098 union find \uc790\ub8cc\uad6c\uc870\ub85c \ud574\uacb0\ud55c\ub2e4.</p>","tags":["~post"]},{"location":"study/OI%20Review/post/#2022","title":"2022","text":"","tags":["~post"]},{"location":"study/OI%20Review/post/#p3-lets-win-the-election","title":"P3 Let\u2019s Win the Election","text":"<p>\ucd5c\uc801\ud574\ub294 collaborator\uc744 \uc5bb\uc744 \uc9c0\uc5ed\uc744 \uc6b0\uc120 \uc21c\ud68c\ud558\uba70 \\(i\\)\uba85 \uc5bb\uc740 \ud6c4, \ub0a8\uc740 \uc9c0\uc5ed\ub4e4 \uc911 \\(A_i\\)\uac00 \uac00\uc7a5 \uc791\uc740 \uac83 \\(K-i\\)\uac1c\ub97c \uba39\ub294 \ud615\ud0dc\uc774\ub2e4. \uc989, \\(K\\)\uc911 \uba87\uac1c\ub97c \\(B\\), \uba87\uac1c\ub97c \\(A\\)\ub85c \uce60\ud574 \uba3c\uc800 \\(B\\)\ub4e4\uc744 \uc99d\uac00 \uc21c\uc11c\ub300\ub85c \uba39\uc740 \ud6c4 \ub0a8\uc740 \uc9c0\uc5ed\ub4e4 \uc911 \uac00\uc7a5 \uc791\uc740 \\(A_i\\)\ub4e4\uc744 \uace8\ub77c \ub2f4\uc73c\uba74 \ub41c\ub2e4. \uad6c\uccb4\uc801\uc73c\ub85c\ub294, \ud2b9\uc815 \uc0c1\uc218 \\(X\\), \\(Y\\)\uc5d0 \ub300\ud574\uc11c \\(A \\le X\\)\uc774\uac70\ub098 \\(B \\le Y\\)\uc778 \uac83\ub4e4\uc744 \ubaa8\ub450 \uba39\uac8c \ub41c\ub2e4. \uba39\uc744 \\(B\\) \uc9c0\uc5ed\uc758 \uac1c\uc218\ub97c \uace0\uc815\ud574\ub193\uace0 \uc0dd\uac01\ud558\uc790. \\(B\\)\uc5d0 \ub300\ud574\uc11c \uc815\ub82c\ud574\ub193\uace0 \uc0dd\uac01\ud558\uace0, \uc55e\uc5d0\uc11c\ubd80\ud130 \ud558\ub098\uc529 \\(B\\)\ub85c \uba39\uc744\uc9c0, \\(A\\)\ub85c \uba39\uc744\uc9c0 \uacb0\uc815\ud558\uba70 \\(dp[i][j] :=\\) \\(i\\)\uae4c\uc9c0 \ubd24\uace0, \uc9c0\uae08\uae4c\uc9c0 B\ub294 \\(j\\)\ub85c \uba39\uc5c8\uc744 \ub584\uc758 \ucd5c\uc18c \ube44\uc6a9\uc758 \ud569\uc744 \uacc4\uc0b0\ud55c\ub2e4. \\(B\\)\ub97c \uc815\ud55c \ub9cc\ud07c \ub2e4 \uba39\uc73c\uba74 \ub0a8\uc740 \uac83\ub4e4 \uc911 \uba39\uc5b4\uc57c \ud558\ub294\ub9cc\ud07c \uc791\uc740\uac70\ubd80\ud130 \uace8\ub77c\uc11c \uba39\uc5b4\uc8fc\uba74 \ub41c\ub2e4. \uba39\uc744 \uc9c0\uc5ed\uc758 \uac1c\uc218\ub97c \uace0\uc815\ud574\ub193\uc558\uae30 \ub584\ubb38\uc5d0 dp\ub97c \ud558\ub294 \uacfc\uc815\uc5d0\uc11c \uc704 \uc2dd\uc744 \uacc4\uc0b0\ud560 \uc218 \uc788\ub2e4. \ubcc0\uc218 \uace0\uc815\uacfc dp\uc5d0 \\(O(N^3)\\)\uc758 \uc2dc\uac04\uc774 \uac78\ub9b0\ub2e4.</p>","tags":["~post"]},{"location":"study/OI%20Review/post/#p4-railway-trip-2","title":"P4 Railway Trip 2","text":"<p>\uac01 \uc815\uc810\uc5d0\uc11c \uc2dc\uc791\ud558\uba74 \ud55c \ubc88\uc758 \uc774\ub3d9\uc73c\ub85c \uc5b4\ub5a4 \uc601\uc5ed\uae4c\uc9c0 \uc774\ub3d9\ud560 \uc218 \uc788\ub294\uc9c0 \uc0dd\uac01\ud558\uc790. \uc774\ub294 \ud604\uc7ac \ub0b4 \uc704\uce58\ub97c \ucee4\ubc84\ud560 \uc218 \uc788\ub294 \uc5f4\ucc28\ub4e4 \uc911 \ucd5c\ub313\uac12\uacfc \ucd5c\uc19f\uac12 \ucffc\ub9ac\ub85c \uc2a4\uc704\ud551\ud558\uba74\uc11c \uad6c\ud560 \uc218 \uc788\ub2e4. \uc774\uc81c, \ubb38\uc81c\ub294 \uac01 \uc815\uc810\uc5d0\uc11c 1\uc758 \uac00\uc911\uce58\ub85c \uc774\ub3d9\ud560 \uc218 \uc788\ub294 \uad6c\uac04\uc774 \uc8fc\uc5b4\uc9c8 \ub54c, \\(s\\)\uc5d0\uc11c \\(e\\)\uae4c\uc9c0 \uac00\ub294 \ucd5c\ub2e8\uacbd\ub85c \ucffc\ub9ac\uc5d0 \ub300\ud574 \ub2f5\ud574\uc57c \ud55c\ub2e4. \uac00\uc911\uce58 \\(k\\)\ub85c \uc774\ub3d9\ud560 \uc218 \uc788\ub294 \uc815\uc810\ub4e4\uc740 \ud56d\uc0c1 \uad6c\uac04\uc744 \uc774\ub8e8\uace0, \uc774 \uad6c\uac04\ub4e4\uc740 \\(k\\)\uac00 \uc99d\uac00\ud558\uba74 \ud560\uc218\ub85d \ud655\uc7a5\ub418\ub294 \ud615\ud0dc\uc774\ub2e4. \uc774\ub97c sparse table\uc744 \uc774\uc6a9\ud558\uc5ec \uad00\ub9ac\ud560\uac74\ub370, \ud604\uc7ac \uc704\uce58\uc5d0\uc11c \\(2^{i+1}\\)\ubc88\uc758 \uc774\ub3d9\uc73c\ub85c \ub3c4\ucc29\ud560 \uc218 \uc788\ub294 \uad6c\uac04\uc740 \\(2^i\\)\ubc88\uc758 \uc774\ub3d9\uc73c\ub85c \ub3c4\ucc29\ud560 \uc218 \uc788\ub294 \uad6c\uac04\ub4e4\uc758 \uac12 \uc911 min, max\uc758 \ud615\ud0dc\uc774\ub2c8, range min / max query\ub97c sparse table\uc758 \uac01 \uce35\uc5d0 \ub300\ud558\uc5ec \ub0a0\ub824\uc11c \uad6c\ud560 \uc218 \uc788\ub2e4.</p>","tags":["~post"]},{"location":"study/OI%20Review/post/#p5-sandcastle-2","title":"P5 Sandcastle 2","text":"<p>\ud575\uc2ec \uad00\ucc30\uc740 \uc804\uccb4 \uc9c1\uc0ac\uac01\ud615\uc774 \uc62c\ubc14\ub978 \uc9c1\uc0ac\uac01\ud615\uc77c \ud544\uc694\ucda9\ubd84 \uc870\uac74\uc740, \uac01 \uc815\uc810\uc5d0\uc11c \uc778\uc811\ud55c \uce78\ub4e4 \uc911 \uc790\uc2e0\ubcf4\ub2e4 \uc791\uc740 \uac83 \uc911 \ucd5c\ub300\uc778 \uce78\uc73c\ub85c \uac04\uc120\uc744 \uc774\uc5c8\uc744 \ub584, \ubaa8\ub4e0 \uce78\uc758 \\(outdegree=1\\), \\(indegree=1\\)\uc774\uba70, \ub531 \ud55c \uc815\uc810\ub9cc \\(outdegree \\ne 1\\), \ub531 \ud55c \uc815\uc810\ub9cc \\(indegree \\ne 1\\)\uc774\ub77c\ub294 \uac83\uc774\ub2e4. \ub610\ud55c, \\(HW \\le N\\)\uc778 \uc0c1\ud669\uc5d0\uc11c \\(min(H, W) HW \\le N \\sqrt{N}\\)\uc774\ub77c\ub294 \uc810\uc744 \uc0dd\uac01\ud558\uc790. WLOG \\(H \\le W\\)\ub77c\uba74, \\(1 \\le i \\le j \\le H\\)\ub97c \ubaa8\ub450 \uace0\uc815\ud574\ubcf4\uba70, \\(O(W)\\)\uc5d0 \uc62c\ubc14\ub978 \uc9c1\uc0ac\uac01\ud615\uc758 \uac1c\uc218\ub97c \uc138\uc8fc\uba74 \ub418\ub294\ub370, \uacb0\uad6d \uc911\uc694\ud55c\uac74 \\(indegree \\ne 1\\), \\(outdegree \\ne 1\\)\uc778 \uce78\uc758 \uac1c\uc218\ub77c\ub294 \uac83\uc5d0 \uc9d1\uc911\ud558\uc790. \ubd80\ubd84\uc9c1\uc0ac\uac01\ud615\uc744 \uc7a1\uc558\uc744 \ub54c, \ud14c\ub450\ub9ac\uc5d0\uc11c \uba40\ub9ac \ub5a8\uc5b4\uc838 \uc788\ub294 \uce78\ub4e4\uc758 \uc785\uc7a5\uc5d0\uc11c\ub294 \ubd80\ubd84\uc9c1\uc0ac\uac01\ud615\uacfc \ubb34\uad00\ud558\uac8c indegree, outdegree\uac00 \uc77c\uc815\ud558\ub2e4\ub294 \uc810\uc744 \uc0dd\uac01\ud558\uba74 \uac00\ub2a5\ud55c \ubaa8\ub4e0 \uacbd\uc6b0\uac00 \\(3^4\\)\uac00\uc9c0 \uc815\ub3c4\ubc16\uc5d0 \uc5c6\uace0, \uc774\ub97c \ubbf8\ub9ac \uc804\ucc98\ub9ac\ud574\ub193\uc73c\uba74, \ub2e8\uc21c \ub204\uc801\ud569 \uc791\uc5c5 \ub4f1\uc73c\ub85c \ub2f5\uc744 \uacc4\uc0b0\ud560 \uc218 \uc788\ub2e4.</p>","tags":["~post"]},{"location":"study/OI%20Review/post/#2020","title":"2020","text":"","tags":["~post"]},{"location":"study/OI%20Review/post/#p4-olympic-bus","title":"P4 Olympic Bus","text":"<p>\uac04\uc120 \\((u, v)\\)\ub97c \ub4a4\uc9d1\ub294\ub2e4\uace0 \uc0dd\uac01\ud588\uc744 \ub54c\uc758 \ub2f5\uc740 \uc6b0\uc120 \uadf8\ub798\ud504\uc5d0\uc11c \\((u, v)\\)\ub97c \uc0ad\uc81c\ud55c \ud6c4, \\(1 \\rightarrow N\\)\uc740 \\(min(dist(1, v)+w+dist(u, N), dist(1, N))\\)\uc774\uace0, \ube44\uc2b7\ud558\uac8c \\(N \\rightarrow 1\\)\ub3c4 \uad6c\ud560 \uc218 \uc788\ub2e4. \uc911\uc694\ud55c \uac83\uc740 \uac04\uc120\uc744 \uadf8\ub798\ud504\uc5d0\uc11c \uc0ad\uc81c\ud574\uc57c\ud55c\ub2e4\ub294 \uac83\uc778\ub370, \ub2e4\uc775\uc2a4\ud2b8\ub77c\ub97c \ub3cc\ub9ac\ub294 \uacfc\uc815\uc5d0\uc11c \ucd5c\ub2e8\uacbd\ub85c\ub97c \uac31\uc2e0\ud558\ub294\ub370 \uc0ac\uc6a9\ud55c \uac04\uc120\uc744 \uac01 \uc815\uc810\uc5d0 \ub300\ud574\uc11c \ud558\ub098\uc529 \uace8\ub77c\uc11c \ub2e4\uc775\uc2a4\ud2b8\ub77c \ud2b8\ub9ac\ub97c \ub9cc\ub4e4\uc790. \uac04\uc120 \\((u, v)\\)\uac00 \ub2e4\uc775\uc2a4\ud2b8\ub77c \ud2b8\ub9ac\uc5d0 \uc0ac\uc6a9\ub418\uc9c0 \uc54a\ub294\ub2e4\uba74, \uc774 \uac04\uc120\uc774 \uc5c6\uc5b4\ub3c4 \ucd5c\ub2e8\uacbd\ub85c\ub294 \ubc14\ub00c\uc9c0 \uc54a\uc73c\ub2c8, \ubb38\uc81c\uac00 \uc5c6\ub2e4. \ub2e4\uc775\uc2a4\ud2b8\ub77c \ud2b8\ub9ac\uc5d0 \uc0ac\uc6a9\ub41c\ub2e4\uba74, \uadf8\ub7f0 \uac04\uc120\uc758 \uc218\ub294 \\(O(N)\\)\uac1c\ubc16\uc5d0 \uc5c6\uc73c\ub2c8, \ub2e4\uc775\uc2a4\ud2b8\ub77c\ub97c \ub2e4\uc2dc \ub3cc\ub824\uc918\ub3c4 \\(O(NM\\log N)\\)\ubc16\uc5d0 \uac78\ub9ac\uc9c0 \uc54a\ub294\ub2e4.</p>","tags":["~post"]},{"location":"study/OI%20Review/post/#p5-fire","title":"P5 Fire","text":"<p>\\(S_i\\)\ub85c \uad6c\uc131\ub41c \ud788\uc2a4\ud1a0\uadf8\ub7a8\uc744 \uadf8\ub9ac\uace0, \uac01 \ud788\uc2a4\ud1a0\uadf8\ub7a8\uc744 \uc624\ub978\ucabd\uc73c\ub85c \ud655\uc7a5\ud55c \ud615\ud0dc\uc758 \uc9c1\uc0ac\uac01\ud615\uc744 \uc0dd\uac01\ud558\uc790. \ub610\ud55c, \ucffc\ub9ac \\((t, l, r)\\)\uc740 \ub204\uc801\ud569\uc744 \uc0dd\uac01\ud558\uba74 \\((t, x)\\)\ub85c \ucabc\uac1c\uc5b4 \uc0dd\uac01\ud560 \uc218 \uc788\ub2e4. \uac01 \uc9c1\uc0ac\uac01\ud615\uc758 \ud615\ud0dc\ub294 \\((l, r, k)\\)\uc758 \ud615\ud0dc\ub85c, \uc9c1\uc0ac\uac01\ud615\uc758 \ub192\uc774\ub294 \\(k\\), \uc67c\ucabd \ubcc0\uc740 \\(x=l\\), \uc624\ub978\ucabd \ubcc0\uc740 \\(x=min(r, l+t)\\)\uc77c \ub54c, \\((t, x)\\) \ucffc\ub9ac\uc5d0 \ub300\ud574\uc11c \\(x\\) \uc774\ud558\uc758 \uc601\uc5ed\uc758 \uc9c1\uc0ac\uac01\ud615\uc758 \ub113\uc774\uc758 \ud569\uc744 \uad6c\ud558\uba74 \ub41c\ub2e4. \\((x, t)\\) \uc88c\ud45c\ud3c9\uba74\uc5d0 \uac01 \uc9c1\uc0ac\uac01\ud615\uc758 \uc815\ubcf4\ub97c \ud45c\ud604\ud558\uba74 \uacb0\uad6d \ub2e4\uc74c \ubb38\uc81c\ub97c \ud480\uc5b4\uc57c \ud568\uc744 \uc54c \uc218 \uc788\ub2e4. \uac01 \uc9c1\uc0ac\uac01\ud615\uc740 \uc810 \\((x, y)\\)\ub97c \uae30\uc900\uc73c\ub85c \uc704\ucabd\uc73c\ub85c \\(y\\)\ucd95\uc5d0 \ud3c9\ud589\uc778 \ubc18\uc9c1\uc120\uacfc \\(y=x\\)\uc5d0 \ud3c9\ud589\uc778 \ubc18\uc9c1\uc120\uc73c\ub85c \uad6c\uc131\ub41c \uc601\uc5ed\uc758 \uc810\ub4e4\uc5d0 \ubaa8\ub450 \\(k\\)\ub97c \ub354\ud558\ub294 \ud615\ud0dc\uc774\uace0, \uac01 \ucffc\ub9ac\ub294 \uc810 \\((x, y)\\)\ub97c \uae30\uc900\uc73c\ub85c \uc67c\ucabd\uc73c\ub85c \uc774\ub3d9\ud558\uba70 \ub9cc\ub098\ub294 \ubaa8\ub4e0 \uac12\ub4e4\uc758 \ud569\uc774\ub2e4. \uc9c1\uc0ac\uac01\ud615 \uc5c5\ub370\uc774\ud2b8 \\((x, y)\\)\uc640 \ucffc\ub9ac \\((x', y')\\)\uc744 \uae30\uc900\uc73c\ub85c \uc0dd\uac01\ud558\uba74 \\(x-y\\), \\(x'-y'\\)\uc758 \ub300\uc18c\uad00\uacc4\uc5d0 \ub530\ub77c \uacbd\uc6b0\ub97c \ub098\ub204\uc5b4 \uc0dd\uac01\ud558\uba74, \ub450 \uacbd\uc6b0\uc5d0 \ub530\ub77c \\(x\\)\uc640 \\(y\\)\uc911 \ud55c \ubcc0\uc218\ub97c \ubb34\uc2dc\ud574\ub3c4 \ub428\uc744 \uc54c \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, \\(x-y\\)\ub85c \ubaa8\ub4e0 \uc5c5\ub370\uc774\ud2b8\uc640 \ucffc\ub9ac\ub4e4\uc744 \uc815\ub82c\ud55c \ud6c4, \uac01 \uacbd\uc6b0\uc5d0 \ub300\ud558\uc5ec \\(x\\)\ub098 \\(y\\)\ucd95\uc5d0 \uc0ac\uc601\uc2dc\ucf1c fenwick tree\ub97c \uc774\uc6a9\ud558\uc5ec \uacc4\uc0b0\ud560 \uc218 \uc788\ub2e4.</p>","tags":["~post"]},{"location":"study/OI%20Review/post/#2019","title":"2019","text":"","tags":["~post"]},{"location":"study/OI%20Review/post/#p4-coin-collecting","title":"P4 Coin Collecting","text":"<p>\uc6b0\uc120, \ud06c\uae30 \\(2N\\)\uc758 \uc9c1\uc0ac\uac01\ud615 \uc601\uc5ed \ubc16\uc758 \uc810\ub4e4\uc5d0 \ub300\ud574\uc11c\ub294 \uac00\uc7a5 \uac00\uae4c\uc6b4 \uc9c1\uc0ac\uac01\ud615 \uc548\uc758 \uc810\uc73c\ub85c \uc774\ub3d9\uc2dc\ud0a4\uace0 \uc0dd\uac01\ud574\ub3c4 \ub41c\ub2e4. \uc774\uc81c, \ubb38\uc81c\ub294 \\(2N\\)\uc758 \uc9c1\uc0ac\uac01\ud615 \uc601\uc5ed\uc5d0 \ub3d9\uc804\ub4e4\uc774 \ucd1d \\(2N\\)\uac1c \ub193\uc5ec \uc788\uc744 \ub54c, \uc774\ub97c \uc801\ub2f9\ud788 \uc774\ub3d9\uc2dc\ucf1c \uc9c1\uc0ac\uac01\ud615\uc758 \uac01 \uce78\uc5d0 \ub3d9\uc804\uc774 \ud558\ub098\uc529 \ub193\uc5ec \uc788\ub3c4\ub85d \ud558\ub294 \ucd5c\uc18c \uc774\ub3d9\uc774\ub2e4. \uc774\ub294 \uc27d\uac8c MCMF\ub85c \ubaa8\ub378\ub9c1\ud560 \uc218 \uc788\uace0, \ub530\ub77c\uc11c \uadf8\ub9ac\ub514\ud558\uac8c \ub3d9\uc804\uc744 \uc790\uae30\uac00 \ub4e4\uc5b4\uac08 \uc218 \uc788\ub294 \uac00\uc7a5 \uac00\uae4c\uc6b4 \uad6c\uba4d\uc73c\ub85c \ub9e4\uce6d\uc2dc\ucf1c\ub3c4 \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub294\ub2e4. \uc774\ub97c \uc27d\uac8c \uad6c\ud604\ud558\uba74, \uccab \ubc88\uc9f8 \uc5f4\ubd80\ud130 \uc2dc\uc791\ud574 \uc2a4\uc704\ud551\ud558\uba70 \ub3d9\uc804\uc774 \ub0a8\uc73c\uba74 \uc624\ub978\ucabd\uc73c\ub85c \ud55c \uce78\uc529 \ubc00\uc5b4\uc8fc\uace0, \ubd80\uc871\ud558\ub2e4\uba74 \uaf2d \ud544\uc694\ud55c \ub9cc\ud07c\ub9cc \ubbf8\ub9ac \ub300\ucd9c\uc744 \ubc1b\uc544 \uc624\ub978\ucabd\uc5d0\uc11c \ubc1b\uc544\uc628\ub2e4\uace0 \uc0dd\uac01\ud558\uace0 \uacc4\uc0b0\uc744 \ud574\uc918\ub3c4 \ub41c\ub2e4.</p>","tags":["~post"]},{"location":"study/OI%20Review/post/#p5-unique-cities","title":"P5 Unique Cities","text":"<p>https://arnold518.tistory.com/78</p>","tags":["~post"]},{"location":"study/OI%20Review/post/#2018","title":"2018","text":"","tags":["~post"]},{"location":"study/OI%20Review/post/#p3-dango-maker","title":"P3 Dango Maker","text":"<p>\uc11c\ub85c \uc601\ud5a5\uc744 \uc904 \uc218 \uc788\ub294 dango\ub4e4\uc740 \uac00\ub85c/\uc138\ub85c \uc5ec\ubd80\uac00 \ub2ec\ub77c\uc57c \ud558\uace0, \uad6c\uccb4\uc801\uc73c\ub85c\ub294 \"RGW\" \uc911 \uac01 R, G, W\ub4e4\uc774 \uac19\uc740 \ub300\uac01\uc120 \uc704\uc5d0 \uc788\uc5b4\uc57c\ub9cc \ud55c\ub2e4. \uc774 \uad00\ucc30\ub85c\ubd80\ud130 \ub9cc\ub4e4 \uc218 \uc788\ub294 \ubaa8\ub4e0 dango\ub4e4\uc744 \ub9cc\ub4e4\uc5b4 \ub193\uace0, \uc18d\ud574 \uc788\ub294 \ub300\uac01\uc120\uc5d0 \ub530\ub77c dango\ub4e4\uc744 \ubb36\uc5b4 \uc904 \uc218 \uc788\ub2e4. \uc774\uc81c \uac01 \uc9d1\ud569\uc5d0 \ub300\ud574\uc11c\ub294 \ub3c5\ub9bd\uc801\uc73c\ub85c \ubb38\uc81c\ub97c \ud480\uba74 \ub418\uace0, \uac19\uc740 \uc9d1\ud569\uc5d0 \ud574\ub2f9\ud558\ub294 dango\ub4e4\uc5d0 \ub300\ud574\uc11c\ub294 \ub9c8\uc9c0\ub9c9 dango\uc758 \uc120\ud0dd \uc5ec\ubd80\ub9cc \uae30\uc5b5\ud558\uba74 \ub418\ub2c8, \\(O(N)\\)\uc5d0 dp\ub97c \ud1b5\ud574 \uad6c\ud560 \uc218 \uc788\ub2e4.</p>","tags":["~post"]},{"location":"study/Random%20Platinum%20Defence/rpd/","title":"Random Platinum Defence","text":"<p>Random Problem</p> Date Problem Time Without Computer Time With Computer Failed Attempts Total Penalty 2023-05-01 14961 12 15 2 67 2023-05-02 14756 11 23 3 94 2023-05-03 10266 2 16 1 38 2023-05-04 8916 2 8 0 10 2023-05-05 3946 12 14 0 26 2023-05-06 9463 1 5 0 6 2023-07-09 3295 4 16 0 20 2023-07-10 20176 7 20 0 27 2024-03-05 2764 8 12 0 20 2024-03-05 27844 7 24 1 51 2024-03-07 20701 14 6 0 20 2024-05-22 16529 6 7 0 13 2024-05-22 18208 10 10 0 20 2024-05-22 24614 31 22 0 53"}]}